"""added clinical data tables

Revision ID: 325f9c7aaf07
Revises: 405b680558e1
Create Date: 2025-07-05 14:16:56.781555

"""
import sqlalchemy as sa
from alembic import op
from sqlalchemy.dialects import postgresql

# revision identifiers, used by Alembic.
revision = '325f9c7aaf07'
down_revision = '405b680558e1'
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('clinical_data',
                    sa.Column('analysis_request_uid', sa.String(), nullable=False),
                    sa.Column('symptoms', postgresql.ARRAY(sa.String()), nullable=True),
                    sa.Column('symptoms_raw', sa.Text(), nullable=True),
                    sa.Column('clinical_indication', sa.Text(), nullable=True),
                    sa.Column('pregnancy_status', sa.Boolean(), nullable=True),
                    sa.Column('breast_feeding', sa.Boolean(), nullable=True),
                    sa.Column('vitals', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
                    sa.Column('treatment_notes', sa.Text(), nullable=True),
                    sa.Column('other_context', postgresql.JSONB(astext_type=sa.Text()), nullable=True),
                    sa.Column('uid', sa.String(), nullable=False),
                    sa.Column('created_at', sa.DateTime(), nullable=True),
                    sa.Column('created_by_uid', sa.String(), nullable=True),
                    sa.Column('updated_at', sa.DateTime(), nullable=True),
                    sa.Column('updated_by_uid', sa.String(), nullable=True),
                    sa.ForeignKeyConstraint(['analysis_request_uid'], ['analysis_request.uid'], ),
                    sa.ForeignKeyConstraint(['created_by_uid'], ['user.uid'], ),
                    sa.ForeignKeyConstraint(['updated_by_uid'], ['user.uid'], ),
                    sa.PrimaryKeyConstraint('uid'),
                    sa.UniqueConstraint('analysis_request_uid')
                    )
    op.create_index(op.f('ix_clinical_data_uid'), 'clinical_data', ['uid'], unique=False)
    op.create_table('clinical_data_coding',
                    sa.Column('clinical_data_uid', sa.String(), nullable=False),
                    sa.Column('coding_standard_uid', sa.String(), nullable=False),
                    sa.Column('code', sa.String(), nullable=False),
                    sa.Column('name', sa.String(), nullable=True),
                    sa.Column('description', sa.Text(), nullable=True),
                    sa.Column('uid', sa.String(), nullable=False),
                    sa.Column('created_at', sa.DateTime(), nullable=True),
                    sa.Column('created_by_uid', sa.String(), nullable=True),
                    sa.Column('updated_at', sa.DateTime(), nullable=True),
                    sa.Column('updated_by_uid', sa.String(), nullable=True),
                    sa.ForeignKeyConstraint(['clinical_data_uid'], ['clinical_data.uid'], ),
                    sa.ForeignKeyConstraint(['coding_standard_uid'], ['coding_standard.uid'], ),
                    sa.ForeignKeyConstraint(['created_by_uid'], ['user.uid'], ),
                    sa.ForeignKeyConstraint(['updated_by_uid'], ['user.uid'], ),
                    sa.PrimaryKeyConstraint('uid'),
                    sa.UniqueConstraint('clinical_data_uid', 'coding_standard_uid')
                    )
    op.create_index(op.f('ix_clinical_data_coding_uid'), 'clinical_data_coding', ['uid'], unique=False)
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_index(op.f('ix_clinical_data_coding_uid'), table_name='clinical_data_coding')
    op.drop_table('clinical_data_coding')
    op.drop_index(op.f('ix_clinical_data_uid'), table_name='clinical_data')
    op.drop_table('clinical_data')
    # ### end Alembic commands ###
