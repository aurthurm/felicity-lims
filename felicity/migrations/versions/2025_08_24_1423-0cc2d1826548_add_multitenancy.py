"""add-multitenancy

Revision ID: 0cc2d1826548
Revises: 225f793a73ce
Create Date: 2025-08-24 14:23:26.159985

"""
from alembic import op
import sqlalchemy as sa
from sqlalchemy.dialects import postgresql

# revision identifiers, used by Alembic.
revision = '0cc2d1826548'
down_revision = '225f793a73ce'
branch_labels = None
depends_on = None


def upgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.create_table('organization',
    sa.Column('setup_name', sa.String(), nullable=False),
    sa.Column('name', sa.String(), nullable=False),
    sa.Column('code', sa.String(), nullable=True),
    sa.Column('timezone', sa.String(), nullable=True),
    sa.Column('tag_line', sa.String(), nullable=True),
    sa.Column('email', sa.String(), nullable=True),
    sa.Column('email_cc', sa.String(), nullable=True),
    sa.Column('mobile_phone', sa.String(), nullable=True),
    sa.Column('business_phone', sa.String(), nullable=True),
    sa.Column('address', sa.String(), nullable=True),
    sa.Column('banking', sa.String(), nullable=True),
    sa.Column('logo', sa.String(), nullable=True),
    sa.Column('quality_statement', sa.String(), nullable=True),
    sa.Column('country_uid', sa.String(), nullable=True),
    sa.Column('province_uid', sa.String(), nullable=True),
    sa.Column('district_uid', sa.String(), nullable=True),
    sa.Column('uid', sa.String(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('created_by_uid', sa.String(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.Column('updated_by_uid', sa.String(), nullable=True),
    sa.ForeignKeyConstraint(['country_uid'], ['country.uid'], ),
    sa.ForeignKeyConstraint(['created_by_uid'], ['user.uid'], ),
    sa.ForeignKeyConstraint(['district_uid'], ['district.uid'], ),
    sa.ForeignKeyConstraint(['province_uid'], ['province.uid'], ),
    sa.ForeignKeyConstraint(['updated_by_uid'], ['user.uid'], ),
    sa.PrimaryKeyConstraint('uid'),
    sa.UniqueConstraint('code'),
    sa.UniqueConstraint('name')
    )
    op.create_index(op.f('ix_organization_uid'), 'organization', ['uid'], unique=False)
    op.create_table('laboratory_user',
    sa.Column('laboratory_uid', sa.String(), nullable=False),
    sa.Column('user_uid', sa.String(), nullable=False),
    sa.ForeignKeyConstraint(['laboratory_uid'], ['laboratory.uid'], ),
    sa.ForeignKeyConstraint(['user_uid'], ['user.uid'], ),
    sa.PrimaryKeyConstraint('laboratory_uid', 'user_uid')
    )
    op.create_table('organization_setting',
    sa.Column('organization_uid', sa.String(), nullable=False),
    sa.Column('password_lifetime', sa.Integer(), nullable=True),
    sa.Column('inactivity_log_out', sa.Integer(), nullable=True),
    sa.Column('allow_billing', sa.Boolean(), nullable=True),
    sa.Column('allow_auto_billing', sa.Boolean(), nullable=True),
    sa.Column('currency', sa.String(), nullable=True),
    sa.Column('payment_terms_days', sa.Integer(), nullable=True),
    sa.Column('uid', sa.String(), nullable=False),
    sa.Column('created_at', sa.DateTime(), nullable=True),
    sa.Column('created_by_uid', sa.String(), nullable=True),
    sa.Column('updated_at', sa.DateTime(), nullable=True),
    sa.Column('updated_by_uid', sa.String(), nullable=True),
    sa.ForeignKeyConstraint(['created_by_uid'], ['user.uid'], ),
    sa.ForeignKeyConstraint(['organization_uid'], ['organization.uid'], ),
    sa.ForeignKeyConstraint(['updated_by_uid'], ['user.uid'], ),
    sa.PrimaryKeyConstraint('uid')
    )
    op.create_index(op.f('ix_organization_setting_uid'), 'organization_setting', ['uid'], unique=False)
    op.add_column('abx_ast_panel', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_abx_ast_panel_laboratory_uid'), 'abx_ast_panel', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'abx_ast_panel', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('abx_ast_result', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_abx_ast_result_laboratory_uid'), 'abx_ast_result', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'abx_ast_result', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('abx_organism_result', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_abx_organism_result_laboratory_uid'), 'abx_organism_result', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'abx_organism_result', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('activity_feed', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_activity_feed_laboratory_uid'), 'activity_feed', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'activity_feed', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('activity_stream', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_activity_stream_laboratory_uid'), 'activity_stream', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'activity_stream', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('analysis_discount', sa.Column('laboratory_uid', sa.String(), nullable=True))
    op.create_index(op.f('ix_analysis_discount_laboratory_uid'), 'analysis_discount', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'analysis_discount', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('analysis_price', sa.Column('laboratory_uid', sa.String(), nullable=True))
    op.create_index(op.f('ix_analysis_price_laboratory_uid'), 'analysis_price', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'analysis_price', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('analysis_request', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_analysis_request_laboratory_uid'), 'analysis_request', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'analysis_request', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('analysis_result', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_analysis_result_laboratory_uid'), 'analysis_result', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'analysis_result', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('analysis_template', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_analysis_template_laboratory_uid'), 'analysis_template', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'analysis_template', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('analysis_uncertainty', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_analysis_uncertainty_laboratory_uid'), 'analysis_uncertainty', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'analysis_uncertainty', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('app_activity_logs', sa.Column('user_uid', sa.String(length=39), nullable=True))
    op.add_column('app_activity_logs', sa.Column('request_id', sa.String(length=39), nullable=True))
    op.add_column('app_activity_logs', sa.Column('laboratory_uid', sa.String(length=39), nullable=True))
    op.add_column('app_activity_logs', sa.Column('organization_uid', sa.String(length=39), nullable=True))
    op.add_column('audit_log', sa.Column('extras', postgresql.JSONB(astext_type=sa.Text()), nullable=True))
    op.add_column('calibration_certificate', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_calibration_certificate_laboratory_uid'), 'calibration_certificate', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'calibration_certificate', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('clinical_data', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_clinical_data_laboratory_uid'), 'clinical_data', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'clinical_data', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('clinical_data_coding', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_clinical_data_coding_laboratory_uid'), 'clinical_data_coding', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'clinical_data_coding', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('country', sa.Column('email', sa.String(), nullable=True))
    op.add_column('country', sa.Column('email_cc', sa.String(), nullable=True))
    op.add_column('country', sa.Column('mobile_phone', sa.String(), nullable=True))
    op.add_column('country', sa.Column('business_phone', sa.String(), nullable=True))
    op.add_column('document', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_document_laboratory_uid'), 'document', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'document', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('document_audit', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_document_audit_laboratory_uid'), 'document_audit', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'document_audit', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('document_category', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_document_category_laboratory_uid'), 'document_category', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'document_category', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('document_folder', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_document_folder_laboratory_uid'), 'document_folder', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'document_folder', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('document_review_cycle', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_document_review_cycle_laboratory_uid'), 'document_review_cycle', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'document_review_cycle', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('document_review_step', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_document_review_step_laboratory_uid'), 'document_review_step', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'document_review_step', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('document_status', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_document_status_laboratory_uid'), 'document_status', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'document_status', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('document_subscription', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_document_subscription_laboratory_uid'), 'document_subscription', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'document_subscription', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('document_tag', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_document_tag_laboratory_uid'), 'document_tag', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'document_tag', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('document_template', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_document_template_laboratory_uid'), 'document_template', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'document_template', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('document_version', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_document_version_laboratory_uid'), 'document_version', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'document_version', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('grind_board', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_grind_board_laboratory_uid'), 'grind_board', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'grind_board', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('grind_errand', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_grind_errand_laboratory_uid'), 'grind_errand', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'grind_errand', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('grind_errand_discussion', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_grind_errand_discussion_laboratory_uid'), 'grind_errand_discussion', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'grind_errand_discussion', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('grind_label', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_grind_label_laboratory_uid'), 'grind_label', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'grind_label', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('grind_media', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_grind_media_laboratory_uid'), 'grind_media', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'grind_media', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('grind_milestone', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_grind_milestone_laboratory_uid'), 'grind_milestone', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'grind_milestone', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('grind_occurrence', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_grind_occurrence_laboratory_uid'), 'grind_occurrence', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'grind_occurrence', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('grind_poster', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_grind_poster_laboratory_uid'), 'grind_poster', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'grind_poster', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('grind_scheme', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_grind_scheme_laboratory_uid'), 'grind_scheme', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'grind_scheme', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('grind_stamp', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_grind_stamp_laboratory_uid'), 'grind_stamp', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'grind_stamp', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('group', sa.Column('laboratory_uid', sa.String(), nullable=True))
    op.create_index(op.f('ix_group_laboratory_uid'), 'group', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'group', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('instrument_calibration', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_instrument_calibration_laboratory_uid'), 'instrument_calibration', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'instrument_calibration', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('instrument_competence', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_instrument_competence_laboratory_uid'), 'instrument_competence', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'instrument_competence', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('laboratory', sa.Column('organization_uid', sa.String(), nullable=False))
    op.add_column('laboratory', sa.Column('name', sa.String(), nullable=False))
    op.add_column('laboratory', sa.Column('country_uid', sa.String(), nullable=True))
    op.add_column('laboratory', sa.Column('province_uid', sa.String(), nullable=True))
    op.add_column('laboratory', sa.Column('district_uid', sa.String(), nullable=True))
    op.create_foreign_key(None, 'laboratory', 'country', ['country_uid'], ['uid'])
    op.create_foreign_key(None, 'laboratory', 'district', ['district_uid'], ['uid'])
    op.create_foreign_key(None, 'laboratory', 'province', ['province_uid'], ['uid'])
    op.create_foreign_key(None, 'laboratory', 'organization', ['organization_uid'], ['uid'])
    op.drop_column('laboratory', 'lab_name')
    op.drop_column('laboratory', 'setup_name')
    op.add_column('laboratory_instrument', sa.Column('laboratory_uid', sa.String(), nullable=True))
    op.create_index(op.f('ix_laboratory_instrument_laboratory_uid'), 'laboratory_instrument', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'laboratory_instrument', 'laboratory', ['laboratory_uid'], ['uid'])
    op.alter_column('laboratory_setting', 'laboratory_uid',
               existing_type=sa.VARCHAR(),
               nullable=False)
    op.create_index(op.f('ix_laboratory_setting_laboratory_uid'), 'laboratory_setting', ['laboratory_uid'], unique=False)
    op.add_column('message', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_message_laboratory_uid'), 'message', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'message', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('message_thread', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_message_thread_laboratory_uid'), 'message_thread', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'message_thread', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('notice', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_notice_laboratory_uid'), 'notice', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'notice', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('notification', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_notification_laboratory_uid'), 'notification', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'notification', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('patient', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_patient_laboratory_uid'), 'patient', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'patient', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('patient_identification', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_patient_identification_laboratory_uid'), 'patient_identification', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'patient_identification', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('profile', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_profile_laboratory_uid'), 'profile', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'profile', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('profile_coding', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_profile_coding_laboratory_uid'), 'profile_coding', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'profile_coding', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('profile_discount', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_profile_discount_laboratory_uid'), 'profile_discount', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'profile_discount', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('profile_price', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_profile_price_laboratory_uid'), 'profile_price', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'profile_price', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('qc_level', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_qc_level_laboratory_uid'), 'qc_level', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'qc_level', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('qc_reference', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_qc_reference_laboratory_uid'), 'qc_reference', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'qc_reference', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('qc_set', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_qc_set_laboratory_uid'), 'qc_set', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'qc_set', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('qc_template', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_qc_template_laboratory_uid'), 'qc_template', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'qc_template', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('referral_laboratory', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_referral_laboratory_laboratory_uid'), 'referral_laboratory', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'referral_laboratory', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('report_meta', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_report_meta_laboratory_uid'), 'report_meta', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'report_meta', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('result_mutation', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_result_mutation_laboratory_uid'), 'result_mutation', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'result_mutation', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('sample', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_sample_laboratory_uid'), 'sample', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'sample', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('shipped_sample', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_shipped_sample_laboratory_uid'), 'shipped_sample', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'shipped_sample', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('stock_adjustment', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_stock_adjustment_laboratory_uid'), 'stock_adjustment', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'stock_adjustment', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('stock_order', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_stock_order_laboratory_uid'), 'stock_order', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'stock_order', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('stock_order_product', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_stock_order_product_laboratory_uid'), 'stock_order_product', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'stock_order_product', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('stock_product_inventory', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_stock_product_inventory_laboratory_uid'), 'stock_product_inventory', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'stock_product_inventory', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('stock_receipt', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_stock_receipt_laboratory_uid'), 'stock_receipt', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'stock_receipt', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('test_bill', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_test_bill_laboratory_uid'), 'test_bill', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'test_bill', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('test_bill_invoice', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_test_bill_invoice_laboratory_uid'), 'test_bill_invoice', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'test_bill_invoice', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('test_bill_transaction', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_test_bill_transaction_laboratory_uid'), 'test_bill_transaction', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'test_bill_transaction', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('user', sa.Column('active_laboratory_uid', sa.String(), nullable=True))
    op.create_foreign_key(None, 'user', 'laboratory', ['active_laboratory_uid'], ['uid'])
    op.add_column('user_preference', sa.Column('laboratory_uid', sa.String(), nullable=True))
    op.create_index(op.f('ix_user_preference_laboratory_uid'), 'user_preference', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'user_preference', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('voucher', sa.Column('laboratory_uid', sa.String(), nullable=True))
    op.create_index(op.f('ix_voucher_laboratory_uid'), 'voucher', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'voucher', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('voucher_code', sa.Column('laboratory_uid', sa.String(), nullable=True))
    op.create_index(op.f('ix_voucher_code_laboratory_uid'), 'voucher_code', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'voucher_code', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('voucher_customer', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_voucher_customer_laboratory_uid'), 'voucher_customer', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'voucher_customer', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('worksheet', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_worksheet_laboratory_uid'), 'worksheet', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'worksheet', 'laboratory', ['laboratory_uid'], ['uid'])
    op.add_column('worksheet_template', sa.Column('laboratory_uid', sa.String(), nullable=False))
    op.create_index(op.f('ix_worksheet_template_laboratory_uid'), 'worksheet_template', ['laboratory_uid'], unique=False)
    op.create_foreign_key(None, 'worksheet_template', 'laboratory', ['laboratory_uid'], ['uid'])
    # ### end Alembic commands ###


def downgrade():
    # ### commands auto generated by Alembic - please adjust! ###
    op.drop_constraint(None, 'worksheet_template', type_='foreignkey')
    op.drop_index(op.f('ix_worksheet_template_laboratory_uid'), table_name='worksheet_template')
    op.drop_column('worksheet_template', 'laboratory_uid')
    op.drop_constraint(None, 'worksheet', type_='foreignkey')
    op.drop_index(op.f('ix_worksheet_laboratory_uid'), table_name='worksheet')
    op.drop_column('worksheet', 'laboratory_uid')
    op.drop_constraint(None, 'voucher_customer', type_='foreignkey')
    op.drop_index(op.f('ix_voucher_customer_laboratory_uid'), table_name='voucher_customer')
    op.drop_column('voucher_customer', 'laboratory_uid')
    op.drop_constraint(None, 'voucher_code', type_='foreignkey')
    op.drop_index(op.f('ix_voucher_code_laboratory_uid'), table_name='voucher_code')
    op.drop_column('voucher_code', 'laboratory_uid')
    op.drop_constraint(None, 'voucher', type_='foreignkey')
    op.drop_index(op.f('ix_voucher_laboratory_uid'), table_name='voucher')
    op.drop_column('voucher', 'laboratory_uid')
    op.drop_constraint(None, 'user_preference', type_='foreignkey')
    op.drop_index(op.f('ix_user_preference_laboratory_uid'), table_name='user_preference')
    op.drop_column('user_preference', 'laboratory_uid')
    op.drop_constraint(None, 'user', type_='foreignkey')
    op.drop_column('user', 'active_laboratory_uid')
    op.drop_constraint(None, 'test_bill_transaction', type_='foreignkey')
    op.drop_index(op.f('ix_test_bill_transaction_laboratory_uid'), table_name='test_bill_transaction')
    op.drop_column('test_bill_transaction', 'laboratory_uid')
    op.drop_constraint(None, 'test_bill_invoice', type_='foreignkey')
    op.drop_index(op.f('ix_test_bill_invoice_laboratory_uid'), table_name='test_bill_invoice')
    op.drop_column('test_bill_invoice', 'laboratory_uid')
    op.drop_constraint(None, 'test_bill', type_='foreignkey')
    op.drop_index(op.f('ix_test_bill_laboratory_uid'), table_name='test_bill')
    op.drop_column('test_bill', 'laboratory_uid')
    op.drop_constraint(None, 'stock_receipt', type_='foreignkey')
    op.drop_index(op.f('ix_stock_receipt_laboratory_uid'), table_name='stock_receipt')
    op.drop_column('stock_receipt', 'laboratory_uid')
    op.drop_constraint(None, 'stock_product_inventory', type_='foreignkey')
    op.drop_index(op.f('ix_stock_product_inventory_laboratory_uid'), table_name='stock_product_inventory')
    op.drop_column('stock_product_inventory', 'laboratory_uid')
    op.drop_constraint(None, 'stock_order_product', type_='foreignkey')
    op.drop_index(op.f('ix_stock_order_product_laboratory_uid'), table_name='stock_order_product')
    op.drop_column('stock_order_product', 'laboratory_uid')
    op.drop_constraint(None, 'stock_order', type_='foreignkey')
    op.drop_index(op.f('ix_stock_order_laboratory_uid'), table_name='stock_order')
    op.drop_column('stock_order', 'laboratory_uid')
    op.drop_constraint(None, 'stock_adjustment', type_='foreignkey')
    op.drop_index(op.f('ix_stock_adjustment_laboratory_uid'), table_name='stock_adjustment')
    op.drop_column('stock_adjustment', 'laboratory_uid')
    op.drop_constraint(None, 'shipped_sample', type_='foreignkey')
    op.drop_index(op.f('ix_shipped_sample_laboratory_uid'), table_name='shipped_sample')
    op.drop_column('shipped_sample', 'laboratory_uid')
    op.drop_constraint(None, 'sample', type_='foreignkey')
    op.drop_index(op.f('ix_sample_laboratory_uid'), table_name='sample')
    op.drop_column('sample', 'laboratory_uid')
    op.drop_constraint(None, 'result_mutation', type_='foreignkey')
    op.drop_index(op.f('ix_result_mutation_laboratory_uid'), table_name='result_mutation')
    op.drop_column('result_mutation', 'laboratory_uid')
    op.drop_constraint(None, 'report_meta', type_='foreignkey')
    op.drop_index(op.f('ix_report_meta_laboratory_uid'), table_name='report_meta')
    op.drop_column('report_meta', 'laboratory_uid')
    op.drop_constraint(None, 'referral_laboratory', type_='foreignkey')
    op.drop_index(op.f('ix_referral_laboratory_laboratory_uid'), table_name='referral_laboratory')
    op.drop_column('referral_laboratory', 'laboratory_uid')
    op.drop_constraint(None, 'qc_template', type_='foreignkey')
    op.drop_index(op.f('ix_qc_template_laboratory_uid'), table_name='qc_template')
    op.drop_column('qc_template', 'laboratory_uid')
    op.drop_constraint(None, 'qc_set', type_='foreignkey')
    op.drop_index(op.f('ix_qc_set_laboratory_uid'), table_name='qc_set')
    op.drop_column('qc_set', 'laboratory_uid')
    op.drop_constraint(None, 'qc_reference', type_='foreignkey')
    op.drop_index(op.f('ix_qc_reference_laboratory_uid'), table_name='qc_reference')
    op.drop_column('qc_reference', 'laboratory_uid')
    op.drop_constraint(None, 'qc_level', type_='foreignkey')
    op.drop_index(op.f('ix_qc_level_laboratory_uid'), table_name='qc_level')
    op.drop_column('qc_level', 'laboratory_uid')
    op.drop_constraint(None, 'profile_price', type_='foreignkey')
    op.drop_index(op.f('ix_profile_price_laboratory_uid'), table_name='profile_price')
    op.drop_column('profile_price', 'laboratory_uid')
    op.drop_constraint(None, 'profile_discount', type_='foreignkey')
    op.drop_index(op.f('ix_profile_discount_laboratory_uid'), table_name='profile_discount')
    op.drop_column('profile_discount', 'laboratory_uid')
    op.drop_constraint(None, 'profile_coding', type_='foreignkey')
    op.drop_index(op.f('ix_profile_coding_laboratory_uid'), table_name='profile_coding')
    op.drop_column('profile_coding', 'laboratory_uid')
    op.drop_constraint(None, 'profile', type_='foreignkey')
    op.drop_index(op.f('ix_profile_laboratory_uid'), table_name='profile')
    op.drop_column('profile', 'laboratory_uid')
    op.drop_constraint(None, 'patient_identification', type_='foreignkey')
    op.drop_index(op.f('ix_patient_identification_laboratory_uid'), table_name='patient_identification')
    op.drop_column('patient_identification', 'laboratory_uid')
    op.drop_constraint(None, 'patient', type_='foreignkey')
    op.drop_index(op.f('ix_patient_laboratory_uid'), table_name='patient')
    op.drop_column('patient', 'laboratory_uid')
    op.drop_constraint(None, 'notification', type_='foreignkey')
    op.drop_index(op.f('ix_notification_laboratory_uid'), table_name='notification')
    op.drop_column('notification', 'laboratory_uid')
    op.drop_constraint(None, 'notice', type_='foreignkey')
    op.drop_index(op.f('ix_notice_laboratory_uid'), table_name='notice')
    op.drop_column('notice', 'laboratory_uid')
    op.drop_constraint(None, 'message_thread', type_='foreignkey')
    op.drop_index(op.f('ix_message_thread_laboratory_uid'), table_name='message_thread')
    op.drop_column('message_thread', 'laboratory_uid')
    op.drop_constraint(None, 'message', type_='foreignkey')
    op.drop_index(op.f('ix_message_laboratory_uid'), table_name='message')
    op.drop_column('message', 'laboratory_uid')
    op.drop_index(op.f('ix_laboratory_setting_laboratory_uid'), table_name='laboratory_setting')
    op.alter_column('laboratory_setting', 'laboratory_uid',
               existing_type=sa.VARCHAR(),
               nullable=True)
    op.drop_constraint(None, 'laboratory_instrument', type_='foreignkey')
    op.drop_index(op.f('ix_laboratory_instrument_laboratory_uid'), table_name='laboratory_instrument')
    op.drop_column('laboratory_instrument', 'laboratory_uid')
    op.add_column('laboratory', sa.Column('setup_name', sa.VARCHAR(), autoincrement=False, nullable=False))
    op.add_column('laboratory', sa.Column('lab_name', sa.VARCHAR(), autoincrement=False, nullable=False))
    op.drop_constraint(None, 'laboratory', type_='foreignkey')
    op.drop_constraint(None, 'laboratory', type_='foreignkey')
    op.drop_constraint(None, 'laboratory', type_='foreignkey')
    op.drop_constraint(None, 'laboratory', type_='foreignkey')
    op.drop_column('laboratory', 'district_uid')
    op.drop_column('laboratory', 'province_uid')
    op.drop_column('laboratory', 'country_uid')
    op.drop_column('laboratory', 'name')
    op.drop_column('laboratory', 'organization_uid')
    op.drop_constraint(None, 'instrument_competence', type_='foreignkey')
    op.drop_index(op.f('ix_instrument_competence_laboratory_uid'), table_name='instrument_competence')
    op.drop_column('instrument_competence', 'laboratory_uid')
    op.drop_constraint(None, 'instrument_calibration', type_='foreignkey')
    op.drop_index(op.f('ix_instrument_calibration_laboratory_uid'), table_name='instrument_calibration')
    op.drop_column('instrument_calibration', 'laboratory_uid')
    op.drop_constraint(None, 'group', type_='foreignkey')
    op.drop_index(op.f('ix_group_laboratory_uid'), table_name='group')
    op.drop_column('group', 'laboratory_uid')
    op.drop_constraint(None, 'grind_stamp', type_='foreignkey')
    op.drop_index(op.f('ix_grind_stamp_laboratory_uid'), table_name='grind_stamp')
    op.drop_column('grind_stamp', 'laboratory_uid')
    op.drop_constraint(None, 'grind_scheme', type_='foreignkey')
    op.drop_index(op.f('ix_grind_scheme_laboratory_uid'), table_name='grind_scheme')
    op.drop_column('grind_scheme', 'laboratory_uid')
    op.drop_constraint(None, 'grind_poster', type_='foreignkey')
    op.drop_index(op.f('ix_grind_poster_laboratory_uid'), table_name='grind_poster')
    op.drop_column('grind_poster', 'laboratory_uid')
    op.drop_constraint(None, 'grind_occurrence', type_='foreignkey')
    op.drop_index(op.f('ix_grind_occurrence_laboratory_uid'), table_name='grind_occurrence')
    op.drop_column('grind_occurrence', 'laboratory_uid')
    op.drop_constraint(None, 'grind_milestone', type_='foreignkey')
    op.drop_index(op.f('ix_grind_milestone_laboratory_uid'), table_name='grind_milestone')
    op.drop_column('grind_milestone', 'laboratory_uid')
    op.drop_constraint(None, 'grind_media', type_='foreignkey')
    op.drop_index(op.f('ix_grind_media_laboratory_uid'), table_name='grind_media')
    op.drop_column('grind_media', 'laboratory_uid')
    op.drop_constraint(None, 'grind_label', type_='foreignkey')
    op.drop_index(op.f('ix_grind_label_laboratory_uid'), table_name='grind_label')
    op.drop_column('grind_label', 'laboratory_uid')
    op.drop_constraint(None, 'grind_errand_discussion', type_='foreignkey')
    op.drop_index(op.f('ix_grind_errand_discussion_laboratory_uid'), table_name='grind_errand_discussion')
    op.drop_column('grind_errand_discussion', 'laboratory_uid')
    op.drop_constraint(None, 'grind_errand', type_='foreignkey')
    op.drop_index(op.f('ix_grind_errand_laboratory_uid'), table_name='grind_errand')
    op.drop_column('grind_errand', 'laboratory_uid')
    op.drop_constraint(None, 'grind_board', type_='foreignkey')
    op.drop_index(op.f('ix_grind_board_laboratory_uid'), table_name='grind_board')
    op.drop_column('grind_board', 'laboratory_uid')
    op.drop_constraint(None, 'document_version', type_='foreignkey')
    op.drop_index(op.f('ix_document_version_laboratory_uid'), table_name='document_version')
    op.drop_column('document_version', 'laboratory_uid')
    op.drop_constraint(None, 'document_template', type_='foreignkey')
    op.drop_index(op.f('ix_document_template_laboratory_uid'), table_name='document_template')
    op.drop_column('document_template', 'laboratory_uid')
    op.drop_constraint(None, 'document_tag', type_='foreignkey')
    op.drop_index(op.f('ix_document_tag_laboratory_uid'), table_name='document_tag')
    op.drop_column('document_tag', 'laboratory_uid')
    op.drop_constraint(None, 'document_subscription', type_='foreignkey')
    op.drop_index(op.f('ix_document_subscription_laboratory_uid'), table_name='document_subscription')
    op.drop_column('document_subscription', 'laboratory_uid')
    op.drop_constraint(None, 'document_status', type_='foreignkey')
    op.drop_index(op.f('ix_document_status_laboratory_uid'), table_name='document_status')
    op.drop_column('document_status', 'laboratory_uid')
    op.drop_constraint(None, 'document_review_step', type_='foreignkey')
    op.drop_index(op.f('ix_document_review_step_laboratory_uid'), table_name='document_review_step')
    op.drop_column('document_review_step', 'laboratory_uid')
    op.drop_constraint(None, 'document_review_cycle', type_='foreignkey')
    op.drop_index(op.f('ix_document_review_cycle_laboratory_uid'), table_name='document_review_cycle')
    op.drop_column('document_review_cycle', 'laboratory_uid')
    op.drop_constraint(None, 'document_folder', type_='foreignkey')
    op.drop_index(op.f('ix_document_folder_laboratory_uid'), table_name='document_folder')
    op.drop_column('document_folder', 'laboratory_uid')
    op.drop_constraint(None, 'document_category', type_='foreignkey')
    op.drop_index(op.f('ix_document_category_laboratory_uid'), table_name='document_category')
    op.drop_column('document_category', 'laboratory_uid')
    op.drop_constraint(None, 'document_audit', type_='foreignkey')
    op.drop_index(op.f('ix_document_audit_laboratory_uid'), table_name='document_audit')
    op.drop_column('document_audit', 'laboratory_uid')
    op.drop_constraint(None, 'document', type_='foreignkey')
    op.drop_index(op.f('ix_document_laboratory_uid'), table_name='document')
    op.drop_column('document', 'laboratory_uid')
    op.drop_column('country', 'business_phone')
    op.drop_column('country', 'mobile_phone')
    op.drop_column('country', 'email_cc')
    op.drop_column('country', 'email')
    op.drop_constraint(None, 'clinical_data_coding', type_='foreignkey')
    op.drop_index(op.f('ix_clinical_data_coding_laboratory_uid'), table_name='clinical_data_coding')
    op.drop_column('clinical_data_coding', 'laboratory_uid')
    op.drop_constraint(None, 'clinical_data', type_='foreignkey')
    op.drop_index(op.f('ix_clinical_data_laboratory_uid'), table_name='clinical_data')
    op.drop_column('clinical_data', 'laboratory_uid')
    op.drop_constraint(None, 'calibration_certificate', type_='foreignkey')
    op.drop_index(op.f('ix_calibration_certificate_laboratory_uid'), table_name='calibration_certificate')
    op.drop_column('calibration_certificate', 'laboratory_uid')
    op.drop_column('audit_log', 'extras')
    op.drop_column('app_activity_logs', 'organization_uid')
    op.drop_column('app_activity_logs', 'laboratory_uid')
    op.drop_column('app_activity_logs', 'request_id')
    op.drop_column('app_activity_logs', 'user_uid')
    op.drop_constraint(None, 'analysis_uncertainty', type_='foreignkey')
    op.drop_index(op.f('ix_analysis_uncertainty_laboratory_uid'), table_name='analysis_uncertainty')
    op.drop_column('analysis_uncertainty', 'laboratory_uid')
    op.drop_constraint(None, 'analysis_template', type_='foreignkey')
    op.drop_index(op.f('ix_analysis_template_laboratory_uid'), table_name='analysis_template')
    op.drop_column('analysis_template', 'laboratory_uid')
    op.drop_constraint(None, 'analysis_result', type_='foreignkey')
    op.drop_index(op.f('ix_analysis_result_laboratory_uid'), table_name='analysis_result')
    op.drop_column('analysis_result', 'laboratory_uid')
    op.drop_constraint(None, 'analysis_request', type_='foreignkey')
    op.drop_index(op.f('ix_analysis_request_laboratory_uid'), table_name='analysis_request')
    op.drop_column('analysis_request', 'laboratory_uid')
    op.drop_constraint(None, 'analysis_price', type_='foreignkey')
    op.drop_index(op.f('ix_analysis_price_laboratory_uid'), table_name='analysis_price')
    op.drop_column('analysis_price', 'laboratory_uid')
    op.drop_constraint(None, 'analysis_discount', type_='foreignkey')
    op.drop_index(op.f('ix_analysis_discount_laboratory_uid'), table_name='analysis_discount')
    op.drop_column('analysis_discount', 'laboratory_uid')
    op.drop_constraint(None, 'activity_stream', type_='foreignkey')
    op.drop_index(op.f('ix_activity_stream_laboratory_uid'), table_name='activity_stream')
    op.drop_column('activity_stream', 'laboratory_uid')
    op.drop_constraint(None, 'activity_feed', type_='foreignkey')
    op.drop_index(op.f('ix_activity_feed_laboratory_uid'), table_name='activity_feed')
    op.drop_column('activity_feed', 'laboratory_uid')
    op.drop_constraint(None, 'abx_organism_result', type_='foreignkey')
    op.drop_index(op.f('ix_abx_organism_result_laboratory_uid'), table_name='abx_organism_result')
    op.drop_column('abx_organism_result', 'laboratory_uid')
    op.drop_constraint(None, 'abx_ast_result', type_='foreignkey')
    op.drop_index(op.f('ix_abx_ast_result_laboratory_uid'), table_name='abx_ast_result')
    op.drop_column('abx_ast_result', 'laboratory_uid')
    op.drop_constraint(None, 'abx_ast_panel', type_='foreignkey')
    op.drop_index(op.f('ix_abx_ast_panel_laboratory_uid'), table_name='abx_ast_panel')
    op.drop_column('abx_ast_panel', 'laboratory_uid')
    op.drop_index(op.f('ix_organization_setting_uid'), table_name='organization_setting')
    op.drop_table('organization_setting')
    op.drop_table('laboratory_user')
    op.drop_index(op.f('ix_organization_uid'), table_name='organization')
    op.drop_table('organization')
    # ### end Alembic commands ###
