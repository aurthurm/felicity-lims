import{a0 as D,aq as N,g as j,a7 as L,ad as E,a5 as S,e as k,_ as U,r as w,c,o as i,A as o,E as C,C as R,F as g,H as F,J as M,K as T,N as h,Q as P,L as m,P as A,a as H,b as I,a2 as V,D as W}from"./index-v7Q387fb.js";import{C as q}from"./index-u1GM8hOO.js";import{u as z}from"./dashboard-DNWjftU4.js";import"./index-BkD7Hj8s.js";import"./ticks-yQcwDFE8.js";import"./arc-B8IjlRao.js";import"./rgb-Co1IAoj1.js";import"./math-CyDA0WRY.js";import"./index-DaJBD5B5.js";import"./defaultLocale-D2nGpDRe.js";import"./Tableau10-1LCcg9PS.js";import"./range-OtVwhkKS.js";const J=D({__name:"Resource",setup(B,{expose:t}){t();const l=z(),{dashboard:e}=N(l),p=j({range:{from:"",to:""}}),x=L(!1),y=()=>{l.setFilterRange(k(p.range.from),k(p.range.to)),x.value=!1};E(async()=>{r(),l.setShowFilters(!0),l.getResourceStats()}),S(()=>e.value.filterRange.from,()=>{r(),l.getResourceStats()}),S(()=>e.value.resourceStats?.samples,a=>{a?.forEach(n=>{const f=[],s=n.counts?.reduce((d,u)=>d+u.count,0)||0;n.counts?.forEach(d=>{f.push({item:d.group,count:d.count,percent:d.count/s})}),console.log(n.group),v(f,n.group,n.group)})});const _=a=>{const n=e.value.resourceStats?.instruments?.reduce((s,d)=>s+d.count,0)||0;return`${(a/n*100).toFixed(2)}%`},v=(a,n,f)=>{const s=new q({container:n,autoFit:!0,height:250,width:500,localRefresh:!1});s.coordinate("theta",{radius:.75,innerRadius:.5}),s.data(a),s.scale("percent",{formatter:u=>`${(u*100).toFixed(2)}%`}),s.tooltip({showTitle:!1,showMarkers:!1}),s.legend(!1),s.interval().position("percent").color("item").label("percent",{layout:[{type:"pie-spider"},{type:"hide-overlap"}],offset:8,labelHeight:38,content:u=>`${u.item} (${u.count})`,labelLine:{style:{lineWidth:.5}}}).adjust("stack"),s.createView().annotation().text({position:["50%","50%"],content:f,style:{fill:"#262626",textAlign:"center"}}),s.interaction("element-active"),s.render()},r=()=>{const a=document.getElementById("user-matrix");a&&(a.innerHTML=`
      <div>
        <div id="registration"></div>
      </div>
      <div>
        <div id="submission"></div>
      </div>
      <div>
        <div id="verification"></div>
      </div>
      <div>
        <div id="publication"></div>
      </div>
    `)},b={dashBoardStore:l,dashboard:e,localState:p,showModal:x,setCustomRange:y,instrumentPerf:_,plotUserMatrix:v,resetUserMatrix:r};return Object.defineProperty(b,"__isScriptSetup",{enumerable:!1,value:!0}),b}}),K={class:"mt-4"},O={class:"flex justify-between mb-8"},Q={class:"flex justify-end items-center"},G=["onClick"],X={key:0,class:"text-start my-4"},Y={class:"mb-8"},Z={key:0,class:"text-muted-foreground"},$={key:1,class:"flex justify-start"},tt={class:"mr-4 font-bold text-foreground text-xl"},et={class:"font-semibold text-muted-foreground text-l"},ot={action:"post",class:"p-1"},rt={class:"grid grid-cols-2 gap-x-4 mb-4"},st={class:"block col-span-2 mb-2"},at={class:"block col-span-2 mb-2"};function nt(B,t,l,e,p,x){const y=w("VTooltip"),_=w("fel-loader"),v=w("fel-modal");return i(),c("div",K,[o("section",O,[g(o("div",Q,[(i(!0),c(M,null,T(e.dashboard.filters,(r,b)=>g((i(),R(y,{key:b,placements:["right-start"]},{popper:h(()=>[A(m(e.dashBoardStore.filterToolTip(r)),1)]),default:h(()=>[o("button",{onClick:a=>e.dashBoardStore.setCurrentFilter(r),type:"button",class:P(["px-2 py-1 mr-2 border border-foreground text-foreground rounded-sm transition duration-300 hover:bg-primary hover:text-primary-foreground focus:outline-none",{"bg-primary text-primary-foreground":e.dashboard.currentFilter===r}])},m(r),11,G)]),_:2},1024)),[[F,r!==e.dashboard.filters[e.dashboard.filters.length]]])),128)),o("button",{onClick:t[0]||(t[0]=r=>e.showModal=!0),class:"ml-4 mr-1 px-2 py-1 border border-border text-muted-foreground rounded-sm transition duration-300 hover:bg-muted hover:text-primary-foreground focus:outline-none"},m(e.dashboard.filterRange.from)+" - "+m(e.dashboard.filterRange.to),1)],512),[[F,e.dashboard.showFilters]])]),e.dashboard.fetchingResourceStats?(i(),c("div",X,[H(_,{message:"Fetching resource stats..."})])):C("",!0),o("section",null,[o("div",Y,[t[5]||(t[5]=o("h1",{class:"text-xl text-foreground font-semibold"},"Instrument Matrix / Load",-1)),t[6]||(t[6]=o("hr",{class:"my-2"},null,-1)),e.dashboard.resourceStats?.instruments?.length?(i(),c("div",$,[(i(!0),c(M,null,T(e.dashboard.resourceStats?.instruments,r=>(i(),c("div",{key:r.group,class:"flex items-center bg-background shadow rounded-sm px-6 pt-3 pb-5 border border-foreground mr-8"},[o("span",tt,m(e.instrumentPerf(r?.count)),1),o("span",et,m(r.group),1)]))),128))])):(i(),c("div",Z," No instrument data available "))]),t[7]||(t[7]=I('<div class="mb-8"><h1 class="text-xl text-foreground font-semibold">User Matrix / Load</h1><hr class="my-2"><div class="flex flex-wrap justify-start" id="user-matrix"><div><div id="registration"></div></div><div><div id="submission"></div></div><div><div id="verification"></div></div><div><div id="publication"></div></div></div></div>',1))]),e.showModal?(i(),R(v,{key:1,onClose:t[4]||(t[4]=r=>e.showModal=!1),contentWidth:"w-1/4"},{header:h(()=>[...t[8]||(t[8]=[o("h3",null,"Custom Filter Date Range",-1)])]),body:h(()=>[o("form",ot,[o("div",rt,[o("label",st,[t[9]||(t[9]=o("span",{class:"text-foreground"},"Date From",-1)),g(o("input",{type:"datetime-local",class:"form-input mt-1 block w-full",autocomplete:"off","onUpdate:modelValue":t[1]||(t[1]=r=>e.localState.range.from=r),placeholder:"Select start date..."},null,512),[[V,e.localState.range.from]])]),o("label",at,[t[10]||(t[10]=o("span",{class:"text-foreground"},"Date To",-1)),g(o("input",{type:"datetime-local",class:"form-input mt-1 block w-full",autocomplete:"off","onUpdate:modelValue":t[2]||(t[2]=r=>e.localState.range.to=r),placeholder:"Select end date..."},null,512),[[V,e.localState.range.to]])])]),t[11]||(t[11]=o("hr",null,null,-1)),o("button",{type:"button",onClick:t[3]||(t[3]=W(r=>e.setCustomRange(),["prevent"])),class:"m-2 -mb-4 w-full rounded-sm border border-primary bg-primary px-4 py-2 text-primary-foreground transition-colors duration-500 ease select-none hover:bg-primary focus:outline-none focus:shadow-outline"}," Apply Filter ")])]),_:1})):C("",!0)])}const xt=U(J,[["render",nt],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/dashboard/Resource.vue"]]);export{xt as default};
