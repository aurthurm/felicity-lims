import{S as Y,f as ee,a0 as u,a1 as te,ai as oe,ah as T,h as A,i as le,r as x,o as i,c as d,a as k,L as v,C as c,M as ne,D as se,N as o,a5 as n,K as M,y as ae,H as C,X as P,ac as w,F as g,E as U,a2 as D,A as ie,Z as re,$ as ue,_ as de}from"./index-6c3e61f6.js";import{A as fe,E as ce}from"./clients.mutations-73f93234.js";import{u as me}from"./client-15762689.js";import{u as pe}from"./location-3008fd14.js";import{h as ve,a as be,o as Ce}from"./constants-5a2ddd7f.js";const ge={class:"rounded-lg border border-border bg-card shadow-sm p-6"},ye={action:"post",class:"p-1"},he={class:"grid grid-cols-2 gap-x-4 mb-4"},xe={class:"block col-span-1 mb-2"},ke={class:"block col-span-1 mb-2"},we={class:"grid grid-cols-3 gap-x-4 mb-4"},Ue={class:"block col-span-1 mb-2"},De=["value"],_e={class:"block col-span-1 mb-2"},Be=["value"],Ee={class:"block col-span-1 mb-2"},Ne=["value"],Te=Y({__name:"ClientListing",setup(Ae){const S=re(()=>ue(()=>import("./FelDataTable-204fbd7a.js"),["assets/FelDataTable-204fbd7a.js","assets/index-6c3e61f6.js","assets/index-a402b5a2.css"])),r=me(),b=pe(),{withClientMutation:_}=ee(),L=u([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Client Name",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(l,e){return te(oe,{to:{name:"client-detail",query:{clientUid:l?.uid}},class:"px-2 py-1 font-semibold rounded-md hover:underline transition-colors duration-200",innerHTML:l?.name})}},{name:"Client ID",value:"code",sortable:!1,sortBy:"asc",hidden:!1},{name:"District",value:"district.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Province",value:"district.province.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Mobile Number",value:"mobilePhone",sortable:!1,sortBy:"asc",hidden:!1},{name:"Email Address",value:"email",sortable:!1,sortBy:"asc",hidden:!1}]),{countries:V,provinces:I,districts:R}=T(b),{clients:B,clientPageInfo:E,fetchingClients:F}=T(r);let f=u(!1),y=u(!1),O=u(""),s=A({});const N=u(""),j=()=>Object.assign(s,{});let a=A({first:50,after:"",text:"",sortBy:["uid"],filterAction:!1}),m=u(),p=u();r.fetchClients(a),b.fetchCountries();function H(){_(fe,{payload:{name:s.name,code:s.code,districtUid:s.districtUid}},"createClient").then(l=>r.addClient(l))}function K(){_(ce,{uid:s.uid,payload:{name:s.name,code:s.code,districtUid:s.districtUid}},"updateClient").then(l=>r.updateClient(l))}function $(l){b.filterProvincesByCountry(m.value)}function q(l){b.filterDistrictsByProvince(p.value)}function X(l){a.first=100,a.after="",a.text=l.filterText,a.filterAction=!0,r.fetchClients(a)}function Z(l){a.first=l.fetchCount,a.after=E?.value?.endCursor,a.text=l.filterText,a.filterAction=!1,r.fetchClients(a)}function z(l,e,h={}){y.value=l,O.value=e,N.value=(l?"CREATE":"EDIT")+" "+e.toUpperCase(),e=="client"&&(f.value=!0),l?e=="client"&&Object.assign(s,{}):e=="client"&&Object.assign(s,{...h})}function G(){y.value&&H(),y.value||K(),f.value=!1}const J=le(()=>B?.value?.length+" of "+r.getClientCount+" clients");return(l,e)=>{const h=x("fel-button"),Q=x("fel-heading"),W=x("fel-modal");return i(),d(g,null,[k(Q,{title:"Clients"},{default:v(()=>[c(k(h,{onClick:e[0]||(e[0]=t=>z(!0,"client"))},{default:v(()=>e[10]||(e[10]=[ne(" Add client ")])),_:1},512),[[se,ve(be.CREATE,Ce.CLIENT)]])]),_:1}),o("div",ge,[k(n(S),{columns:L.value,data:n(B),toggleColumns:!0,loading:n(F),paginable:!0,pageMeta:{fetchCount:n(a).first,hasNextPage:n(E)?.hasNextPage,countNone:J.value},searchable:!0,filterable:!1,onOnSearchKeyUp:X,onOnSearchFocus:j,onOnPaginate:Z,selectable:!1},{footer:v(()=>e[11]||(e[11]=[])),_:1},8,["columns","data","loading","pageMeta"])]),M(" Location Edit Form Modal "),n(f)?(i(),ae(W,{key:0,onClose:e[9]||(e[9]=t=>w(f)?f.value=!1:f=!1)},{header:v(()=>[o("h3",null,C(N.value),1)]),body:v(()=>[o("form",ye,[o("div",he,[o("label",xe,[e[12]||(e[12]=o("span",{class:"text-foreground"},"Name",-1)),c(o("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":e[1]||(e[1]=t=>n(s).name=t),placeholder:"Name ..."},null,512),[[P,n(s).name]])]),o("label",ke,[e[13]||(e[13]=o("span",{class:"text-foreground"},"Code",-1)),c(o("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":e[2]||(e[2]=t=>n(s).code=t),placeholder:"Code ..."},null,512),[[P,n(s).code]])])]),o("div",we,[o("label",Ue,[e[15]||(e[15]=o("span",{class:"text-foreground"},"Country",-1)),c(o("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[3]||(e[3]=t=>w(m)?m.value=t:m=t),onChange:e[4]||(e[4]=t=>$(t))},[e[14]||(e[14]=o("option",null,null,-1)),(i(!0),d(g,null,U(n(V),t=>(i(),d("option",{key:t.uid,value:t.uid},C(t.name),9,De))),128))],544),[[D,n(m)]])]),o("label",_e,[e[17]||(e[17]=o("span",{class:"text-foreground"},"Province",-1)),c(o("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[5]||(e[5]=t=>w(p)?p.value=t:p=t),onChange:e[6]||(e[6]=t=>q(t))},[e[16]||(e[16]=o("option",null,null,-1)),(i(!0),d(g,null,U(n(I),t=>(i(),d("option",{key:t.uid,value:t.uid},C(t.name),9,Be))),128))],544),[[D,n(p)]])]),o("label",Ee,[e[19]||(e[19]=o("span",{class:"text-foreground"},"District",-1)),c(o("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[7]||(e[7]=t=>n(s).districtUid=t)},[e[18]||(e[18]=o("option",null,null,-1)),(i(!0),d(g,null,U(n(R),t=>(i(),d("option",{key:t.uid,value:t.uid},C(t.name),9,Ne))),128))],512),[[D,n(s).districtUid]])])]),e[20]||(e[20]=o("hr",null,null,-1)),o("button",{type:"button",onClick:e[8]||(e[8]=ie(t=>G(),["prevent"])),class:"m-2 -mb-4 w-full rounded-sm border border-primary bg-primary px-4 py-2 text-primary-foreground transition-colors duration-500 ease select-none hover:bg-primary focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):M("v-if",!0)],64)}}}),Ie=de(Te,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/client/ClientListing.vue"]]);export{Ie as default};
