const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/TreeItem-Ca5K9Pe-.js","assets/index-OdhKCqIc.js","assets/index-DD18L2yL.css","assets/storage-CAZM5V7o.js","assets/CollapsibleTrigger-BinpFqP8.js","assets/CollapsibleTrigger-CC-LRQ5L.js"])))=>i.map(i=>d[i]);
import{Y as G,ah as q,an as W,a7 as T,a5 as z,a6 as H,a3 as J,b7 as K,_ as Y,c as S,o as d,z as t,F as A,H as k,A as b,I as g,C as w,K as u,M as E,B as Q,a as p,D as X,E as Z}from"./index-OdhKCqIc.js";import{u as $}from"./samples-BGCTZScT.js";import{a as ee,u as te}from"./storage-CAZM5V7o.js";import{u as se,c as oe,e as ae,F as re}from"./index.esm-BfHj8iGm.js";import{F as ne,a as le,b as ie}from"./FormMessage-CgXFMXx9.js";import{S as de,a as me,b as ce,c as ue,d as ge}from"./SelectValue-Ds0cfAgl.js";import"./analyses.mutations-DUxQZn1r.js";import"./useNonce-B4v0IDPb.js";import"./chevron-down-Dqf-ptA3.js";import"./useFocusGuards-Bjb6OG0k.js";import"./PopperContent-BfyCnGUj.js";const pe=(C,s,F,e)=>{const _="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").slice(0,C),l=Array.from({length:s},(o,i)=>i+1);if(F)return Array.from({length:(s??1)*C},(o,i)=>i+1).map(o=>({storageSlot:o.toString(),storageSlotIndex:o}));{const o=[];let i=1;return e?_.forEach((n,c)=>{l.forEach(y=>{o.push({storageSlot:n+y.toString(),storageSlotIndex:i}),i++})}):l.forEach(n=>{_.forEach((c,y)=>{o.push({storageSlot:c+n.toString(),storageSlotIndex:i}),i++})}),o}},fe=G({__name:"StoreSamples",setup(C,{expose:s}){s();const F=z(()=>H(()=>import("./TreeItem-Ca5K9Pe-.js"),__vite__mapDeps([0,1,2,3,4,5]))),{treeData:e,tags:U,activeTree:_,resetActiveTree:l}=ee();l();const o=te(),{storeSamples:i}=$();let n=JSON.parse(window.history.state.samples),c=[];const y=()=>{c=[],h.samples.forEach(a=>{a.sampleUid&&c.push(a.sampleUid?.toString())})};q(()=>o.fetchStorageTree()),W(()=>_.value,(a,m)=>{a.tag==="storage-container"&&(o.fetchStorageContainer(a.uid),v("samples",[]))},{deep:!0});const f=T(()=>o.getStorageContainer),D=T(()=>{const a=o.getStorageContainer;return(a?.slots??0)-(a?.storedCount??0)}),V=()=>{n=[...n,...f.value?.samples??[]],v("samples",[]);const a=pe(f.value?.cols??1,f.value?.rows??1,!f.value?.grid,f.value?.rowWise??!1).map(r=>({...r,storageContainerUid:f.value?.uid})),m=[];a.forEach(r=>{const I=n.filter(x=>x.storageSlotIndex===r.storageSlotIndex&&x.storageContainerUid===r.storageContainerUid);I.length>0&&(r={...r,sampleUid:I[0].uid},c.push(r.sampleUid.toString())),m.push({sampleUid:void 0,...r})}),v("samples",m)},N=oe({samples:ae().required().min(1,"Select At least one sample")}),{handleSubmit:R,setFieldValue:v,values:h}=se({validationSchema:N,initialValues:{priority:0,samples:f.value?.samples??[]}}),O=T(()=>h.samples),j=a=>{const m=h.samples.map(r=>(r.sampleUid===a&&(r={...r,sampleUid:void 0}),r));v("samples",m),c=c.filter(r=>+r!==a)},P=(a,m)=>{const r=m?Number(m):void 0,I=h.samples.map((x,M)=>M===a?{...x,sampleUid:r}:x);v("samples",I),y()},L=R(async a=>{const m=a.samples.filter(r=>r.sampleUid);await i(m).then(async r=>{await o.fetchStorageContainer(m[0].storageContainerUid),V()})}),B={TreeItem:F,treeData:e,tags:U,activeTree:_,resetActiveTree:l,storageSrore:o,storeSamples:i,get samples(){return n},set samples(a){n=a},get assignedUids(){return c},set assignedUids(a){c=a},setAssigned:y,storageContainer:f,emptySlots:D,prepareSlots:V,formSchema:N,handleSubmit:R,setFieldValue:v,values:h,samplesData:O,removeSample:j,updateSampleAt:P,submitForm:L,get FontAwesomeIcon(){return K},get Button(){return J},get FormControl(){return ie},get FormField(){return re},get FormItem(){return le},get FormMessage(){return ne},get Select(){return ge},get SelectContent(){return ue},get SelectItem(){return ce},get SelectTrigger(){return me},get SelectValue(){return de}};return Object.defineProperty(B,"__isScriptSetup",{enumerable:!1,value:!0}),B}}),Se={class:"space-y-6"},_e={class:"grid grid-cols-12 gap-6 min-h-full"},ve={class:"col-span-2 bg-secondary rounded-lg shadow-sm p-4"},ye={class:"space-y-2"},he={class:"col-span-7 space-y-6"},xe={class:"bg-background rounded-lg shadow-sm p-6"},be={key:0},Ce={class:"grid grid-cols-2 gap-6"},Fe={class:"space-y-4"},Ie={class:"flex items-center justify-between"},we={class:"text-muted-foreground"},Ue={class:"flex items-center justify-between"},Te={class:"flex items-center gap-2"},Ae={class:"text-muted-foreground"},ke={key:0,class:"text-sm text-muted-foreground bg-muted px-2 py-1 rounded-md"},Ee={class:"space-y-4"},Ve={class:"flex items-center justify-between"},Ne={class:"text-muted-foreground"},Re={class:"flex items-center justify-between"},Be={class:"text-muted-foreground"},De={key:1,class:"text-muted-foreground"},Oe={class:"flex justify-end"},je={class:"space-y-4"},Pe={class:"col-span-1 text-muted-foreground"},Le={class:"col-span-1 text-muted-foreground"},Me={class:"col-span-10"},Ge={class:"flex items-center gap-4"},qe={class:"flex justify-end pt-4"};function We(C,s,F,e,U,_){return d(),S("div",Se,[s[10]||(s[10]=t("h4",{class:"text-xl font-semibold text-foreground"},"Store Samples",-1)),t("div",_e,[t("div",ve,[t("ul",ye,[(d(!0),S(A,null,k(e.treeData,(l,o)=>(d(),b(e.TreeItem,{tree:l,key:o},null,8,["tree"]))),128))])]),t("div",he,[t("div",xe,[e.activeTree.tag===e.tags.STORAGE_CONTAINER?(d(),S("div",be,[t("div",Ce,[t("div",Fe,[t("div",Ie,[s[2]||(s[2]=t("span",{class:"font-medium text-foreground"},"Name",-1)),t("span",we,g(e.storageContainer?.name),1)]),t("div",Ue,[s[3]||(s[3]=t("span",{class:"font-medium text-foreground"},"Layout",-1)),t("div",Te,[t("span",Ae,g(e.storageContainer?.grid?"grid":"column"),1),e.storageContainer?.grid?(d(),S("span",ke,g(e.storageContainer?.rowWise?"by-row":"by-column"),1)):w("",!0)])])]),t("div",Ee,[t("div",Ve,[s[4]||(s[4]=t("span",{class:"font-medium text-foreground"},"Slots",-1)),t("span",Ne,g(e.storageContainer?.slots),1)]),t("div",Re,[s[5]||(s[5]=t("span",{class:"font-medium text-foreground"},"Empty Slots",-1)),t("span",Be,g(e.emptySlots),1)])])])])):(d(),S("div",De,"Please select a storage container"))]),t("div",Oe,[e.activeTree.tag===e.tags.STORAGE_CONTAINER?(d(),b(e.Button,{key:0,onClick:s[0]||(s[0]=l=>e.prepareSlots()),type:"button"},{default:u(()=>[...s[6]||(s[6]=[E(" Reset Slots ",-1)])]),_:1})):w("",!0)]),t("form",{class:"bg-background rounded-lg shadow-sm p-6 space-y-6",onSubmit:s[1]||(s[1]=Q((...l)=>e.submitForm&&e.submitForm(...l),["prevent"]))},[s[8]||(s[8]=t("div",{class:"grid grid-cols-12 gap-4 text-sm font-medium text-foreground"},[t("div",{class:"col-span-1"},"Position"),t("div",{class:"col-span-1"},"Label"),t("div",{class:"col-span-10"},"Sample")],-1)),t("div",je,[(d(!0),S(A,null,k(e.samplesData,(l,o)=>(d(),S("div",{key:o,class:"grid grid-cols-12 gap-4 items-center py-4 border-b border-border last:border-0"},[t("div",Pe,g(l.storageSlotIndex),1),t("div",Le,g(l.storageSlot),1),t("div",Me,[t("div",Ge,[p(e.FormField,{name:`samples.${o}.sampleUid`},{default:u(({value:i})=>[p(e.FormItem,{class:"w-64"},{default:u(()=>[p(e.FormControl,null,{default:u(()=>[p(e.Select,{"model-value":i?String(i):"","onUpdate:modelValue":n=>e.updateSampleAt(o,n)},{default:u(()=>[p(e.SelectTrigger,null,{default:u(()=>[p(e.SelectValue,{placeholder:"Select sample"})]),_:1}),p(e.SelectContent,null,{default:u(()=>[(d(!0),S(A,null,k(e.samples,n=>X((d(),b(e.SelectItem,{key:n.uid,value:String(n.uid)},{default:u(()=>[E(g(n?.sampleId)+" ❲"+g(n?.analysisRequest?.clientRequestId)+"❳ ",1)]),_:2},1032,["value"])),[[Z,!e.assignedUids.includes(n.uid.toString())]])),128))]),_:1})]),_:1},8,["model-value","onUpdate:modelValue"])]),_:2},1024),p(e.FormMessage)]),_:2},1024)]),_:2},1032,["name"]),l.sampleUid?(d(),b(e.Button,{key:0,onClick:i=>e.removeSample(l.sampleUid),variant:"ghost",size:"icon",type:"button","aria-label":"Remove sample"},{default:u(()=>[p(e.FontAwesomeIcon,{icon:"ban"})]),_:1},8,["onClick"])):w("",!0)])])]))),128))]),t("div",qe,[e.activeTree.tag===e.tags.STORAGE_CONTAINER&&e.samples?.length>0?(d(),b(e.Button,{key:0,type:"submit",variant:"destructive"},{default:u(()=>[...s[7]||(s[7]=[E(" Store Samples ",-1)])]),_:1})):w("",!0)])],32)]),s[9]||(s[9]=t("div",{class:"col-span-3"},null,-1))])])}const st=Y(fe,[["render",We],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/sample/StoreSamples.vue"]]);export{st as default};
