import{P as se,M as te,u as oe,e as le,Z as S,h as f,f as q,r as ne,o as n,c as r,b as s,F as u,D as p,a1 as g,a2 as l,z as h,E as m,a as re,J as y,a7 as D,x as ie,K as $,A as c,V as _,a4 as w,W as ae,X as de,Y as me,aT as ue,aU as pe,_ as ce}from"./index-66877f9a.js";import{u as ve}from"./analysis-793745a0.js";import{u as ye}from"./setup-e3499a38.js";import"./_queries-6b94db9a.js";const fe={class:"mt-4"},ge={class:"flex items-center"},be={class:"grid grid-cols-12 gap-4 mt-2"},xe={class:"col-span-3"},ke={class:"overflow-y-scroll overscroll-contain scroll-section"},we=["onClick"],he=["onClick"],_e={key:0,class:"col-span-9 overflow-y-scroll overscroll-contain scroll-section"},Te={class:"bg-white rounded-sm shadow-sm hover:shadow-lg duration-500 px-4 sm:px-6 md:px-2 py-4"},Se={class:"grid grid-cols-12 gap-3"},Ue={class:"col-span-12 px-3 sm:px-0"},Ce={class:"flex justify-between sm:text-sm md:text-md lg:text-lg text-gray-700 font-bold"},We={class:"grid grid-cols-2 mt-2"},Ae={class:"col-span-1"},Ve={class:"flex"},Ee={class:"text-gray-600 text-sm md:text-md"},Re={class:"flex"},Oe={class:"text-gray-600 text-sm md:text-md ml-1"},je={class:"col-span-1"},Me={class:"flex"},qe={class:"text-gray-600 text-sm md:text-md"},De={class:"flex"},$e={class:"text-gray-600 text-sm md:text-md"},Ie={class:"grid grid-cols-2 mt-2"},Le={class:"col-span-1"},Ne={class:"flex w-full"},Pe={class:"text-gray-600 text-sm md:text-md"},Qe={key:0,class:"flex w-full"},Be={class:"text-gray-600 text-sm md:text-md"},Fe={key:0,class:"col-span-1"},ze={class:"flex w-full"},Ke={class:"text-gray-600 text-sm md:text-md"},Ge={class:"flex w-full"},He={class:"text-gray-600 text-sm md:text-md"},Je={class:"bg-white shadow-md mt-2"},Xe={class:"-mb-px flex justify-start"},Ye=["onClick"],Ze={class:"mt-4"},es={key:0},ss={key:0},ts={class:"grid grid-cols-6 gap-x-2 w-1/2"},os={class:"col-span-1 my-1"},ls={key:1},ns={action:"post",class:"p-1"},rs={class:"grid grid-cols-3 gap-x-4 mb-4"},is={class:"block col-span-2 mb-2"},as={class:"block col-span-1 mb-2"},ds={class:"grid grid-cols-4 gap-x-4 mb-4"},ms={class:"block col-span-1 mb-2"},us={key:0,class:"col-span-3"},ps={class:"grid grid-cols-3 gap-x-4"},cs={class:"block col-span-1 mb-2"},vs={class:"block col-span-1 mb-2"},ys={for:"toggle",class:"text-gray-700 mt-8 ml-4"},fs={class:"relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in"},gs={class:"grid grid-cols-3 gap-x-4 mb-4"},bs={class:"block col-span-1 mb-2"},xs=["value"],ks={class:"block col-span-1 mb-2"},ws=["value"],hs={class:"block col-span-1 mb-2"},_s=["value"],Ts={id:"samples"},Ss={class:"flex justify-between items-center py-2"},Us={class:"block col-span-1 mb-2"},Cs={class:"flex items-center"},Ws=["value"],As={class:"flex items-center justify-between"},Vs={class:""},Es={class:"grid grid-cols-6 gap-x-4"},Rs={class:"block col-span-2 mb-2"},Os=["onUpdate:modelValue"],js={class:"block col-span-2 mb-2"},Ms=["onUpdate:modelValue"],qs=["value"],Ds={class:""},$s=["onClick"],Is=se({__name:"WorkSheetsAdmin",setup(Ls){const I=de(()=>me(()=>import("./index-66877f9a.js").then(i=>i.cN),["assets/index-66877f9a.js","assets/index-78b87750.css"])),T=te(),b=ve(),V=oe(),E=ye(),{withClientMutation:R}=le();let x=S("preview");const L=["preview"];f(()=>"tab-"+x.value);let k=S(!1),U=S(null),t=q({}),O=S(""),N=q({first:void 0,after:"",text:"",sortBy:["name"]});b.fetchAnalysesServices(N),V.fetchSampleTypes(),E.fetchInstruments(),b.fetchQCTemplates(),b.fetchQCLevels(),T.fetchWorkSheetTemplates();const j=f(()=>b.getQCTemplates),P=f(()=>T.getWorkSheetTemplates);function Q(){const i={name:t.name,sampleTypeUid:t.sampleTypeUid,instrumentUid:t.instrumentUid,description:t.description,qcTemplateUid:t.qcTemplateUid,reserved:t.reserved,numberOfSamples:+t.numberOfSamples,worksheetType:t.worksheetType,cols:t.cols,rows:t.rows,rowWise:t.rowWise,analysisUid:t.analysisUid};R(ue,{payload:i},"createWorksheetTemplate").then(e=>T.addWorksheetTemplate(e))}function B(){const i={name:t.name,sampleTypeUid:t.sampleTypeUid,instrumentUid:t.instrumentUid,description:t.description,qcTemplateUid:t.qcTemplateUid,reserved:t.reserved,numberOfSamples:t.numberOfSamples,worksheetType:t.worksheetType,cols:t.cols,rows:t.rows,rowWise:t.rowWise,analysisUid:t.analysisUid};R(pe,{uid:t.uid,payload:i},"updateWorksheetTemplate").then(e=>T.updateWorksheetTemplate(e))}function F(i){let e=[];return Array.from({length:i?.numberOfSamples+i?.reserved?.length},(o,a)=>a+1).forEach(o=>{let a={position:o,row:1,col:1,name:"sample",sampleUid:void 0};i?.reserved?.some(d=>d.position===o)&&(a.name="control"),i?.reserved?.forEach(d=>{d[1]?.position===o&&(a.name=d[1]?.name)}),e.push(a)}),e}function C(){t.worksheetType=="grid"&&(t.rows=Math.ceil((t?.numberOfSamples+(t.reserved?.length|0))/t?.cols))}function M(i){Object.assign(t,i);const e=F(i);t.preview=e}function z(){t.reserved?.push({}),C()}function K(i){t.reserved?.splice(i,1)}function G(){if(t.reserved=[],!t.qcTemplateUid)return;j.value?.find(e=>e.uid===t.qcTemplateUid)?.qcLevels.forEach((e,v)=>{t.reserved?.push({position:v+1,levelUid:e.uid})}),C()}function H(i){i.target.value=="flat"&&(t.cols=void 0,t.rows=void 0)}function W(i,e={}){if(U.value=i,O.value=(i?"CREATE":"EDIT")+" WOKKSHEET TEMPLATE",k.value=!0,i){let v={};v.instrument={},v.sampleType={},v.analysis={},Object.assign(t,{...v})}else M(e)}function J(){U.value&&Q(),U.value||B(),k.value=!1}const X=f(()=>E.getInstruments),Y=f(()=>b.getAnalysesServicesSimple?.filter(v=>v?.category?.name!=="Quality Control")),Z=f(()=>b.getQCLevels),ee=f(()=>V.getSampleTypes);return(i,e)=>{const v=ne("font-awesome-icon");return n(),r(u,null,[s("div",fe,[s("div",ge,[e[18]||(e[18]=s("h1",{class:"h1 my-4 font-bold text-dark-700"},"WorkSheet Templates",-1)),s("button",{class:"p-2 my-2 ml-8 text-sm border-sky-800 border text-dark-700 transition-colors duration-150 rounded-sm focus:outline-none hover:bg-sky-800 hover:text-gray-100",onClick:e[0]||(e[0]=o=>W(!0))}," Add Template ")]),e[32]||(e[32]=s("hr",null,null,-1)),s("div",be,[s("section",xe,[s("div",ke,[(n(!0),r(u,null,p(P.value,o=>(n(),r("div",{key:o.uid,class:g(l(t)?.uid===o.uid?"w-full flex justify-between p-2 mb-1 rounded-sm shadow border border-sky-800 bg-emerald-200":"bg-white w-full flex justify-between p-2 mb-1 rounded-sm shadow border")},[s("a",{onClick:h(a=>M(o),["prevent","stop"]),class:"font-semibold text-gray-700"},[s("span",null,m(o.name),1)],8,we),s("a",{onClick:a=>W(!1,o),class:"px-2 cursor"},[re(v,{icon:"pen"})],8,he)],2))),128))])]),l(t).uid?(n(),r("section",_e,[s("div",Te,[s("div",Se,[s("div",Ue,[s("div",Ce,[s("span",null,m(l(t).name),1),s("div",null,[s("button",{onClick:e[1]||(e[1]=o=>W(!1,l(t))),class:"ml-4 inline-flex items-center justify-center w-8 h-8 mr-2 border-sky-800 border text-gray-900 transition-colors duration-150 bg-white rounded-full focus:outline-none hover:bg-gray-200"},e[19]||(e[19]=[s("svg",{class:"w-4 h-4 fill-current",viewBox:"0 0 20 20"},[s("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})],-1)]))])]),e[28]||(e[28]=s("hr",null,null,-1)),s("div",We,[s("div",Ae,[s("div",Ve,[e[20]||(e[20]=s("span",{class:"text-gray-800 text-sm font-medium w-1/2"},"Instrument:",-1)),s("span",Ee,m(l(t).instrument?.name),1)]),s("div",Re,[e[21]||(e[21]=s("span",{class:"text-gray-800 text-sm font-medium w-1/2"},"Analyses Service:",-1)),s("span",Oe,m(l(t)?.analysis?.name),1)])]),s("div",je,[s("div",Me,[e[22]||(e[22]=s("span",{class:"text-gray-800 text-sm font-medium w-1/2"},"Number of Samples:",-1)),s("span",qe,m(l(t).numberOfSamples),1)]),s("div",De,[e[23]||(e[23]=s("span",{class:"text-gray-800 text-sm font-medium w-1/2"},"Number of Reserved:",-1)),s("span",$e,m(l(t).reserved?.length),1)])])]),e[29]||(e[29]=s("hr",{class:"my-4"},null,-1)),s("div",Ie,[s("div",Le,[s("div",Ne,[e[24]||(e[24]=s("span",{class:"text-gray-800 text-sm font-medium w-1/2"},"WorkSheet type",-1)),s("span",Pe,m(l(t).worksheetType),1)]),l(t).worksheetType=="grid"?(n(),r("div",Qe,[e[25]||(e[25]=s("span",{class:"text-gray-800 text-sm font-medium w-1/2"},"Direction:",-1)),s("span",Be,m(l(t).rowWise?"row-wise":"column-wise"),1)])):y("",!0)]),l(t).worksheetType=="grid"?(n(),r("div",Fe,[s("div",ze,[e[26]||(e[26]=s("span",{class:"text-gray-800 text-sm font-medium w-1/2"},"Rows:",-1)),s("span",Ke,m(l(t).rows),1)]),s("div",Ge,[e[27]||(e[27]=s("span",{class:"text-gray-800 text-sm font-medium w-1/2"},"Columns:",-1)),s("span",He,m(l(t).cols),1)])])):y("",!0)])])])]),s("nav",Je,[s("div",Xe,[(n(),r(u,null,p(L,o=>s("a",{key:o,class:g(["no-underline text-gray-500 uppercase tracking-wide font-bold text-xs py-1 px-4 tab hover:bg-sky-600 hover:text-gray-200",{"tab-active":l(x)===o}]),onClick:a=>D(x)?x.value=o:x=o},m(o),11,Ye)),64))])]),s("section",Ze,[l(x)==="preview"?(n(),r("div",es,[e[30]||(e[30]=s("h3",{class:"my-4"},"WorkSheet Layout Preview",-1)),e[31]||(e[31]=s("hr",{class:"my-2"},null,-1)),l(t).worksheetType=="flat"?(n(),r("div",ss,[(n(!0),r(u,null,p(l(t)?.preview||[],(o,a)=>(n(),r("div",ts,[s("span",os,m(o.position)+":",1),s("span",{class:g(["col-span-5 my-1 p-1 text-white rounded-xl flex justify-center",{"bg-emerald-600":o.name!=="sample"},{"bg-sky-800":o.name==="sample"}])},m(o.name),3)]))),256))])):y("",!0),l(t).worksheetType=="grid"?(n(),r("div",ls,[l(t).rowWise?(n(!0),r(u,{key:0},p(l(t).rows,(o,a)=>(n(),r("div",{class:g(["grid grid-cols-"+l(t).cols,"gap-2"]),key:a+"x"},[(n(!0),r(u,null,p(l(t).cols,(d,A)=>(n(),r("div",{key:A,class:"col-span-1 w-full"},[s("span",{class:g(["my-1 p-1 text-white rounded-xl flex justify-center",{"bg-emerald-600":l(t)?.preview[a*l(t).cols+d-1]?.name!=="sample"},{"bg-sky-800":l(t)?.preview[a*l(t).cols+d-1]?.name==="sample"}])},"("+m(a*l(t).cols+d)+") "+m(l(t)?.preview[a*l(t).cols+d-1]?.name),3)]))),128))],2))),128)):(n(),r("div",{key:1,class:g(["grid grid-cols-"+l(t).cols,"gap-2"])},[(n(!0),r(u,null,p(l(t).cols,(o,a)=>(n(),r("div",{class:"col-span-1",key:a+"y"},[(n(!0),r(u,null,p(l(t).rows,(d,A)=>(n(),r("div",{key:A},[s("span",{class:g(["my-1 p-1 text-white rounded-xl flex justify-center",{"bg-emerald-600":l(t)?.preview[a*l(t).rows+d-1]?.name!=="sample"},{"bg-sky-800":l(t)?.preview[a*l(t).rows+d-1]?.name==="sample"}])},"("+m(a*l(t).rows+d)+") "+m(l(t)?.preview[a*l(t).rows+d-1]?.name),3)]))),128))]))),128))],2))])):y("",!0)])):y("",!0)])])):y("",!0)])]),l(k)?(n(),ie(l(I),{key:0,onClose:e[17]||(e[17]=o=>D(k)?k.value=!1:k=!1)},{header:$(()=>[s("h3",null,m(l(O)),1)]),body:$(()=>[s("form",ns,[s("div",rs,[s("label",is,[e[33]||(e[33]=s("span",{class:"text-gray-700"},"Template Name",-1)),c(s("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":e[2]||(e[2]=o=>l(t).name=o),placeholder:"Name ..."},null,512),[[_,l(t).name]])]),s("label",as,[e[34]||(e[34]=s("span",{class:"text-gray-700"},"Number of Samples",-1)),e[35]||(e[35]=s("span",{class:"text-orange-600 ml-2 italic"},"(less reserved)",-1)),c(s("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":e[3]||(e[3]=o=>l(t).numberOfSamples=o),placeholder:"Count ...",type:"number"},null,512),[[_,l(t).numberOfSamples]])])]),s("div",ds,[s("label",ms,[e[37]||(e[37]=s("span",{class:"text-gray-700"},"Template Type",-1)),c(s("select",{class:"form-select block w-full mt-1",onChange:e[4]||(e[4]=o=>H(o)),"onUpdate:modelValue":e[5]||(e[5]=o=>l(t).worksheetType=o)},e[36]||(e[36]=[s("option",{value:"flat"},"Single Column / Flat",-1),s("option",{value:"grid"},"GRID",-1)]),544),[[w,l(t).worksheetType]])]),l(t).worksheetType==="grid"?(n(),r("span",us,[s("div",ps,[s("label",cs,[e[38]||(e[38]=s("span",{class:"text-gray-700"},"Cols",-1)),c(s("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":e[6]||(e[6]=o=>l(t).cols=o),onKeyup:e[7]||(e[7]=o=>C()),type:"number"},null,544),[[_,l(t).cols]])]),s("label",vs,[e[39]||(e[39]=s("span",{class:"text-gray-700"},"Rows",-1)),c(s("input",{class:"form-input mt-1 block w-full bg-gray-100","onUpdate:modelValue":e[8]||(e[8]=o=>l(t).rows=o),type:"number",disabled:""},null,512),[[_,l(t).rows]])]),s("label",ys,[s("div",fs,[c(s("input",{type:"checkbox",name:"toggle",id:"toggle","onUpdate:modelValue":e[9]||(e[9]=o=>l(t).rowWise=o),class:"toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer outline-none"},null,512),[[ae,l(t).rowWise]]),e[40]||(e[40]=s("label",{for:"toggle",class:"toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"},null,-1))]),e[41]||(e[41]=s("span",{class:"text-gray-700 text-base"},"Row Wise",-1))])])])):y("",!0)]),s("div",gs,[s("label",bs,[e[43]||(e[43]=s("span",{class:"text-gray-700"},"Instrument",-1)),c(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[10]||(e[10]=o=>l(t).instrumentUid=o)},[e[42]||(e[42]=s("option",null,null,-1)),(n(!0),r(u,null,p(X.value,o=>(n(),r("option",{key:o.uid,value:o.uid},m(o.name),9,xs))),128))],512),[[w,l(t).instrumentUid]])]),s("label",ks,[e[45]||(e[45]=s("span",{class:"text-gray-700"},"SampleType",-1)),c(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[11]||(e[11]=o=>l(t).sampleTypeUid=o)},[e[44]||(e[44]=s("option",null,null,-1)),(n(!0),r(u,null,p(ee.value,o=>(n(),r("option",{key:o.uid,value:o.uid},m(o.name),9,ws))),128))],512),[[w,l(t).sampleTypeUid]])]),s("label",hs,[e[47]||(e[47]=s("span",{class:"text-gray-700"},"Anslysis Service",-1)),c(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[12]||(e[12]=o=>l(t).analysisUid=o)},[e[46]||(e[46]=s("option",null,null,-1)),(n(!0),r(u,null,p(Y.value,o=>(n(),r("option",{key:o.uid,value:o.uid},m(o.name),9,_s))),128))],512),[[w,l(t).analysisUid]])])]),s("section",Ts,[e[54]||(e[54]=s("hr",null,null,-1)),s("div",Ss,[e[50]||(e[50]=s("h5",null,"Reserved Positions",-1)),s("label",Us,[e[49]||(e[49]=s("span",{class:"text-gray-700"},"QC Template",-1)),s("div",Cs,[c(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[13]||(e[13]=o=>l(t).qcTemplateUid=o)},[e[48]||(e[48]=s("option",null,null,-1)),(n(!0),r(u,null,p(j.value,o=>(n(),r("option",{key:o.uid,value:o.uid},m(o.name),9,Ws))),128))],512),[[w,l(t).qcTemplateUid]]),s("button",{onClick:e[14]||(e[14]=h(o=>G(),["prevent"])),class:"px-2 py-1 ml-2 h-auto border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Apply ")])]),s("button",{onClick:e[15]||(e[15]=h(o=>z(),["prevent"])),class:"px-2 py-1 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Add Reserve Slot ")]),e[55]||(e[55]=s("hr",{class:"mb-4"},null,-1)),(n(!0),r(u,null,p(l(t).reserved,(o,a)=>(n(),r("div",{key:a},[s("div",As,[s("div",Vs,[s("div",Es,[s("label",Rs,[e[51]||(e[51]=s("span",{class:"text-gray-700"},"Position",-1)),c(s("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":d=>o.position=d,type:"number"},null,8,Os),[[_,o.position]])]),s("label",js,[e[52]||(e[52]=s("span",{class:"text-gray-700"},"Blank/Control",-1)),c(s("select",{"onUpdate:modelValue":d=>o.levelUid=d,class:"form-input mt-1 block w-full"},[(n(!0),r(u,null,p(Z.value,d=>(n(),r("option",{key:d.uid,value:d.uid},m(d.level),9,qs))),128))],8,Ms),[[w,o.levelUid]])])])]),s("div",Ds,[s("button",{onClick:h(d=>K(a),["prevent"]),class:"px-2 py-1 mr-2 border-orange-600 border text-orange-600rounded-smtransition duration-300 hover:bg-orange-600 hover:text-white focus:outline-none"}," Remove ",8,$s)])]),e[53]||(e[53]=s("hr",null,null,-1))]))),128))]),e[56]||(e[56]=s("hr",null,null,-1)),s("button",{type:"button",onClick:e[16]||(e[16]=h(o=>J(),["prevent"])),class:"-mb-4 w-full border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):y("",!0)],64)}}});const Fs=ce(Is,[["__scopeId","data-v-548ca798"],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/admin/worksheets/WorkSheetsAdmin.vue"]]);export{Fs as default};
