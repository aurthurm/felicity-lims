import{Y as N,a0 as d,a7 as f,ah as I,e as M,a2 as g,a3 as B,_ as D,c as o,o as n,z as t,C as c,I as i,a as h,K as b,M as L,T as R}from"./index-OdhKCqIc.js";const S=N({__name:"VersionDisplay",setup(w,{expose:s}){s();const l=d(!1),e=d("0.0.0"),a=d(null),u=d(null),_=d(!1),v=async()=>{l.value=!0,g.get("/version").then(({data:{version:r}})=>{e.value=r}).catch(r=>{u.value="Failed to get current version"}).finally(()=>l.value=!1)},{toastInfo:p}=M(),m=async()=>{l.value=!0,g.get("/version/updates").then(({data:r})=>{a.value=r,r.update_available?p(`Update available: ${r.latest_version}`):p("No updates available")}).catch(r=>{u.value="Failed to get current version"}).finally(()=>l.value=!1)},y=f(()=>a.value?.latest_version||"-"),k=f(()=>a.value?.last_checked?new Date(a.value.last_checked).toLocaleString():"—"),V=f(()=>a.value?.version_released?new Date(a.value.version_released).toLocaleString():""),C=f(()=>a.value?.release_notes?a.value.release_notes.replace(/^(\s*[-*] .*)$/gm,'<span style="color:hsl(var(--primary));">$1</span>').replace(/^(\s*[A-Z][^:]+:)/gm,"<b>$1</b>").replace(/\r?\n/g,"<br>"):"");I(()=>{v(),m()});const x={loading:l,currentVersion:e,updateInfo:a,error:u,showNotes:_,getCurrentVersion:v,toastInfo:p,getUpdates:m,latestVersion:y,formattedLastChecked:k,formattedVersionReleased:V,formattedReleaseNotes:C,get Button(){return B}};return Object.defineProperty(x,"__isScriptSetup",{enumerable:!1,value:!0}),x}}),T={class:"flex flex-col gap-y-3"},H={class:"flex flex-col gap-y-2 bg-background/50 px-4 py-2 rounded-lg border border-border/50"},z={class:"flex flex-wrap items-baseline gap-x-1.5 text-sm"},U={class:"text-foreground"},j={key:0,class:"flex flex-wrap items-baseline gap-x-1.5 text-sm"},A={class:"text-foreground"},F={class:"flex flex-wrap items-baseline gap-x-1.5 text-sm"},E={class:"text-foreground"},G={class:"flex flex-col gap-2"},K={key:0,class:"mr-2 h-4 w-4 animate-spin",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true"},O={key:1,class:"mr-2 h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round","aria-hidden":"true"},P={key:0,class:"flex items-center gap-2 text-sm font-medium text-primary"},Y={key:0,class:"flex flex-col gap-2"},Z={class:"flex items-center gap-2 flex-wrap"},q=["href"],J={key:0,class:"bg-muted/30 border border-border/30 rounded p-3 max-h-96 overflow-auto whitespace-pre-wrap text-xs font-mono"},Q=["innerHTML"],W={key:1,class:"text-xs text-muted-foreground"};function X(w,s,l,e,a,u){return n(),o("div",T,[t("div",H,[t("div",z,[s[1]||(s[1]=t("span",{class:"font-medium text-muted-foreground"},"Current version:",-1)),t("span",U,"v"+i(e.currentVersion),1)]),e.formattedVersionReleased?(n(),o("div",j,[s[2]||(s[2]=t("span",{class:"font-medium text-muted-foreground"},"Version released:",-1)),t("span",A,i(e.formattedVersionReleased),1)])):c("",!0),t("div",F,[s[3]||(s[3]=t("span",{class:"font-medium text-muted-foreground"},"Last checked:",-1)),t("span",E,i(e.formattedLastChecked),1)])]),t("div",G,[h(e.Button,{variant:"outline",size:"sm",class:"w-full",disabled:e.loading,onClick:e.getUpdates},{default:b(()=>[e.loading?(n(),o("svg",K,[...s[4]||(s[4]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)])])):(n(),o("svg",O,[...s[5]||(s[5]=[t("path",{d:"M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.3"},null,-1)])])),L(" "+i(e.loading?"Checking…":"Check for updates"),1)]),_:1},8,["disabled"]),e.updateInfo?.update_available?(n(),o("div",P,[t("span",null,"v"+i(e.latestVersion)+" available",1)])):c("",!0)]),e.updateInfo?.update_available?(n(),o("div",Y,[t("div",Z,[e.updateInfo.release_url?(n(),o("a",{key:0,href:e.updateInfo.release_url,target:"_blank",rel:"noopener",class:"text-blue-600 hover:underline text-xs font-medium"}," View Release on GitHub ",8,q)):c("",!0),t("button",{type:"button",onClick:s[0]||(s[0]=_=>e.showNotes=!e.showNotes),class:"text-xs text-primary underline focus:outline-none"},i(e.showNotes?"Hide":"Show")+" Release Notes ",1)]),h(R,{name:"fade"},{default:b(()=>[e.showNotes?(n(),o("div",J,[t("span",{innerHTML:e.formattedReleaseNotes},null,8,Q)])):c("",!0)]),_:1})])):e.updateInfo&&!e.updateInfo.update_available?(n(),o("div",W," No updates available. ")):c("",!0)])}const ee=D(S,[["render",X],["__scopeId","data-v-f64094ba"],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/VersionDisplay.vue"]]);export{ee as default};
