import{a0 as K,f as Q,a4 as j,ad as H,h as T,a7 as c,aJ as W,aG as X,i as Y,_ as Z,r as x,c as m,o as d,A as e,C as $,E as ee,a as V,N as g,P as te,J as y,K as D,L as i,D as oe,F as _,a2 as E,a9 as se}from"./index-v7Q387fb.js";import{u as ae}from"./user-COlWaJ-j.js";import{u as ne}from"./setup-sVxge2CR.js";import{c as re,a as M,u as ie,b as w}from"./index.esm-D-THTBXR.js";const le=K({__name:"LaboratoryListing",setup(A,{expose:t}){t();const{toastSuccess:L,toastError:s}=Y(),{withClientQuery:U,withClientMutation:f}=Q(),p=j(),l=ae(),r=ne();H(()=>{r.fetchOrganization(),l.fetchUsers({}),r.fetchLaboratories()});const o=T(()=>l.getUsers),k=T(()=>r.getLaboratories),B=a=>{if(a.labManagerUid){const n=l.getUsers?.filter(I=>I.uid==a.labManagerUid);if(n?.length>0)return`${n[0]?.firstName} ${n[0]?.lastName}`}return"No Manager Assigned"};let b=c(!1),v=c("");const h=c(!0),u=c(null),N=re({name:M().required("Laboratory name is required"),labManagerUid:M().nullable(),businessPhone:M().nullable()}),{handleSubmit:S,errors:z,resetForm:P,setValues:C}=ie({validationSchema:N,initialValues:{name:"",labManagerUid:null,businessPhone:""}}),{value:O}=w("name"),{value:q}=w("labManagerUid"),{value:J}=w("businessPhone");function R(a,n){h.value=a,b.value=!0,v.value=(a?"CREATE":"EDIT")+" Laboratory",a?(u.value=null,P({values:{name:"",labManagerUid:null,businessPhone:""}})):(u.value=n?.uid??null,C({name:n?.name??"",labManagerUid:n?.labManagerUid??null,businessPhone:n?.businessPhone??""}))}const G=S(a=>{if(h.value===!0)f(W,{payload:{...a,organizationUid:r.getOrganization?.uid}},"createLaboratory").then(n=>r.addLaboratory(n));else{if(!u.value)return;f(X,{uid:u.value,payload:a},"updateLaboratory").then(n=>r.updateLaboratory(n,!0))}b.value=!1}),F={toastSuccess:L,toastError:s,withClientQuery:U,withClientMutation:f,router:p,userStore:l,setupStore:r,users:o,laboratories:k,getManagerName:B,get showModal(){return b},set showModal(a){b=a},get formTitle(){return v},set formTitle(a){v=a},formAction:h,currentUid:u,formSchema:N,handleSubmit:S,errors:z,resetForm:P,setValues:C,name:O,labManagerUid:q,businessPhone:J,FormManager:R,saveForm:G};return Object.defineProperty(F,"__isScriptSetup",{enumerable:!1,value:!0}),F}}),de={class:"space-y-6"},ue={class:"rounded-md border bg-card"},me={class:"relative w-full overflow-auto"},fe={class:"w-full caption-bottom text-sm"},be={class:"[&_tr:last-child]:border-0"},ce={class:"px-4 py-2 align-middle"},ge={class:"px-4 py-2 align-middle"},pe={class:"px-4 py-2 align-middle"},ve={class:"px-4 py-2 align-middle text-right"},he=["onClick"],xe={class:"text-lg font-semibold text-foreground"},ye={class:"space-y-2"},_e={class:"text-sm text-destructive"},Me={class:"space-y-2"},we=["value"],Le={class:"space-y-2"};function Ue(A,t,L,s,U,f){const p=x("fel-button"),l=x("fel-heading"),r=x("fel-modal");return d(),m(y,null,[e("div",de,[V(l,{title:"Laboratories",description:"Manage your laboratories and their details."},{default:g(()=>[V(p,{onClick:t[0]||(t[0]=o=>s.FormManager(!0,null))},{default:g(()=>[...t[6]||(t[6]=[te("Add Laboratory",-1)])]),_:1})]),_:1}),e("div",ue,[e("div",me,[e("table",fe,[t[7]||(t[7]=e("thead",{class:"[&_tr]:border-b"},[e("tr",{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[e("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Name"),e("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Manager"),e("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Contact Phone"),e("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"})])],-1)),e("tbody",be,[(d(!0),m(y,null,D(s.laboratories,o=>(d(),m("tr",{key:o?.uid,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[e("td",ce,i(o?.name),1),e("td",ge,i(s.getManagerName(o)),1),e("td",pe,i(o?.businessPhone),1),e("td",ve,[e("button",{onClick:k=>s.FormManager(!1,o),class:"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 px-4 py-2"}," Edit ",8,he)])]))),128))])])])])]),s.showModal?(d(),$(r,{key:0,onClose:t[5]||(t[5]=o=>s.showModal=!1)},{header:g(()=>[e("h3",xe,i(s.formTitle),1)]),body:g(()=>[e("form",{class:"space-y-6",onSubmit:t[4]||(t[4]=oe((...o)=>s.saveForm&&s.saveForm(...o),["prevent"]))},[e("div",ye,[t[8]||(t[8]=e("label",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"}," Laboratory Name ",-1)),_(e("input",{class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","onUpdate:modelValue":t[1]||(t[1]=o=>s.name=o),placeholder:"Name ..."},null,512),[[E,s.name]]),e("div",_e,i(s.errors.name),1)]),e("div",Me,[t[10]||(t[10]=e("label",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"}," Lab Manager ",-1)),_(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.labManagerUid=o),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[t[9]||(t[9]=e("option",{value:""},"Select Manager",-1)),(d(!0),m(y,null,D(s.users,o=>(d(),m("option",{key:o?.uid,value:o.uid},i(o?.firstName)+" "+i(o?.lastName),9,we))),128))],512),[[se,s.labManagerUid]])]),e("div",Le,[t[11]||(t[11]=e("label",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"}," Business Phone ",-1)),_(e("input",{class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","onUpdate:modelValue":t[3]||(t[3]=o=>s.businessPhone=o),placeholder:"Business Phone ..."},null,512),[[E,s.businessPhone]])]),t[12]||(t[12]=e("hr",{class:"border-border"},null,-1)),t[13]||(t[13]=e("button",{type:"submit",class:"inline-flex w-full items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"}," Save Form ",-1))],32)]),_:1})):ee("",!0)],64)}const Ce=Z(le,[["render",Ue],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/laboratory/LaboratoryListing.vue"]]);export{Ce as default};
