import{d as q,I as B,q as Q,p as D,r as i,P as V,m as j,o as u,c,b as v,g as d,f as r,i as x,F as b,B as F,C as I,j as h,aE as A,_ as f,k as M}from"./index-fc86f1fc.js";import{u as O}from"./analysis-cfb70cf0.js";const N={class:"min-h-[500px]"},U={class:"flex justify-between"},z={class:"flex justify-start items-center gap-x-2"},G=v("hr",{class:"my-4"},null,-1),H=q({__name:"QualityCharts",setup(J){const k=h(()=>f(()=>import("./vue-multiselect.esm-2e9cf21d.js"),["assets/vue-multiselect.esm-2e9cf21d.js","assets/index-fc86f1fc.js","assets/index-246842b1.css"])),w=h(()=>f(()=>import("./index-fc86f1fc.js").then(e=>e.br),["assets/index-fc86f1fc.js","assets/index-246842b1.css"])),P=h(()=>f(()=>import("./ChartLJ-5dd88e29.js"),["assets/ChartLJ-5dd88e29.js","assets/index-fc86f1fc.js","assets/index-246842b1.css","assets/index-c14db449.js"])),y=O(),{withClientQuery:_}=B();Q(()=>{y.fetchAnalysesServices({})});const E=D(()=>y.getAnalysesServicesSimple),o=i([]),m=new Date;let l=i({month:m.getMonth(),year:m.getFullYear()}),n=i(null);const p=i(!1),L=async e=>{if(!l.value)return;const t={analyses:[e.uid],month:l.value.month+1,year:l.value.year};await _(A,t,"qcChartData").then(s=>{o.value=s??[]}).finally(()=>p.value=!1)},S=async e=>{if(!n.value)return;const t={analyses:[n.value?.uid],month:e.month+1,year:e.year};await _(A,t,"qcChartData").then(s=>{o.value=s??[]}).finally(()=>p.value=!1)},C=D(()=>{if(!o.value)return[];const e=R(g(o.value));return console.log("converted: ",e),e});function g(e){return e.reduce((t,s)=>{const a=s.sample.qcLevel.level;return t[a]||(t[a]={results:[],dates:[]}),t[a].results.push(parseFloat(s.result)),t[a].dates.push(s.dateVerified),t},{})}function R(e){return Object.entries(e).map(([t,s])=>({name:t,data:s.results.map((a,T)=>({date:s.dates[T],value:a}))}))}return V(n,async e=>{e&&await L(e)}),V(l,async e=>{e&&await S(e)}),(e,t)=>{const s=j("VueDatePicker");return u(),c("div",N,[v("div",U,[d(r(w),{title:"Analyses Service Control Charts"}),v("div",z,[d(s,{class:"z-60 disabled:bg-slate-200",modelValue:r(l),"onUpdate:modelValue":t[0]||(t[0]=a=>x(l)?l.value=a:l=a),"max-date":r(m),"month-picker":""},null,8,["modelValue","max-date"]),d(r(k),{class:"max-w-[300px]",modelValue:r(n),"onUpdate:modelValue":t[1]||(t[1]=a=>x(n)?n.value=a:n=a),options:E.value,multiple:!1,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","options"])])]),G,C.value?.length==0?(u(),c(b,{key:0},[F(" The selected analysis has no data for the selected period. ")],64)):(u(!0),c(b,{key:1},I(C.value,a=>(u(),c("div",{class:"mb-4",key:a.name},[d(r(P),{title:a.name,series:a.data},null,8,["title","series"])]))),128))])}}}),W=M(H,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/qcontrol/QualityCharts.vue"]]);export{W as default};
