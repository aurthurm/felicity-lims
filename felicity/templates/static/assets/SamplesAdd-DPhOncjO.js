import{a0 as G,h as f,_ as W,c as r,o as a,A as t,E as w,J as x,K as h,L as p,Q as M,u as Ae,a4 as Ue,f as Pe,a7 as I,g as re,e as O,a5 as ne,bm as qe,r as ie,C as Me,a as C,F as R,a9 as J,a2 as B,M as Ee,D as T,P as Q}from"./index-Daoe3XS9.js";import{Multiselect as Ne}from"./vue-multiselect.esm-C31Sh9AO.js";import{u as Ie}from"./patient-B9al8v_N.js";import{u as Be}from"./analysis-D7-3mDtD.js";import{u as Te}from"./client-CTaZ-zn-.js";import{u as je}from"./billing-CBiZn6uF.js";import{u as me}from"./setup-B4brziEy.js";import{$ as Fe}from"./analyses.mutations-DmiK7cfK.js";import{c as k,e as j,i as de,d as Le,f as ce,a as q,u as Ye,b as U}from"./index.esm-BT7_X8h2.js";import{f as ue}from"./index-Cgdayxkn.js";/* empty css                                                                 */import"./location-CxPODs5_.js";import"./billing.queries-BnjjrvVy.js";const ze=G({__name:"SampleCostBreakdown",props:{profiles:{type:Array,default:()=>[]},analyses:{type:Array,default:()=>[]},priceMap:{type:Map,required:!0},loading:{type:Boolean,default:!1}},setup(D,{expose:s}){s();const m=me(),e=D,g=f(()=>m.getLaboratory?.settings?.currency??"USD"),_=n=>n==null?"N/A":new Intl.NumberFormat("en-US",{style:"currency",currency:g.value}).format(n),u=f(()=>e.profiles?.map(n=>({name:n.name,price:e.priceMap.get(`profile_${n.uid}`)??null}))??[]),b=f(()=>e.analyses?.map(n=>({name:n.name,price:e.priceMap.get(`analysis_${n.uid}`)??null}))??[]),o=f(()=>{let n=0;return u.value.forEach(y=>{y.price!==null&&(n+=y.price)}),b.value.forEach(y=>{y.price!==null&&(n+=y.price)}),n}),i={setupStore:m,props:e,currency:g,formatCurrency:_,profileCosts:u,analysisCosts:b,subtotal:o};return Object.defineProperty(i,"__isScriptSetup",{enumerable:!1,value:!0}),i}}),He={class:"space-y-2 text-sm"},Ke={key:0,class:"animate-pulse space-y-2"},Oe={key:1},Je={key:0,class:"space-y-1"},Qe={class:"text-foreground truncate flex-1 mr-2"},Ge={class:"text-foreground truncate flex-1 mr-2"},We={key:2,class:"border-t border-border pt-2 mt-2"},Xe={class:"flex justify-between items-center font-semibold"},Ze={class:"text-primary text-base"},$e={key:3,class:"text-muted-foreground italic"};function et(D,s,m,e,g,_){return a(),r("div",He,[m.loading?(a(),r("div",Ke,[...s[0]||(s[0]=[t("div",{class:"h-4 bg-muted rounded w-3/4"},null,-1),t("div",{class:"h-4 bg-muted rounded w-1/2"},null,-1),t("div",{class:"h-4 bg-muted rounded w-full"},null,-1)])])):(a(),r("div",Oe,[e.profileCosts.length>0?(a(),r("div",Je,[s[1]||(s[1]=t("div",{class:"text-xs font-semibold text-muted-foreground uppercase"},"Profiles",-1)),(a(!0),r(x,null,h(e.profileCosts,(u,b)=>(a(),r("div",{key:`profile-${b}`,class:"flex justify-between items-center"},[t("span",Qe,p(u.name),1),t("span",{class:M(u.price===null?"text-destructive":"text-foreground font-medium")},p(e.formatCurrency(u.price)),3)]))),128))])):w("",!0),e.analysisCosts.length>0?(a(),r("div",{key:1,class:M(["space-y-1",{"mt-3":e.profileCosts.length>0}])},[s[2]||(s[2]=t("div",{class:"text-xs font-semibold text-muted-foreground uppercase"},"Analyses",-1)),(a(!0),r(x,null,h(e.analysisCosts,(u,b)=>(a(),r("div",{key:`analysis-${b}`,class:"flex justify-between items-center"},[t("span",Ge,p(u.name),1),t("span",{class:M(u.price===null?"text-destructive":"text-foreground font-medium")},p(e.formatCurrency(u.price)),3)]))),128))],2)):w("",!0),e.profileCosts.length>0||e.analysisCosts.length>0?(a(),r("div",We,[t("div",Xe,[s[3]||(s[3]=t("span",{class:"text-foreground"},"Subtotal:",-1)),t("span",Ze,p(e.formatCurrency(e.subtotal)),1)])])):w("",!0),e.profileCosts.length===0&&e.analysisCosts.length===0?(a(),r("div",$e," No tests selected ")):w("",!0)]))])}const tt=W(ze,[["render",et],["__scopeId","data-v-d366cf69"],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/components/billing/SampleCostBreakdown.vue"]]),st=G({__name:"CostSummary",props:{sampleCosts:{type:Array,required:!0},grandTotal:{type:Number,required:!0},currency:{type:String,default:"USD"},loading:{type:Boolean,default:!1}},setup(D,{expose:s}){s();const m=D,e=u=>new Intl.NumberFormat("en-US",{style:"currency",currency:m.currency}).format(u),g=f(()=>m.sampleCosts.some(u=>u.subtotal>0)),_={props:m,formatCurrency:e,hasCosts:g};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}}),ot={class:"bg-muted rounded-lg p-6 mt-6 border border-border"},lt={key:0,class:"animate-pulse space-y-3"},at={key:1},rt={class:"space-y-2 mb-4"},nt={class:"text-foreground"},it={class:"font-medium text-foreground"},dt={class:"border-t border-border pt-4 mt-4"},ct={class:"flex justify-between items-center"},ut={class:"text-2xl font-bold text-primary"},mt={key:2,class:"text-muted-foreground italic text-sm"};function pt(D,s,m,e,g,_){return a(),r("div",ot,[s[3]||(s[3]=t("h3",{class:"text-lg font-semibold text-foreground mb-4"},"Cost Summary",-1)),m.loading?(a(),r("div",lt,[...s[0]||(s[0]=[t("div",{class:"h-4 bg-background rounded w-3/4"},null,-1),t("div",{class:"h-4 bg-background rounded w-1/2"},null,-1),t("div",{class:"h-6 bg-background rounded w-full mt-4"},null,-1)])])):e.hasCosts?(a(),r("div",at,[t("div",rt,[(a(!0),r(x,null,h(m.sampleCosts,(u,b)=>(a(),r("div",{key:b,class:"flex justify-between items-center text-sm"},[t("span",nt,"Sample "+p(b+1)+":",1),t("span",it,p(e.formatCurrency(u.subtotal)),1)]))),128))]),t("div",dt,[t("div",ct,[s[1]||(s[1]=t("span",{class:"text-xl font-bold text-foreground"},"Total:",-1)),t("span",ut,p(e.formatCurrency(m.grandTotal)),1)])]),s[2]||(s[2]=t("div",{class:"mt-4 text-xs text-muted-foreground italic"}," * Final cost may vary after discounts and adjustments are applied ",-1))])):(a(),r("div",mt," No tests selected. Add profiles or analyses to see cost breakdown. "))])}const bt=W(st,[["render",pt],["__scopeId","data-v-8d1e035b"],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/components/billing/CostSummary.vue"]]),ft=G({__name:"SamplesAdd",setup(D,{expose:s}){s();const m=Ae(),e=Ie(),g=Be(),_=Te(),u=je(),b=me(),o=Ue(),{withClientMutation:i}=Pe(),n=I(!1);let y=f(()=>e.getPatient),F=re({first:void 0,after:"",text:"",sortBy:["name"],contacts:!0});_.fetchClients(F);const pe=f(()=>_.getClients),E=I(null),be=l=>{E.value=l,A.value=null};m.fetchSampleTypes();const fe=f(()=>m.getSampleTypes);let L=re({first:void 0,after:"",text:"",sortBy:["name"]});g.fetchAnalysesServices(L);const ge=f(()=>{const l=g.getAnalysesServicesSimple;let c=new Set;return l.forEach((d,v)=>{d.profiles?.length===0&&c.add(d)}),[...c]});g.fetchAnalysesProfiles();const ye=f(()=>g.getAnalysesProfiles),Y=I(!1),ve=O().endOf("day").toDate(),X=k({sampleType:k().required("Sample type is required").test("sample-type-uid","Sample type is required",l=>!!l?.uid),dateCollected:de().nullable(),dateReceived:de().nullable(),profiles:j().nullable(),analyses:j().nullable()}).test("profiles-or-analyses","Samples must have either profiles or services",l=>(l?.profiles?.length??0)+(l?.analyses?.length??0)>0),Z=k({clientRequestId:q().required("Client Request ID is Required"),clinicalData:k({clinicalIndication:q().nullable(),symptoms:j().of(q()),symptomsRaw:q().nullable(),treatmentNotes:q().nullable(),pregnancyStatus:ce().nullable(),breastFeeding:ce().nullable(),vitals:k().nullable(),otherContext:k().nullable()}).nullable(),client:k().required("Client is Required"),clientContact:k().nullable().required("Client Contact is Required"),samples:j().of(X).required().min(1,"Add at least 1 sample"),priority:Le()});function z(l){return{sampleType:null,dateCollected:O(new Date),dateReceived:O(new Date),profiles:[],analyses:[],...l}}function $(){return{clinicalIndication:"",symptoms:[],symptomsRaw:"",treatmentNotes:"",pregnancyStatus:null,breastFeeding:null,vitals:{},otherContext:{}}}const{handleSubmit:ee,errors:xe}=Ye({validationSchema:Z,initialValues:{priority:0,client:y?.value?.client,samples:[z({})],clinicalData:$()}});y?.value?.client&&(E.value=y.value.client),ne(H,l=>{E.value=l??null,A.value&&A.value?.clientUid!==l?.uid&&(A.value=null)},{immediate:!0});const{value:he}=U("clientRequestId"),{value:N}=U("clinicalData"),{value:H}=U("client"),{value:A}=U("clientContact"),{value:_e}=U("priority"),{value:V}=U("samples"),P=I(""),Se=()=>{P.value.trim()&&!N.value?.symptoms?.includes(P.value.trim())&&(N.value?.symptoms?.push(P.value.trim()),P.value="")},we=l=>{N.value?.symptoms?.splice(l,1)},Ce=ee(l=>{Y.value=!0,te(l)});function te(l){const c={patientUid:y.value?.uid,clientRequestId:l.clientRequestId,clinicalData:l.clinicalData,clientUid:H?.value?.uid,clientContactUid:A?.value?.uid,samples:l.samples?.map(d=>({...d,profiles:d.profiles?.map(v=>v.uid),analyses:d.analyses?.map(v=>v.uid),sampleType:d.sampleType?.uid,dateCollected:d.dateCollected?ue(d.dateCollected,"YYYY-MM-DD HH:mm"):null,dateReceived:d.dateReceived?ue(d.dateReceived,"YYYY-MM-DD HH:mm"):null}))};i(Fe,{payload:c},"createAnalysisRequest").then(d=>{m.addAnalysisRequest(d),o.push({name:"patient-detail",params:{patientUid:y.value?.uid}})}).finally(()=>{Y.value=!1})}function ke(){const l=z({});V.value.push(l)}function De(l){V.value.length>1&&V.value.splice(l,1)}const Ve=f(()=>V.value.length>1),se=f(()=>b.getLaboratory?.settings?.allowBilling??!1),K=f(()=>{const l=new Map;return u.profilePrices.forEach((c,d)=>{l.set(`profile_${d}`,c.amount)}),u.analysisPrices.forEach((c,d)=>{l.set(`analysis_${d}`,c.amount)}),l}),oe=f(()=>V.value.map(l=>{let c=0;const d={profiles:[],analyses:[],subtotal:0};return l.profiles?.forEach(v=>{const S=K.value.get(`profile_${v.uid}`);S!==void 0&&(c+=S,d.profiles.push({name:v.name,price:S}))}),l.analyses?.forEach(v=>{const S=K.value.get(`analysis_${v.uid}`);S!==void 0&&(c+=S,d.analyses.push({name:v.name,price:S}))}),d.subtotal=c,d})),Re=f(()=>oe.value.reduce((l,c)=>l+c.subtotal,0)),le=qe((l,c)=>{u.fetchBatchPrices(l,c)},300);ne(()=>V.value.map(l=>({profiles:l.profiles?.map(c=>c.uid)??[],analyses:l.analyses?.map(c=>c.uid)??[]})),l=>{if(!se.value)return;const c=new Set,d=new Set;l.forEach(v=>{v.profiles.forEach(S=>c.add(S)),v.analyses.forEach(S=>d.add(S))}),(c.size>0||d.size>0)&&le(Array.from(c),Array.from(d))},{deep:!0});const ae={sampleStore:m,patientStore:e,analysisStore:g,clientStore:_,billingStore:u,setupStore:b,router:o,withClientMutation:i,clinicalDataExpanded:n,get patient(){return y},set patient(l){y=l},get clientParams(){return F},set clientParams(l){F=l},clients:pe,selectedClient:E,selectContact:be,sampleTypes:fe,get analysesParams(){return L},set analysesParams(l){L=l},analysesServices:ge,analysesProfiles:ye,arSaving:Y,maxDate:ve,sampleSchema:X,arSchema:Z,createDefaultSample:z,createDefaultClinicalData:$,handleSubmit:ee,errors:xe,clientRequestId:he,clinicalData:N,client:H,clientContact:A,priority:_e,samples:V,newSymptom:P,addSymptom:Se,removeSymptom:we,submitARForm:Ce,addAnalysesRequest:te,addSample:ke,removeSample:De,canRemoveSample:Ve,billingEnabled:se,priceMap:K,sampleCosts:oe,grandTotal:Re,debouncedFetchPrices:le,contactLabel:l=>`${l.firstName} ${l.lastName}`,get VueMultiselect(){return Ne},SampleCostBreakdown:tt,CostSummary:bt};return Object.defineProperty(ae,"__isScriptSetup",{enumerable:!1,value:!0}),ae}}),gt={class:"space-y-6"},yt={key:0,class:"absolute inset-0 bg-background/10 backdrop-blur-sm z-50 flex items-center justify-center rounded-lg",role:"status","aria-live":"polite"},vt={class:"flex flex-col items-center gap-4"},xt={class:"space-y-4"},ht={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},_t={class:"flex items-center gap-x-4"},St={class:"flex items-center gap-x-4"},wt={class:"text-sm text-destructive"},Ct={class:"flex items-center gap-x-4"},kt=["disabled"],Dt={class:"text-sm text-destructive"},Vt={class:"flex items-center gap-x-4"},Rt=["disabled"],At={class:"text-sm text-destructive"},Ut={class:"border border-border rounded-lg bg-background/50"},Pt=["disabled"],qt={key:0,class:"px-4 py-4 space-y-4 border-t border-border"},Mt={class:"flex items-center gap-x-4"},Et=["disabled"],Nt={class:"flex flex-wrap mt-2"},It={class:"flex gap-2"},Bt=["disabled","onKeydown"],Tt=["disabled"],jt={class:"flex flex-wrap gap-2 mt-2"},Ft=["onClick","disabled"],Lt={class:"flex items-center gap-x-4"},Yt=["disabled"],zt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ht={class:"flex items-center gap-x-4"},Kt=["disabled"],Ot={class:"flex items-center gap-x-4"},Jt=["disabled"],Qt={id:"samples",class:"space-y-4"},Gt={class:"flex justify-between items-center"},Wt={class:"flex items-center gap-4"},Xt={class:"text-sm text-destructive"},Zt=["disabled"],$t={class:"relative border border-border rounded-lg bg-background/50 overflow-visible"},es={class:"absolute left-0 top-0 bottom-0 w-48 bg-muted/30 border-r border-border z-10"},ts={class:"w-full h-full fel-table"},ss={key:0,class:"border-b border-border"},os={class:"overflow-x-auto overflow-y-visible pl-48"},ls={class:"w-80 min-w-80 fel-table"},as={class:"border-b border-border bg-muted/30"},rs={class:"flex items-center justify-between"},ns=["onClick","disabled","title"],is={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},ds={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},cs={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},us={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},ms={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},ps={key:0,class:"border-b border-border hover:bg-muted/20"},bs={class:"hover:bg-muted/20 h-24"},fs={class:"p-3 bg-muted/50 rounded-md text-sm space-y-1"},gs={key:0,class:"text-xs text-destructive whitespace-nowrap"},ys={key:1},vs={class:"text-xs text-muted-foreground"},xs={class:"text-xs text-muted-foreground"},hs={class:"flex justify-end pt-4"},_s=["disabled"];function Ss(D,s,m,e,g,_){const u=ie("fel-loader"),b=ie("VueDatePicker");return a(),r("div",gt,[s[37]||(s[37]=t("h5",{class:"text-xl font-semibold text-foreground mb-4"},"Add Analysis Request",-1)),t("form",{action:"post",class:"relative p-6 bg-background rounded-lg shadow-sm space-y-6",onSubmit:s[11]||(s[11]=T((...o)=>e.submitARForm&&e.submitARForm(...o),["prevent"]))},[e.arSaving?(a(),r("div",yt,[t("div",vt,[C(u,{message:"Adding Samples...",variant:"primary",size:"lg"})])])):w("",!0),t("div",xt,[t("div",ht,[t("label",_t,[s[12]||(s[12]=t("span",{class:"text-sm font-medium text-foreground"},"Client",-1)),C(e.VueMultiselect,{class:"w-full",placeholder:"Select a Client",modelValue:e.client,"onUpdate:modelValue":s[0]||(s[0]=o=>e.client=o),options:e.clients,searchable:!0,disabled:e.arSaving,label:"name","track-by":"uid",onSelect:e.selectContact,"option-height":60,"close-on-select":!0},null,8,["modelValue","options","disabled"])]),t("label",St,[s[13]||(s[13]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap"},"Client Contact",-1)),C(e.VueMultiselect,{class:"w-full",placeholder:"Select a Client Contact",modelValue:e.clientContact,"onUpdate:modelValue":s[1]||(s[1]=o=>e.clientContact=o),options:e.selectedClient?.contacts??[],"custom-label":e.contactLabel,disabled:e.arSaving,"track-by":"uid","close-on-select":!0,searchable:!0},null,8,["modelValue","options","disabled"]),t("div",wt,p(e.errors.clientContact),1)]),t("label",Ct,[s[15]||(s[15]=t("span",{class:"text-sm font-medium text-foreground"},"Priority",-1)),R(t("select",{name:"priority",id:"priority","onUpdate:modelValue":s[2]||(s[2]=o=>e.priority=o),disabled:e.arSaving,class:"w-full px-3 py-2 bg-background/10 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","aria-label":"Select priority level"},[...s[14]||(s[14]=[t("option",{value:"0"},"Low",-1),t("option",{value:"1"},"Medium",-1),t("option",{value:"2"},"High",-1)])],8,kt),[[J,e.priority]]),t("div",Dt,p(e.errors.priority),1)])]),t("label",Vt,[s[16]||(s[16]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap"},"Client Request ID",-1)),R(t("input",{class:"w-full px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","onUpdate:modelValue":s[3]||(s[3]=o=>e.clientRequestId=o),disabled:e.arSaving,placeholder:"CRID ..."},null,8,Rt),[[B,e.clientRequestId]]),t("div",At,p(e.errors.clientRequestId),1)]),t("div",Ut,[t("button",{type:"button",onClick:s[4]||(s[4]=o=>e.clinicalDataExpanded=!e.clinicalDataExpanded),disabled:e.arSaving,class:"w-full px-4 py-3 flex items-center justify-between text-left hover:bg-muted/20 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50 rounded-t-lg disabled:opacity-50 disabled:cursor-not-allowed"},[s[18]||(s[18]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap"},"Clinical Data (click to expand)",-1)),(a(),r("svg",{class:M(["w-5 h-5 transition-transform duration-200",{"rotate-180":e.clinicalDataExpanded}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...s[17]||(s[17]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))],8,Pt),e.clinicalDataExpanded?(a(),r("div",qt,[t("label",Mt,[s[19]||(s[19]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap w-40"},"Clinical Indication",-1)),R(t("input",{class:"w-full px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","onUpdate:modelValue":s[5]||(s[5]=o=>e.clinicalData.clinicalIndication=o),disabled:e.arSaving,placeholder:"Enter clinical indication..."},null,8,Et),[[B,e.clinicalData.clinicalIndication]])]),t("div",Nt,[s[20]||(s[20]=t("span",{class:"text-sm font-medium text-foreground w-40"},"Symptoms",-1)),t("div",It,[R(t("input",{class:"flex-1 px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","onUpdate:modelValue":s[6]||(s[6]=o=>e.newSymptom=o),disabled:e.arSaving,placeholder:"Add symptom...",onKeydown:Ee(T(e.addSymptom,["prevent","stop"]),["enter"])},null,40,Bt),[[B,e.newSymptom]]),t("button",{type:"button",onClick:e.addSymptom,disabled:e.arSaving,class:"px-3 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50 disabled:cursor-not-allowed"}," Add ",8,Tt)]),t("div",jt,[(a(!0),r(x,null,h(e.clinicalData.symptoms,(o,i)=>(a(),r("span",{key:i,class:"inline-flex items-center gap-1 px-2 py-1 bg-muted text-muted-foreground rounded-md text-sm"},[Q(p(o)+" ",1),t("button",{type:"button",onClick:n=>e.removeSymptom(i),disabled:e.arSaving,class:"text-destructive hover:text-destructive/80 ml-1 disabled:opacity-50 disabled:cursor-not-allowed"}," × ",8,Ft)]))),128))])]),t("label",Lt,[s[21]||(s[21]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap w-40"},"Treatment Notes",-1)),R(t("textarea",{class:"w-full px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","onUpdate:modelValue":s[7]||(s[7]=o=>e.clinicalData.treatmentNotes=o),disabled:e.arSaving,placeholder:"Enter treatment notes...",rows:"2"},null,8,Yt),[[B,e.clinicalData.treatmentNotes]])]),t("div",zt,[t("label",Ht,[s[23]||(s[23]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap w-40"},"Pregnancy Status",-1)),R(t("select",{"onUpdate:modelValue":s[8]||(s[8]=o=>e.clinicalData.pregnancyStatus=o),disabled:e.arSaving,class:"w-full ml-4 px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50"},[...s[22]||(s[22]=[t("option",{value:null},"Not specified",-1),t("option",{value:!0},"Pregnant",-1),t("option",{value:!1},"Not pregnant",-1)])],8,Kt),[[J,e.clinicalData.pregnancyStatus]])]),t("label",Ot,[s[25]||(s[25]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap w-40"},"Breastfeeding Status",-1)),R(t("select",{"onUpdate:modelValue":s[9]||(s[9]=o=>e.clinicalData.breastFeeding=o),disabled:e.arSaving,class:"w-full px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50"},[...s[24]||(s[24]=[t("option",{value:null},"Not specified",-1),t("option",{value:!0},"Breastfeeding",-1),t("option",{value:!1},"Not breastfeeding",-1)])],8,Jt),[[J,e.clinicalData.breastFeeding]])])])])):w("",!0)])]),t("section",Qt,[t("div",Gt,[s[26]||(s[26]=t("h5",{class:"text-lg font-semibold text-foreground"},"Samples",-1)),t("div",Wt,[t("span",Xt,p(e.errors.samples),1),e.samples?.length!==20?(a(),r("button",{key:0,type:"button",onClick:s[10]||(s[10]=T(o=>e.addSample(),["prevent"])),disabled:e.arSaving,class:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50 disabled:cursor-not-allowed"}," Add Sample ",8,Zt)):w("",!0)])]),t("div",$t,[t("div",es,[t("table",ts,[s[34]||(s[34]=t("thead",null,[t("tr",{class:"border-b border-border bg-muted/30"},[t("th",{class:"p-4 text-left text-sm font-medium text-foreground h-16"}," Field ")])],-1)),t("tbody",null,[s[28]||(s[28]=t("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Sample Type ")],-1)),s[29]||(s[29]=t("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Date Collected ")],-1)),s[30]||(s[30]=t("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Date Received ")],-1)),s[31]||(s[31]=t("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Analysis Profiles ")],-1)),s[32]||(s[32]=t("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Analysis Services ")],-1)),e.billingEnabled?(a(),r("tr",ss,[...s[27]||(s[27]=[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Cost Breakdown ",-1)])])):w("",!0),s[33]||(s[33]=t("tr",{class:"h-24"},[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Selection Summary ")],-1))])])]),t("div",os,[t("table",ls,[t("thead",null,[t("tr",as,[(a(!0),r(x,null,h(e.samples,(o,i)=>(a(),r("th",{key:i,class:"p-4 text-center text-sm font-medium text-foreground w-80 min-w-80 relative h-16 border-r"},[t("div",rs,[t("span",null,"Sample "+p(i+1),1),t("button",{type:"button",onClick:T(n=>e.removeSample(i),["prevent"]),disabled:!e.canRemoveSample||e.arSaving,class:M(["px-2 py-1 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 text-xs ml-2",e.canRemoveSample&&!e.arSaving?"bg-destructive text-destructive-foreground hover:bg-destructive/90 focus:ring-destructive/50":"bg-muted text-muted-foreground cursor-not-allowed"]),title:e.canRemoveSample&&!e.arSaving?"Remove sample":"At least one sample is required"}," Remove ",10,ns)])]))),128))])]),t("tbody",null,[t("tr",is,[(a(!0),r(x,null,h(e.samples,(o,i)=>(a(),r("td",{key:i,class:"p-4 w-80 border-r"},[C(e.VueMultiselect,{class:"w-full",placeholder:"Select sample type",modelValue:o.sampleType,"onUpdate:modelValue":n=>o.sampleType=n,options:e.sampleTypes,searchable:!0,disabled:e.arSaving,label:"name","track-by":"uid",openDirection:"below"},null,8,["modelValue","onUpdate:modelValue","options","disabled"])]))),128))]),t("tr",ds,[(a(!0),r(x,null,h(e.samples,(o,i)=>(a(),r("td",{key:i,class:"p-4 w-80 border-r"},[C(b,{class:"w-full",modelValue:o.dateCollected,"onUpdate:modelValue":n=>o.dateCollected=n,"max-date":e.maxDate,disabled:e.arSaving,"time-picker-inline":"",teleport:!0},null,8,["modelValue","onUpdate:modelValue","max-date","disabled"])]))),128))]),t("tr",cs,[(a(!0),r(x,null,h(e.samples,(o,i)=>(a(),r("td",{key:i,class:"p-4 w-80 border-r"},[C(b,{class:"w-full",modelValue:o.dateReceived,"onUpdate:modelValue":n=>o.dateReceived=n,"min-date":o.dateCollected&&typeof o.dateCollected=="object"&&!(o.dateCollected instanceof Date)&&typeof o.dateCollected.toDate=="function"?o.dateCollected.toDate():o.dateCollected||null,"max-date":e.maxDate,disabled:e.arSaving,"time-picker-inline":"",teleport:!0},null,8,["modelValue","onUpdate:modelValue","min-date","max-date","disabled"])]))),128))]),t("tr",us,[(a(!0),r(x,null,h(e.samples,(o,i)=>(a(),r("td",{key:i,class:"p-4 w-80 border-r"},[C(e.VueMultiselect,{class:"w-full whitespace-nowrap z-10",placeholder:"Select analysis profiles",modelValue:o.profiles,"onUpdate:modelValue":n=>o.profiles=n,options:e.analysesProfiles,searchable:!0,disabled:e.arSaving,multiple:!0,label:"name","track-by":"uid",openDirection:"below"},null,8,["modelValue","onUpdate:modelValue","options","disabled"])]))),128))]),t("tr",ms,[(a(!0),r(x,null,h(e.samples,(o,i)=>(a(),r("td",{key:i,class:"p-4 w-80 border-r"},[C(e.VueMultiselect,{class:"w-full whitespace-nowrap",placeholder:"Select analysis services",modelValue:o.analyses,"onUpdate:modelValue":n=>o.analyses=n,options:e.analysesServices,searchable:!0,disabled:e.arSaving,multiple:!0,label:"name","track-by":"uid",openDirection:"below"},null,8,["modelValue","onUpdate:modelValue","options","disabled"])]))),128))]),e.billingEnabled?(a(),r("tr",ps,[(a(!0),r(x,null,h(e.samples,(o,i)=>(a(),r("td",{key:i,class:"p-4 w-80 border-r align-top"},[C(e.SampleCostBreakdown,{profiles:o.profiles,analyses:o.analyses,"price-map":e.priceMap,loading:e.billingStore.fetchingPrices},null,8,["profiles","analyses","price-map","loading"])]))),128))])):w("",!0),t("tr",bs,[(a(!0),r(x,null,h(e.samples,(o,i)=>(a(),r("td",{key:i,class:"p-4 w-80 border-r"},[t("div",fs,[o.profiles?.length===0&&o.analyses?.length===0?(a(),r("div",gs," ⚠️ Select profiles or services ")):(a(),r("div",ys,[t("div",vs,[s[35]||(s[35]=t("strong",null,"Profiles:",-1)),Q(" "+p(o.profiles?.length||0)+" selected ",1)]),t("div",xs,[s[36]||(s[36]=t("strong",null,"Services:",-1)),Q(" "+p(o.analyses?.length||0)+" selected ",1)])]))])]))),128))])])])])])]),e.billingEnabled?(a(),Me(e.CostSummary,{key:1,"sample-costs":e.sampleCosts,"grand-total":e.grandTotal,currency:e.setupStore.getLaboratory?.settings?.currency??"USD",loading:e.billingStore.fetchingPrices},null,8,["sample-costs","grand-total","currency","loading"])):w("",!0),t("div",hs,[t("button",{type:"submit",disabled:e.arSaving,class:"px-6 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50 disabled:cursor-not-allowed"}," Save Sample(s) ",8,_s)])],32)])}const Bs=W(ft,[["render",Ss],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/sample/SamplesAdd.vue"]]);export{Bs as default};
