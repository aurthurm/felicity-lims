const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DataTable-DLBrhw2Z.js","assets/index-OdhKCqIc.js","assets/index-DD18L2yL.css","assets/TooltipTrigger-BWIYwmnQ.js","assets/PopperContent-BfyCnGUj.js","assets/Input-BEm5S0CJ.js","assets/SelectValue-Ds0cfAgl.js","assets/useNonce-B4v0IDPb.js","assets/chevron-down-Dqf-ptA3.js","assets/useFocusGuards-Bjb6OG0k.js","assets/Spinner-Bl8RfjFA.js"])))=>i.map(i=>d[i]);
import{Y as U,u as L,a0 as l,aB as k,av as B,a7 as O,a5 as R,a6 as V,a3 as j,aD as H,aC as K,_ as q,r as z,c as Y,o as I,a as m,z as M,A as G,C as J,K as s,D as Q,M as W,E as X,I as Z,F as $}from"./index-OdhKCqIc.js";import{A as ee,E as te}from"./clients.mutations-B0cLk_GK.js";import{u as ne}from"./client-BNZY_Y1e.js";import{u as oe}from"./location-zigt6URg.js";import{C as ae}from"./ClientForm-Du5SJdtG.js";import{s as ie}from"./index-DJJ2wcNX.js";import{P as re}from"./PageHeading-Czi_4opS.js";import"./index.esm-BfHj8iGm.js";import"./FormMessage-CgXFMXx9.js";import"./FormLabel-DxP9wnWS.js";import"./Label-CS46LzLb.js";import"./Input-BEm5S0CJ.js";import"./SelectValue-Ds0cfAgl.js";import"./useNonce-B4v0IDPb.js";import"./chevron-down-Dqf-ptA3.js";import"./useFocusGuards-Bjb6OG0k.js";import"./PopperContent-BfyCnGUj.js";const le=U({__name:"ClientListing",setup(y,{expose:o}){o();const g=R(()=>V(()=>import("./DataTable-DLBrhw2Z.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),e=ne(),f=oe(),{withClientMutation:c}=L(),u=l([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Client Name",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(t,a){return H(K,{to:{name:"client-detail",query:{clientUid:t?.uid}},class:"px-2 py-1 font-semibold rounded-md hover:underline transition-colors duration-200",innerHTML:t?.name})}},{name:"Client ID",value:"code",sortable:!1,sortBy:"asc",hidden:!1},{name:"District",value:"district.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Province",value:"district.province.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Mobile Number",value:"mobilePhone",sortable:!1,sortBy:"asc",hidden:!1},{name:"Email Address",value:"email",sortable:!1,sortBy:"asc",hidden:!1}]),{clients:C,clientPageInfo:b,fetchingClients:D}=k(e);let i=l(!1),d=l(!1),h=l(""),r=B({});const v=l(""),T=()=>Object.assign(r,{});let n=B({first:50,after:"",text:"",sortBy:["uid"],filterAction:!1});e.fetchClients(n),f.fetchCountries();function _(t){c(ee,{payload:{name:t.name,code:t.code,districtUid:t.districtUid}},"createClient").then(a=>e.addClient(a))}function p(t){c(te,{uid:r.uid,payload:{name:t.name,code:t.code,districtUid:t.districtUid}},"updateClient").then(a=>e.updateClient(a))}function w(t){n.first=100,n.after="",n.text=t.filterText,n.filterAction=!0,e.fetchClients(n)}function x(t){n.first=t.fetchCount,n.after=b?.value?.endCursor,n.text=t.filterText,n.filterAction=!1,e.fetchClients(n)}function S(t,a,N={}){d.value=t,h.value=a,v.value=(t?"CREATE":"EDIT")+" "+a.toUpperCase(),a=="client"&&(i.value=!0,Object.assign(r,t?{}:{...N}))}function A(t){d.value?_(t):p(t),i.value=!1}function E(){i.value=!1}const F=O(()=>C?.value?.length+" of "+e.getClientCount+" clients"),P={DataTable:g,clientStore:e,locationStore:f,withClientMutation:c,tableColumns:u,clients:C,clientPageInfo:b,fetchingClients:D,get showClientModal(){return i},set showClientModal(t){i=t},get createItem(){return d},set createItem(t){d=t},get targetItem(){return h},set targetItem(t){h=t},get client(){return r},set client(t){r=t},formTitle:v,resetClient:T,get clientParams(){return n},set clientParams(t){n=t},addClient:_,editClient:p,searchClients:w,showMoreClients:x,FormManager:S,onFormSubmit:A,onFormClose:E,countNone:F,get Button(){return j},ClientForm:ae,get shield(){return ie},PageHeading:re};return Object.defineProperty(P,"__isScriptSetup",{enumerable:!1,value:!0}),P}}),se={class:"rounded-lg border border-border bg-card shadow-sm p-6"};function ce(y,o,g,e,f,c){const u=z("Modal");return I(),Y($,null,[m(e.PageHeading,{title:"Clients"},{default:s(()=>[Q(m(e.Button,{onClick:o[0]||(o[0]=C=>e.FormManager(!0,"client"))},{default:s(()=>[...o[1]||(o[1]=[W(" Add client ",-1)])]),_:1},512),[[X,e.shield.hasRights(e.shield.actions.CREATE,e.shield.objects.CLIENT)]])]),_:1}),M("div",se,[m(e.DataTable,{columns:e.tableColumns,data:e.clients,toggleColumns:!0,loading:e.fetchingClients,paginable:!0,pageMeta:{fetchCount:e.clientParams.first,hasNextPage:e.clientPageInfo?.hasNextPage,countNone:e.countNone},searchable:!0,filterable:!1,onOnSearchKeyUp:e.searchClients,onOnSearchFocus:e.resetClient,onOnPaginate:e.showMoreClients,selectable:!1},{footer:s(()=>[...o[2]||(o[2]=[])]),_:1},8,["columns","data","loading","pageMeta"])]),e.showClientModal?(I(),G(u,{key:0,onClose:e.onFormClose},{header:s(()=>[M("h3",null,Z(e.formTitle),1)]),body:s(()=>[m(e.ClientForm,{client:e.client,create:e.createItem,onSubmit:e.onFormSubmit,onClose:e.onFormClose},null,8,["client","create"])]),_:1})):J("",!0)],64)}const Te=q(le,[["render",ce],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/client/ClientListing.vue"]]);export{Te as default};
