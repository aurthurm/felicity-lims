import{Y as L,u as O,aS as V,a0 as _,a7 as C,ai as o,aT as z,ah as j,aU as F,e as G,aV as H,a3 as K,_ as Q,r as q,c as r,o as l,N as a,z as t,a as x,D as N,aG as M,F as E,H as A,I as T,K as W,A as Y,C as J,M as X}from"./index-OdhKCqIc.js";import{u as Z}from"./setup-BcFG_bXr.js";import{S as $}from"./Spinner-Bl8RfjFA.js";const ee=L({__name:"UserPreferences",props:{compact:{type:Boolean,required:!1,default:!1}},setup(v,{expose:n}){n();const y=v,{withClientQuery:e,withClientMutation:p}=O(),i=Z(),{toastSuccess:d,toastError:s}=G(),{initPreferences:h,toggleDepartment:w,isDepartmentSelected:B,theme:k,expandedMenu:S,defaultRoute:D,departments:u}=V(),m=_(!0),f=_(!1),I=C(()=>i.getDepartments),U=C(()=>[{label:"Dashboard",value:"/dashboard",page:o.DASHBOARD},{label:"Patients",value:"/patients",page:o.PATIENTS},{label:"Patients Compact",value:"/patients-compact",page:o.PATIENTS_COMPACT},{label:"Clients",value:"/clients",page:o.CLIENTS},{label:"Samples",value:"/samples",page:o.SAMPLES},{label:"Quality Control",value:"/quality-control",page:o.QC_SAMPLES},{label:"Worksheets",value:"/worksheets",page:o.WORKSHEETS},{label:"Referrals",value:"/shipments",page:o.REFERRAL},{label:"Bio-Banking",value:"/bio-banking",page:o.BIO_BANKING},{label:"Inventory",value:"/inventory",page:o.INVENTORY},{label:"Notice Manager",value:"/notice-manager",page:o.NOTICE_MANAGER},{label:"Projects/Schemes",value:"/schemes",page:o.SCHEMES},{label:"Documents",value:"/documents",page:o.DOCUMENT},{label:"Billing",value:"/billing",page:o.BILLING},{label:"Administration",value:"/admin",page:o.ADMINISTRATION}].filter(c=>z(c.page)));j(()=>{i.fetchDepartments({}),g()});function g(){m.value=!0,e(F,{},"userPreferences").then(c=>{c&&h(c)}).finally(()=>{m.value=!1})}async function R(){f.value=!0;const c={expandedMenu:S.value,theme:k.value,defaultRoute:D.value||void 0,departments:u.value.length>0?u.value.map(b=>b.uid):void 0};try{p(H,{preferencesIn:c},"updateUserPreferences").then(()=>{d("Preferences updated successfully"),g()}).catch(b=>{s(b?.message||"Failed to update preferences")})}finally{f.value=!1}}const P={props:y,withClientQuery:e,withClientMutation:p,setupStore:i,toastSuccess:d,toastError:s,initPreferences:h,toggleDepartment:w,isDepartmentSelected:B,theme:k,expandedMenu:S,defaultRoute:D,departments:u,loading:m,saving:f,allDepartments:I,availablePages:U,fetchUserPreferences:g,savePreferences:R,get Spinner(){return $},get Button(){return K}};return Object.defineProperty(P,"__isScriptSetup",{enumerable:!1,value:!0}),P}}),ae={class:"inline-flex items-center gap-2"},te=["value"],se={class:"flex items-center justify-between gap-2"},oe=["aria-checked"],ne=["for"],le=["disabled"];function re(v,n,y,e,p,i){const d=q("Checkbox");return l(),r("div",{class:a(["w-full",e.props.compact?"space-y-4":"space-y-6"])},[e.loading?(l(),r("div",{key:0,class:a(["flex justify-center items-center",e.props.compact?"h-24":"h-32"])},[t("span",ae,[x(e.Spinner,{class:a(e.props.compact?"size-3":"size-4")},null,8,["class"]),t("span",{class:a(e.props.compact?"text-xs":"text-sm")},"Loading preferences...",2)])],2)):(l(),r("div",{key:1,class:a(e.props.compact?"space-y-3":"space-y-6")},[t("div",{class:a(e.props.compact?"space-y-3":"grid grid-cols-2 gap-4")},[t("div",{class:a(e.props.compact?"space-y-1":"space-y-2")},[t("label",{class:a(["block font-semibold text-foreground",e.props.compact?"text-xs":"text-l"])}," Theme ",2),N(t("select",{"onUpdate:modelValue":n[0]||(n[0]=s=>e.theme=s),class:a(["w-full border border-input bg-background text-foreground rounded focus:outline-none focus:ring-2 focus:ring-ring",e.props.compact?"px-2 py-1.5 text-xs rounded-md":"px-3 py-2 rounded-lg"])},[...n[3]||(n[3]=[t("option",{value:"light"},"Light",-1),t("option",{value:"dark"},"Dark",-1),t("option",{value:"system"},"System",-1)])],2),[[M,e.theme]])],2),t("div",{class:a(e.props.compact?"space-y-1":"space-y-2")},[t("label",{class:a(["block font-semibold text-foreground",e.props.compact?"text-xs":"text-l"])}," Default Route ",2),N(t("select",{"onUpdate:modelValue":n[1]||(n[1]=s=>e.defaultRoute=s),class:a(["w-full border border-input bg-background text-foreground rounded focus:outline-none focus:ring-2 focus:ring-ring",e.props.compact?"px-2 py-1.5 text-xs rounded-md":"px-3 py-2 rounded-lg"])},[n[4]||(n[4]=t("option",{value:""},"No preference (Dashboard)",-1)),(l(!0),r(E,null,A(e.availablePages,s=>(l(),r("option",{key:s.value,value:s.value},T(s.label),9,te))),128))],2),[[M,e.defaultRoute]])],2)],2),t("div",se,[t("label",{class:a(["font-semibold text-foreground shrink-0",e.props.compact?"text-xs":"text-l"])}," Expanded Menu ",2),t("button",{onClick:n[2]||(n[2]=s=>e.expandedMenu=!e.expandedMenu),class:a(["relative inline-flex h-6 w-11 items-center rounded-full transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",e.expandedMenu?"bg-primary":"bg-muted"]),role:"switch","aria-checked":e.expandedMenu},[t("span",{class:a(["inline-block h-4 w-4 transform rounded-full bg-background transition-transform",e.expandedMenu?"translate-x-6":"translate-x-1"])},null,2)],10,oe)]),t("div",{class:a(e.props.compact?"space-y-2":"space-y-3")},[t("label",{class:a(["block font-semibold text-foreground",e.props.compact?"text-xs":"text-l"])}," Departments Filter ",2),e.allDepartments.length===0?(l(),r("div",{key:0,class:a(["text-muted-foreground italic",e.props.compact?"text-xs":"text-sm"])}," No departments available ",2)):(l(),r("div",{key:1,class:a(e.props.compact?"space-y-1.5":"grid grid-cols-2 gap-4")},[(l(!0),r(E,null,A(e.allDepartments,s=>(l(),r("div",{key:s.uid,class:"flex items-center"},[x(d,{id:`dept-${s.uid}`,checked:e.isDepartmentSelected(s.uid),"onUpdate:checked":()=>e.toggleDepartment(s)},null,8,["id","checked","onUpdate:checked"]),t("label",{for:`dept-${s.uid}`,class:a(["font-medium text-foreground cursor-pointer truncate",e.props.compact?"ml-1.5 text-xs":"ml-2 text-sm"])},T(s.name),11,ne)]))),128))],2))],2),t("div",{class:a(["flex flex-wrap justify-end",e.props.compact?"gap-2 pt-2":"gap-3 pt-4"])},[t("button",{type:"button",onClick:e.fetchUserPreferences,disabled:e.saving,class:a(["font-medium border border-input bg-background text-foreground hover:bg-muted transition-colors focus:outline-none focus:ring-2 focus:ring-ring disabled:opacity-50 disabled:cursor-not-allowed",e.props.compact?"px-2 py-1 text-xs rounded-md":"px-4 py-2 text-sm rounded-lg"])}," Cancel ",10,le),x(e.Button,{type:"button",onClick:e.savePreferences,disabled:e.saving||e.loading,class:a(e.props.compact?"h-7 px-2 text-xs":"px-4 py-2")},{default:W(()=>[e.saving?(l(),Y(e.Spinner,{key:0,class:a(e.props.compact?"mr-1 size-3":"mr-2 size-4")},null,8,["class"])):J("",!0),n[5]||(n[5]=X(" Save ",-1))]),_:1},8,["disabled","class"])],2)],2))],2)}const pe=Q(ee,[["render",re],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/components/user/UserPreferences.vue"]]);export{pe as default};
