import{W as X,f as Y,a2 as u,a3 as ee,al as te,ak as E,h as P,i as oe,r as x,o as i,c as d,a as k,M as b,D as c,N as le,E as ne,O as o,a7 as n,z as se,J as C,Z as A,af as w,F as g,H as U,a4 as D,C as ae,L as ie,a0 as re,a1 as ue,_ as de}from"./index-93739211.js";import{A as fe,E as ce}from"./clients.mutations-1f93083e.js";import{u as me}from"./client-946311ca.js";import{u as pe}from"./location-d054e737.js";import{h as be,a as ve,o as Ce}from"./constants-c5e2e8e5.js";const ge={class:"rounded-lg border border-border bg-card shadow-sm p-6"},ye={action:"post",class:"p-1"},he={class:"grid grid-cols-2 gap-x-4 mb-4"},xe={class:"block col-span-1 mb-2"},ke={class:"block col-span-1 mb-2"},we={class:"grid grid-cols-3 gap-x-4 mb-4"},Ue={class:"block col-span-1 mb-2"},De=["value"],_e={class:"block col-span-1 mb-2"},Be=["value"],Ne={class:"block col-span-1 mb-2"},Te=["value"],Ee=X({__name:"ClientListing",setup(Pe){const M=re(()=>ue(()=>import("./FelDataTable-2f84e0fb.js"),["assets/FelDataTable-2f84e0fb.js","assets/index-93739211.js","assets/index-0f090789.css"])),r=me(),v=pe(),{withClientMutation:_}=Y(),S=u([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Client Name",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(l,e){return ee(te,{to:{name:"client-detail",query:{clientUid:l?.uid}},class:"px-2 py-1 font-semibold rounded-md hover:underline transition-colors duration-200",innerHTML:l?.name})}},{name:"Client ID",value:"code",sortable:!1,sortBy:"asc",hidden:!1},{name:"District",value:"district.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Province",value:"district.province.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Mobile Number",value:"mobilePhone",sortable:!1,sortBy:"asc",hidden:!1},{name:"Email Address",value:"email",sortable:!1,sortBy:"asc",hidden:!1}]),{countries:L,provinces:V,districts:I}=E(v),{clients:B,clientPageInfo:N,fetchingClients:O}=E(r);let f=u(!1),y=u(!1),R=u(""),s=P({});const T=u(""),F=()=>Object.assign(s,{});let a=P({first:50,after:"",text:"",sortBy:["uid"],filterAction:!1}),m=u(),p=u();r.fetchClients(a),v.fetchCountries();function j(){_(fe,{payload:{name:s.name,code:s.code,districtUid:s.districtUid}},"createClient").then(l=>r.addClient(l))}function H(){_(ce,{uid:s.uid,payload:{name:s.name,code:s.code,districtUid:s.districtUid}},"updateClient").then(l=>r.updateClient(l))}function q(l){v.filterProvincesByCountry(m.value)}function z(l){v.filterDistrictsByProvince(p.value)}function J(l){a.first=100,a.after="",a.text=l.filterText,a.filterAction=!0,r.fetchClients(a)}function K(l){a.first=l.fetchCount,a.after=N?.value?.endCursor,a.text=l.filterText,a.filterAction=!1,r.fetchClients(a)}function W(l,e,h={}){y.value=l,R.value=e,T.value=(l?"CREATE":"EDIT")+" "+e.toUpperCase(),e=="client"&&(f.value=!0),l?e=="client"&&Object.assign(s,{}):e=="client"&&Object.assign(s,{...h})}function Z(){y.value&&j(),y.value||H(),f.value=!1}const $=oe(()=>B?.value?.length+" of "+r.getClientCount+" clients");return(l,e)=>{const h=x("fel-button"),G=x("fel-heading"),Q=x("fel-modal");return i(),d(g,null,[k(G,{title:"Clients"},{default:b(()=>[c(k(h,{onClick:e[0]||(e[0]=t=>W(!0,"client"))},{default:b(()=>e[10]||(e[10]=[le(" Add client ")])),_:1},512),[[ne,be(ve.CREATE,Ce.CLIENT)]])]),_:1}),o("div",ge,[k(n(M),{columns:S.value,data:n(B),toggleColumns:!0,loading:n(O),paginable:!0,pageMeta:{fetchCount:n(a).first,hasNextPage:n(N)?.hasNextPage,countNone:$.value},searchable:!0,filterable:!1,onOnSearchKeyUp:J,onOnSearchFocus:F,onOnPaginate:K,selectable:!1},{footer:b(()=>e[11]||(e[11]=[])),_:1},8,["columns","data","loading","pageMeta"])]),n(f)?(i(),se(Q,{key:0,onClose:e[9]||(e[9]=t=>w(f)?f.value=!1:f=!1)},{header:b(()=>[o("h3",null,C(T.value),1)]),body:b(()=>[o("form",ye,[o("div",he,[o("label",xe,[e[12]||(e[12]=o("span",{class:"text-foreground"},"Name",-1)),c(o("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":e[1]||(e[1]=t=>n(s).name=t),placeholder:"Name ..."},null,512),[[A,n(s).name]])]),o("label",ke,[e[13]||(e[13]=o("span",{class:"text-foreground"},"Code",-1)),c(o("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":e[2]||(e[2]=t=>n(s).code=t),placeholder:"Code ..."},null,512),[[A,n(s).code]])])]),o("div",we,[o("label",Ue,[e[15]||(e[15]=o("span",{class:"text-foreground"},"Country",-1)),c(o("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[3]||(e[3]=t=>w(m)?m.value=t:m=t),onChange:e[4]||(e[4]=t=>q(t))},[e[14]||(e[14]=o("option",null,null,-1)),(i(!0),d(g,null,U(n(L),t=>(i(),d("option",{key:t.uid,value:t.uid},C(t.name),9,De))),128))],544),[[D,n(m)]])]),o("label",_e,[e[17]||(e[17]=o("span",{class:"text-foreground"},"Province",-1)),c(o("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[5]||(e[5]=t=>w(p)?p.value=t:p=t),onChange:e[6]||(e[6]=t=>z(t))},[e[16]||(e[16]=o("option",null,null,-1)),(i(!0),d(g,null,U(n(V),t=>(i(),d("option",{key:t.uid,value:t.uid},C(t.name),9,Be))),128))],544),[[D,n(p)]])]),o("label",Ne,[e[19]||(e[19]=o("span",{class:"text-foreground"},"District",-1)),c(o("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[7]||(e[7]=t=>n(s).districtUid=t)},[e[18]||(e[18]=o("option",null,null,-1)),(i(!0),d(g,null,U(n(I),t=>(i(),d("option",{key:t.uid,value:t.uid},C(t.name),9,Te))),128))],512),[[D,n(s).districtUid]])])]),e[20]||(e[20]=o("hr",null,null,-1)),o("button",{type:"button",onClick:e[8]||(e[8]=ae(t=>Z(),["prevent"])),class:"m-2 -mb-4 w-full rounded-sm border border-primary bg-primary px-4 py-2 text-primary-foreground transition-colors duration-500 ease select-none hover:bg-primary focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):ie("",!0)],64)}}}),Ie=de(Ee,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/client/ClientListing.vue"]]);export{Ie as default};
