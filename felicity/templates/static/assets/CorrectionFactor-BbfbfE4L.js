const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-v7Q387fb.js","assets/index-c4lX_LAY.css"])))=>i.map(i=>d[i]);
import{a0 as H,f as Q,t as X,a7 as h,a5 as Z,h as D,a1 as j,a6 as $,_ as ee,r as q,c as i,o as d,a as O,A as e,C as te,E as x,N as v,P as oe,J as y,K as w,L as a,D as re,F as U,a9 as R,a2 as ne}from"./index-v7Q387fb.js";import{c as se,d as de,a as B,u as ie,b as C}from"./index.esm-D-THTBXR.js";import{F as ae,G as le}from"./analyses.mutations-DwO9qbHD.js";import{u as ue}from"./analysis-xHaHOXP2.js";import{u as ce}from"./setup-sVxge2CR.js";const me=H({__name:"CorrectionFactor",props:{analysis:{type:Object,required:!0,default:()=>({})},analysisUid:{type:String,required:!0,default:0}},setup(k,{expose:t}){t();const A=j(()=>$(()=>import("./index-v7Q387fb.js").then(n=>n.cl),__vite__mapDeps([0,1]))),o=ue(),l=ce(),{withClientMutation:f}=Q(),c=k,{analysis:p}=X(c);let r=h(!1),b=h("");const g=h(!0),m=h(null),M=se({instrumentUid:B().trim().required("Instrument is required"),methodUid:B().trim().required("Method is required"),factor:de().typeError("Factor must be a number").required("Factor is required")}),{handleSubmit:E,resetForm:S,setValues:N}=ie({validationSchema:M,initialValues:{instrumentUid:"",methodUid:"",factor:""}}),{value:L,errorMessage:P}=C("instrumentUid"),{value:G,errorMessage:J}=C("methodUid"),{value:K,errorMessage:W}=C("factor");Z(()=>c.analysisUid,(n,s)=>{}),l.fetchInstruments();const _=D(()=>l.getInstruments);l.fetchMethods();const F=D(()=>l.getMethods);function I(n){f(ae,{payload:n},"createAnalysisCorrectionFactor").then(s=>o.AddAnalysisCorrectionFactor(s))}function T(n){m.value&&f(le,{uid:m.value,payload:n},"updateAnalysisCorrectionFactor").then(s=>o.updateAnalysisCorrectionFactor(s))}function Y(n,s={}){g.value=n,r.value=!0,b.value=(n?"CREATE":"EDIT")+" ANALYSIS CORRECTION FACTOR",n?(m.value=null,S({values:{instrumentUid:"",methodUid:"",factor:""}})):(m.value=s.uid??null,N({instrumentUid:s.instrumentUid??"",methodUid:s.methodUid??"",factor:s.factor??""}))}const z=E(n=>{const s=p?.value?.uid;if(!s)return;const u={instrumentUid:n.instrumentUid,methodUid:n.methodUid,factor:Number(n.factor),analysisUid:s};g.value===!0&&I(u),g.value===!1&&T(u),r.value=!1}),V={modal:A,analysisStore:o,setupStore:l,withClientMutation:f,props:c,analysis:p,get showModal(){return r},set showModal(n){r=n},get formTitle(){return b},set formTitle(n){b=n},formAction:g,currentUid:m,correctionSchema:M,handleSubmit:E,resetForm:S,setValues:N,instrumentUid:L,instrumentError:P,methodUid:G,methodError:J,factor:K,factorError:W,instruments:_,methods:F,addAnalysisCorrectionFactor:I,editAnalysisCorrectionFactor:T,FormManager:Y,saveForm:z,instrumentName:n=>{const s=_?.value?.findIndex(u=>u.uid===n);return _?.value[s]?.name||"unknown"},methodName:n=>{const s=F?.value?.findIndex(u=>u.uid===n);return F?.value[s]?.name||"unknown"}};return Object.defineProperty(V,"__isScriptSetup",{enumerable:!1,value:!0}),V}}),fe={class:"overflow-x-auto mt-4"},pe={class:"align-middle inline-block min-w-full shadow overflow-hidden bg-card text-card-foreground rounded-lg border border-border"},be={class:"min-w-full"},ge={class:"bg-card"},he={class:"px-4 py-2 whitespace-no-wrap border-b border-border"},xe={class:"text-sm text-foreground"},ve={class:"px-4 py-2 whitespace-no-wrap border-b border-border"},ye={class:"text-sm text-foreground"},_e={class:"px-4 py-2 whitespace-no-wrap border-b border-border"},Fe={class:"text-sm text-foreground"},we={class:"px-4 py-2 whitespace-no-wrap text-right border-b border-border"},Ue=["onClick"],Ce={class:"text-lg font-bold text-foreground"},ke={class:"space-y-4"},Ae={class:"grid grid-cols-3 gap-4"},Me={class:"space-y-2"},Ee=["value"],Se={key:0,class:"text-sm text-destructive"},Ne={class:"space-y-2"},Ie=["value"],Te={key:0,class:"text-sm text-destructive"},Ve={class:"space-y-2"},De={key:0,class:"text-sm text-destructive"};function qe(k,t,A,o,l,f){const c=q("fel-button"),p=q("fel-heading");return d(),i(y,null,[O(p,{title:"Correction Factors"},{default:v(()=>[O(c,{onClick:t[0]||(t[0]=r=>o.FormManager(!0))},{default:v(()=>[...t[6]||(t[6]=[oe("Add Correction Factor",-1)])]),_:1})]),_:1}),e("div",fe,[e("div",pe,[e("table",be,[t[7]||(t[7]=e("thead",null,[e("tr",null,[e("th",{class:"px-4 py-2 border-b border-border text-left text-sm font-medium text-muted-foreground"},"Instrument"),e("th",{class:"px-4 py-2 border-b border-border text-left text-sm font-medium text-muted-foreground"},"Method"),e("th",{class:"px-4 py-2 border-b border-border text-left text-sm font-medium text-muted-foreground"},"Factor"),e("th",{class:"px-4 py-2 border-b border-border"})])],-1)),e("tbody",ge,[(d(!0),i(y,null,w(o.analysis?.correctionFactors,r=>(d(),i("tr",{key:r?.uid,class:"hover:bg-accent/50"},[e("td",he,[e("div",xe,a(o.instrumentName(r?.instrumentUid)),1)]),e("td",ve,[e("div",ye,a(o.methodName(r?.methodUid)),1)]),e("td",_e,[e("div",Fe,a(r.factor),1)]),e("td",we,[e("button",{onClick:b=>o.FormManager(!1,r),class:"px-2 py-1 mr-2 border border-border bg-background text-foreground transition-colors duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-ring hover:bg-accent hover:text-accent-foreground"}," Edit ",8,Ue)])]))),128))])])])]),o.showModal?(d(),te(o.modal,{key:0,onClose:t[5]||(t[5]=r=>o.showModal=!1),contentWidth:"w-2/4"},{header:v(()=>[e("h3",Ce,a(o.formTitle),1)]),body:v(()=>[e("form",{onSubmit:t[4]||(t[4]=re((...r)=>o.saveForm&&o.saveForm(...r),["prevent"])),class:"p-6 space-y-6"},[e("div",ke,[e("div",Ae,[e("label",Me,[t[9]||(t[9]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Instrument",-1)),U(e("select",{class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":t[1]||(t[1]=r=>o.instrumentUid=r)},[t[8]||(t[8]=e("option",{value:""},"Select Instrument",-1)),(d(!0),i(y,null,w(o.instruments,r=>(d(),i("option",{key:r?.uid,value:r.uid},a(r?.name),9,Ee))),128))],512),[[R,o.instrumentUid]]),o.instrumentError?(d(),i("p",Se,a(o.instrumentError),1)):x("",!0)]),e("label",Ne,[t[11]||(t[11]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Method",-1)),U(e("select",{class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":t[2]||(t[2]=r=>o.methodUid=r)},[t[10]||(t[10]=e("option",{value:""},"Select Method",-1)),(d(!0),i(y,null,w(o.methods,r=>(d(),i("option",{key:r?.uid,value:r.uid},a(r?.name),9,Ie))),128))],512),[[R,o.methodUid]]),o.methodError?(d(),i("p",Te,a(o.methodError),1)):x("",!0)]),e("label",Ve,[t[12]||(t[12]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Factor",-1)),U(e("input",{type:"number",class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":t[3]||(t[3]=r=>o.factor=r),placeholder:"Factor ..."},null,512),[[ne,o.factor]]),o.factorError?(d(),i("p",De,a(o.factorError),1)):x("",!0)])])]),t[13]||(t[13]=e("div",{class:"pt-4"},[e("button",{type:"submit",class:"w-full bg-primary text-primary-foreground hover:bg-primary/90 rounded-lg px-4 py-2 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-ring"}," Save Form ")],-1))],32)]),_:1})):x("",!0)],64)}const Ke=ee(me,[["render",qe],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/analyses/services/CorrectionFactor.vue"]]);export{Ke as default};
