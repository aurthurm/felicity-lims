import{a0 as w,a7 as d,h as p,ad as N,i as V,ar as h,_ as C,c as a,o as n,A as t,E as i,L as u,a as I,N as D,T as L}from"./index-Cdc6vSVw.js";const M=w({__name:"VersionDisplay",setup(g,{expose:s}){s();const l=d(!1),e=d("0.0.0"),r=d(null),c=d(null),_=d(!1),v=async()=>{l.value=!0,h.get("/version").then(({data:{version:o}})=>{e.value=o}).catch(o=>{c.value="Failed to get current version",console.error(o)}).finally(()=>l.value=!1)},{toastInfo:f}=V(),m=async()=>{l.value=!0,h.get("/version/updates").then(({data:o})=>{r.value=o,o.update_available?f(`Update available: ${o.latest_version}`):f("No updates available")}).catch(o=>{c.value="Failed to get current version",console.error(o)}).finally(()=>l.value=!1)},b=p(()=>r.value?.latest_version||"-"),y=p(()=>r.value?.last_checked?new Date(r.value.last_checked).toLocaleString():"-"),k=p(()=>r.value?.release_notes?r.value.release_notes.replace(/^(\s*[-*] .*)$/gm,'<span style="color:#2563eb;">$1</span>').replace(/^(\s*[A-Z][^:]+:)/gm,"<b>$1</b>").replace(/\r?\n/g,"<br>"):"");N(()=>{v(),m()});const x={loading:l,currentVersion:e,updateInfo:r,error:c,showNotes:_,getCurrentVersion:v,toastInfo:f,getUpdates:m,latestVersion:b,formattedLastChecked:y,formattedReleaseNotes:k};return Object.defineProperty(x,"__isScriptSetup",{enumerable:!1,value:!0}),x}}),B={class:"flex flex-col gap-y-2 bg-background/50 px-4 py-2 rounded-lg border border-border/50"},S={class:"flex items-center gap-x-4"},T={class:"flex items-center gap-x-2"},H={class:"text-sm font-medium text-foreground"},R={key:0,class:"flex items-center gap-x-2 text-primary"},j={class:"text-sm font-medium"},U={key:1,class:"ml-auto text-xs text-muted-foreground"},A={key:0},E={key:0,class:"flex flex-col gap-2 mt-2"},F={class:"flex items-center gap-2"},G=["href"],O={key:0,class:"bg-muted/30 border border-border/30 rounded p-3 mt-1 max-h-96 overflow-auto whitespace-pre-wrap text-xs font-mono"},P=["innerHTML"],Z={key:1,class:"text-xs text-muted-foreground mt-2"};function q(g,s,l,e,r,c){return n(),a("div",B,[t("div",S,[t("div",T,[t("span",H,"v"+u(e.currentVersion),1),e.updateInfo?.update_available?i("",!0):(n(),a("button",{key:0,onClick:e.getUpdates,class:"p-1.5 text-muted-foreground hover:text-foreground hover:bg-muted rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2","aria-label":"Check for updates"},[...s[1]||(s[1]=[t("svg",{class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.3"})],-1)])]))]),e.updateInfo?.update_available?(n(),a("div",R,[t("span",j,"v"+u(e.latestVersion)+" available",1),s[2]||(s[2]=t("svg",{class:"w-4 h-4 animate-pulse",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round","aria-hidden":"true"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),t("line",{x1:"12",y1:"8",x2:"12",y2:"8"})],-1))])):i("",!0),e.updateInfo?.last_checked?(n(),a("span",U,"Last checked: "+u(e.formattedLastChecked),1)):i("",!0)]),e.updateInfo?(n(),a("div",A,[e.updateInfo.update_available?(n(),a("div",E,[t("div",F,[e.updateInfo.release_url?(n(),a("a",{key:0,href:e.updateInfo.release_url,target:"_blank",rel:"noopener",class:"text-blue-600 hover:underline text-xs font-medium"}," View Release on GitHub ",8,G)):i("",!0),t("button",{onClick:s[0]||(s[0]=_=>e.showNotes=!e.showNotes),class:"text-xs text-primary underline focus:outline-none"},u(e.showNotes?"Hide":"Show")+" Release Notes ",1)]),I(L,{name:"fade"},{default:D(()=>[e.showNotes?(n(),a("div",O,[t("span",{innerHTML:e.formattedReleaseNotes},null,8,P)])):i("",!0)]),_:1})])):(n(),a("div",Z,[...s[3]||(s[3]=[t("span",null,"No updates available.",-1)])]))])):i("",!0)])}const J=C(M,[["render",q],["__scopeId","data-v-f64094ba"],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/admin/VersionDisplay.vue"]]);export{J as default};
