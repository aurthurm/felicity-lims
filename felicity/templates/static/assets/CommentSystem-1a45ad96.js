import{d as U,I as E,r as b,o as i,c as l,e as B,v as j,b as n,G as m,y as s,B as q,t as x,k as $,q as M,p as f,f as P,aM as Q,F as R,g as w,C as W}from"./index-fc86f1fc.js";import{h as J,i as K,j as X,k as Y}from"./grind.queries-5040943e.js";const Z={class:"mb-4"},_=["rows","placeholder"],ee={class:"flex items-center justify-end mt-2 gap-2"},te={key:0,class:"flex items-center gap-2 font-sm"},ne=n("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[n("path",{"fill-rule":"evenodd",d:"M7.707 3.293a1 1 0 010 1.414L5.414 7H11a7 7 0 017 7v2a1 1 0 11-2 0v-2a5 5 0 00-5-5H5.414l2.293 2.293a1 1 0 11-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1),oe=[ne],ie=U({__name:"CommentForm",props:{errandUid:{type:String,required:!0},parentDiscussion:{type:Object,default:void 0},isReply:{type:Boolean,default:!1}},emits:["commentAdded","cancelReply"],setup(e,{emit:v}){const t=e,o=v,{withClientMutation:g}=E(),d=b("");function a(){d.value.trim()&&g(J,{payload:{comment:d.value,errandUid:t.errandUid,parentUid:t.parentDiscussion?.uid}},"createGrindErrandDiscussion").then(()=>{d.value="",o("commentAdded")})}function c(){o("cancelReply")}return(y,u)=>(i(),l("div",Z,[B(n("textarea",{"onUpdate:modelValue":u[0]||(u[0]=C=>d.value=C),rows:e.isReply?2:3,class:m(`w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500 ${e.isReply?"text-sm":""}`),placeholder:e.isReply?"Write a reply...":"Add a comment..."},null,10,_),[[j,d.value]]),n("div",ee,[e.isReply?(i(),l("button",{key:0,onClick:c,class:"px-2 py-1 border border-gray-300 rounded hover:bg-gray-50 text-sm"}," Cancel ")):s("v-if",!0),n("button",{onClick:a,class:m(`px-3 py-1.5 bg-blue-500 text-white rounded hover:bg-blue-600 flex items-center gap-2 ${e.isReply?"text-sm px-2 py-1":""}`)},[e.isReply?s("v-if",!0):(i(),l("div",te,[...oe])),q(" "+x(e.isReply?"Reply":"Comment"),1)],2)])]))}}),N=$(ie,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/grind/CommentForm.vue"]]),le={class:"flex items-start gap-4"},me={class:"flex-1"},se={class:"flex justify-between"},de={key:0,class:"flex gap-2"},ae=n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"},null,-1),re=[ae],ce=n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"},null,-1),ue=[ce],ge=["rows"],ve={class:"flex items-center justify-end gap-2 mt-2"},ye=["innerHTML"],fe=U({__name:"CommentItem",props:{comment:{type:Object,required:!0},replyingTo:{type:Object,default:null},editingComment:{type:Object,default:null},level:{type:Number,default:0}},emits:["setReplyingTo","setEditingComment","commentAdded","commentUpdated"],setup(e,{emit:v}){const t=e;M(()=>{console.log("CommentItem mounted ::: comment",t.comment),c(t.comment.uid)});const o=v,{withClientMutation:g,withClientQuery:d}=E(),a=b([]);function c(h){d(K,{parentUid:h},"grindErrandDiscussionsByParent").then(p=>{p&&(a.value=p)})}const y=f(()=>t.editingComment&&t.editingComment.uid===t.comment.uid),u=f(()=>t.replyingTo&&t.replyingTo.uid===t.comment.uid),C=f(()=>t.level<2),D=f(()=>{switch(t.level){case 0:return"h-10 w-10";case 1:return"h-8 w-8";case 2:return"h-6 w-6";default:return"h-10 w-10"}}),r=f(()=>{switch(t.level){case 0:return"bg-orange-100 text-orange-600";case 1:return"bg-blue-100 text-blue-600";case 2:return"bg-green-100 text-green-600";default:return"bg-orange-100 text-orange-600"}}),k=f(()=>{switch(t.level){case 0:return"";case 1:return"text-sm";case 2:return"text-xs";default:return""}}),T=f(()=>{switch(t.level){case 0:return"h-5 w-5";case 1:return"h-4 w-4";case 2:return"h-3.5 w-3.5";default:return"h-5 w-5"}});function A(){u.value?o("setReplyingTo",null):o("setReplyingTo",t.comment)}function L(){o("setEditingComment",{...t.comment})}function z(){o("setEditingComment",null)}function H(){t.editingComment&&g(X,{uid:t.comment.uid,payload:{comment:t.editingComment.comment,errandUid:t.editingComment.errandUid}},"updateGrindErrandDiscussion").then(()=>{o("commentUpdated")})}function S(){o("commentAdded")}function I(){o("commentUpdated")}function O(h){o("setReplyingTo",h)}function V(h){o("setEditingComment",h)}return(h,p)=>(i(),l(R,null,[n("div",le,[n("div",{class:m(`${D.value} shrink-0 rounded-full ${r.value} flex items-center justify-center font-semibold ${k.value}`)},x(P(Q)(e.comment.createdBy?.firstName,e.comment.createdBy?.lastName)),3),n("div",me,[s(" Comment header "),n("div",se,[n("div",null,[n("h3",{class:m(`font-medium ${k.value}`)},x(e.comment.createdBy?.firstName)+" "+x(e.comment.createdBy?.lastName),3),n("div",{class:m(`${e.level>0?"text-xs":"text-sm"} text-gray-500`)},x(e.comment.createdAt),3)]),s(" Comment action buttons "),y.value?s("v-if",!0):(i(),l("div",de,[e.comment.canEdit?(i(),l("button",{key:0,onClick:L,class:"text-gray-500 hover:text-blue-500"},[(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",class:m(T.value),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...re],2))])):s("v-if",!0),C.value?(i(),l("button",{key:1,onClick:A,class:"text-gray-500 hover:text-blue-500"},[(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",class:m(T.value),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...ue],2))])):s("v-if",!0)]))]),s(" Comment content - edit mode "),y.value?(i(),l("div",{key:0,class:m(`mt-${e.level===0||e.level===1?2:1}`)},[B(n("textarea",{"onUpdate:modelValue":p[0]||(p[0]=F=>e.editingComment.comment=F),rows:e.level===0?3:2,class:m(`w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500 ${e.level===2?"text-xs":""}`)},null,10,ge),[[j,e.editingComment.comment]]),n("div",ve,[n("button",{onClick:z,class:m(`px-${e.level<2?3:2} py-${e.level<2?"1.5":1} border border-gray-300 rounded hover:bg-gray-50 ${e.level>0?"text-sm":""}`)}," Cancel ",2),n("button",{onClick:H,class:m(`px-${e.level<2?3:2} py-${e.level<2?"1.5":1} bg-blue-500 text-white rounded hover:bg-blue-600 ${e.level>0?"text-sm":""}`)}," Save ",2)])],2)):(i(),l(R,{key:1},[s(" Comment content - normal mode "),n("div",{class:m(`mt-${e.level===0?2:1} text-gray-600 ${k.value}`),innerHTML:e.comment.comment},null,10,ye)],2112)),s(" Reply input area "),u.value?(i(),l("div",{key:2,class:m(`mt-${e.level===0?3:2}`)},[w(N,{"parent-discussion":e.comment,"is-reply":!0,errandUid:e.comment.errandUid,onCommentAdded:S,onCancelReply:A},null,8,["parent-discussion","errandUid"])],2)):s("v-if",!0)])]),s(" Render replies to this comment "),a.value.length>0?(i(),l("div",{key:0,class:m(`ml-${e.level===0?14:12} mt-4`)},[w(G,{comments:a.value,"replying-to":e.replyingTo,"editing-comment":e.editingComment,level:e.level+1,onSetReplyingTo:O,onSetEditingComment:V,onCommentAdded:S,onCommentUpdated:I},null,8,["comments","replying-to","editing-comment","level"])],2)):s("v-if",!0)],64))}}),he=$(fe,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/grind/CommentItem.vue"]]),Ce=U({__name:"CommentList",props:{comments:{type:Array,required:!0},replyingTo:{type:Object,default:null},editingComment:{type:Object,default:null},level:{type:Number,default:0}},emits:["setReplyingTo","setEditingComment","commentAdded","commentUpdated"],setup(e,{emit:v}){const t=v;function o(c){t("setReplyingTo",c)}function g(c){t("setEditingComment",c)}function d(){t("commentAdded")}function a(){t("commentUpdated")}return(c,y)=>(i(),l("div",{class:m(`space-y-${e.level===0?"6":"4"}`)},[(i(!0),l(R,null,W(e.comments,u=>(i(),l("div",{key:u.uid,class:m(e.level===0?"border-b border-gray-200 pb-4":"")},[w(he,{comment:u,"replying-to":e.replyingTo,"editing-comment":e.editingComment,level:e.level,onSetReplyingTo:o,onSetEditingComment:g,onCommentAdded:d,onCommentUpdated:a},null,8,["comment","replying-to","editing-comment","level"])],2))),128))],2))}}),G=$(Ce,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/grind/CommentList.vue"]]),pe=U({__name:"CommentSystem",props:["errandUid"],setup(e){const v=e,{withClientQuery:t}=E(),o=b([]),g=b(null),d=b(null);M(()=>{a()});function a(){t(Y,{errandUid:v.errandUid},"grindErrandDiscussions").then(r=>{r&&(o.value=r)})}function c(){return o.value.filter(r=>!r.parentUid)}function y(){a(),g.value=null}function u(){a(),d.value=null}function C(r){g.value=r}function D(r){d.value=r}return(r,k)=>(i(),l(R,null,[s(" Main comment input "),w(N,{"errand-uid":e.errandUid,onCommentAdded:y},null,8,["errand-uid"]),s(" Comments and replies "),w(G,{comments:c(),"replying-to":g.value,"editing-comment":d.value,"errand-uid":e.errandUid,onSetReplyingTo:C,onSetEditingComment:D,onCommentAdded:y,onCommentUpdated:u},null,8,["comments","replying-to","editing-comment","errand-uid"])],64))}}),we=$(pe,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/grind/CommentSystem.vue"]]);export{we as default};
