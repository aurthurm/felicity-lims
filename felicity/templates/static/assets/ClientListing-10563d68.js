import{d as Y,I as Z,r as u,at as ee,au as te,s as P,n as E,p as se,m as oe,o as i,c,g as T,f as n,e as m,L as ne,b as s,z as g,y as le,t as b,v as A,i as y,F as h,C as k,ad as x,w as ae,B as ie,j as N,_ as I,k as re}from"./index-d5ae4e74.js";import{A as ue,E as ce}from"./clients.mutations-62682e3d.js";import{u as de}from"./client-4fea2c4d.js";import{u as me}from"./location-b7def12b.js";import{h as fe,o as pe,a as ve}from"./constants-d3cbea61.js";const be=s("hr",null,null,-1),he={action:"post",class:"p-1"},_e={class:"grid grid-cols-2 gap-x-4 mb-4"},Ce={class:"block col-span-1 mb-2"},ge=s("span",{class:"text-gray-700"},"Name",-1),ye={class:"block col-span-1 mb-2"},ke=s("span",{class:"text-gray-700"},"Code",-1),xe={class:"grid grid-cols-3 gap-x-4 mb-4"},we={class:"block col-span-1 mb-2"},Ue=s("span",{class:"text-gray-700"},"Country",-1),De=s("option",null,null,-1),Be=["value"],Pe={class:"block col-span-1 mb-2"},Ee=s("span",{class:"text-gray-700"},"Province",-1),Te=s("option",null,null,-1),Ae=["value"],Ne={class:"block col-span-1 mb-2"},Ie=s("span",{class:"text-gray-700"},"District",-1),Le=s("option",null,null,-1),Me=["value"],Se=s("hr",null,null,-1),Ve=Y({__name:"ClientListing",setup(Re){const L=N(()=>I(()=>import("./FelDataTable-ca271ba4.js"),["assets/FelDataTable-ca271ba4.js","assets/index-d5ae4e74.js","assets/index-246842b1.css"])),M=N(()=>I(()=>import("./index-d5ae4e74.js").then(o=>o.br),["assets/index-d5ae4e74.js","assets/index-246842b1.css"])),r=de(),v=me(),{withClientMutation:w}=Z(),S=u([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Client Name",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(o,t){return ee(te,{to:{name:"client-detail",query:{clientUid:o?.uid}},class:"px-1 ml-2 border-white border text-gray-500rounded-smtransition duration-300 hover:border-sky-800 hover:text-sky-800 focus:outline-none",innerHTML:o?.name})}},{name:"Client ID",value:"code",sortable:!1,sortBy:"asc",hidden:!1},{name:"District",value:"district.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Province",value:"district.province.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Mobile Number",value:"mobilePhone",sortable:!1,sortBy:"asc",hidden:!1},{name:"Email Asdress",value:"email",sortable:!1,sortBy:"asc",hidden:!1}]),{countries:V,provinces:R,districts:O}=P(v),{clients:U,clientPageInfo:D,fetchingClients:F}=P(r);let d=u(!1),_=u(!1),j=u(""),l=E({});const B=u(""),H=()=>Object.assign(l,{});let a=E({first:50,after:"",text:"",sortBy:["uid"],filterAction:!1}),f=u(),p=u();r.fetchClients(a),v.fetchCountries();function q(){w(ue,{payload:{name:l.name,code:l.code,districtUid:l.districtUid}},"createClient").then(o=>r.addClient(o))}function z(){w(ce,{uid:l.uid,payload:{name:l.name,code:l.code,districtUid:l.districtUid}},"updateClient").then(o=>r.updateClient(o))}function K(o){v.filterProvincesByCountry(f.value)}function $(o){v.filterDistrictsByProvince(p.value)}function G(o){a.first=100,a.after="",a.text=o.filterText,a.filterAction=!0,r.fetchClients(a)}function J(o){a.first=o.fetchCount,a.after=D?.value?.endCursor,a.text=o.filterText,a.filterAction=!1,r.fetchClients(a)}function Q(o,t,C={}){_.value=o,j.value=t,B.value=(o?"CREATE":"EDIT")+" "+t.toUpperCase(),t=="client"&&(d.value=!0),o?t=="client"&&Object.assign(l,{}):t=="client"&&Object.assign(l,{...C})}function W(){_.value&&q(),_.value||z(),d.value=!1}const X=se(()=>U?.value?.length+" of "+r.getClientCount+" clients");return(o,t)=>{const C=oe("modal");return i(),c(h,null,[T(n(M),{title:"Clients"}),m(s("button",{class:"p-2 my-2 text-sm border-sky-800 border text-dark-700 transition-colors duration-150 rounded-sm focus:outline-none hover:bg-sky-800 hover:text-gray-100",onClick:t[0]||(t[0]=e=>Q(!0,"client"))}," Add client ",512),[[ne,fe(ve.CREATE,pe.CLIENT)]]),be,T(n(L),{columns:S.value,data:n(U),toggleColumns:!0,loading:n(F),paginable:!0,pageMeta:{fetchCount:n(a).first,hasNextPage:n(D)?.hasNextPage,countNone:X.value},searchable:!0,filterable:!1,onOnSearchKeyUp:G,onOnSearchFocus:H,onOnPaginate:J,selectable:!1},{footer:g(()=>[]),_:1},8,["columns","data","loading","pageMeta"]),n(d)?(i(),le(C,{key:0,onClose:t[9]||(t[9]=e=>y(d)?d.value=!1:d=!1)},{header:g(()=>[s("h3",null,b(B.value),1)]),body:g(()=>[s("form",he,[s("div",_e,[s("label",Ce,[ge,m(s("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":t[1]||(t[1]=e=>n(l).name=e),placeholder:"Name ..."},null,512),[[A,n(l).name]])]),s("label",ye,[ke,m(s("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":t[2]||(t[2]=e=>n(l).code=e),placeholder:"Code ..."},null,512),[[A,n(l).code]])])]),s("div",xe,[s("label",we,[Ue,m(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":t[3]||(t[3]=e=>y(f)?f.value=e:f=e),onChange:t[4]||(t[4]=e=>K(e))},[De,(i(!0),c(h,null,k(n(V),e=>(i(),c("option",{key:e.uid,value:e.uid},b(e.name),9,Be))),128))],544),[[x,n(f)]])]),s("label",Pe,[Ee,m(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":t[5]||(t[5]=e=>y(p)?p.value=e:p=e),onChange:t[6]||(t[6]=e=>$(e))},[Te,(i(!0),c(h,null,k(n(R),e=>(i(),c("option",{key:e.uid,value:e.uid},b(e.name),9,Ae))),128))],544),[[x,n(p)]])]),s("label",Ne,[Ie,m(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":t[7]||(t[7]=e=>n(l).districtUid=e)},[Le,(i(!0),c(h,null,k(n(O),e=>(i(),c("option",{key:e.uid,value:e.uid},b(e.name),9,Me))),128))],512),[[x,n(l).districtUid]])])]),Se,s("button",{type:"button",onClick:t[8]||(t[8]=ae(e=>W(),["prevent"])),class:"-mb-4 w-full border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):ie("",!0)],64)}}}),ze=re(Ve,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/client/ClientListing.vue"]]);export{ze as default};
