import{a0 as z,S as G,u as X,f as Z,a7 as T,h as _,g as $,aP as q,aT as ee,aU as te,_ as se,r as N,aa as Y,c as l,o as n,A as t,F as a,J as u,K as b,L as d,a9 as w,D as U,H as B,a as W,N as P,P as Q,a3 as R}from"./index-Daoe3XS9.js";import{u as oe}from"./analysis-D7-3mDtD.js";import{s as re}from"./index-YWAiCrzl.js";const le=z({__name:"WorkSheetAssign",setup(H,{expose:e}){e();const c=G(),o=oe(),S=X(),{withClientMutation:y}=Z(),p=T(null);c.fetchWorkSheetTemplates();const m=_(()=>c.getWorkSheet),g=_(()=>c.getWorkSheetTemplates),A=async()=>{try{q.fire({title:"Are you sure?",text:"You want to apply this template to add samples?",icon:"warning",showCancelButton:!0,confirmButtonColor:"hsl(var(--primary))",cancelButtonColor:"hsl(var(--destructive))",confirmButtonText:"Yes, apply now!",cancelButtonText:"No, cancel apply!"}).then(r=>{r.isConfirmed&&y(ee,{worksheetUid:m?.value?.uid,templateUid:p.value},"updateWorksheetApplyTemplate").then(i=>{})})}catch{}};o.fetchAnalysesServices({first:void 0,after:"",text:"",sortBy:["name"]}),S.fetchSampleTypes(),o.fetchQCTemplates();const s=_(()=>o.getQCTemplates),f=T(null),F=$({sampleTypeUid:void 0,analysisUid:void 0}),x=T(!1),k=_(()=>{const r=v;return c.getAnalysisResults?.forEach(h=>{r?.some(J=>J.uid===h.uid)||r.push(h)}),r}),I=()=>{C(),c.fetchForWorkSheetsAssign({first:50,after:"",text:"",sortBy:void 0,...F})},K=()=>{const r=D();try{q.fire({title:"Are you sure?",text:"You want to assign selected to worksheet?",icon:"warning",showCancelButton:!0,confirmButtonColor:"hsl(var(--primary))",cancelButtonColor:"hsl(var(--destructive))",confirmButtonText:"Yes, assign now!",cancelButtonText:"No, cancel apply!"}).then(i=>{i.isConfirmed&&y(te,{uid:m?.value?.uid,qcTemplateUid:f.value,analysesUids:r},"updateWorksheetManualAssign").then(h=>{})})}catch{}};let v=[];function C(){let r=[];return k?.value?.forEach(i=>{i.checked&&r.push(i)}),v=r,r}function D(){const r=C();let i=[];return r?.forEach(h=>i.push(h.uid)),i}function L(r){M()?x.value=!0:x.value=!1}function E(r){r.checked=!0}function V(r){r.checked=!1}async function O(){await k?.value?.forEach(r=>x.value?E(r):V(r))}function M(){return k?.value?.every(r=>r.checked===!0)}const j={worksheetStore:c,analysisStore:o,sampleStore:S,withClientMutation:y,templateUid:p,worksheet:m,workSheetTemplates:g,applyTemplate:A,qcTemplates:s,qcTemplateUid:f,filterForm:F,allChecked:x,analysisResults:k,filterAnalysis:I,assignToWorkSheet:K,get checkedAnalyses(){return v},set checkedAnalyses(r){v=r},getResultsChecked:C,getResultsUids:D,checkCheck:L,check:E,unCheck:V,toggleCheckAll:O,areAllChecked:M,get shield(){return re}};return Object.defineProperty(j,"__isScriptSetup",{enumerable:!1,value:!0}),j}}),ne={class:"space-y-6"},ae={class:"border-t border-border pt-6"},ie={action:"post",class:"space-y-4"},de={class:"flex items-center space-x-4"},ce={class:"flex-1 max-w-xs"},ue=["value"],pe={class:"overflow-x-auto mt-4"},me={action:"post",class:"p-1"},fe={class:"flex justify-start mb-4"},he={class:"flex justify-between items-center"},be=["value"],ye={class:"flex justify-between items-center ml-6"},ge=["value"],xe={class:"ml-6 mt-2"},ke={class:"overflow-x-auto mt-4"},ve={class:"align-middle inline-block min-w-full shadow overflow-hidden bg-background shadow-dashboard px-2 pt-1 rounded-bl-lg rounded-br-lg"},_e={key:0,class:"py-4 text-center"},we={key:1,class:"min-w-full fel-table"},Se={class:"px-1 py-1 border-b-2 border-border text-left leading-4 text-foreground tracking-wider"},Ae={class:"bg-background"},Ce=["onUpdate:modelValue","onChange"],Te={class:"px-1 py-1 whitespace-no-wrap border-b border-border"},Ue={class:"text-sm leading-5 text-primary font-semibold"},Be={class:"px-1 py-1 whitespace-no-wrap border-b border-border"},We={class:"text-sm leading-5 text-primary"},Fe={class:"px-1 py-1 whitespace-no-wrap border-b border-border"},De={class:"text-sm leading-5 text-primary"},Ee={class:"px-1 py-1 whitespace-no-wrap border-b border-border"},Ve={class:"text-sm leading-5 text-primary"},Me={class:"px-1 py-1 whitespace-no-wrap border-b border-border"},je={class:"text-sm leading-5 text-primary"},qe={class:"my-4"},Ne={action:"post",class:"mb-4"},Ye={class:"flex justify-start items-center mr-4"},Pe={class:"block mx-4"},Qe=["value"];function Re(H,e,c,o,S,y){const p=N("FButton"),m=N("fel-loader"),g=Y("motion-slide-right"),A=Y("motion-slide-left");return n(),l(u,null,[t("section",ne,[t("div",ae,[a((n(),l("form",ie,[t("div",de,[e[8]||(e[8]=t("span",{class:"text-sm font-medium text-foreground"},"Worksheet Template",-1)),t("label",ce,[a(t("select",{class:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary","onUpdate:modelValue":e[0]||(e[0]=s=>o.templateUid=s)},[e[7]||(e[7]=t("option",{value:""},null,-1)),(n(!0),l(u,null,b(o.workSheetTemplates,s=>(n(),l("option",{key:s.uid,value:s.uid},d(s.name),9,ue))),128))],512),[[w,o.templateUid]])]),a(t("button",{type:"button",onClick:e[1]||(e[1]=U(s=>o.applyTemplate(),["prevent"])),class:"px-4 py-2 bg-primary text-primary-foreground rounded-md text-sm font-medium hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors"}," Apply Template ",512),[[B,o.shield.hasRights(o.shield.actions.CREATE,o.shield.objects.WORKSHEET)]])])])),[[g]])])]),e[22]||(e[22]=t("hr",{class:"mt-4 mb-2"},null,-1)),e[23]||(e[23]=t("h3",{class:"font-bold"},"Manual Analyses Assignment",-1)),e[24]||(e[24]=t("hr",{class:"mb-4 mt-2"},null,-1)),t("div",pe,[a((n(),l("form",me,[t("div",fe,[t("label",he,[e[9]||(e[9]=t("span",{class:"text-foreground mr-2"},"SampleType",-1)),a(t("select",{name:"analyses_uids","onUpdate:modelValue":e[2]||(e[2]=s=>o.filterForm.sampleTypeUid=s),class:"form-input mt-1 block w-full py-1"},[(n(!0),l(u,null,b(o.sampleStore.sampleTypes,s=>(n(),l("option",{key:s.uid,value:s.uid},d(s.name),9,be))),128))],512),[[w,o.filterForm.sampleTypeUid]])]),t("label",ye,[e[10]||(e[10]=t("span",{class:"text-foreground mr-2"},"Analyses",-1)),a(t("select",{name:"analyses_uids","onUpdate:modelValue":e[3]||(e[3]=s=>o.filterForm.analysisUid=s),class:"form-input mt-1 block w-full py-1"},[(n(!0),l(u,null,b(o.analysisStore.analysesServices,s=>(n(),l("option",{key:s.uid,value:s.uid},d(s.name),9,ge))),128))],512),[[w,o.filterForm.analysisUid]])]),t("div",xe,[a(W(p,{onClick:e[4]||(e[4]=U(s=>o.filterAnalysis(),["prevent"])),color:"sky-800",class:"p-1"},{default:P(()=>[...e[11]||(e[11]=[Q("Apply Filters",-1)])]),_:1},512),[[B,!0]])])])])),[[A]])]),t("div",ke,[t("div",ve,[o.worksheetStore.fetchingAnalysisResults?(n(),l("div",_e,[W(m,{message:"Fetching analytes ..."})])):(n(),l("table",we,[t("thead",null,[t("tr",null,[t("th",Se,[a(t("input",{type:"checkbox",onChange:o.toggleCheckAll,"onUpdate:modelValue":e[5]||(e[5]=s=>o.allChecked=s)},null,544),[[R,o.allChecked]])]),e[12]||(e[12]=t("th",{class:"px-1 py-1 border-b-2 border-border text-left leading-4 text-foreground tracking-wider"},null,-1)),e[13]||(e[13]=t("th",{class:"px-1 py-1 border-b-2 border-border text-left leading-4 text-foreground tracking-wider"}," Sample ID ",-1)),e[14]||(e[14]=t("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Analysis ",-1)),e[15]||(e[15]=t("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Date Created ",-1)),e[16]||(e[16]=t("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Date Received ",-1)),e[17]||(e[17]=t("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Status ",-1))])]),a((n(),l("tbody",Ae,[(n(!0),l(u,null,b(o.analysisResults,s=>(n(),l("tr",{key:s?.uid},[t("td",null,[a(t("input",{type:"checkbox","onUpdate:modelValue":f=>s.checked=f,onChange:f=>o.checkCheck(s)},null,40,Ce),[[R,s.checked]])]),e[18]||(e[18]=t("td",{class:"px-1 py-1 whitespace-no-wrap border-b border-border"},null,-1)),t("td",Te,[t("div",Ue,d(s?.sample?.sampleId),1)]),t("td",Be,[t("div",We,d(s?.analysis?.name),1)]),t("td",Fe,[t("div",De,d(s?.sample?.createdAt),1)]),t("td",Ee,[t("div",Ve,d(s?.sample?.dateReceived),1)]),t("td",Me,[t("div",je,d(s?.sample?.status),1)])]))),128))])),[[g]])]))])]),t("section",qe,[t("form",Ne,[t("div",Ye,[e[20]||(e[20]=t("span",{class:"text-foreground"},"Apply QC Template",-1)),t("label",Pe,[a(t("select",{class:"form-select block w-full py-1","onUpdate:modelValue":e[6]||(e[6]=s=>o.qcTemplateUid=s)},[e[19]||(e[19]=t("option",null,null,-1)),(n(!0),l(u,null,b(o.qcTemplates,s=>(n(),l("option",{key:s.uid,value:s.uid},d(s.name),9,Qe))),128))],512),[[w,o.qcTemplateUid]])])])]),a(W(p,{onClick:U(o.assignToWorkSheet,["prevent"]),color:"orange-600"},{default:P(()=>[...e[21]||(e[21]=[Q("Assign Analyses",-1)])]),_:1},512),[[B,!0]])])],64)}const Le=se(le,[["render",Re],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/worksheet/_id/WorkSheetAssign.vue"]]);export{Le as default};
