import{a0 as ve,f as pe,a4 as be,ac as we,g as H,h as N,ad as ge,t as xe,a7 as P,av as Ue,e as ye,_ as De,r as Ne,c as u,o as m,A as t,F as r,a2 as p,L as s,a3 as G,H as Pe,a as K,a9 as U,J as w,K as g,D as T}from"./index-v7Q387fb.js";import{Multiselect as Se}from"./vue-multiselect.esm-CWr9tQJL.js";import{c as V,e as he,a as d,f as z,g as Me,d as Ie,u as Be,b as o}from"./index.esm-D-THTBXR.js";import{A as Ve,E as Oe}from"./patient.mutations-DAG-3KNR.js";import{u as Ce}from"./client-DK1A-Mdi.js";import{u as qe}from"./location-DpzuhiAg.js";import{u as _e}from"./patient-BYWUJGUo.js";import{f as Ee}from"./index-Cd7XCJEF.js";/* empty css                                                                 */const ke=ve({__name:"PatientForm",props:{patient:{type:Object,required:!1},navigate:{type:Boolean,required:!1,default:!1}},emits:["close"],setup(O,{expose:e,emit:C}){e();const i=O,y=C;let x=Ce(),c=qe(),a=_e();const{withClientMutation:b}=pe();let f=be(),S=we();const J=H({genders:["Male","Female","Missing","Trans Gender"],createAction:!0,countries:N(()=>c.getCountries),provinces:N(()=>c.getProvinces),districts:N(()=>c.getDistricts),clients:N(()=>x.getClients)});let h=H({first:void 0,after:"",text:"",sortBy:["name"],filterAction:!1});ge(async()=>{await c.fetchCountries(),await x.fetchClients(h),i.patient?.countryUid&&await c.filterProvincesByCountry(i.patient?.countryUid),i.patient?.provinceUid&&await c.filterDistrictsByProvince(i.patient?.provinceUid),await a.fetchIdentifications()});const{patient:n,navigate:q}=xe(i),W=P(new Date),M=P(0),_=P(0),E=P(0),X=()=>{const l=ye().subtract(M.value,"year").subtract(_.value,"month").subtract(E.value,"day");D.value=l.format("YYYY-MM-DD"),I.value=M.value},Q=()=>{var l=new Date().getFullYear();if(D.value){const v=new Date(D.value).getFullYear();I.value=l-v}},k=V({uid:d().nullable(),clientPatientId:d().required("Client Patient ID is Required"),patientId:d().nullable(),firstName:d().required("First Name is Required"),middleName:d().nullable(),lastName:d().required("Last Name is Required"),client:V().required("Client is Required"),gender:d().required("Gender is Required"),age:Ie().nullable(),dateOfBirth:Me().nullable(),ageDobEstimated:z().nullable(),phoneHome:d().nullable(),phoneMobile:d().nullable(),consentSms:z().nullable(),districtUid:d().nullable(),provinceUid:d().nullable(),countryUid:d().nullable(),identifications:he().of(V({identificationUid:d().required("Identification type is required"),value:d().required("Identification value is required")})).nullable()}),{handleSubmit:F,errors:Z}=Be({validationSchema:k,initialValues:{uid:n?.value?.uid,clientPatientId:n?.value?.clientPatientId||S?.query?.cpid,patientId:n?.value?.patientId,firstName:n?.value?.firstName,middleName:n?.value?.middleName,lastName:n?.value?.lastName,client:n?.value?.client,gender:n?.value?.gender,age:n?.value?.age,dateOfBirth:Ue(n?.value?.dateOfBirth)?void 0:new Date(n?.value?.dateOfBirth).toISOString().split("T")[0],ageDobEstimated:n?.value?.ageDobEstimated,phoneHome:n?.value?.phoneHome,phoneMobile:n?.value?.phoneMobile,consentSms:n?.value?.consentSms,districtUid:n?.value?.districtUid,provinceUid:n?.value?.provinceUid,countryUid:n?.value?.countryUid,identifications:n?.value?.identifications??[]}}),{value:$}=o("clientPatientId"),{value:ee}=o("firstName"),{value:te}=o("middleName"),{value:ie}=o("lastName"),{value:ae}=o("client"),{value:le}=o("gender"),{value:I}=o("age"),{value:D}=o("dateOfBirth"),{value:ne}=o("ageDobEstimated"),{value:se}=o("phoneMobile"),{value:re}=o("consentSms"),{value:oe}=o("districtUid"),{value:Y}=o("provinceUid"),{value:A}=o("countryUid"),{value:B}=o("identifications"),de=F(l=>{l.uid||R(l),l.uid&&j(l)});function R(l){b(Ve,{payload:{clientPatientId:l.clientPatientId,firstName:l.firstName,middleName:l.middleName,lastName:l.lastName,age:l.age,gender:l.gender,dateOfBirth:l.dateOfBirth?Ee(l.dateOfBirth,"YYYY-MM-DD HH:mm"):null,ageDobEstimated:l.ageDobEstimated,clientUid:l.client.uid,phoneMobile:l.phoneMobile,consentSms:l.consentSms,countryUid:l.countryUid,provinceUid:l.provinceUid,districtUid:l.districtUid,identifications:l.identifications}},"createPatient").then(v=>{a.addPatient(v),y("close",v),q.value===!0&&f.push({name:"patient-detail",params:{patientUid:v?.uid}})})}function j(l){b(Oe,{uid:l.uid,payload:{clientPatientId:l.clientPatientId,firstName:l.firstName,middleName:l.middleName,lastName:l.lastName,age:l.age,gender:l.gender,dateOfBirth:l.dateOfBirth?new Date(l.dateOfBirth).toISOString():null,ageDobEstimated:l.ageDobEstimated,clientUid:l.client.uid,phoneMobile:l.phoneMobile,consentSms:l.consentSms,countryUid:l.countryUid,provinceUid:l.provinceUid,districtUid:l.districtUid,identifications:l.identifications?.map(v=>({identificationUid:v.identificationUid,value:v.value}))}},"updatePatient").then(v=>{a.updatePatient(v),y("close",v)})}function ue(l){c.filterProvincesByCountry(A.value)}function me(l){c.filterDistrictsByProvince(Y.value)}function ce(){B.value.push({identificationUid:"",value:""})}function fe(l){B.value.splice(l,1)}const L={props:i,emit:y,get clientStore(){return x},set clientStore(l){x=l},get locationsStore(){return c},set locationsStore(l){c=l},get patientStore(){return a},set patientStore(l){a=l},withClientMutation:b,get router(){return f},set router(l){f=l},get route(){return S},set route(l){S=l},state:J,get clientParams(){return h},set clientParams(l){h=l},patient:n,navigate:q,maxDate:W,estimateYears:M,estimateMonths:_,estimateDays:E,estimateDOB:X,calculateAge:Q,patientSchema:k,handleSubmit:F,errors:Z,clientPatientId:$,firstName:ee,middleName:te,lastName:ie,client:ae,gender:le,age:I,dateOfBirth:D,ageDobEstimated:ne,phoneMobile:se,consentSms:re,districtUid:oe,provinceUid:Y,countryUid:A,identifications:B,submitPatientForm:de,addPatient:R,updatePatient:j,getProvinces:ue,getDistricts:me,addIdentifier:ce,removeIdentifier:fe,get VueMultiselect(){return Se}};return Object.defineProperty(L,"__isScriptSetup",{enumerable:!1,value:!0}),L}}),Fe={class:"flex whitespace-nowrap w-full"},Ye={class:"w-full"},Ae={class:"text-destructive w-4/12",role:"alert"},Re={class:"flex whitespace-nowrap w-full"},je={class:"w-full"},Le={class:"text-destructive w-4/12",role:"alert"},He={class:"flex whitespace-nowrap mb-2 w-full"},Ge={class:"w-full"},Ke={class:"text-destructive w-4/12",role:"alert"},Te={class:"flex whitespace-nowrap w-full"},ze={class:"w-full"},Je={class:"text-destructive w-4/12",role:"alert"},We={class:"flex whitespace-nowrap my-2 w-full"},Xe={class:"w-full flex justify-between items-center"},Qe={class:"flex justify-start items-center gap-x-2 ml-4"},Ze={for:"estimateYears"},$e={for:"estimateMonths"},et={for:"estimateDays"},tt={class:"text-destructive w-4/12",role:"alert"},it={class:"flex whitespace-nowrap mb-2 w-full"},at={class:"w-full"},lt={class:"text-destructive w-4/12",role:"alert"},nt={class:"flex whitespace-nowrap mb-2 w-full"},st={class:"w-full"},rt={class:"text-destructive w-4/12",role:"alert"},ot={class:"flex whitespace-nowrap mb-2 w-full"},dt={class:"w-full"},ut=["value"],mt={class:"text-destructive w-4/12",role:"alert"},ct={class:"flex whitespace-nowrap mb-2 w-full"},ft={class:"w-full"},vt={class:"text-destructive w-4/12",role:"alert"},pt={class:"flex whitespace-nowrap mb-2 w-full"},bt={class:"w-full"},wt={class:"text-destructive w-4/12",role:"alert"},gt={class:"flex whitespace-nowrap mb-2 w-full"},xt={class:"w-full"},Ut={class:"text-destructive w-4/12",role:"alert"},yt={class:"flex whitespace-nowrap mb-2 w-full"},Dt={class:"text-foreground w-4/12 flex justify-between items-center"},Nt={class:"w-full border-border"},Pt=["onUpdate:modelValue","aria-label"],St=["value"],ht=["onUpdate:modelValue","aria-label"],Mt=["onClick","aria-label"],It={class:"grid grid-cols-3 gap-x-4 mb-4"},Bt={class:"col-span-1"},Vt={class:"flex gap-x-2 items-center whitespace-nowrap w-full"},Ot=["value"],Ct={class:"text-destructive w-4/12",role:"alert"},qt={class:"col-span-1"},_t={class:"flex gap-x-2 items-center whitespace-nowrap col-span-1 w-full"},Et=["value"],kt={class:"text-destructive w-4/12",role:"alert"},Ft={class:"col-span-1"},Yt={class:"flex gap-x-2 items-center whitespace-nowrap col-span-1 w-full"},At=["value"],Rt={class:"text-destructive w-4/12",role:"alert"};function jt(O,e,C,i,y,x){const c=Ne("VueDatePicker");return m(),u("form",{onSubmit:e[27]||(e[27]=T((...a)=>i.submitPatientForm&&i.submitPatientForm(...a),["prevent"])),autocomplete:"off",role:"form","aria-label":"Patient Information Form"},[t("label",Fe,[e[28]||(e[28]=t("span",{class:"text-foreground w-4/12"},"Patient Unique Identifier",-1)),t("div",Ye,[r(t("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":e[0]||(e[0]=a=>i.clientPatientId=a),placeholder:"Patient Unique Identifier","aria-label":"Patient Unique Identifier","aria-required":"true"},null,512),[[p,i.clientPatientId]]),t("div",Ae,s(i.errors.clientPatientId),1)])]),t("label",Re,[e[29]||(e[29]=t("span",{class:"text-foreground w-4/12"},"First Name",-1)),t("div",je,[r(t("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":e[1]||(e[1]=a=>i.firstName=a),placeholder:"First Name","aria-label":"First Name","aria-required":"true"},null,512),[[p,i.firstName]]),t("div",Le,s(i.errors.firstName),1)])]),t("label",He,[e[30]||(e[30]=t("span",{class:"text-foreground w-4/12"},"Middle Name",-1)),t("div",Ge,[r(t("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":e[2]||(e[2]=a=>i.middleName=a),placeholder:"Middle Name","aria-label":"Middle Name"},null,512),[[p,i.middleName]]),t("div",Ke,s(i.errors.middleName),1)])]),t("label",Te,[e[31]||(e[31]=t("span",{class:"text-foreground w-4/12"},"Last Name",-1)),t("div",ze,[r(t("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":e[3]||(e[3]=a=>i.lastName=a),placeholder:"Last Name","aria-label":"Last Name","aria-required":"true"},null,512),[[p,i.lastName]]),t("div",Je,s(i.errors.lastName),1)])]),t("label",We,[e[35]||(e[35]=t("span",{class:"text-foreground w-4/12"},"Age/DOB Estimated?",-1)),t("div",Xe,[r(t("input",{type:"checkbox",class:"form-checkbox text-primary","onUpdate:modelValue":e[4]||(e[4]=a=>i.ageDobEstimated=a),"aria-label":"Age/DOB Estimated"},null,512),[[G,i.ageDobEstimated]]),r(t("div",Qe,[t("label",Ze,[e[32]||(e[32]=t("span",{class:"mr-1"},"Years",-1)),r(t("input",{name:"estimateYears",type:"number",min:"0",class:"form-input w-24 py-0 text-primary","onUpdate:modelValue":e[5]||(e[5]=a=>i.estimateYears=a),onChange:e[6]||(e[6]=a=>i.estimateDOB()),onKeyup:e[7]||(e[7]=a=>i.estimateDOB()),"aria-label":"Estimated Years"},null,544),[[p,i.estimateYears]])]),t("label",$e,[e[33]||(e[33]=t("span",{class:"mr-1"},"Months",-1)),r(t("input",{name:"estimateMonths",type:"number",min:"0",max:"12",class:"form-input w-24 py-0 text-primary","onUpdate:modelValue":e[8]||(e[8]=a=>i.estimateMonths=a),onChange:e[9]||(e[9]=a=>i.estimateDOB()),onKeyup:e[10]||(e[10]=a=>i.estimateDOB()),"aria-label":"Estimated Months"},null,544),[[p,i.estimateMonths]])]),t("label",et,[e[34]||(e[34]=t("span",{class:"mr-1"},"Days",-1)),r(t("input",{name:"estimateDays",type:"number",min:"0",max:"365",class:"form-input w-24 py-0 text-primary","onUpdate:modelValue":e[11]||(e[11]=a=>i.estimateDays=a),onChange:e[12]||(e[12]=a=>i.estimateDOB()),onKeyup:e[13]||(e[13]=a=>i.estimateDOB()),"aria-label":"Estimated Days"},null,544),[[p,i.estimateDays]])])],512),[[Pe,i.ageDobEstimated]]),t("div",tt,s(i.errors.ageDobEstimated),1)])]),t("label",it,[e[36]||(e[36]=t("span",{class:"text-foreground w-4/12"},"Date of Birth",-1)),t("div",at,[K(c,{class:"z-60 disabled:bg-muted",modelValue:i.dateOfBirth,"onUpdate:modelValue":e[14]||(e[14]=a=>i.dateOfBirth=a),disabled:i.ageDobEstimated,onClosed:e[15]||(e[15]=a=>i.calculateAge()),"max-date":i.maxDate,"aria-label":"Date of Birth"},null,8,["modelValue","disabled","max-date"]),t("div",lt,s(i.errors.dateOfBirth),1)])]),t("label",nt,[e[37]||(e[37]=t("span",{class:"text-foreground w-4/12"},"Age",-1)),t("div",st,[r(t("input",{class:"form-input mt-1 w-full disabled:bg-muted",type:"number","onUpdate:modelValue":e[16]||(e[16]=a=>i.age=a),placeholder:"Age",disabled:"","aria-label":"Age"},null,512),[[p,i.age]]),t("div",rt,s(i.errors.age),1)])]),t("label",ot,[e[39]||(e[39]=t("span",{class:"text-foreground w-4/12"},"Gender",-1)),t("div",dt,[r(t("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":e[17]||(e[17]=a=>i.gender=a),"aria-label":"Gender","aria-required":"true"},[e[38]||(e[38]=t("option",{value:""},null,-1)),(m(!0),u(w,null,g(i.state.genders,a=>(m(),u("option",{key:a,value:a},s(a),9,ut))),128))],512),[[U,i.gender]]),t("div",mt,s(i.errors.gender),1)])]),t("label",ct,[e[40]||(e[40]=t("span",{class:"text-foreground w-4/12"},"Mobile Number",-1)),t("div",ft,[r(t("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":e[18]||(e[18]=a=>i.phoneMobile=a),placeholder:"Mobile Number","aria-label":"Mobile Number"},null,512),[[p,i.phoneMobile]]),t("div",vt,s(i.errors.phoneMobile),1)])]),t("label",pt,[e[41]||(e[41]=t("span",{class:"text-foreground w-4/12"},"Consent to SMS",-1)),t("div",bt,[r(t("input",{type:"checkbox",class:"form-checkbox text-primary","onUpdate:modelValue":e[19]||(e[19]=a=>i.consentSms=a),"aria-label":"Consent to SMS"},null,512),[[G,i.consentSms]]),t("div",wt,s(i.errors.consentSms),1)])]),t("label",gt,[e[42]||(e[42]=t("span",{class:"text-foreground w-4/12"},"Primary Referrer",-1)),t("div",xt,[K(i.VueMultiselect,{placeholder:"Select a Primary Referrer",modelValue:i.client,"onUpdate:modelValue":e[20]||(e[20]=a=>i.client=a),options:i.state.clients,searchable:!0,label:"name","track-by":"uid","aria-label":"Primary Referrer","aria-required":"true"},null,8,["modelValue","options"]),t("div",Ut,s(i.errors.client),1)])]),t("label",yt,[t("span",Dt,[e[43]||(e[43]=t("span",{class:"mr-4"},"Extra Ids:",-1)),t("div",null,[t("button",{type:"button",class:"relative px-1 mr-2 mt-4 border-primary border text-primary rounded-sm transition duration-300 hover:bg-primary hover:text-primary-foreground focus:outline-none focus:ring-2 focus:ring-primary",onClick:e[21]||(e[21]=a=>i.addIdentifier()),"aria-label":"Add Extra Identifier"}," Add ")])]),t("div",Nt,[(m(!0),u(w,null,g(i.identifications,(a,b)=>(m(),u("div",{class:"flex justify-around items-center w-full",key:b},[e[45]||(e[45]=t("span",null,"Identification",-1)),r(t("select",{class:"form-select mt-1","onUpdate:modelValue":f=>a.identificationUid=f,"aria-label":"Identification Type "+(b+1)},[e[44]||(e[44]=t("option",{value:""},null,-1)),(m(!0),u(w,null,g(i.patientStore.identifications,f=>(m(),u("option",{key:f.uid,value:f.uid},s(f.name),9,St))),128))],8,Pt),[[U,a.identificationUid]]),e[46]||(e[46]=t("span",null,"Value",-1)),r(t("input",{type:"text",class:"form-input text-primary","onUpdate:modelValue":f=>a.value=f,"aria-label":"Identification Value "+(b+1)},null,8,ht),[[p,a.value]]),t("button",{type:"button",class:"p-2 text-destructive",onClick:T(f=>i.removeIdentifier(b),["prevent"]),"aria-label":"Remove Identification "+(b+1)},"X",8,Mt)]))),128))])]),e[53]||(e[53]=t("hr",{class:"my-2"},null,-1)),t("div",It,[t("div",Bt,[t("label",Vt,[e[48]||(e[48]=t("span",{class:"text-foreground w-4/12"},"Country",-1)),r(t("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":e[22]||(e[22]=a=>i.countryUid=a),onChange:e[23]||(e[23]=a=>i.getProvinces(a)),"aria-label":"Country"},[e[47]||(e[47]=t("option",{value:null},null,-1)),(m(!0),u(w,null,g(i.state.countries,a=>(m(),u("option",{key:a.uid,value:a.uid},s(a.name),9,Ot))),128))],544),[[U,i.countryUid]])]),t("div",Ct,s(i.errors.countryUid),1)]),t("div",qt,[t("label",_t,[e[50]||(e[50]=t("span",{class:"text-foreground w-4/12"},"Province",-1)),r(t("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":e[24]||(e[24]=a=>i.provinceUid=a),onChange:e[25]||(e[25]=a=>i.getDistricts(a)),"aria-label":"Province"},[e[49]||(e[49]=t("option",{value:null},null,-1)),(m(!0),u(w,null,g(i.state.provinces,a=>(m(),u("option",{key:a.uid,value:a.uid},s(a.name),9,Et))),128))],544),[[U,i.provinceUid]])]),t("div",kt,s(i.errors.provinceUid),1)]),t("div",Ft,[t("label",Yt,[e[52]||(e[52]=t("span",{class:"text-foreground w-4/12"},"District",-1)),r(t("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":e[26]||(e[26]=a=>i.districtUid=a),"aria-label":"District"},[e[51]||(e[51]=t("option",{value:null},null,-1)),(m(!0),u(w,null,g(i.state.districts,a=>(m(),u("option",{key:a.uid,value:a.uid},s(a.name),9,At))),128))],512),[[U,i.districtUid]])]),t("div",Rt,s(i.errors.districtUid),1)])]),e[54]||(e[54]=t("hr",null,null,-1)),e[55]||(e[55]=t("button",{type:"submit",class:"-mb-4 w-1/5 border border-primary bg-primary text-primary-foreground rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-primary focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Save Patient Information"}," Save Patient ",-1))],32)}const Qt=De(ke,[["render",jt],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/components/person/PatientForm.vue"]]);export{Qt as default};
