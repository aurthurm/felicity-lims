import{S as pe,O as me,a6 as ce,V as fe,a0 as n,i as ge,h as ve,o as g,c as v,N as o,C as r,D as x,a5 as a,a as l,L as c,M as f,ac as W,Y as $,F as xe,E as ye,a3 as O,H as y,X as he,Z as B,$ as M,al as ke,_ as be}from"./index-8d0a01b3.js";import{u as we}from"./worksheet-05927284.js";import{u as Re}from"./analysis-85b1def1.js";import{u as Se}from"./user-157f78e9.js";import{u as Ue}from"./setup-8486ed9e.js";import{h,o as k,a as b}from"./constants-cc44aa7b.js";import"./analyses.mutations-56a25983.js";import"./_queries-5236cda4.js";const _e={class:"space-y-6"},Ve={class:"flex items-center justify-between bg-background rounded-lg shadow-sm p-4"},Ce={class:"flex items-center space-x-4"},Ae={class:"flex items-center space-x-4"},Ie={class:"bg-background rounded-lg shadow-sm overflow-hidden"},Ee={class:"p-4 border-b border-border"},De={class:"grid grid-cols-3 gap-4"},Ne={class:"block space-y-2"},Le={class:"block space-y-2"},Te={class:"block space-y-2"},We={class:"mt-4 flex justify-end"},Be={class:"overflow-x-auto"},Me={class:"w-full"},ze={class:"bg-muted"},Ye={class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},Fe={class:"divide-y divide-border"},Pe={class:"px-4 py-3 whitespace-nowrap"},$e=["onUpdate:modelValue","disabled"],Oe={class:"px-4 py-3 whitespace-nowrap"},je={class:"px-4 py-3 whitespace-nowrap"},Ge={class:"px-4 py-3 whitespace-nowrap"},He={class:"px-4 py-3 whitespace-nowrap"},Xe=["onUpdate:modelValue"],Ze={key:1},qe={class:"px-4 py-3 whitespace-nowrap"},Je=pe({__name:"WorkSheetResults",setup(Ke){const d=B(()=>M(()=>import("./index-8d0a01b3.js").then(s=>s.cI),["assets/index-8d0a01b3.js","assets/index-a402b5a2.css"])),_=B(()=>M(()=>import("./FelSelect-f2719645.js"),["assets/FelSelect-f2719645.js","assets/index-8d0a01b3.js","assets/index-a402b5a2.css"])),z=B(()=>M(()=>import("./FelSwitch-dc2e2b79.js"),["assets/FelSwitch-dc2e2b79.js","assets/index-8d0a01b3.js","assets/index-a402b5a2.css"])),V=me(),w=Ue(),Y=Se(),F=ce();fe();let C=n(!1),A=n(!1),I=n(!1),E=n(!1),D=n(!1),p=n(!1),i=n(!1),R=n(!1),m=ge(()=>V.getWorkSheet);const j=()=>{V.fetchWorksheetByUid(F.params.workSheetUid)};Y.fetchUsers({}),w.fetchLaboratoryInstruments(),w.fetchMethods();const u=ve({analystUid:null,instrumentUid:null,methodUid:null}),N=n(!1),G=()=>{N.value=!0,V.updateWorksheet({worksheetUid:F.params.workSheetUid,...u}).then(()=>{N.value=!1,j()})};function H(){return m.value?.analysisResults?.every(s=>s.checked===!0)}function L(){let s=[];return m.value?.analysisResults?.forEach(e=>{e.checked&&s.push(e)}),s}function X(){H()?i.value=!0:i.value=!1,S()}function Z(s){if(q(s)){P(s);return}s.checked=!0,S()}function q(s){return["retracted","approved"].includes(s.status)}function P(s){s.checked=!1,S()}function J(){m?.value?.analysisResults?.forEach(s=>i.value?Z(s):P(s)),S()}function K(s){s.editable=!0}function Q(s){return s.status!=="pending"?!1:s?.editable||ke(s?.result)?(K(s),!0):!1}function ee(){let s=L(),e=[];return s?.forEach(t=>e.push({uid:t.uid,result:t.result,laboratoryInstrumentUid:t.laboratoryInstrumentUid,methodUid:t.methodUid})),e}function T(){const s=L();let e=[];return s?.forEach(t=>e.push(t.uid)),e}function te(s){switch(s?.status){case"retracted":return"bg-muted text-sm italic text-muted-foreground";default:return"text-sm leading-5 text-primary"}}function se(s){switch(s?.status){case"retracted":return!0;case"approved":return s?.reportable===!1;default:return!1}}function S(){C.value=!1,D.value=!1,A.value=!1,I.value=!1,E.value=!1,p.value=!1;const s=L();s.length!==0&&(p.value=!0,s.every(e=>e.status==="pending")&&(C.value=!0,D.value=!0),s.every(e=>e.status==="resulted")&&(A.value=!0,I.value=!0,E.value=!0))}const{submitResults:oe,approveResults:ae,retractResults:le,retestResults:ne}=Re();we();const re=()=>oe(ee(),"worksheet",m.value?.uid),ie=()=>ae(T(),"worksheet",m.value?.uid),ue=()=>le(T()),de=()=>ne(T());return(s,e)=>(g(),v("div",_e,[o("div",Ve,[o("div",Ce,[r(l(a(d),{onClick:e[0]||(e[0]=t=>re()),loading:s.submitting,variant:"primary",size:"sm"},{default:c(()=>e[14]||(e[14]=[f(" Submit Results ")])),_:1},8,["loading"]),[[x,a(C)&&h(b.SUBMIT,k.ANALYSIS)]]),r(l(a(d),{onClick:e[1]||(e[1]=t=>ie()),loading:s.approving,variant:"primary",size:"sm"},{default:c(()=>e[15]||(e[15]=[f(" Approve Results ")])),_:1},8,["loading"]),[[x,a(I)&&h(b.VERIFY,k.ANALYSIS)]]),r(l(a(d),{onClick:e[2]||(e[2]=t=>ue()),loading:s.retracting,variant:"destructive",size:"sm"},{default:c(()=>e[16]||(e[16]=[f(" Retract Results ")])),_:1},8,["loading"]),[[x,a(A)&&h(b.RETRACT,k.ANALYSIS)]]),r(l(a(d),{onClick:e[3]||(e[3]=t=>de()),loading:s.retesting,variant:"secondary",size:"sm"},{default:c(()=>e[17]||(e[17]=[f(" Retest ")])),_:1},8,["loading"]),[[x,a(E)&&h(b.RETEST,k.ANALYSIS)]]),r(l(a(d),{onClick:e[4]||(e[4]=t=>s.unassignResults()),loading:s.unassigning,variant:"secondary",size:"sm"},{default:c(()=>e[18]||(e[18]=[f(" Unassign ")])),_:1},8,["loading"]),[[x,a(D)&&h(b.UNASSIGN,k.ANALYSIS)]])]),o("div",Ae,[l(a(z),{modelValue:a(R),"onUpdate:modelValue":e[5]||(e[5]=t=>W(R)?R.value=t:R=t),label:"View Detail"},null,8,["modelValue"]),l(a(z),{modelValue:a(p),"onUpdate:modelValue":e[6]||(e[6]=t=>W(p)?p.value=t:p=t),label:"Print Barcodes"},null,8,["modelValue"])])]),o("div",Ie,[o("div",Ee,[o("div",De,[o("label",Ne,[e[19]||(e[19]=o("span",{class:"text-sm font-medium text-foreground"},"Analyst",-1)),l(a(_),{modelValue:u.analystUid,"onUpdate:modelValue":e[7]||(e[7]=t=>u.analystUid=t),options:a(Y).getUsers,"option-label":"firstName","option-value":"uid",placeholder:"Select Analyst",class:"w-full"},null,8,["modelValue","options"])]),o("label",Le,[e[20]||(e[20]=o("span",{class:"text-sm font-medium text-foreground"},"Instrument",-1)),l(a(_),{modelValue:u.instrumentUid,"onUpdate:modelValue":e[8]||(e[8]=t=>u.instrumentUid=t),options:a(w).getLaboratoryInstruments,"option-label":"name","option-value":"uid",placeholder:"Select Instrument",class:"w-full"},null,8,["modelValue","options"])]),o("label",Te,[e[21]||(e[21]=o("span",{class:"text-sm font-medium text-foreground"},"Method",-1)),l(a(_),{modelValue:u.methodUid,"onUpdate:modelValue":e[9]||(e[9]=t=>u.methodUid=t),options:a(w).getMethods,"option-label":"name","option-value":"uid",placeholder:"Select Method",class:"w-full"},null,8,["modelValue","options"])])]),o("div",We,[l(a(d),{onClick:e[10]||(e[10]=t=>G()),loading:N.value,variant:"primary",size:"sm"},{default:c(()=>e[22]||(e[22]=[f(" Apply Changes ")])),_:1},8,["loading"])])]),o("div",Be,[o("table",Me,[o("thead",ze,[o("tr",null,[o("th",Ye,[r(o("input",{type:"checkbox","onUpdate:modelValue":e[11]||(e[11]=t=>W(i)?i.value=t:i=t),onClick:e[12]||(e[12]=t=>J()),class:"rounded border-input text-primary focus:ring-primary"},null,512),[[$,a(i)]])]),e[23]||(e[23]=o("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Sample ID",-1)),e[24]||(e[24]=o("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Client Sample ID",-1)),e[25]||(e[25]=o("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Analysis",-1)),e[26]||(e[26]=o("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Result",-1)),e[27]||(e[27]=o("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Status",-1))])]),o("tbody",Fe,[(g(!0),v(xe,null,ye(a(m)?.analysisResults,t=>(g(),v("tr",{key:t.uid,class:O(te(t))},[o("td",Pe,[r(o("input",{type:"checkbox","onUpdate:modelValue":U=>t.checked=U,onClick:e[13]||(e[13]=U=>X()),disabled:se(t),class:"rounded border-input text-primary focus:ring-primary"},null,8,$e),[[$,t.checked]])]),o("td",Oe,y(t.sample?.sampleId),1),o("td",je,y(t.sample?.clientSampleId),1),o("td",Ge,y(t.analysis?.name),1),o("td",He,[Q(t)?r((g(),v("input",{key:0,type:"text","onUpdate:modelValue":U=>t.result=U,class:"w-full px-2 py-1 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary"},null,8,Xe)),[[he,t.result]]):(g(),v("span",Ze,y(t.result),1))]),o("td",qe,[o("span",{class:O(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",{"bg-primary/10 text-primary":t.status==="pending","bg-warning/10 text-warning":t.status==="awaiting","bg-success/10 text-success":t.status==="approved","bg-destructive/10 text-destructive":t.status==="retracted"}])},y(t.status),3)])],2))),128))])])])])]))}}),rt=be(Je,[["__file","/Users/admin/Documents/Development/felicity/felicity-lims/webapp/views/worksheet/_id/WorkSheetResults.vue"]]);export{rt as default};
