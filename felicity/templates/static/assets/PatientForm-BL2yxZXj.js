import{a0 as pe,f as be,a4 as we,ac as ge,g as H,h as P,ad as xe,t as Ue,a7 as S,aw as ye,e as De,_ as Ne,r as Pe,c as d,o as u,A as t,F as o,a2 as v,L as n,a3 as G,H as Se,a as K,a9 as U,J as w,K as g,D as T}from"./index-CNAOKjig.js";import{Multiselect as Me}from"./vue-multiselect.esm-BoOjdWpS.js";import{c as z,a as y,e as J,d as b,f as he,u as Be,b as r}from"./index.esm-BflgK3Uu.js";import{A as Ie,E as Ve}from"./patient.mutations-CV6jDJyb.js";import{u as Oe}from"./client-fmVydEyQ.js";import{u as Ce}from"./location-Cp7ZTBxF.js";import{u as _e}from"./patient-DPjByMBc.js";import{f as Ee}from"./index-zY702zsb.js";/* empty css                                                                 */const qe=pe({__name:"PatientForm",props:{patient:{type:Object,required:!1},navigate:{type:Boolean,required:!1,default:!1}},emits:["close"],setup(O,{expose:e,emit:C}){e();const i=O,D=C;let x=Oe(),m=Ce(),l=_e();const{withClientMutation:p}=be();let c=we(),M=ge();const W=H({genders:["Male","Female","Missing","Trans Gender"],createAction:!0,countries:P(()=>m.getCountries),provinces:P(()=>m.getProvinces),districts:P(()=>m.getDistricts),clients:P(()=>x.getClients)});let h=H({first:void 0,after:"",text:"",sortBy:["name"],filterAction:!1});xe(async()=>{await m.fetchCountries(),await x.fetchClients(h),i.patient?.countryUid&&await m.filterProvincesByCountry(i.patient?.countryUid),i.patient?.provinceUid&&await m.filterDistrictsByProvince(i.patient?.provinceUid),await l.fetchIdentifications()});const{patient:s,navigate:_}=Ue(i),X=S(new Date),B=S(0),E=S(0),q=S(0),Q=()=>{const a=De().subtract(B.value,"year").subtract(E.value,"month").subtract(q.value,"day");N.value=a.format("YYYY-MM-DD"),I.value=B.value},Z=()=>{var a=new Date().getFullYear();if(N.value){const f=new Date(N.value).getFullYear();I.value=a-f}},k=z({uid:y().nullable(),clientPatientId:b().required("Client Patient ID is Required"),patientId:b().nullable(),firstName:b().required("First Name is Required"),middleName:b().nullable(),lastName:b().required("Last Name is Required"),client:z().required("Client is Required"),gender:b().required("Gender is Required"),age:y().nullable(),dateOfBirth:he().nullable(),ageDobEstimated:J().nullable(),phoneHome:b().nullable(),phoneMobile:b().nullable(),consentSms:J().nullable(),districtUid:y().nullable(),provinceUid:y().nullable(),countryUid:y().nullable()}),{handleSubmit:F,errors:$}=Be({validationSchema:k,initialValues:{uid:s?.value?.uid,clientPatientId:s?.value?.clientPatientId||M?.query?.cpid,patientId:s?.value?.patientId,firstName:s?.value?.firstName,middleName:s?.value?.middleName,lastName:s?.value?.lastName,client:s?.value?.client,gender:s?.value?.gender,age:s?.value?.age,dateOfBirth:ye(s?.value?.dateOfBirth)?void 0:new Date(s?.value?.dateOfBirth).toISOString().split("T")[0],ageDobEstimated:s?.value?.ageDobEstimated,phoneHome:s?.value?.phoneHome,phoneMobile:s?.value?.phoneMobile,consentSms:s?.value?.consentSms,districtUid:s?.value?.districtUid,provinceUid:s?.value?.provinceUid,countryUid:s?.value?.countryUid,identifications:s?.value?.identifications??[]}}),{value:ee}=r("clientPatientId"),{value:te}=r("firstName"),{value:ie}=r("middleName"),{value:le}=r("lastName"),{value:ae}=r("client"),{value:se}=r("gender"),{value:I}=r("age"),{value:N}=r("dateOfBirth"),{value:ne}=r("ageDobEstimated"),{value:oe}=r("phoneMobile"),{value:re}=r("consentSms"),{value:de}=r("districtUid"),{value:Y}=r("provinceUid"),{value:A}=r("countryUid"),{value:V}=r("identifications"),ue=F(a=>{a.uid||R(a),a.uid&&j(a)});function R(a){p(Ie,{payload:{clientPatientId:a.clientPatientId,firstName:a.firstName,middleName:a.middleName,lastName:a.lastName,age:a.age,gender:a.gender,dateOfBirth:Ee(a.dateOfBirth,"YYYY-MM-DD HH:mm"),ageDobEstimated:a.ageDobEstimated,clientUid:a.client.uid,phoneMobile:a.phoneMobile,consentSms:a.consentSms,countryUid:a.countryUid,provinceUid:a.provinceUid,districtUid:a.districtUid,identifications:a.identifications}},"createPatient").then(f=>{l.addPatient(f),D("close",f),_.value===!0&&c.push({name:"patient-detail",params:{patientUid:f?.uid}})})}function j(a){p(Ve,{uid:a.uid,payload:{clientPatientId:a.clientPatientId,firstName:a.firstName,middleName:a.middleName,lastName:a.lastName,age:a.age,gender:a.gender,dateOfBirth:a.dateOfBirth?new Date(a.dateOfBirth).toISOString():null,ageDobEstimated:a.ageDobEstimated,clientUid:a.client.uid,phoneMobile:a.phoneMobile,consentSms:a.consentSms,countryUid:a.countryUid,provinceUid:a.provinceUid,districtUid:a.districtUid,identifications:a.identifications?.map(f=>({identificationUid:f.identificationUid,value:f.value}))}},"updatePatient").then(f=>{l.updatePatient(f),D("close",f)})}function me(a){m.filterProvincesByCountry(A.value)}function ce(a){m.filterDistrictsByProvince(Y.value)}function fe(){V.value.push({identificationUid:"12122",value:""})}function ve(a){V.value.splice(a,1)}const L={props:i,emit:D,get clientStore(){return x},set clientStore(a){x=a},get locationsStore(){return m},set locationsStore(a){m=a},get patientStore(){return l},set patientStore(a){l=a},withClientMutation:p,get router(){return c},set router(a){c=a},get route(){return M},set route(a){M=a},state:W,get clientParams(){return h},set clientParams(a){h=a},patient:s,navigate:_,maxDate:X,estimateYears:B,estimateMonths:E,estimateDays:q,estimateDOB:Q,calculateAge:Z,patientSchema:k,handleSubmit:F,errors:$,clientPatientId:ee,firstName:te,middleName:ie,lastName:le,client:ae,gender:se,age:I,dateOfBirth:N,ageDobEstimated:ne,phoneMobile:oe,consentSms:re,districtUid:de,provinceUid:Y,countryUid:A,identifications:V,submitPatientForm:ue,addPatient:R,updatePatient:j,getProvinces:me,getDistricts:ce,addIdentifier:fe,removeIdentifier:ve,get VueMultiselect(){return Me}};return Object.defineProperty(L,"__isScriptSetup",{enumerable:!1,value:!0}),L}}),ke={class:"flex whitespace-nowrap w-full"},Fe={class:"w-full"},Ye={class:"text-destructive w-4/12",role:"alert"},Ae={class:"flex whitespace-nowrap w-full"},Re={class:"w-full"},je={class:"text-destructive w-4/12",role:"alert"},Le={class:"flex whitespace-nowrap mb-2 w-full"},He={class:"w-full"},Ge={class:"text-destructive w-4/12",role:"alert"},Ke={class:"flex whitespace-nowrap w-full"},Te={class:"w-full"},ze={class:"text-destructive w-4/12",role:"alert"},Je={class:"flex whitespace-nowrap my-2 w-full"},We={class:"w-full flex justify-between items-center"},Xe={class:"flex justify-start items-center gap-x-2 ml-4"},Qe={for:"estimateYears"},Ze={for:"estimateMonths"},$e={for:"estimateDays"},et={class:"text-destructive w-4/12",role:"alert"},tt={class:"flex whitespace-nowrap mb-2 w-full"},it={class:"w-full"},lt={class:"text-destructive w-4/12",role:"alert"},at={class:"flex whitespace-nowrap mb-2 w-full"},st={class:"w-full"},nt={class:"text-destructive w-4/12",role:"alert"},ot={class:"flex whitespace-nowrap mb-2 w-full"},rt={class:"w-full"},dt=["value"],ut={class:"text-destructive w-4/12",role:"alert"},mt={class:"flex whitespace-nowrap mb-2 w-full"},ct={class:"w-full"},ft={class:"text-destructive w-4/12",role:"alert"},vt={class:"flex whitespace-nowrap mb-2 w-full"},pt={class:"w-full"},bt={class:"text-destructive w-4/12",role:"alert"},wt={class:"flex whitespace-nowrap mb-2 w-full"},gt={class:"w-full"},xt={class:"text-destructive w-4/12",role:"alert"},Ut={class:"flex whitespace-nowrap mb-2 w-full"},yt={class:"text-foreground w-4/12 flex justify-between items-center"},Dt={class:"w-full border-border"},Nt=["onUpdate:modelValue","aria-label"],Pt=["value"],St=["onUpdate:modelValue","aria-label"],Mt=["onClick","aria-label"],ht={class:"grid grid-cols-3 gap-x-4 mb-4"},Bt={class:"col-span-1"},It={class:"flex gap-x-2 items-center whitespace-nowrap w-full"},Vt=["value"],Ot={class:"text-destructive w-4/12",role:"alert"},Ct={class:"col-span-1"},_t={class:"flex gap-x-2 items-center whitespace-nowrap col-span-1 w-full"},Et=["value"],qt={class:"text-destructive w-4/12",role:"alert"},kt={class:"col-span-1"},Ft={class:"flex gap-x-2 items-center whitespace-nowrap col-span-1 w-full"},Yt=["value"],At={class:"text-destructive w-4/12",role:"alert"};function Rt(O,e,C,i,D,x){const m=Pe("VueDatePicker");return u(),d("form",{onSubmit:e[27]||(e[27]=T((...l)=>i.submitPatientForm&&i.submitPatientForm(...l),["prevent"])),autocomplete:"off",role:"form","aria-label":"Patient Information Form"},[t("label",ke,[e[28]||(e[28]=t("span",{class:"text-foreground w-4/12"},"Patient Unique Identifier",-1)),t("div",Fe,[o(t("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":e[0]||(e[0]=l=>i.clientPatientId=l),placeholder:"Patient Unique Identifier","aria-label":"Patient Unique Identifier","aria-required":"true"},null,512),[[v,i.clientPatientId]]),t("div",Ye,n(i.errors.clientPatientId),1)])]),t("label",Ae,[e[29]||(e[29]=t("span",{class:"text-foreground w-4/12"},"First Name",-1)),t("div",Re,[o(t("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":e[1]||(e[1]=l=>i.firstName=l),placeholder:"First Name","aria-label":"First Name","aria-required":"true"},null,512),[[v,i.firstName]]),t("div",je,n(i.errors.firstName),1)])]),t("label",Le,[e[30]||(e[30]=t("span",{class:"text-foreground w-4/12"},"Middle Name",-1)),t("div",He,[o(t("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":e[2]||(e[2]=l=>i.middleName=l),placeholder:"Middle Name","aria-label":"Middle Name"},null,512),[[v,i.middleName]]),t("div",Ge,n(i.errors.middleName),1)])]),t("label",Ke,[e[31]||(e[31]=t("span",{class:"text-foreground w-4/12"},"Last Name",-1)),t("div",Te,[o(t("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":e[3]||(e[3]=l=>i.lastName=l),placeholder:"Last Name","aria-label":"Last Name","aria-required":"true"},null,512),[[v,i.lastName]]),t("div",ze,n(i.errors.lastName),1)])]),t("label",Je,[e[35]||(e[35]=t("span",{class:"text-foreground w-4/12"},"Age/DOB Estimated?",-1)),t("div",We,[o(t("input",{type:"checkbox",class:"form-checkbox text-primary","onUpdate:modelValue":e[4]||(e[4]=l=>i.ageDobEstimated=l),"aria-label":"Age/DOB Estimated"},null,512),[[G,i.ageDobEstimated]]),o(t("div",Xe,[t("label",Qe,[e[32]||(e[32]=t("span",{class:"mr-1"},"Years",-1)),o(t("input",{name:"estimateYears",type:"number",min:"0",class:"form-input w-24 py-0 text-primary","onUpdate:modelValue":e[5]||(e[5]=l=>i.estimateYears=l),onChange:e[6]||(e[6]=l=>i.estimateDOB()),onKeyup:e[7]||(e[7]=l=>i.estimateDOB()),"aria-label":"Estimated Years"},null,544),[[v,i.estimateYears]])]),t("label",Ze,[e[33]||(e[33]=t("span",{class:"mr-1"},"Months",-1)),o(t("input",{name:"estimateMonths",type:"number",min:"0",max:"12",class:"form-input w-24 py-0 text-primary","onUpdate:modelValue":e[8]||(e[8]=l=>i.estimateMonths=l),onChange:e[9]||(e[9]=l=>i.estimateDOB()),onKeyup:e[10]||(e[10]=l=>i.estimateDOB()),"aria-label":"Estimated Months"},null,544),[[v,i.estimateMonths]])]),t("label",$e,[e[34]||(e[34]=t("span",{class:"mr-1"},"Days",-1)),o(t("input",{name:"estimateDays",type:"number",min:"0",max:"365",class:"form-input w-24 py-0 text-primary","onUpdate:modelValue":e[11]||(e[11]=l=>i.estimateDays=l),onChange:e[12]||(e[12]=l=>i.estimateDOB()),onKeyup:e[13]||(e[13]=l=>i.estimateDOB()),"aria-label":"Estimated Days"},null,544),[[v,i.estimateDays]])])],512),[[Se,i.ageDobEstimated]]),t("div",et,n(i.errors.ageDobEstimated),1)])]),t("label",tt,[e[36]||(e[36]=t("span",{class:"text-foreground w-4/12"},"Date of Birth",-1)),t("div",it,[K(m,{class:"z-60 disabled:bg-muted",modelValue:i.dateOfBirth,"onUpdate:modelValue":e[14]||(e[14]=l=>i.dateOfBirth=l),disabled:i.ageDobEstimated,onClosed:e[15]||(e[15]=l=>i.calculateAge()),"max-date":i.maxDate,"aria-label":"Date of Birth"},null,8,["modelValue","disabled","max-date"]),t("div",lt,n(i.errors.dateOfBirth),1)])]),t("label",at,[e[37]||(e[37]=t("span",{class:"text-foreground w-4/12"},"Age",-1)),t("div",st,[o(t("input",{class:"form-input mt-1 w-full disabled:bg-muted",type:"number","onUpdate:modelValue":e[16]||(e[16]=l=>i.age=l),placeholder:"Age",disabled:"","aria-label":"Age"},null,512),[[v,i.age]]),t("div",nt,n(i.errors.age),1)])]),t("label",ot,[e[39]||(e[39]=t("span",{class:"text-foreground w-4/12"},"Gender",-1)),t("div",rt,[o(t("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":e[17]||(e[17]=l=>i.gender=l),"aria-label":"Gender","aria-required":"true"},[e[38]||(e[38]=t("option",{value:""},null,-1)),(u(!0),d(w,null,g(i.state.genders,l=>(u(),d("option",{key:l,value:l},n(l),9,dt))),128))],512),[[U,i.gender]]),t("div",ut,n(i.errors.gender),1)])]),t("label",mt,[e[40]||(e[40]=t("span",{class:"text-foreground w-4/12"},"Mobile Number",-1)),t("div",ct,[o(t("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":e[18]||(e[18]=l=>i.phoneMobile=l),placeholder:"Mobile Number","aria-label":"Mobile Number"},null,512),[[v,i.phoneMobile]]),t("div",ft,n(i.errors.phoneMobile),1)])]),t("label",vt,[e[41]||(e[41]=t("span",{class:"text-foreground w-4/12"},"Consent to SMS",-1)),t("div",pt,[o(t("input",{type:"checkbox",class:"form-checkbox text-primary","onUpdate:modelValue":e[19]||(e[19]=l=>i.consentSms=l),"aria-label":"Consent to SMS"},null,512),[[G,i.consentSms]]),t("div",bt,n(i.errors.consentSms),1)])]),t("label",wt,[e[42]||(e[42]=t("span",{class:"text-foreground w-4/12"},"Primary Referrer",-1)),t("div",gt,[K(i.VueMultiselect,{placeholder:"Select a Primary Referrer",modelValue:i.client,"onUpdate:modelValue":e[20]||(e[20]=l=>i.client=l),options:i.state.clients,searchable:!0,label:"name","track-by":"uid","aria-label":"Primary Referrer","aria-required":"true"},null,8,["modelValue","options"]),t("div",xt,n(i.errors.client),1)])]),t("label",Ut,[t("span",yt,[e[43]||(e[43]=t("span",{class:"mr-4"},"Extra Ids:",-1)),t("div",null,[t("button",{type:"button",class:"relative px-1 mr-2 mt-4 border-primary border text-primary rounded-sm transition duration-300 hover:bg-primary hover:text-primary-foreground focus:outline-none focus:ring-2 focus:ring-primary",onClick:e[21]||(e[21]=l=>i.addIdentifier()),"aria-label":"Add Extra Identifier"}," Add ")])]),t("div",Dt,[(u(!0),d(w,null,g(i.identifications,(l,p)=>(u(),d("div",{class:"flex justify-around items-center w-full",key:p},[e[45]||(e[45]=t("span",null,"Identification",-1)),o(t("select",{class:"form-select mt-1","onUpdate:modelValue":c=>l.identificationUid=c,"aria-label":"Identification Type "+(p+1)},[e[44]||(e[44]=t("option",{value:""},null,-1)),(u(!0),d(w,null,g(i.patientStore.identifications,c=>(u(),d("option",{key:c.uid,value:c.uid},n(c.name),9,Pt))),128))],8,Nt),[[U,l.identificationUid]]),e[46]||(e[46]=t("span",null,"Value",-1)),o(t("input",{type:"text",class:"form-input text-primary","onUpdate:modelValue":c=>l.value=c,"aria-label":"Identification Value "+(p+1)},null,8,St),[[v,l.value]]),t("button",{type:"button",class:"p-2 text-destructive",onClick:T(c=>i.removeIdentifier(p),["prevent"]),"aria-label":"Remove Identification "+(p+1)},"X",8,Mt)]))),128))])]),e[53]||(e[53]=t("hr",{class:"my-2"},null,-1)),t("div",ht,[t("div",Bt,[t("label",It,[e[48]||(e[48]=t("span",{class:"text-foreground w-4/12"},"Country",-1)),o(t("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":e[22]||(e[22]=l=>i.countryUid=l),onChange:e[23]||(e[23]=l=>i.getProvinces(l)),"aria-label":"Country"},[e[47]||(e[47]=t("option",{value:null},null,-1)),(u(!0),d(w,null,g(i.state.countries,l=>(u(),d("option",{key:l.uid,value:l.uid},n(l.name),9,Vt))),128))],544),[[U,i.countryUid]])]),t("div",Ot,n(i.errors.countryUid),1)]),t("div",Ct,[t("label",_t,[e[50]||(e[50]=t("span",{class:"text-foreground w-4/12"},"Province",-1)),o(t("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":e[24]||(e[24]=l=>i.provinceUid=l),onChange:e[25]||(e[25]=l=>i.getDistricts(l)),"aria-label":"Province"},[e[49]||(e[49]=t("option",{value:null},null,-1)),(u(!0),d(w,null,g(i.state.provinces,l=>(u(),d("option",{key:l.uid,value:l.uid},n(l.name),9,Et))),128))],544),[[U,i.provinceUid]])]),t("div",qt,n(i.errors.provinceUid),1)]),t("div",kt,[t("label",Ft,[e[52]||(e[52]=t("span",{class:"text-foreground w-4/12"},"District",-1)),o(t("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":e[26]||(e[26]=l=>i.districtUid=l),"aria-label":"District"},[e[51]||(e[51]=t("option",{value:null},null,-1)),(u(!0),d(w,null,g(i.state.districts,l=>(u(),d("option",{key:l.uid,value:l.uid},n(l.name),9,Yt))),128))],512),[[U,i.districtUid]])]),t("div",At,n(i.errors.districtUid),1)])]),e[54]||(e[54]=t("hr",null,null,-1)),e[55]||(e[55]=t("button",{type:"submit",class:"-mb-4 w-1/5 border border-primary bg-primary text-primary-foreground rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-primary focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Save Patient Information"}," Save Patient ",-1))],32)}const Xt=Ne(qe,[["render",Rt],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/person/PatientForm.vue"]]);export{Xt as default};
