import{P as te,e as se,ai as oe,aa as ae,Z as ne,r as le,$ as Y,o as r,c as u,b as e,A as c,a2 as t,a as C,F as ie,D as de,a1 as p,E as d,a7 as m,J as N,x as re,K as j,V as D,W as A,z as ce,X as P,Y as L,ak as R,aT as ue,aU as me,_ as _e}from"./index-fa13e788.js";import{u as pe,A as he,d as xe}from"./billing-92650e42.js";import{c as be,a as O,f as q,d as fe,g as F,u as ye,b as _}from"./array-5698c257.js";const n=h=>(ue("data-v-3f30ca74"),h=h(),me(),h),ge={class:"mt-4"},ve=n(()=>e("hr",null,null,-1)),Ve={class:"grid grid-cols-12 gap-4 mt-2"},ke={initial:{opacity:0,y:100},enter:{opacity:1,y:0,scale:1},variants:{custom:{scale:2}},delay:400,class:"col-span-3 overflow-y-scroll overscroll-contain voucher-scroll"},we={key:0,class:"py-4 text-center bg-white w-full mb-1 rounded-sm shadow border"},De={key:1},Ce=["onClick"],Pe={class:"flex-grow p-1"},Le={class:"font-semibold text-gray-800 flex justify-between"},Oe={class:"text-sm text-gray-500"},Ue={key:0,initial:{opacity:0,y:-100},enter:{opacity:1,y:0,scale:1},variants:{custom:{scale:2}},delay:400,class:"col-span-9"},Se={class:"bg-white rounded-sm shadow-sm hover:shadow-xs duration-500 px-4 sm:px-6 md:px-2 py-4"},Ee={class:"flex justify-between items-center"},Me={class:"text-gray-800 text-l font-bold"},Ye=n(()=>e("hr",null,null,-1)),Ne={class:"grid grid-cols-3 gap-x-8"},je={class:"col-span-1"},Ae={class:"flex justify-between items-center mt-2"},Re=n(()=>e("span",{class:"text-gray-800 text-sm font-semibold"},"Start Date:",-1)),qe={class:"text-gray-600 text-sm md:text-md"},Fe={class:"flex justify-between items-center mt-2"},$e=n(()=>e("span",{class:"text-gray-800 text-sm font-semibold"},"End Date:",-1)),Ie={class:"text-gray-600 text-sm md:text-md"},Te={class:"col-span-1"},Be={class:"flex justify-between items-center mt-2"},ze=n(()=>e("span",{class:"text-gray-800 text-sm font-semibold"},"Usage Limit:",-1)),We={class:"text-gray-600 text-sm md:text-md"},Je={class:"flex justify-between items-center mt-2"},Ke=n(()=>e("span",{class:"text-gray-800 text-sm font-semibold"},"Used:",-1)),Xe={class:"text-gray-600 text-sm md:text-md"},Ze={class:"col-span-1"},Ge={class:"flex justify-between items-center mt-2"},He=n(()=>e("span",{class:"text-gray-800 text-sm font-semibold"},"Once per customer:",-1)),Qe={class:"text-gray-600 text-sm md:text-md"},et={class:"flex justify-between items-center mt-2"},tt=n(()=>e("span",{class:"text-gray-800 text-sm font-semibold"},"Once per order:",-1)),st={class:"text-gray-600 text-sm md:text-md"},ot=n(()=>e("h3",null,"Voucher Form",-1)),at={class:"grid grid-cols-4 gap-x-4 mb-4"},nt={class:"block col-span-2 mb-2"},lt=n(()=>e("span",{class:"text-gray-700"},"Voucher Name",-1)),it={class:"block col-span-1 mb-2"},dt=n(()=>e("span",{class:"text-gray-700"},"Start Date",-1)),rt={class:"block col-span-1 mb-2"},ct=n(()=>e("span",{class:"text-gray-700"},"End Date",-1)),ut={class:"grid grid-cols-4 gap-x-4 mb-4"},mt={class:"block col-span-2 mb-2"},_t=n(()=>e("span",{class:"text-gray-700"},"Usage Limit",-1)),pt={class:"grid grid-cols-2 gap-x-4 mb-4"},ht={class:"block col-span-1 mb-2"},xt=n(()=>e("span",{class:"text-gray-700"},"Once Per Customer",-1)),bt={class:"block col-span-1 mb-2"},ft=n(()=>e("span",{class:"text-gray-700"},"Once Per Order",-1)),yt=n(()=>e("hr",null,null,-1)),gt=te({__name:"Voucher",setup(h){const $=P(()=>L(()=>import("./FelLoadingMessage-c4848162.js"),["assets/FelLoadingMessage-c4848162.js","assets/index-fa13e788.js","assets/index-ccc6a521.css"])),I=P(()=>L(()=>import("./index-fa13e788.js").then(s=>s.cN),["assets/index-fa13e788.js","assets/index-ccc6a521.css"])),T=P(()=>L(()=>import("./VoucherCodes-d90fe93e.js"),["assets/VoucherCodes-d90fe93e.js","assets/index-fa13e788.js","assets/index-ccc6a521.css","assets/billing-92650e42.js","assets/array-5698c257.js","assets/VoucherCodes-bd5edd75.css"])),{withClientMutation:U}=se();let x=pe();const{vouchers:S,fetchingVouchers:B}=oe(x);ae(()=>{x.fetchVouchers()});let i=ne(!1);const z=be({uid:O().nullable(),name:O().required("Voucher Name is Required"),startDate:q().required("Start Date is Required"),endDate:q().required("End Date is Required"),usageLimit:fe().required("Usage Limit is Required"),used:O().nullable(),oncePerCustomer:F().default(!0),oncePerOrder:F().default(!0)}),{handleSubmit:W,errors:b,setFieldValue:l}=ye({validationSchema:z,initialValues:{oncePerCustomer:!0,oncePerOrder:!0}}),{value:f}=_("uid"),{value:y}=_("name"),{value:g}=_("startDate"),{value:v}=_("endDate"),{value:V}=_("usageLimit"),{value:J}=_("used"),{value:k}=_("oncePerCustomer"),{value:w}=_("oncePerOrder"),E=W(s=>{s.uid||G(s),s.uid&&H(s)});let K=s=>{l("uid",s.uid),l("name",s.name),l("startDate",R(s.startDate,"DD/MM/YYYY")),l("endDate",R(s.endDate,"DD/MM/YYYY")),l("usageLimit",s.usageLimit),l("used",s.used),l("oncePerCustomer",s.oncePerCustomer),l("oncePerOrder",s.oncePerOrder)},X=()=>{l("uid",void 0),l("name",void 0),l("startDate",void 0),l("endDate",void 0),l("usageLimit",void 0),l("oncePerCustomer",!0),l("oncePerOrder",!0)};const Z=()=>{X(),i.value=!0},G=s=>{delete s.uid,U(he,{payload:s},"createVoucher").then(o=>x.addVoucher(o)).finally(()=>i.value=!1)},H=s=>{delete s.uid,delete s.used,U(xe,{uid:f?.value,payload:s},"updateVoucher").then(o=>x.updateVoucher(o)).finally(()=>i.value=!1)};return(s,o)=>{const Q=le("font-awesome-icon"),M=Y("motion"),ee=Y("motion-slide-top");return r(),u("div",ge,[e("div",{class:"flex justify-between"},[e("button",{class:"px-4 my-2 p-1 text-sm border-sky-800 border text-dark-700 transition-colors duration-150 rounded-sm focus:outline-none hover:bg-sky-800 hover:text-gray-100",onClick:Z}," Add Voucher ")]),ve,e("div",Ve,[c((r(),u("section",ke,[t(B)?(r(),u("div",we,[C(t($),{message:"Fetching vouchers ..."})])):(r(),u("div",De,[(r(!0),u(ie,null,de(t(S),a=>(r(),u("a",{key:a.uid,onClick:vt=>t(K)(a),class:p(["bg-white w-full flex items-center p-1 mb-1 rounded-sm shadow border",{"border-sky-800 bg-emerald-200":a.uid===t(f)}])},[e("div",Pe,[e("div",Le,[e("span",null,d(a.name),1),e("span",Oe,d(a.used)+" of "+d(a.usageLimit),1)])])],10,Ce))),128))]))])),[[M]]),t(S)?.length>0&&t(f)?c((r(),u("section",Ue,[c((r(),u("div",Se,[e("div",Ee,[e("h4",Me,d(t(y)?.toUpperCase()),1),e("a",{onClick:o[0]||(o[0]=a=>m(i)?i.value=!0:i=!0),class:"px-2 cursor text-gray-400 hover:text-gray-900"},[C(Q,{icon:"pen"})])]),Ye,e("section",Ne,[e("div",je,[e("div",Ae,[Re,e("span",qe,d(t(g)),1)]),e("div",Fe,[$e,e("span",Ie,d(t(v)),1)])]),e("div",Te,[e("div",Be,[ze,e("span",We,d(t(V)),1)]),e("div",Je,[Ke,e("span",Xe,d(t(J)),1)])]),e("div",Ze,[e("div",Ge,[He,e("span",Qe,d(t(k)?"Yes":"No"),1)]),e("div",et,[tt,e("span",st,d(t(w)?"Yes":"No"),1)])])])])),[[ee]]),C(t(T),{voucherUid:t(f)},null,8,["voucherUid"])])),[[M]]):N("",!0)]),t(i)?(r(),re(t(I),{key:0,onClose:o[8]||(o[8]=a=>m(i)?i.value=!1:i=!1),contentWidth:"w-2/6"},{header:j(()=>[ot]),body:j(()=>[e("form",null,[e("div",at,[e("label",nt,[lt,c(e("input",{class:p(["form-input mt-1 block w-full",{"border-red-500 animate-pulse":t(b).name}]),type:"text","onUpdate:modelValue":o[1]||(o[1]=a=>m(y)?y.value=a:null),placeholder:"Name ..."},null,2),[[D,t(y)]])]),e("label",it,[dt,c(e("input",{class:p(["form-input mt-1 block w-full",{"border-red-500 animate-pulse":t(b).startDate}]),type:"date","onUpdate:modelValue":o[2]||(o[2]=a=>m(g)?g.value=a:null)},null,2),[[D,t(g)]])]),e("label",rt,[ct,c(e("input",{class:p(["form-input mt-1 block w-full",{"border-red-500 animate-pulse":t(b).endDate}]),type:"date","onUpdate:modelValue":o[3]||(o[3]=a=>m(v)?v.value=a:null)},null,2),[[D,t(v)]])])]),e("div",ut,[e("label",mt,[_t,c(e("input",{class:p(["form-input mt-1 block w-full",{"border-red-500 animate-pulse":t(b).usageLimit}]),type:"number",min:"1","onUpdate:modelValue":o[4]||(o[4]=a=>m(V)?V.value=a:null)},null,2),[[D,t(V)]])])]),e("div",pt,[e("label",ht,[xt,c(e("input",{class:"form-checkbox ml-4",type:"checkbox","onUpdate:modelValue":o[5]||(o[5]=a=>m(k)?k.value=a:null),checked:""},null,512),[[A,t(k)]])]),e("label",bt,[ft,c(e("input",{class:"form-checkbox ml-4",type:"checkbox","onUpdate:modelValue":o[6]||(o[6]=a=>m(w)?w.value=a:null),checked:""},null,512),[[A,t(w)]])])]),yt,e("button",{type:"submit",class:"-mb-4 border border-sky-800 bg-sky-800 text-white rounded-sm px-2 py-1 mt-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline",onClick:o[7]||(o[7]=ce((...a)=>t(E)&&t(E)(...a),["prevent"]))}," Save Voucher ")])]),_:1})):N("",!0)])}}});const Dt=_e(gt,[["__scopeId","data-v-3f30ca74"],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/admin/billing/Voucher.vue"]]);export{Dt as default};
