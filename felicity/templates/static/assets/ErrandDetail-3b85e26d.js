import{d as ye,r as i,q as fe,J as _e,p as R,I as he,az as j,m as F,f as t,o as r,c as u,b as e,t as c,e as z,v as xe,ax as ke,aM as De,A,av as M,B as g,y as Ve,L as Ue,aK as we,G as h,g as d,z as K,j as x,X as Ee,_ as k,k as Ce}from"./index-d5ae4e74.js";import{c as Be,d as Se,e as Ae,f as Me,g as Te}from"./grind.queries-d4db0842.js";import{S as O}from"./schema-f3233b53.js";import{C as Le,A as Pe,a as He,b as $e,B as Ye,c as Ie,E as Ge,H as Ne,I as Re,d as je,e as Fe,L as ze,P as Ke,S as Oe,T as Qe,f as qe,U as Je,g as We}from"./index-6fbc7104.js";import v from"./vue-multiselect.esm-3a760e8f.js";import{U as Xe}from"./_queries-827ee6fb.js";import"./isArray-513c67aa.js";const Ze={key:0,class:"bg-white rounded-lg shadow"},et={class:"flex flex-col md:flex-row"},tt={class:"flex-1 p-6 border-r"},st={class:"p-6 border-b"},at={class:"flex justify-between items-center"},ot={class:"relative w-full"},lt={class:"mt-4 text-xs flex items-center gap-2"},it={class:"h-8 w-8 rounded-full bg-orange-200 flex items-center justify-center text-orange-600"},nt={class:"my-1 font-semibold"},rt={class:"text-sm text-gray-600"},dt=["innerHTML"],ut={key:1,class:"mt-6"},ct={class:"main-container min-w-full prose prose-slate"},mt={class:"editor-container editor-container_balloon-editor",ref:"editorContainerElement"},pt={class:"editor-container__editor"},gt={ref:"editorElement"},vt={class:"flex justify-start items-center gap-x-2 mt-1"},bt={class:"my-2 w-full bg-gray-200 rounded-full h-1 dark:bg-gray-700"},yt={class:"text-xs"},ft={class:"border-b border-gray-200"},_t={class:"flex"},ht={class:"py-4"},xt={key:0,class:"space-y-6"},kt={key:1,class:"space-y-4"},Dt={key:2,class:"space-y-4"},Vt={key:3},Ut={class:"w-full md:w-80 p-6"},wt={class:"space-y-6"},Et=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1),Ct=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Assignee",-1),Bt=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Reporter",-1),St=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Team Members",-1),At={class:"multiselect-tag"},Mt=["onClick"],Tt=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Priority",-1),Lt=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tags",-1),Pt={class:"multiselect-tag"},Ht=["onClick"],$t=ye({__name:"ErrandDetail",setup(Yt){const Q=x(()=>k(()=>import("./ErrandActivity-a776a1ee.js"),["assets/ErrandActivity-a776a1ee.js","assets/index-d5ae4e74.js","assets/index-246842b1.css"])),q=x(()=>k(()=>import("./CommentSystem-723b2651.js"),["assets/CommentSystem-723b2651.js","assets/index-d5ae4e74.js","assets/index-246842b1.css","assets/grind.queries-d4db0842.js","assets/CommentSystem-d474aa42.css"])),J=x(()=>k(()=>import("./ErrandFile-b0517351.js"),["assets/ErrandFile-b0517351.js","assets/index-d5ae4e74.js","assets/index-246842b1.css","assets/grind.queries-d4db0842.js","assets/schema-f3233b53.js","assets/ErrandFile-a405999b.css"])),W=x(()=>k(()=>import("./ErrandMilestone-d4ef2569.js"),["assets/ErrandMilestone-d4ef2569.js","assets/index-d5ae4e74.js","assets/index-246842b1.css","assets/_queries-827ee6fb.js","assets/grind.queries-d4db0842.js","assets/vue-multiselect.esm-3a760e8f.js"])),D=i(!1),T=i(null),X=i(Le);function Z(){T.value={toolbar:{items:["undo","redo","|","heading","|","bold","italic","underline","|","link","insertTable","blockQuote","|","bulletedList","numberedList","todoList","outdent","indent"],shouldNotGroupWhenFull:!1},plugins:[Pe,He,$e,Ye,Ie,Ge,Ne,Re,je,Fe,ze,Ke,Oe,Qe,qe,Je,We],heading:{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h1",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h2",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h3",title:"Heading 3",class:"ck-heading_heading3"},{model:"heading4",view:"h4",title:"Heading 4",class:"ck-heading_heading4"},{model:"heading5",view:"h5",title:"Heading 5",class:"ck-heading_heading5"},{model:"heading6",view:"h6",title:"Heading 6",class:"ck-heading_heading6"}]},placeholder:"Begin typing..."},D.value=!0}fe(()=>{Z(),$(),ne(),de(),ve()});const n=i("discussions"),L=_e(),P=R(()=>L.params.errandUid),ee=R(()=>L.params.boardUid);let a=i();const{withClientQuery:y,withClientMutation:H}=he();function $(){y(Be,{uid:P.value},"grindErrandByUid").then(o=>{a.value=o;const s=j(a.value.startDate,!0)??new Date,p=j(a.value.endDate,!0)??new Date(new Date().setDate(s.getDate()+7));w.value=[s,p]})}function m(o){H(Te,{uid:P.value,payload:o},"updateGrindErrand").then(()=>$())}const V=i(!1),U=i(null),te=()=>{V.value=!0,Ee(()=>{U.value?.focus(),U.value?.select()})},Y=()=>{V.value=!1,m({title:a.value?.title})},f=i(!1),I=i(""),se=()=>{f.value=!0,I.value=a.value?.description??""},ae=()=>{f.value=!1,m({description:a.value?.description})},oe=()=>{a.value.description=I.value,f.value=!1},w=i(),le=o=>{const s=o[0]?.getDate(),p=o[0]?.getMonth()+1,B=o[0]?.getFullYear(),l=o[1]?.getDate(),b=o[1]?.getMonth()+1,S=o[1]?.getFullYear();return`${s}/${p}/${B} - ${l}/${b}/${S}`},ie=o=>{if(o.length!==2){alert("Invalid date range");return}m({startDate:M(o[0],"YYYY-MM-DD HH:mm"),endDate:M(o[1],"YYYY-MM-DD HH:mm")})},G=i([]);function ne(){y(Se,{boardUid:ee.value},"grindPostersByBoard").then(o=>{G.value=o.filter(s=>s.uid!==a.value?.posterUid)})}function re(o){m({posterUid:o.uid})}const _=i();function de(){y(Xe,{first:100},"userAll").then(o=>{_.value=o.items})}function E({firstName:o,lastName:s}){return`${o} ${s}`}function ue(o){m({assigneeUid:o.uid})}function ce(o){m({reporterUid:o.uid})}function me(o){m({members:o.map(s=>s.uid)})}const pe=["Low","Normal","High","Critical"];function ge(o){m({priority:o})}const C=i([]);function ve(){y(Ae,{category:O.Project},"grindStampByCategory").then(o=>{C.value=o})}function N(o){m({stamps:o?.map(s=>s.uid)})}const be=o=>{H(Me,{payload:{title:o,category:O.Project}},"createGrindStamp").then(s=>{if(s.uid){C.value.push(s);const p=a.value?.stamps??[];p.push(s),N(p)}})};return(o,s)=>{const p=F("ckeditor"),B=F("VueDatePicker");return t(a)?(r(),u("div",Ze,[e("div",et,[e("div",tt,[e("div",st,[e("div",at,[e("div",ot,[V.value?z((r(),u("input",{key:1,type:"text","onUpdate:modelValue":s[0]||(s[0]=l=>t(a).title=l),onBlur:Y,onKeyup:ke(Y,["enter"]),ref_key:"titleInput",ref:U,class:"text-2xl font-semibold text-gray-800 w-full px-2 py-1 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544)),[[xe,t(a).title]]):(r(),u("h1",{key:0,onClick:te,class:"text-3xl font-bold text-gray-800 cursor-pointer hover:bg-gray-50 rounded"},c(t(a).title),1))])]),e("div",lt,[e("div",it,c(t(De)(t(a).createdBy?.firstName,t(a).createdBy?.lastName)),1),A(" by "),e("span",nt,c(t(a).createdBy?.firstName)+" "+c(t(a).createdBy?.lastName),1),e("span",rt,"on "+c(t(M)(t(a).createdAt,"D MMMM YYYY")),1)]),f.value?(r(),u("div",ut,[e("div",ct,[e("p",null,"isLayoutReady : "+c(D.value),1),e("div",mt,[e("div",pt,[e("div",gt,[D.value?(r(),Ve(p,{key:0,modelValue:t(a).description,"onUpdate:modelValue":s[1]||(s[1]=l=>t(a).description=l),editor:X.value,config:T.value,"tag-name":"textarea"},null,8,["modelValue","editor","config"])):g("",!0)],512)])],512)]),e("div",{class:"mt-2 flex gap-2"},[e("button",{onClick:ae,class:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm"}," Save "),e("button",{onClick:oe,class:"px-3 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 text-sm"}," Cancel ")])])):(r(),u("div",{key:0,class:"mt-6",onClick:se},[t(a).description?(r(),u("div",{key:0,class:"text-lg text-gray-800",innerHTML:t(a).description},null,8,dt)):g("",!0)]))]),z(e("div",vt,[e("div",bt,[e("div",{class:"bg-green-600 h-1 rounded-full",style:we(`width: ${t(a)?.milestonesAt}%`)},null,4)]),e("span",yt,c(t(a)?.milestonesAt)+"%",1)],512),[[Ue,t(a)?.milestonesAt]]),e("div",ft,[e("div",_t,[e("button",{onClick:s[2]||(s[2]=l=>n.value="discussions"),class:h(["py-3 px-4 text-sm font-medium border-b-2 focus:outline-none",n.value==="discussions"?"border-blue-500 text-blue-500":"border-transparent text-gray-500 hover:text-gray-700"])}," Discussions ",2),e("button",{onClick:s[3]||(s[3]=l=>n.value="milestones"),class:h(["py-3 px-4 text-sm font-medium border-b-2 focus:outline-none",n.value==="milestones"?"border-blue-500 text-blue-500":"border-transparent text-gray-500 hover:text-gray-700"])}," Milestones ",2),e("button",{onClick:s[4]||(s[4]=l=>n.value="activity"),class:h(["py-3 px-4 text-sm font-medium border-b-2 focus:outline-none",n.value==="activity"?"border-blue-500 text-blue-500":"border-transparent text-gray-500 hover:text-gray-700"])}," Activity Stream ",2),e("button",{onClick:s[5]||(s[5]=l=>n.value="files"),class:h(["py-3 px-4 text-sm font-medium border-b-2 focus:outline-none",n.value==="files"?"border-blue-500 text-blue-500":"border-transparent text-gray-500 hover:text-gray-700"])}," Files ",2)])]),e("div",ht,[n.value==="discussions"?(r(),u("div",xt,[d(t(q),{errandUid:t(a).uid},null,8,["errandUid"])])):g("",!0),n.value==="milestones"?(r(),u("div",kt,[d(t(W),{errandUid:t(a).uid},null,8,["errandUid"])])):g("",!0),n.value==="activity"?(r(),u("div",Dt,[d(t(Q),{errandUid:t(a).uid},null,8,["errandUid"])])):g("",!0),n.value==="files"?(r(),u("div",Vt,[d(t(J),{errandUid:t(a).uid},null,8,["errandUid"])])):g("",!0)])]),e("div",Ut,[e("div",wt,[d(B,{class:"z-60",modelValue:w.value,"onUpdate:modelValue":[s[6]||(s[6]=l=>w.value=l),ie],range:"",format:le},null,8,["modelValue"]),e("div",null,[Et,d(t(v),{modelValue:t(a).poster,"onUpdate:modelValue":[s[7]||(s[7]=l=>t(a).poster=l),re],options:G.value,label:"title","track-by":"uid",placeholder:"Select status"},null,8,["modelValue","options"])]),e("div",null,[Ct,d(t(v),{modelValue:t(a).assignee,"onUpdate:modelValue":[s[8]||(s[8]=l=>t(a).assignee=l),ue],options:_.value,"track-by":"uid",searchable:!0,"custom-label":E,placeholder:"Select assignee"},null,8,["modelValue","options"])]),e("div",null,[Bt,d(t(v),{modelValue:t(a).reporter,"onUpdate:modelValue":[s[9]||(s[9]=l=>t(a).reporter=l),ce],options:_.value,"track-by":"uid",searchable:!0,"custom-label":E,placeholder:"Select reporter"},null,8,["modelValue","options"])]),e("div",null,[St,d(t(v),{modelValue:t(a).members,"onUpdate:modelValue":[s[10]||(s[10]=l=>t(a).members=l),me],options:_.value,multiple:!0,searchable:!0,"custom-label":E,"track-by":"uid",placeholder:"Select members"},{tag:K(({option:l,remove:b})=>[e("div",At,[A(c(l.firstName)+" "+c(l.lastName)+" ",1),e("i",{class:"multiselect-tag-remove",onClick:S=>b(l)},"×",8,Mt)])]),_:1},8,["modelValue","options"])]),e("div",null,[Tt,d(t(v),{modelValue:t(a).priority,"onUpdate:modelValue":[s[11]||(s[11]=l=>t(a).priority=l),ge],options:pe,searchable:!1,"show-labels":!1,placeholder:"Select priority"},null,8,["modelValue"])]),e("div",null,[Lt,d(t(v),{modelValue:t(a).stamps,"onUpdate:modelValue":[s[12]||(s[12]=l=>t(a).stamps=l),N],options:C.value,multiple:!0,taggable:!0,searchable:!0,"track-by":"uid","show-labels":!1,placeholder:"Select or add tags",onTag:be,"custom-label":({title:l})=>`${l}`},{tag:K(({option:l,remove:b})=>[e("div",Pt,[A(c(l.title)+" ",1),e("i",{class:"multiselect-tag-remove",onClick:S=>b(l)},"×",8,Ht)])]),_:1},8,["modelValue","options","custom-label"])])])])])])):g("",!0)}}}),Kt=Ce($t,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/grind/_id/ErrandDetail.vue"]]);export{Kt as default};
