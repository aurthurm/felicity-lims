import{f as C,T as E,w as p,c as w,r as x,h as u,k as c,x as e,ag as i,F as _,ak as y,D as h,u as B,_ as N}from"./_plugin-vue_export-helper-3f67fb71.js";import{c as L,d as M,e as R,f as F}from"./billing.mutations-59bfac39.js";import{as as O,q}from"./billing-356772f3.js";import{v as m,a as P,d as g,b,e as $}from"./runtime-dom.esm-bundler-6e07ef74.js";const j={class:"grid grid-cols-12"},G={class:"col-span-6 gap-x-4 pr-4 mb-2"},K=e("h3",{class:"font-semibold text-l text-gray-600"},"Pricing Information",-1),Y=e("hr",null,null,-1),z={class:"mt-4"},H={class:""},J={class:"flex justify-start items-center gap-x-4 mb-4"},Q=e("span",{class:"col-span-1 text-gray-700"},"Amount: $",-1),W={class:"col-span-6 gap-x-4 mb-2 border-l-2 border-l-gray-500 pl-4"},X=e("h3",{class:"font-semibold text-l text-gray-600"},"Discounts Information",-1),Z=e("hr",null,null,-1),ee={class:"mt-4"},te={class:"grid grid-cols-2 gap-4"},se={class:"col-span-1 whitespace-nowrap mb-2 w-full"},oe=e("span",{class:"text-gray-700 w-4/12"},"Discount Type",-1),le={class:"w-full"},ne=e("option",null,null,-1),ae=["value"],ie={class:"col-span-1 whitespace-nowrap mb-2 w-full"},ue=e("span",{class:"text-gray-700 w-4/12"},"Value Type",-1),ce={class:"w-full"},re=e("option",null,null,-1),de=["value"],pe={class:"grid grid-cols-4 gap-4 mt-1"},me={class:"col-span-2"},fe=e("span",{class:"col-span-1 text-gray-700"},"Start Date",-1),ve={class:"col-span-2"},_e=e("span",{class:"col-span-1 text-gray-700"},"End Date",-1),ye={class:"col-span-2 whitespace-nowrap w-full mb-2"},he=e("span",{class:"text-gray-700 w-4/12"},"Voucher",-1),ge={class:"w-full"},be=e("option",null,null,-1),De=["value"],we={class:"grid grid-cols-2 gap-x-4 mt-1"},xe={class:"col-span-1"},Pe=e("span",{class:"text-gray-700"},"Value Percent",-1),Te={class:"col-span-1"},Ae=e("span",{class:"text-gray-700"},"Value Amount",-1),Ue={class:"grid grid-cols-2 gap-4 mt-4 mb-2"},ke={class:"col-span-4 flex justify-start items-center gap-x-4"},Ie=e("span",{class:"col-span-1 text-gray-700"},"Is Active",-1),Ve=e("hr",null,null,-1),Se=C({__name:"Billing",props:{target:{type:String,required:!0},targetUid:{type:String,required:!0}},setup(T){const A=T,l=O(),{withClientMutation:D}=q(),{target:n,targetUid:r}=E(A),f=()=>{l.clear(),n?.value==="profile"&&(l.fetchProfilePrice(r.value),l.fetchProfileDiscount(r.value)),n?.value==="analysis"&&(l.fetchAnalysisPrice(r.value),l.fetchAnalysisDiscount(r.value)),l.fetchVouchers()};f(),p(()=>n.value,(a,s)=>f()),p(()=>r.value,(a,s)=>f());const d=w({amount:0});p(()=>l.fetchingPrice,(a,s)=>{a||(n?.value==="profile"&&(d.amount=l.profilePrice?.amount??0),n?.value==="analysis"&&(d.amount=l.analysisPrice?.amount??0))});const U=()=>{const a={...d};let s=n.value=="profile"?L:M,t=n.value=="profile"?"updateProfilePrice":"updateAnaysisPrice",v=n.value=="profile"?l.profilePrice:l.analysisPrice;D(s,{uid:v?.uid,payload:a},t).then(S=>{})},o=w({discountType:"",valueType:"",startDate:"",endDate:"",voucherUid:"",valuePercent:0,valueAmount:0,isActive:!0});p(()=>l.fetchingDiscount,(a,s)=>{if(!a){let t={};n?.value==="profile"&&(t={...l.profileDiscount}),n?.value==="analysis"&&(t={...l.analyisDiscount}),o.discountType=t.discountType,o.valueType=t.valueType,o.startDate=t.startDate,o.endDate=t.endDate,o.voucherUid=t.voucherUid,o.valuePercent=t.valuePercent,o.valueAmount=t.valueAmount,o.isActive=t.isActive}});const k=x(["sale","voucher"]),I=x(["percentage","amount"]),V=()=>{const a={...o};let s=n.value=="profile"?R:F,t=n.value=="profile"?"updateProfileDiscount":"updateAnalysisDiscount",v=n.value=="profile"?l.profileDiscount:l.analyisDiscount;D(s,{uid:v?.uid,payload:a},t).then(S=>{})};return p(()=>o.discountType,(a,s)=>{a!=="voucher"&&(o.voucherUid="")}),(a,s)=>(u(),c("div",j,[e("section",G,[K,Y,e("form",z,[e("div",H,[e("label",J,[Q,i(e("input",{class:"form-input mt-1","onUpdate:modelValue":s[0]||(s[0]=t=>d.amount=t),type:"number",min:"0.0",step:"0.1"},null,512),[[m,d.amount]])])]),e("button",{type:"button",onClick:s[1]||(s[1]=P(t=>U(),["prevent"])),class:"border border-sky-800 bg-sky-800 text-white rounded-sm mt-4 px-2 py-1 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Update Pricing ")])]),e("section",W,[X,Z,e("form",ee,[e("div",te,[e("label",se,[oe,e("div",le,[i(e("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":s[2]||(s[2]=t=>o.discountType=t)},[ne,(u(!0),c(_,null,y(k.value,t=>(u(),c("option",{key:t,value:t},h(t),9,ae))),128))],512),[[g,o.discountType]])])]),e("label",ie,[ue,e("div",ce,[i(e("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":s[3]||(s[3]=t=>o.valueType=t)},[re,(u(!0),c(_,null,y(I.value,t=>(u(),c("option",{key:t,value:t},h(t),9,de))),128))],512),[[g,o.valueType]])])])]),e("div",pe,[e("label",me,[fe,i(e("input",{class:"form-input w-full","onUpdate:modelValue":s[4]||(s[4]=t=>o.startDate=t),type:"date"},null,512),[[m,o.startDate]])]),e("label",ve,[_e,i(e("input",{class:"form-input w-full","onUpdate:modelValue":s[5]||(s[5]=t=>o.endDate=t),type:"date"},null,512),[[m,o.endDate]])]),i(e("label",ye,[he,e("div",ge,[i(e("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":s[6]||(s[6]=t=>o.voucherUid=t)},[be,(u(!0),c(_,null,y(B(l).vouchers,t=>(u(),c("option",{key:t.uid,value:t.uid},h(t.name),9,De))),128))],512),[[g,o.voucherUid]])])],512),[[b,o.discountType==="voucher"]])]),e("div",we,[i(e("label",xe,[Pe,i(e("input",{class:"form-input w-full","onUpdate:modelValue":s[7]||(s[7]=t=>o.valuePercent=t),type:"number",step:"0.1",min:"0.0",max:"100"},null,512),[[m,o.valuePercent]])],512),[[b,o.valueType==="percentage"]]),i(e("label",Te,[Ae,i(e("input",{class:"form-input w-full","onUpdate:modelValue":s[8]||(s[8]=t=>o.valueAmount=t),type:"number",step:"0.1",min:"0.0"},null,512),[[m,o.valueAmount]])],512),[[b,o.valueType==="amount"]])]),e("div",Ue,[e("label",ke,[Ie,i(e("input",{class:"form-checkbox","onUpdate:modelValue":s[9]||(s[9]=t=>o.isActive=t),type:"checkbox"},null,512),[[$,o.isActive]])])]),Ve,e("button",{type:"button",onClick:s[10]||(s[10]=P(t=>V(),["prevent"])),class:"border border-sky-800 bg-sky-800 text-white rounded-sm mt-4 px-2 py-1 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Update Discount ")])])]))}}),Le=N(Se,[["__file","/home/aurthurm/Development/felicity-lims/webapp/views/admin/analyses/Billing.vue"]]);export{Le as default};
