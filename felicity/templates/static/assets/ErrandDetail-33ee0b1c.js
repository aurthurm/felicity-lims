import{d as fe,r as n,q as ye,J as _e,p as R,I as he,az as F,m as j,f as t,o as d,c,y as l,b as e,t as m,e as z,v as xe,ax as ke,aM as De,B as A,av as B,z as Ve,L as Ue,aK as we,G as h,g as u,A as K,j as x,X as Ee,_ as k,k as Ce}from"./index-fc86f1fc.js";import{c as Te,d as Se,e as Ae,f as Be,g as Me}from"./grind.queries-5040943e.js";import{S as O}from"./schema-f3233b53.js";import{C as Pe,A as He,a as Le,b as $e,B as Ye,c as Ie,E as Ge,H as Ne,I as Re,d as Fe,e as je,L as ze,P as Ke,S as Oe,T as Qe,f as qe,U as Je,g as We}from"./index-6d96446e.js";import v from"./vue-multiselect.esm-2e9cf21d.js";import{U as Xe}from"./_queries-be63b368.js";import"./isArray-513c67aa.js";const Ze={key:0,class:"bg-white rounded-lg shadow"},et={class:"flex flex-col md:flex-row"},tt={class:"flex-1 p-6 border-r"},st={class:"p-6 border-b"},at={class:"flex justify-between items-center"},ot={class:"relative w-full"},it={class:"mt-4 text-xs flex items-center gap-2"},lt={class:"h-8 w-8 rounded-full bg-orange-200 flex items-center justify-center text-orange-600"},nt={class:"my-1 font-semibold"},rt={class:"text-sm text-gray-600"},dt=["innerHTML"],ut={key:1,class:"mt-6"},ct={class:"main-container min-w-full prose prose-slate"},mt={class:"editor-container editor-container_balloon-editor",ref:"editorContainerElement"},pt={class:"editor-container__editor"},gt={ref:"editorElement"},vt={class:"flex justify-start items-center gap-x-2 mt-1"},bt={class:"my-2 w-full bg-gray-200 rounded-full h-1 dark:bg-gray-700"},ft={class:"text-xs"},yt={class:"border-b border-gray-200"},_t={class:"flex"},ht={class:"py-4"},xt={key:0,class:"space-y-6"},kt={key:1,class:"space-y-4"},Dt={key:2,class:"space-y-4"},Vt={key:3},Ut={class:"w-full md:w-80 p-6"},wt={class:"space-y-6"},Et=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1),Ct=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Assignee",-1),Tt=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Reporter",-1),St=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Team Members",-1),At={class:"multiselect-tag"},Bt=["onClick"],Mt=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Priority",-1),Pt=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tags",-1),Ht={class:"multiselect-tag"},Lt=["onClick"],$t=fe({__name:"ErrandDetail",setup(Yt){const Q=x(()=>k(()=>import("./ErrandActivity-73e43966.js"),["assets/ErrandActivity-73e43966.js","assets/index-fc86f1fc.js","assets/index-246842b1.css"])),q=x(()=>k(()=>import("./CommentSystem-1a45ad96.js"),["assets/CommentSystem-1a45ad96.js","assets/index-fc86f1fc.js","assets/index-246842b1.css","assets/grind.queries-5040943e.js"])),J=x(()=>k(()=>import("./ErrandFile-d1608917.js"),["assets/ErrandFile-d1608917.js","assets/index-fc86f1fc.js","assets/index-246842b1.css","assets/grind.queries-5040943e.js","assets/schema-f3233b53.js","assets/ErrandFile-a405999b.css"])),W=x(()=>k(()=>import("./ErrandMilestone-90939588.js"),["assets/ErrandMilestone-90939588.js","assets/index-fc86f1fc.js","assets/index-246842b1.css","assets/_queries-be63b368.js","assets/grind.queries-5040943e.js","assets/vue-multiselect.esm-2e9cf21d.js"])),D=n(!1),M=n(null),X=n(Pe);function Z(){M.value={toolbar:{items:["undo","redo","|","heading","|","bold","italic","underline","|","link","insertTable","blockQuote","|","bulletedList","numberedList","todoList","outdent","indent"],shouldNotGroupWhenFull:!1},plugins:[He,Le,$e,Ye,Ie,Ge,Ne,Re,Fe,je,ze,Ke,Oe,Qe,qe,Je,We],heading:{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h1",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h2",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h3",title:"Heading 3",class:"ck-heading_heading3"},{model:"heading4",view:"h4",title:"Heading 4",class:"ck-heading_heading4"},{model:"heading5",view:"h5",title:"Heading 5",class:"ck-heading_heading5"},{model:"heading6",view:"h6",title:"Heading 6",class:"ck-heading_heading6"}]},placeholder:"Begin typing..."},D.value=!0}ye(()=>{Z(),$(),ne(),de(),ve()});const r=n("discussions"),P=_e(),H=R(()=>P.params.errandUid),ee=R(()=>P.params.boardUid);let a=n();const{withClientQuery:f,withClientMutation:L}=he();function $(){f(Te,{uid:H.value},"grindErrandByUid").then(o=>{a.value=o;const s=F(a.value.startDate,!0)??new Date,g=F(a.value.endDate,!0)??new Date(new Date().setDate(s.getDate()+7));w.value=[s,g]})}function p(o){L(Me,{uid:H.value,payload:o},"updateGrindErrand").then(()=>$())}const V=n(!1),U=n(null),te=()=>{V.value=!0,Ee(()=>{U.value?.focus(),U.value?.select()})},Y=()=>{V.value=!1,p({title:a.value?.title})},y=n(!1),I=n(""),se=()=>{y.value=!0,I.value=a.value?.description??""},ae=()=>{y.value=!1,p({description:a.value?.description})},oe=()=>{a.value.description=I.value,y.value=!1},w=n(),ie=o=>{const s=o[0]?.getDate(),g=o[0]?.getMonth()+1,T=o[0]?.getFullYear(),i=o[1]?.getDate(),b=o[1]?.getMonth()+1,S=o[1]?.getFullYear();return`${s}/${g}/${T} - ${i}/${b}/${S}`},le=o=>{if(o.length!==2){alert("Invalid date range");return}p({startDate:B(o[0],"YYYY-MM-DD HH:mm"),endDate:B(o[1],"YYYY-MM-DD HH:mm")})},G=n([]);function ne(){f(Se,{boardUid:ee.value},"grindPostersByBoard").then(o=>{G.value=o.filter(s=>s.uid!==a.value?.posterUid)})}function re(o){p({posterUid:o.uid})}const _=n();function de(){f(Xe,{first:100},"userAll").then(o=>{_.value=o.items})}function E({firstName:o,lastName:s}){return`${o} ${s}`}function ue(o){p({assigneeUid:o.uid})}function ce(o){p({reporterUid:o.uid})}function me(o){p({members:o.map(s=>s.uid)})}const pe=["Low","Normal","High","Critical"];function ge(o){p({priority:o})}const C=n([]);function ve(){f(Ae,{category:O.Project},"grindStampByCategory").then(o=>{C.value=o})}function N(o){p({stamps:o?.map(s=>s.uid)})}const be=o=>{L(Be,{payload:{title:o,category:O.Project}},"createGrindStamp").then(s=>{if(s.uid){C.value.push(s);const g=a.value?.stamps??[];g.push(s),N(g)}})};return(o,s)=>{const g=j("ckeditor"),T=j("VueDatePicker");return t(a)?(d(),c("div",Ze,[l(" Content area with sidebar "),e("div",et,[l(" Main content "),e("div",tt,[l(" Header "),e("div",st,[e("div",at,[e("div",ot,[V.value?z((d(),c("input",{key:1,type:"text","onUpdate:modelValue":s[0]||(s[0]=i=>t(a).title=i),onBlur:Y,onKeyup:ke(Y,["enter"]),ref_key:"titleInput",ref:U,class:"text-2xl font-semibold text-gray-800 w-full px-2 py-1 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544)),[[xe,t(a).title]]):(d(),c("h1",{key:0,onClick:te,class:"text-3xl font-bold text-gray-800 cursor-pointer hover:bg-gray-50 rounded"},m(t(a).title),1))])]),e("div",it,[e("div",lt,m(t(De)(t(a).createdBy?.firstName,t(a).createdBy?.lastName)),1),A(" by "),e("span",nt,m(t(a).createdBy?.firstName)+" "+m(t(a).createdBy?.lastName),1),e("span",rt,"on "+m(t(B)(t(a).createdAt,"D MMMM YYYY")),1)]),y.value?(d(),c("div",ut,[e("div",ct,[e("p",null,"isLayoutReady : "+m(D.value),1),e("div",mt,[e("div",pt,[e("div",gt,[D.value?(d(),Ve(g,{key:0,modelValue:t(a).description,"onUpdate:modelValue":s[1]||(s[1]=i=>t(a).description=i),editor:X.value,config:M.value,"tag-name":"textarea"},null,8,["modelValue","editor","config"])):l("v-if",!0)],512)])],512)]),e("div",{class:"mt-2 flex gap-2"},[e("button",{onClick:ae,class:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm"}," Save "),e("button",{onClick:oe,class:"px-3 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 text-sm"}," Cancel ")])])):(d(),c("div",{key:0,class:"mt-6",onClick:se},[t(a).description?(d(),c("div",{key:0,class:"text-lg text-gray-800",innerHTML:t(a).description},null,8,dt)):l("v-if",!0)]))]),l(" Progress Bar "),z(e("div",vt,[e("div",bt,[e("div",{class:"bg-green-600 h-1 rounded-full",style:we(`width: ${t(a)?.milestonesAt}%`)},null,4)]),e("span",ft,m(t(a)?.milestonesAt)+"%",1)],512),[[Ue,t(a)?.milestonesAt]]),l(" Tabs "),e("div",yt,[e("div",_t,[e("button",{onClick:s[2]||(s[2]=i=>r.value="discussions"),class:h(["py-3 px-4 text-sm font-medium border-b-2 focus:outline-none",r.value==="discussions"?"border-blue-500 text-blue-500":"border-transparent text-gray-500 hover:text-gray-700"])}," Discussions ",2),e("button",{onClick:s[3]||(s[3]=i=>r.value="milestones"),class:h(["py-3 px-4 text-sm font-medium border-b-2 focus:outline-none",r.value==="milestones"?"border-blue-500 text-blue-500":"border-transparent text-gray-500 hover:text-gray-700"])}," Milestones ",2),e("button",{onClick:s[4]||(s[4]=i=>r.value="activity"),class:h(["py-3 px-4 text-sm font-medium border-b-2 focus:outline-none",r.value==="activity"?"border-blue-500 text-blue-500":"border-transparent text-gray-500 hover:text-gray-700"])}," Activity Stream ",2),e("button",{onClick:s[5]||(s[5]=i=>r.value="files"),class:h(["py-3 px-4 text-sm font-medium border-b-2 focus:outline-none",r.value==="files"?"border-blue-500 text-blue-500":"border-transparent text-gray-500 hover:text-gray-700"])}," Files ",2)])]),l(" Tab Content "),e("div",ht,[l(" Discussions Tab "),r.value==="discussions"?(d(),c("div",xt,[u(t(q),{errandUid:t(a).uid},null,8,["errandUid"])])):l("v-if",!0),l(" Milestones Tab "),r.value==="milestones"?(d(),c("div",kt,[u(t(W),{errandUid:t(a).uid},null,8,["errandUid"])])):l("v-if",!0),l(" Activity Stream Tab "),r.value==="activity"?(d(),c("div",Dt,[u(t(Q),{errandUid:t(a).uid},null,8,["errandUid"])])):l("v-if",!0),l(" Files Tab "),r.value==="files"?(d(),c("div",Vt,[u(t(J),{errandUid:t(a).uid},null,8,["errandUid"])])):l("v-if",!0)])]),l(" Sidebar "),e("div",Ut,[e("div",wt,[l(" Dates "),u(T,{class:"z-60",modelValue:w.value,"onUpdate:modelValue":[s[6]||(s[6]=i=>w.value=i),le],range:"",format:ie},null,8,["modelValue"]),l(" Status "),e("div",null,[Et,u(t(v),{modelValue:t(a).poster,"onUpdate:modelValue":[s[7]||(s[7]=i=>t(a).poster=i),re],options:G.value,label:"title","track-by":"uid",placeholder:"Select status"},null,8,["modelValue","options"])]),l(" Assignee "),e("div",null,[Ct,u(t(v),{modelValue:t(a).assignee,"onUpdate:modelValue":[s[8]||(s[8]=i=>t(a).assignee=i),ue],options:_.value,"track-by":"uid",searchable:!0,"custom-label":E,placeholder:"Select assignee"},null,8,["modelValue","options"])]),l(" Reporter "),e("div",null,[Tt,u(t(v),{modelValue:t(a).reporter,"onUpdate:modelValue":[s[9]||(s[9]=i=>t(a).reporter=i),ce],options:_.value,"track-by":"uid",searchable:!0,"custom-label":E,placeholder:"Select reporter"},null,8,["modelValue","options"])]),l(" Team Members "),e("div",null,[St,u(t(v),{modelValue:t(a).members,"onUpdate:modelValue":[s[10]||(s[10]=i=>t(a).members=i),me],options:_.value,multiple:!0,searchable:!0,"custom-label":E,"track-by":"uid",placeholder:"Select members"},{tag:K(({option:i,remove:b})=>[e("div",At,[A(m(i.firstName)+" "+m(i.lastName)+" ",1),e("i",{class:"multiselect-tag-remove",onClick:S=>b(i)},"×",8,Bt)])]),_:1},8,["modelValue","options"])]),l(" Priority "),e("div",null,[Mt,u(t(v),{modelValue:t(a).priority,"onUpdate:modelValue":[s[11]||(s[11]=i=>t(a).priority=i),ge],options:pe,searchable:!1,"show-labels":!1,placeholder:"Select priority"},null,8,["modelValue"])]),l(" Tags "),e("div",null,[Pt,u(t(v),{modelValue:t(a).stamps,"onUpdate:modelValue":[s[12]||(s[12]=i=>t(a).stamps=i),N],options:C.value,multiple:!0,taggable:!0,searchable:!0,"track-by":"uid","show-labels":!1,placeholder:"Select or add tags",onTag:be,"custom-label":({title:i})=>`${i}`},{tag:K(({option:i,remove:b})=>[e("div",Ht,[A(m(i.title)+" ",1),e("i",{class:"multiselect-tag-remove",onClick:S=>b(i)},"×",8,Lt)])]),_:1},8,["modelValue","options","custom-label"])])])])])])):l("v-if",!0)}}}),Kt=Ce($t,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/grind/_id/ErrandDetail.vue"]]);export{Kt as default};
