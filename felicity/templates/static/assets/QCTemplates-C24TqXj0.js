import{Y as R,u as U,a0 as F,a7 as S,a3 as z,_ as K,r as f,c as _,o as p,z as d,A as q,C as w,a as t,K as l,M as s,F as M,H as D,I as v,B as O,a4 as h}from"./index-OdhKCqIc.js";import{c as Y,e as H,a as I,u as G,F as J}from"./index.esm-BfHj8iGm.js";import{q as W,r as X}from"./analyses.mutations-DUxQZn1r.js";import{u as Z}from"./analysis-PB9AMevg.js";import{I as j}from"./Input-BEm5S0CJ.js";import{T as $}from"./Textarea-T3VcJTEo.js";import{E as ee,a as te,b as le,c as oe,d as ae}from"./EmptyTitle-aCQRDpx3.js";import{F as re,a as ne,b as se}from"./FormMessage-CgXFMXx9.js";import{F as de}from"./FormLabel-DxP9wnWS.js";import{P as me}from"./PageHeading-Czi_4opS.js";import"./Label-CS46LzLb.js";const ie=R({__name:"QCTemplates",setup(A,{expose:o}){o();const i=Z(),{withClientMutation:e}=U();let b=F(!1),T=F("");const m=F(!0),u=F(null),y=Y({name:I().trim().required("Template name is required"),description:I().trim().nullable(),qcLevels:H().nullable(),departments:H().nullable()}),{handleSubmit:c,resetForm:x,setValues:C}=G({validationSchema:y,initialValues:{name:"",description:"",qcLevels:[],departments:[]}});i.fetchQCLevels(),i.fetchQCTemplates();const E=S(()=>i.getQCTemplates),Q=S(()=>i.getQCLevels);function r(a){e(W,{payload:a},"createQcTemplate").then(n=>i.addQcTemplate(n))}function g(a){u.value&&e(X,{uid:u.value,payload:a},"updateQcTemplate").then(n=>i.updateQcTemplate(n))}function k(a){if(a?.length<=0)return[];let n=[];return a?.forEach(L=>n.push(L.uid)),n}function N(a,n={}){m.value=a,b.value=!0,T.value=(a?"CREATE":"EDIT")+" QC Template",a?(u.value=null,x({values:{name:"",description:"",qcLevels:[],departments:[]}})):(u.value=n.uid??null,C({name:n.name??"",description:n.description??"",qcLevels:n.qcLevels??[],departments:n.departments??[]}))}function V(a){if(a?.length<=0)return"";let n=[];return a?.forEach(L=>n.push(L.level)),n.join(", ")}const P=c(a=>{const n={name:a.name,description:a.description??null,levels:k(a.qcLevels??[]),departments:a.departments??[]};m.value===!0&&r(n),m.value===!1&&g(n),b.value=!1}),B={analysisStore:i,withClientMutation:e,get showModal(){return b},set showModal(a){b=a},get formTitle(){return T},set formTitle(a){T=a},formAction:m,currentUid:u,qcTemplateSchema:y,handleSubmit:c,resetForm:x,setValues:C,qcTemplates:E,qcLevels:Q,addQCTemplate:r,editQCTemplate:g,levelsUids:k,FormManager:N,levelsNames:V,saveForm:P,get Button(){return z},get Input(){return j},get Textarea(){return $},get Empty(){return ae},get EmptyContent(){return oe},get EmptyDescription(){return le},get EmptyHeader(){return te},get EmptyTitle(){return ee},get FormControl(){return se},get FormField(){return J},get FormItem(){return ne},get FormLabel(){return de},get FormMessage(){return re},PageHeading:me};return Object.defineProperty(B,"__isScriptSetup",{enumerable:!1,value:!0}),B}}),ue={class:"border border-border bg-card rounded-lg shadow-md"},fe={class:"relative w-full overflow-auto"},pe={class:"font-medium text-foreground"},ce={key:0,class:"text-sm text-muted-foreground"},ge={class:"text-xl font-semibold text-foreground"},ve={class:"space-y-4"},be=["value"],_e={class:"pt-4"};function Te(A,o,i,e,b,T){const m=f("TableHead"),u=f("TableRow"),y=f("TableHeader"),c=f("TableCell"),x=f("TableEmpty"),C=f("TableBody"),E=f("Table"),Q=f("Modal");return p(),_(M,null,[d("div",null,[t(e.PageHeading,{title:"QC Templates"},{default:l(()=>[t(e.Button,{onClick:o[0]||(o[0]=r=>e.FormManager(!0))},{default:l(()=>[...o[3]||(o[3]=[s("Add QC Template",-1)])]),_:1})]),_:1}),d("div",ue,[d("div",fe,[t(E,{class:"w-full caption-bottom text-sm"},{default:l(()=>[t(y,{class:"[&_tr]:border-b"},{default:l(()=>[t(u,{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:l(()=>[t(m,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...o[4]||(o[4]=[s("QC Template Name",-1)])]),_:1}),t(m,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...o[5]||(o[5]=[s("Quality Control level(s)",-1)])]),_:1}),t(m,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...o[6]||(o[6]=[s("Department(s)",-1)])]),_:1}),t(m,{class:"h-12 px-4 text-right align-middle font-medium text-muted-foreground"},{default:l(()=>[...o[7]||(o[7]=[s("Actions",-1)])]),_:1})]),_:1})]),_:1}),t(C,{class:"[&_tr:last-child]:border-0"},{default:l(()=>[(p(!0),_(M,null,D(e.qcTemplates,r=>(p(),q(u,{key:r?.uid,class:"border-b border-border/50 transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:l(()=>[t(c,{class:"px-4 py-3 align-middle text-sm"},{default:l(()=>[d("div",pe,v(r?.name),1),r?.description?(p(),_("div",ce,v(r?.description),1)):w("",!0)]),_:2},1024),t(c,{class:"px-4 py-3 align-middle text-sm text-foreground"},{default:l(()=>[s(v(e.levelsNames(r?.qcLevels??[])),1)]),_:2},1024),t(c,{class:"px-4 py-3 align-middle text-sm text-foreground"},{default:l(()=>[s(v(r?.category),1)]),_:2},1024),t(c,{class:"px-4 py-3 align-middle text-right"},{default:l(()=>[t(e.Button,{variant:"outline",size:"sm",onClick:g=>e.FormManager(!1,r)},{default:l(()=>[...o[8]||(o[8]=[s(" Edit ",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),e.qcTemplates?.length?w("",!0):(p(),q(x,{key:0,colspan:4},{default:l(()=>[t(e.Empty,{class:"border-0 bg-transparent p-0"},{default:l(()=>[t(e.EmptyContent,null,{default:l(()=>[t(e.EmptyHeader,null,{default:l(()=>[t(e.EmptyTitle,null,{default:l(()=>[...o[9]||(o[9]=[s("No QC templates found",-1)])]),_:1}),t(e.EmptyDescription,null,{default:l(()=>[...o[10]||(o[10]=[s("Add a QC template to get started.",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}))]),_:1})]),_:1})])])]),e.showModal?(p(),q(Q,{key:0,onClose:o[2]||(o[2]=r=>e.showModal=!1)},{header:l(()=>[d("h3",ge,v(e.formTitle),1)]),body:l(()=>[d("form",{onSubmit:o[1]||(o[1]=O((...r)=>e.saveForm&&e.saveForm(...r),["prevent"])),class:"p-6 space-y-6"},[d("div",ve,[t(e.FormField,{name:"name"},{default:l(({componentField:r})=>[t(e.FormItem,null,{default:l(()=>[t(e.FormLabel,null,{default:l(()=>[...o[11]||(o[11]=[s("QC Template Name",-1)])]),_:1}),t(e.FormControl,null,{default:l(()=>[t(e.Input,h(r,{placeholder:"Enter template name"}),null,16)]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1}),t(e.FormField,{name:"description"},{default:l(({componentField:r})=>[t(e.FormItem,null,{default:l(()=>[t(e.FormLabel,null,{default:l(()=>[...o[12]||(o[12]=[s("Description",-1)])]),_:1}),t(e.FormControl,null,{default:l(()=>[t(e.Textarea,h(r,{placeholder:"Enter template description",rows:"3"}),null,16)]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1}),t(e.FormField,{name:"qcLevels"},{default:l(({componentField:r})=>[t(e.FormItem,null,{default:l(()=>[t(e.FormLabel,null,{default:l(()=>[...o[13]||(o[13]=[s("Quality Control Sample Levels",-1)])]),_:1}),t(e.FormControl,null,{default:l(()=>[d("select",h({id:"controlLevels",class:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",multiple:""},r),[o[14]||(o[14]=d("option",{disabled:"",value:""},"Select QC Levels",-1)),(p(!0),_(M,null,D(e.qcLevels,g=>(p(),_("option",{key:g.uid,value:g,class:"py-1"},v(g.level),9,be))),128))],16)]),_:2},1024),o[15]||(o[15]=d("p",{class:"text-xs text-muted-foreground mt-1"},"Hold Ctrl/Cmd to select multiple levels",-1)),t(e.FormMessage)]),_:2},1024)]),_:1})]),d("div",_e,[t(e.Button,{type:"submit",class:"w-full"},{default:l(()=>[...o[16]||(o[16]=[s(" Save Changes ",-1)])]),_:1})])],32)]),_:1})):w("",!0)],64)}const ke=K(ie,[["render",Te],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/analyses/QCTemplates.vue"]]);export{ke as default};
