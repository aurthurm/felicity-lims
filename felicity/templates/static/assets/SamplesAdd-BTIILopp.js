import{a0 as Q,h as f,_ as G,c as r,o as l,A as e,E as S,J as v,K as x,L as p,Q as E,u as Ve,a4 as Re,f as Ae,a7 as I,g as re,e as K,i as Ue,a5 as Pe,bm as Me,r as ne,C as qe,a as w,F as R,a9 as O,a2 as T,M as Ee,D as B,P as J}from"./index-CNAOKjig.js";import{Multiselect as Ne}from"./vue-multiselect.esm-BoOjdWpS.js";import{u as Ie}from"./patient-DPjByMBc.js";import{u as Te}from"./analysis-CIDyy6YR.js";import{u as Be}from"./client-fmVydEyQ.js";import{u as Fe}from"./billing-B57sUqfU.js";import{u as ce}from"./setup-Cw0fY--X.js";import{_ as je}from"./analyses.mutations-BhfuTbLn.js";import{c as A,a as Le,g as ae,e as ie,d as q,u as Ye,b as U}from"./index.esm-BflgK3Uu.js";import{f as de}from"./index-zY702zsb.js";/* empty css                                                                 */import"./location-Cp7ZTBxF.js";import"./billing.queries-DCoxOTaV.js";const ze=Q({__name:"SampleCostBreakdown",props:{profiles:{type:Array,default:()=>[]},analyses:{type:Array,default:()=>[]},priceMap:{type:Map,required:!0},loading:{type:Boolean,default:!1}},setup(C,{expose:s}){s();const m=ce(),t=C,y=f(()=>m.getLaboratory?.settings?.currency??"USD"),h=a=>a==null?"N/A":new Intl.NumberFormat("en-US",{style:"currency",currency:y.value}).format(a),c=f(()=>t.profiles?.map(a=>({name:a.name,price:t.priceMap.get(`profile_${a.uid}`)??null}))??[]),b=f(()=>t.analyses?.map(a=>({name:a.name,price:t.priceMap.get(`analysis_${a.uid}`)??null}))??[]),o=f(()=>{let a=0;return c.value.forEach(k=>{k.price!==null&&(a+=k.price)}),b.value.forEach(k=>{k.price!==null&&(a+=k.price)}),a}),d={setupStore:m,props:t,currency:y,formatCurrency:h,profileCosts:c,analysisCosts:b,subtotal:o};return Object.defineProperty(d,"__isScriptSetup",{enumerable:!1,value:!0}),d}}),He={class:"space-y-2 text-sm"},Ke={key:0,class:"animate-pulse space-y-2"},Oe={key:1},Je={key:0,class:"space-y-1"},Qe={class:"text-foreground truncate flex-1 mr-2"},Ge={class:"text-foreground truncate flex-1 mr-2"},We={key:2,class:"border-t border-border pt-2 mt-2"},Xe={class:"flex justify-between items-center font-semibold"},Ze={class:"text-primary text-base"},$e={key:3,class:"text-muted-foreground italic"};function et(C,s,m,t,y,h){return l(),r("div",He,[m.loading?(l(),r("div",Ke,[...s[0]||(s[0]=[e("div",{class:"h-4 bg-muted rounded w-3/4"},null,-1),e("div",{class:"h-4 bg-muted rounded w-1/2"},null,-1),e("div",{class:"h-4 bg-muted rounded w-full"},null,-1)])])):(l(),r("div",Oe,[t.profileCosts.length>0?(l(),r("div",Je,[s[1]||(s[1]=e("div",{class:"text-xs font-semibold text-muted-foreground uppercase"},"Profiles",-1)),(l(!0),r(v,null,x(t.profileCosts,(c,b)=>(l(),r("div",{key:`profile-${b}`,class:"flex justify-between items-center"},[e("span",Qe,p(c.name),1),e("span",{class:E(c.price===null?"text-destructive":"text-foreground font-medium")},p(t.formatCurrency(c.price)),3)]))),128))])):S("",!0),t.analysisCosts.length>0?(l(),r("div",{key:1,class:E(["space-y-1",{"mt-3":t.profileCosts.length>0}])},[s[2]||(s[2]=e("div",{class:"text-xs font-semibold text-muted-foreground uppercase"},"Analyses",-1)),(l(!0),r(v,null,x(t.analysisCosts,(c,b)=>(l(),r("div",{key:`analysis-${b}`,class:"flex justify-between items-center"},[e("span",Ge,p(c.name),1),e("span",{class:E(c.price===null?"text-destructive":"text-foreground font-medium")},p(t.formatCurrency(c.price)),3)]))),128))],2)):S("",!0),t.profileCosts.length>0||t.analysisCosts.length>0?(l(),r("div",We,[e("div",Xe,[s[3]||(s[3]=e("span",{class:"text-foreground"},"Subtotal:",-1)),e("span",Ze,p(t.formatCurrency(t.subtotal)),1)])])):S("",!0),t.profileCosts.length===0&&t.analysisCosts.length===0?(l(),r("div",$e," No tests selected ")):S("",!0)]))])}const tt=G(ze,[["render",et],["__scopeId","data-v-d366cf69"],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/billing/SampleCostBreakdown.vue"]]),st=Q({__name:"CostSummary",props:{sampleCosts:{type:Array,required:!0},grandTotal:{type:Number,required:!0},currency:{type:String,default:"USD"},loading:{type:Boolean,default:!1}},setup(C,{expose:s}){s();const m=C,t=c=>new Intl.NumberFormat("en-US",{style:"currency",currency:m.currency}).format(c),y=f(()=>m.sampleCosts.some(c=>c.subtotal>0)),h={props:m,formatCurrency:t,hasCosts:y};return Object.defineProperty(h,"__isScriptSetup",{enumerable:!1,value:!0}),h}}),ot={class:"bg-muted rounded-lg p-6 mt-6 border border-border"},lt={key:0,class:"animate-pulse space-y-3"},rt={key:1},nt={class:"space-y-2 mb-4"},at={class:"text-foreground"},it={class:"font-medium text-foreground"},dt={class:"border-t border-border pt-4 mt-4"},ct={class:"flex justify-between items-center"},ut={class:"text-2xl font-bold text-primary"},mt={key:2,class:"text-muted-foreground italic text-sm"};function pt(C,s,m,t,y,h){return l(),r("div",ot,[s[3]||(s[3]=e("h3",{class:"text-lg font-semibold text-foreground mb-4"},"Cost Summary",-1)),m.loading?(l(),r("div",lt,[...s[0]||(s[0]=[e("div",{class:"h-4 bg-background rounded w-3/4"},null,-1),e("div",{class:"h-4 bg-background rounded w-1/2"},null,-1),e("div",{class:"h-6 bg-background rounded w-full mt-4"},null,-1)])])):t.hasCosts?(l(),r("div",rt,[e("div",nt,[(l(!0),r(v,null,x(m.sampleCosts,(c,b)=>(l(),r("div",{key:b,class:"flex justify-between items-center text-sm"},[e("span",at,"Sample "+p(b+1)+":",1),e("span",it,p(t.formatCurrency(c.subtotal)),1)]))),128))]),e("div",dt,[e("div",ct,[s[1]||(s[1]=e("span",{class:"text-xl font-bold text-foreground"},"Total:",-1)),e("span",ut,p(t.formatCurrency(m.grandTotal)),1)])]),s[2]||(s[2]=e("div",{class:"mt-4 text-xs text-muted-foreground italic"}," * Final cost may vary after discounts and adjustments are applied ",-1))])):(l(),r("div",mt," No tests selected. Add profiles or analyses to see cost breakdown. "))])}const ft=G(st,[["render",pt],["__scopeId","data-v-8d1e035b"],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/billing/CostSummary.vue"]]),bt=Q({__name:"SamplesAdd",setup(C,{expose:s}){s();const m=Ve(),t=Ie(),y=Te(),h=Be(),c=Fe(),b=ce(),o=Re(),{withClientMutation:d}=Ae(),{swalError:a}=Ue(),k=I(!1);let D=f(()=>t.getPatient),F=re({first:void 0,after:"",text:"",sortBy:["name"],contacts:!0});h.fetchClients(F);const ue=f(()=>h.getClients),j=I(null),me=n=>{j.value=n,z.value=null};m.fetchSampleTypes();const pe=f(()=>m.getSampleTypes);let L=re({first:void 0,after:"",text:"",sortBy:["name"]});y.fetchAnalysesServices(L);const fe=f(()=>{const n=y.getAnalysesServicesSimple;let i=new Set;return n.forEach((u,g)=>{u.profiles?.length===0&&i.add(u)}),[...i]});y.fetchAnalysesProfiles();const be=f(()=>y.getAnalysesProfiles),P=I(!1),ye=K().endOf("day").toDate(),W=A({clientRequestId:q().required("Client Request ID is Required"),clinicalData:A({clinicalIndication:q().nullable(),symptoms:ae().of(q()),symptomsRaw:q().nullable(),treatmentNotes:q().nullable(),pregnancyStatus:ie().nullable(),breastFeeding:ie().nullable(),vitals:A().nullable(),otherContext:A().nullable()}).nullable(),client:A().required("Client is Required"),clientContact:A().nullable().required("Client Contact is Required"),samples:ae().required().min(1,"Add at least 1 sample"),priority:Le()});function Y(n){return{sampleType:{},dateCollected:K(new Date),dateReceived:K(new Date),profiles:[],analyses:[],...n}}function X(){return{clinicalIndication:"",symptoms:[],symptomsRaw:"",treatmentNotes:"",pregnancyStatus:null,breastFeeding:null,vitals:{},otherContext:{}}}const{handleSubmit:Z,errors:ge}=Ye({validationSchema:W,initialValues:{priority:0,client:D?.value?.client,samples:[Y({})],clinicalData:X()}});D?.value?.client&&(j.value=D.value.client);const{value:ve}=U("clientRequestId"),{value:N}=U("clinicalData"),{value:$}=U("client"),{value:z}=U("clientContact"),{value:xe}=U("priority"),{value:V}=U("samples"),M=I(""),he=()=>{M.value.trim()&&!N.value?.symptoms?.includes(M.value.trim())&&(N.value?.symptoms?.push(M.value.trim()),M.value="")},_e=n=>{N.value?.symptoms?.splice(n,1)},we=Z(n=>{P.value=!0,console.log("values",n);for(let i of n.samples||[]){if([null,void 0,""].includes(i?.sampleType)){a("Samples must have sample types"),P.value=!1;return}if(i?.analyses?.length<=0&&i?.profiles?.length<=0){a("Samples must have either profiles/analyses or both"),P.value=!1;return}}ee(n)});function ee(n){const i={patientUid:D.value?.uid,clientRequestId:n.clientRequestId,clinicalData:n.clinicalData,clientUid:$?.value?.uid,clientContactUid:z?.value?.uid,samples:n.samples?.map(u=>({...u,profiles:u.profiles?.map(g=>g.uid),analyses:u.analyses?.map(g=>g.uid),sampleType:u.sampleType?.uid,dateCollected:de(u.dateCollected,"YYYY-MM-DD HH:mm"),dateReceived:de(u.dateReceived,"YYYY-MM-DD HH:mm")}))};console.log(i),d(je,{payload:i},"createAnalysisRequest").then(u=>{m.addAnalysisRequest(u),o.push({name:"patient-detail",params:{patientUid:D.value?.uid}})}).finally(()=>{P.value=!1})}function Se(){const n=Y({});V.value.push(n)}function Ce(n){V.value.length>1&&V.value.splice(n,1)}const ke=f(()=>V.value.length>1),te=f(()=>b.getLaboratory?.settings?.allowBilling??!1),H=f(()=>{const n=new Map;return c.profilePrices.forEach((i,u)=>{n.set(`profile_${u}`,i.amount)}),c.analysisPrices.forEach((i,u)=>{n.set(`analysis_${u}`,i.amount)}),n}),se=f(()=>V.value.map(n=>{let i=0;const u={profiles:[],analyses:[],subtotal:0};return n.profiles?.forEach(g=>{const _=H.value.get(`profile_${g.uid}`);_!==void 0&&(i+=_,u.profiles.push({name:g.name,price:_}))}),n.analyses?.forEach(g=>{const _=H.value.get(`analysis_${g.uid}`);_!==void 0&&(i+=_,u.analyses.push({name:g.name,price:_}))}),u.subtotal=i,u})),De=f(()=>se.value.reduce((n,i)=>n+i.subtotal,0)),oe=Me((n,i)=>{c.fetchBatchPrices(n,i)},300);Pe(()=>V.value.map(n=>({profiles:n.profiles?.map(i=>i.uid)??[],analyses:n.analyses?.map(i=>i.uid)??[]})),n=>{if(!te.value)return;const i=new Set,u=new Set;n.forEach(g=>{g.profiles.forEach(_=>i.add(_)),g.analyses.forEach(_=>u.add(_))}),(i.size>0||u.size>0)&&oe(Array.from(i),Array.from(u))},{deep:!0});const le={sampleStore:m,patientStore:t,analysisStore:y,clientStore:h,billingStore:c,setupStore:b,router:o,withClientMutation:d,swalError:a,clinicalDataExpanded:k,get patient(){return D},set patient(n){D=n},get clientParams(){return F},set clientParams(n){F=n},clients:ue,selectedClient:j,selectContact:me,sampleTypes:pe,get analysesParams(){return L},set analysesParams(n){L=n},analysesServices:fe,analysesProfiles:be,arSaving:P,maxDate:ye,arSchema:W,createDefaultSample:Y,createDefaultClinicalData:X,handleSubmit:Z,errors:ge,clientRequestId:ve,clinicalData:N,client:$,clientContact:z,priority:xe,samples:V,newSymptom:M,addSymptom:he,removeSymptom:_e,submitARForm:we,addAnalysesRequest:ee,addSample:Se,removeSample:Ce,canRemoveSample:ke,billingEnabled:te,priceMap:H,sampleCosts:se,grandTotal:De,debouncedFetchPrices:oe,contactLabel:n=>`${n.firstName} ${n.lastName}`,get VueMultiselect(){return Ne},SampleCostBreakdown:tt,CostSummary:ft};return Object.defineProperty(le,"__isScriptSetup",{enumerable:!1,value:!0}),le}}),yt={class:"space-y-6"},gt={class:"space-y-4"},vt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},xt={class:"flex items-center gap-x-4"},ht={class:"flex items-center gap-x-4"},_t={class:"text-sm text-destructive"},wt={class:"flex items-center gap-x-4"},St={class:"text-sm text-destructive"},Ct={class:"flex items-center gap-x-4"},kt={class:"text-sm text-destructive"},Dt={class:"border border-border rounded-lg bg-background/50"},Vt={key:0,class:"px-4 py-4 space-y-4 border-t border-border"},Rt={class:"flex items-center gap-x-4"},At={class:"flex flex-wrap mt-2"},Ut={class:"flex gap-2"},Pt=["onKeydown"],Mt={class:"flex flex-wrap gap-2 mt-2"},qt=["onClick"],Et={class:"flex items-center gap-x-4"},Nt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},It={class:"flex items-center gap-x-4"},Tt={class:"flex items-center gap-x-4"},Bt={id:"samples",class:"space-y-4"},Ft={class:"flex justify-between items-center"},jt={class:"flex items-center gap-4"},Lt={class:"text-sm text-destructive"},Yt={class:"relative border border-border rounded-lg bg-background/50 overflow-visible"},zt={class:"absolute left-0 top-0 bottom-0 w-48 bg-muted/30 border-r border-border z-10"},Ht={class:"w-full h-full"},Kt={key:0,class:"border-b border-border"},Ot={class:"overflow-x-auto overflow-y-visible pl-48"},Jt={class:"w-80 min-w-80"},Qt={class:"border-b border-border bg-muted/30"},Gt={class:"flex items-center justify-between"},Wt=["onClick","disabled","title"],Xt={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},Zt={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},$t={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},es={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},ts={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},ss={key:0,class:"border-b border-border hover:bg-muted/20"},os={class:"hover:bg-muted/20 h-24"},ls={class:"p-3 bg-muted/50 rounded-md text-sm space-y-1"},rs={key:0,class:"text-xs text-destructive whitespace-nowrap"},ns={key:1},as={class:"text-xs text-muted-foreground"},is={class:"text-xs text-muted-foreground"},ds={class:"flex justify-end pt-4"},cs={key:0,type:"submit",class:"px-6 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50"},us={key:1,class:"py-4 text-center"};function ms(C,s,m,t,y,h){const c=ne("VueDatePicker"),b=ne("fel-loader");return l(),r("div",yt,[s[37]||(s[37]=e("h5",{class:"text-xl font-semibold text-foreground mb-4"},"Add Analysis Request",-1)),e("form",{action:"post",class:"p-6 bg-background rounded-lg shadow-sm space-y-6",onSubmit:s[11]||(s[11]=B((...o)=>t.submitARForm&&t.submitARForm(...o),["prevent"]))},[e("div",gt,[e("div",vt,[e("label",xt,[s[12]||(s[12]=e("span",{class:"text-sm font-medium text-foreground"},"Client",-1)),w(t.VueMultiselect,{class:"w-full",placeholder:"Select a Client",modelValue:t.client,"onUpdate:modelValue":s[0]||(s[0]=o=>t.client=o),options:t.clients,searchable:!0,label:"name","track-by":"uid",onSelect:t.selectContact,"option-height":60,"close-on-select":!0},null,8,["modelValue","options"])]),e("label",ht,[s[13]||(s[13]=e("span",{class:"text-sm font-medium text-foreground whitespace-nowrap"},"Client Contact",-1)),w(t.VueMultiselect,{class:"w-full",placeholder:"Select a Client Contact",modelValue:t.clientContact,"onUpdate:modelValue":s[1]||(s[1]=o=>t.clientContact=o),options:t.selectedClient?.contacts??[],"custom-label":t.contactLabel,"track-by":"uid","close-on-select":!0,searchable:!0},null,8,["modelValue","options"]),e("div",_t,p(t.errors.clientContact),1)]),e("label",wt,[s[15]||(s[15]=e("span",{class:"text-sm font-medium text-foreground"},"Priority",-1)),R(e("select",{name:"priority",id:"priority","onUpdate:modelValue":s[2]||(s[2]=o=>t.priority=o),class:"w-full px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","aria-label":"Select priority level"},[...s[14]||(s[14]=[e("option",{value:"0"},"Low",-1),e("option",{value:"1"},"Medium",-1),e("option",{value:"2"},"High",-1)])],512),[[O,t.priority]]),e("div",St,p(t.errors.priority),1)])]),e("label",Ct,[s[16]||(s[16]=e("span",{class:"text-sm font-medium text-foreground whitespace-nowrap"},"Client Request ID",-1)),R(e("input",{class:"w-full px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","onUpdate:modelValue":s[3]||(s[3]=o=>t.clientRequestId=o),placeholder:"CRID ..."},null,512),[[T,t.clientRequestId]]),e("div",kt,p(t.errors.clientRequestId),1)]),e("div",Dt,[e("button",{type:"button",onClick:s[4]||(s[4]=o=>t.clinicalDataExpanded=!t.clinicalDataExpanded),class:"w-full px-4 py-3 flex items-center justify-between text-left hover:bg-muted/20 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50 rounded-t-lg"},[s[18]||(s[18]=e("span",{class:"text-sm font-medium text-foreground whitespace-nowrap"},"Clinical Data (click to expand)",-1)),(l(),r("svg",{class:E(["w-5 h-5 transition-transform duration-200",{"rotate-180":t.clinicalDataExpanded}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...s[17]||(s[17]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),t.clinicalDataExpanded?(l(),r("div",Vt,[e("label",Rt,[s[19]||(s[19]=e("span",{class:"text-sm font-medium text-foreground whitespace-nowrap w-40"},"Clinical Indication",-1)),R(e("input",{class:"w-full px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","onUpdate:modelValue":s[5]||(s[5]=o=>t.clinicalData.clinicalIndication=o),placeholder:"Enter clinical indication..."},null,512),[[T,t.clinicalData.clinicalIndication]])]),e("div",At,[s[20]||(s[20]=e("span",{class:"text-sm font-medium text-foreground w-40"},"Symptoms",-1)),e("div",Ut,[R(e("input",{class:"flex-1 px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","onUpdate:modelValue":s[6]||(s[6]=o=>t.newSymptom=o),placeholder:"Add symptom...",onKeydown:Ee(B(t.addSymptom,["prevent","stop"]),["enter"])},null,40,Pt),[[T,t.newSymptom]]),e("button",{type:"button",onClick:t.addSymptom,class:"px-3 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50"}," Add ")]),e("div",Mt,[(l(!0),r(v,null,x(t.clinicalData.symptoms,(o,d)=>(l(),r("span",{key:d,class:"inline-flex items-center gap-1 px-2 py-1 bg-muted text-muted-foreground rounded-md text-sm"},[J(p(o)+" ",1),e("button",{type:"button",onClick:a=>t.removeSymptom(d),class:"text-destructive hover:text-destructive/80 ml-1"}," × ",8,qt)]))),128))])]),e("label",Et,[s[21]||(s[21]=e("span",{class:"text-sm font-medium text-foreground whitespace-nowrap w-40"},"Treatment Notes",-1)),R(e("textarea",{class:"w-full px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","onUpdate:modelValue":s[7]||(s[7]=o=>t.clinicalData.treatmentNotes=o),placeholder:"Enter treatment notes...",rows:"2"},null,512),[[T,t.clinicalData.treatmentNotes]])]),e("div",Nt,[e("label",It,[s[23]||(s[23]=e("span",{class:"text-sm font-medium text-foreground whitespace-nowrap w-40"},"Pregnancy Status",-1)),R(e("select",{"onUpdate:modelValue":s[8]||(s[8]=o=>t.clinicalData.pregnancyStatus=o),class:"w-full ml-4 px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50"},[...s[22]||(s[22]=[e("option",{value:null},"Not specified",-1),e("option",{value:!0},"Pregnant",-1),e("option",{value:!1},"Not pregnant",-1)])],512),[[O,t.clinicalData.pregnancyStatus]])]),e("label",Tt,[s[25]||(s[25]=e("span",{class:"text-sm font-medium text-foreground whitespace-nowrap w-40"},"Breastfeeding Status",-1)),R(e("select",{"onUpdate:modelValue":s[9]||(s[9]=o=>t.clinicalData.breastFeeding=o),class:"w-full px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50"},[...s[24]||(s[24]=[e("option",{value:null},"Not specified",-1),e("option",{value:!0},"Breastfeeding",-1),e("option",{value:!1},"Not breastfeeding",-1)])],512),[[O,t.clinicalData.breastFeeding]])])])])):S("",!0)])]),e("section",Bt,[e("div",Ft,[s[26]||(s[26]=e("h5",{class:"text-lg font-semibold text-foreground"},"Samples",-1)),e("div",jt,[e("span",Lt,p(t.errors.samples),1),t.samples?.length!==20?(l(),r("button",{key:0,type:"button",onClick:s[10]||(s[10]=B(o=>t.addSample(),["prevent"])),class:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50"}," Add Sample ")):S("",!0)])]),e("div",Yt,[e("div",zt,[e("table",Ht,[s[34]||(s[34]=e("thead",null,[e("tr",{class:"border-b border-border bg-muted/30"},[e("th",{class:"p-4 text-left text-sm font-medium text-foreground h-16"}," Field ")])],-1)),e("tbody",null,[s[28]||(s[28]=e("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[e("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Sample Type ")],-1)),s[29]||(s[29]=e("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[e("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Date Collected ")],-1)),s[30]||(s[30]=e("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[e("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Date Received ")],-1)),s[31]||(s[31]=e("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[e("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Analysis Profiles ")],-1)),s[32]||(s[32]=e("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[e("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Analysis Services ")],-1)),t.billingEnabled?(l(),r("tr",Kt,[...s[27]||(s[27]=[e("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Cost Breakdown ",-1)])])):S("",!0),s[33]||(s[33]=e("tr",{class:"h-24"},[e("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Selection Summary ")],-1))])])]),e("div",Ot,[e("table",Jt,[e("thead",null,[e("tr",Qt,[(l(!0),r(v,null,x(t.samples,(o,d)=>(l(),r("th",{key:d,class:"p-4 text-center text-sm font-medium text-foreground w-80 min-w-80 relative h-16 border-r"},[e("div",Gt,[e("span",null,"Sample "+p(d+1),1),e("button",{type:"button",onClick:B(a=>t.removeSample(d),["prevent"]),disabled:!t.canRemoveSample,class:E(["px-2 py-1 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 text-xs ml-2",t.canRemoveSample?"bg-destructive text-destructive-foreground hover:bg-destructive/90 focus:ring-destructive/50":"bg-muted text-muted-foreground cursor-not-allowed"]),title:t.canRemoveSample?"Remove sample":"At least one sample is required"}," Remove ",10,Wt)])]))),128))])]),e("tbody",null,[e("tr",Xt,[(l(!0),r(v,null,x(t.samples,(o,d)=>(l(),r("td",{key:d,class:"p-4 w-80 border-r"},[w(t.VueMultiselect,{class:"w-full",placeholder:"Select sample type",modelValue:o.sampleType,"onUpdate:modelValue":a=>o.sampleType=a,options:t.sampleTypes,searchable:!0,label:"name","track-by":"uid",openDirection:"below"},null,8,["modelValue","onUpdate:modelValue","options"])]))),128))]),e("tr",Zt,[(l(!0),r(v,null,x(t.samples,(o,d)=>(l(),r("td",{key:d,class:"p-4 w-80 border-r"},[w(c,{class:"w-full",modelValue:o.dateCollected,"onUpdate:modelValue":a=>o.dateCollected=a,"max-date":t.maxDate,"time-picker-inline":"",teleport:!0},null,8,["modelValue","onUpdate:modelValue","max-date"])]))),128))]),e("tr",$t,[(l(!0),r(v,null,x(t.samples,(o,d)=>(l(),r("td",{key:d,class:"p-4 w-80 border-r"},[w(c,{class:"w-full",modelValue:o.dateReceived,"onUpdate:modelValue":a=>o.dateReceived=a,"min-date":o.dateCollected&&typeof o.dateCollected=="object"&&!(o.dateCollected instanceof Date)&&typeof o.dateCollected.toDate=="function"?o.dateCollected.toDate():o.dateCollected||null,"max-date":t.maxDate,"time-picker-inline":"",teleport:!0},null,8,["modelValue","onUpdate:modelValue","min-date","max-date"])]))),128))]),e("tr",es,[(l(!0),r(v,null,x(t.samples,(o,d)=>(l(),r("td",{key:d,class:"p-4 w-80 border-r"},[w(t.VueMultiselect,{class:"w-full whitespace-nowrap z-10",placeholder:"Select analysis profiles",modelValue:o.profiles,"onUpdate:modelValue":a=>o.profiles=a,options:t.analysesProfiles,searchable:!0,multiple:!0,label:"name","track-by":"uid",openDirection:"below"},null,8,["modelValue","onUpdate:modelValue","options"])]))),128))]),e("tr",ts,[(l(!0),r(v,null,x(t.samples,(o,d)=>(l(),r("td",{key:d,class:"p-4 w-80 border-r"},[w(t.VueMultiselect,{class:"w-full whitespace-nowrap",placeholder:"Select analysis services",modelValue:o.analyses,"onUpdate:modelValue":a=>o.analyses=a,options:t.analysesServices,searchable:!0,multiple:!0,label:"name","track-by":"uid",openDirection:"below"},null,8,["modelValue","onUpdate:modelValue","options"])]))),128))]),t.billingEnabled?(l(),r("tr",ss,[(l(!0),r(v,null,x(t.samples,(o,d)=>(l(),r("td",{key:d,class:"p-4 w-80 border-r align-top"},[w(t.SampleCostBreakdown,{profiles:o.profiles,analyses:o.analyses,"price-map":t.priceMap,loading:t.billingStore.fetchingPrices},null,8,["profiles","analyses","price-map","loading"])]))),128))])):S("",!0),e("tr",os,[(l(!0),r(v,null,x(t.samples,(o,d)=>(l(),r("td",{key:d,class:"p-4 w-80 border-r"},[e("div",ls,[o.profiles?.length===0&&o.analyses?.length===0?(l(),r("div",rs," ⚠️ Select profiles or services ")):(l(),r("div",ns,[e("div",as,[s[35]||(s[35]=e("strong",null,"Profiles:",-1)),J(" "+p(o.profiles?.length||0)+" selected ",1)]),e("div",is,[s[36]||(s[36]=e("strong",null,"Services:",-1)),J(" "+p(o.analyses?.length||0)+" selected ",1)])]))])]))),128))])])])])])]),t.billingEnabled?(l(),qe(t.CostSummary,{key:0,"sample-costs":t.sampleCosts,"grand-total":t.grandTotal,currency:t.setupStore.getLaboratory?.settings?.currency??"USD",loading:t.billingStore.fetchingPrices},null,8,["sample-costs","grand-total","currency","loading"])):S("",!0),e("div",ds,[t.arSaving?(l(),r("div",us,[w(b,{message:"Adding Samples ..."})])):(l(),r("button",cs," Save Sample(s) "))])],32)])}const Vs=G(bt,[["render",ms],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/sample/SamplesAdd.vue"]]);export{Vs as default};
