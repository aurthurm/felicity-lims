import{S as z,b$ as xe,O as we,d as Ue,aa as Re,L as Ce,aL as Se,ah as Ee,r as u,D as Ae,C as Te,z as Ve,n as Y,o as n,c as a,e as r,b as e,H as I,i as G,ad as K,f as d,F as f,p as g,t as i,ac as x,g as De,G as J,w as p,E as h,y as Q,x as X,q as We,v as Be,j as Ne,_ as $e,a$ as Oe,k as Ie}from"./index-2a6c9271.js";import{u as Ke}from"./analysis-48dc782c.js";import{u as Me}from"./samples-f733dee1.js";import{h as w,o as U,a as R}from"./constants-b0c30fb3.js";function Pe(){const{withClientMutation:M}=we();return{unAssignSamples:async v=>{try{z.fire({title:"Are you sure?",text:"You want to Un-Assign these analyses",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Un-Assign now!",cancelButtonText:"No, cancel UnAssign!"}).then(async m=>{m.isConfirmed&&(await M(xe,v,"updateWorksheet").then(C=>{}),z.fire("Its Happening!","Selected analyses have been UnAssigned.","success").then(C=>location.reload()))})}catch{}}}}const He={class:""},je=e("hr",{class:"mt-4"},null,-1),qe={class:"flex justify-between items-center"},Le={for:"toggle",class:"text-medium text-gray-700 my-4"},Fe={class:"relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in"},ze=e("label",{for:"toggle",class:"toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"},null,-1),Ye={action:"post",class:"p-1"},Ge={class:"flex justify-start items-center mb-4"},Je={class:"flex justify-between items-center"},Qe=e("span",{class:"text-gray-700 mr-2"},"Analyst",-1),Xe=["value"],Ze={class:"flex justify-between items-center ml-4"},et=e("span",{class:"text-gray-700 mr-2"},"Instrument",-1),tt=["value"],st={class:"flex justify-between items-center ml-4"},ot=e("span",{class:"text-gray-700 mr-2"},"Method",-1),nt=["value"],at={class:"ml-6 mt-2"},lt=e("hr",{class:"mb-4"},null,-1),rt={class:"overflow-x-auto"},it={class:"align-middle inline-block min-w-full shadow overflow-hidden bg-white shadow-dashboard px-2 pt-1 rounded-bl-lg rounded-br-lg"},dt={class:"min-w-full"},ut={class:"px-1 py-1 border-b-2 border-gray-300 text-left leading-4 text-gray-800 tracking-wider"},ct=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left leading-4 text-gray-800 tracking-wider"},null,-1),pt=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left leading-4 text-gray-800 tracking-wider"}," Sample ID ",-1),ht=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Analysis/Test ",-1),mt=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Instrument ",-1),yt=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Method ",-1),bt=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Interim ",-1),_t=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Result ",-1),ft=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Unit ",-1),gt=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Status ",-1),vt={class:"bg-white"},kt=["onUpdate:modelValue","disabled"],xt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},wt=e("i",{class:"fa fa-star"},null,-1),Ut=[wt],Rt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Ct={class:"text-sm leading-5 text-gray-800 font-semibold"},St={key:1},Et={key:0},At={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Tt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Vt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Dt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Wt={key:0,class:"text-sm leading-5 text-sky-800"},Bt={key:1,class:"block col-span-2 mb-2"},Nt=["onUpdate:modelValue","onChange"],$t=e("option",{value:""},null,-1),Ot=["value"],It={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Kt={key:0},Mt={key:1,class:"block"},Pt=["onUpdate:modelValue","onKeyup"],Ht={key:2,class:"block col-span-2 mb-2"},jt=["onUpdate:modelValue","onChange"],qt=e("option",{value:""},null,-1),Lt=["value"],Ft={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},zt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Yt={type:"button",class:"bg-sky-800 text-white py-1 px-2 rounded-sm leading-none"},Gt={class:"my-4"},Jt=Ue({__name:"WorkSheetResults",setup(M){const P=Ne(()=>$e(()=>import("./Button-21c3372d.js"),["assets/Button-21c3372d.js","assets/index-2a6c9271.js","assets/index-88806377.css"])),v=Re(),m=Ce(),C=Se(),H=Ee();let D=u(!1),W=u(!1),B=u(!1),N=u(!1),$=u(!1),O=u(!1),y=u(!1),k=u(!1),b=Ae(()=>v.getWorkSheet);const j=()=>{v.fetchWorksheetByUid(H.params.workSheetUid)};C.fetchUsers({}),m.fetchInstruments(),m.fetchMethods();const _=Te({analystUid:void 0,instrumentUid:void 0,methodUid:void 0}),S=u(!1),Z=()=>{S.value=!0,v.updateWorksheet({worksheetUid:H.params.workSheetUid,..._}).then(()=>{S.value=!1,j()})};function ee(){return b.value?.analysisResults?.every(o=>o.checked===!0)}function E(){let o=[];return b.value?.analysisResults?.forEach(s=>{s.checked&&o.push(s)}),o}function te(){ee()?y.value=!0:y.value=!1,V()}function A(o){if(q(o)){L(o);return}o.checked=!0,V()}function q(o){return["retracted","approved"].includes(o.status)}function L(o){o.checked=!1,V()}function se(){b?.value?.analysisResults?.forEach(o=>y.value?A(o):L(o)),V()}function oe(o){o.editable=!0}function F(o){return o.status!=="pending"?!1:o?.editable||Oe(o?.result)?(oe(o),!0):!1}function ne(){let o=E(),s=[];return o?.forEach(c=>s.push({uid:c.uid,result:c.result})),s}function T(){const o=E();let s=[];return o?.forEach(c=>s.push(c.uid)),s}function ae(){const o=E();let s=[];return o?.forEach(c=>s.push(c.sampleUid)),s}function le(o){switch(o?.status){case"retracted":return"bg-gray-300 text-sm italic text-gray-500";case"pending":return o?.retest===!0?"bg-sky-800 text-sm leading-5 text-sky-800":"";case"resulted":return o?.retest===!0?"bg-sky-800 text-sm leading-5 text-sky-800":"";case"approved":return o?.retest===!0?"bg-sky-800 text-sm leading-5 text-sky-800":"";default:return"text-sm leading-5 text-sky-800"}}function V(){D.value=!1,$.value=!1,W.value=!1,B.value=!1,N.value=!1,O.value=!1;const o=E();o.length!==0&&(O.value=!0,o.every(s=>s.status==="pending")&&(D.value=!0,$.value=!0),o.every(s=>s.status==="resulted")&&(W.value=!0,B.value=!0,N.value=!0))}const{submitResults:re,approveResults:ie,retractResults:de,retestResults:ue}=Ke(),{barcodeSamples:ce}=Me(),{unAssignSamples:pe}=Pe(),he=()=>pe(T()),me=()=>re(ne(),"worksheet",b.value?.uid),ye=()=>ie(T(),"worksheet",b.value?.uid),be=()=>de(T()),_e=()=>ue(T()),fe=async()=>await ce(ae());return(o,s)=>{const c=Ve("router-link"),ge=Y("motion-slide-left"),ve=Y("motion-slide-right");return n(),a("div",He,[je,r((n(),a("div",qe,[e("label",Le,[I("More Sample Detail "),e("div",Fe,[r(e("input",{type:"checkbox",name:"toggle",id:"toggle","onUpdate:modelValue":s[0]||(s[0]=t=>G(k)?k.value=t:k=t),class:"toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer outline-none"},null,512),[[K,d(k)]]),ze])]),r(e("form",Ye,[e("div",Ge,[e("label",Je,[Qe,r(e("select",{name:"instrument_uid","onUpdate:modelValue":s[1]||(s[1]=t=>_.analystUid=t),class:"form-input mt-1 block w-full py-1"},[(n(!0),a(f,null,g(d(C).users,t=>(n(),a("option",{key:t.uid,value:t.uid},i(t.firstName)+" "+i(t.lastName),9,Xe))),128))],512),[[x,_.analystUid]])]),e("label",Ze,[et,r(e("select",{name:"instrument_uid","onUpdate:modelValue":s[2]||(s[2]=t=>_.instrumentUid=t),class:"form-input mt-1 block w-full py-1"},[(n(!0),a(f,null,g(d(m).instruments,t=>(n(),a("option",{key:t.uid,value:t.uid},i(t.name),9,tt))),128))],512),[[x,_.instrumentUid]])]),e("label",st,[ot,r(e("select",{name:"method_uid","onUpdate:modelValue":s[3]||(s[3]=t=>_.methodUid=t),class:"form-input mt-1 block w-full py-1"},[(n(!0),a(f,null,g(d(m).methods,t=>(n(),a("option",{key:t.uid,value:t.uid},i(t.name),9,nt))),128))],512),[[x,_.methodUid]])]),e("div",at,[De(d(P),{onClick:s[4]||(s[4]=p(t=>Z(),["prevent"])),color:"sky-800",class:"p-1"},{default:J(()=>[I("Apply")]),_:1})])])],512),[[h,!S.value]]),r(e("p",null,"updating ...",512),[[h,S.value]]),e("div",null,[e("button",{onClick:s[5]||(s[5]=p(t=>j(),["prevent"])),class:"px-1 py-1 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Refresh ")])])),[[ge]]),lt,e("div",rt,[e("div",it,[e("table",dt,[e("thead",null,[e("tr",null,[e("th",ut,[r(e("input",{type:"checkbox",class:"",onChange:s[6]||(s[6]=t=>se()),"onUpdate:modelValue":s[7]||(s[7]=t=>G(y)?y.value=t:y=t)},null,544),[[K,d(y)]])]),ct,pt,ht,mt,yt,bt,_t,ft,gt])]),e("tbody",vt,[(n(!0),a(f,null,g(d(b)?.analysisResults,t=>r((n(),a("tr",{key:t.uid,class:Q([le(t)])},[e("td",null,[r(e("input",{type:"checkbox",class:"","onUpdate:modelValue":l=>t.checked=l,onChange:s[8]||(s[8]=l=>te()),disabled:q(t)},null,40,kt),[[K,t.checked]])]),e("td",xt,[t?.sample?.priority>0?(n(),a("span",{key:0,class:Q(["font-small",{"text-orange-600":d(b)?.priority>1}])},[...Ut],2)):X("",!0)]),e("td",Rt,[e("div",Ct,[t?.sample?.analysisRequest?.patient?.uid?(n(),We(c,{key:0,to:{name:"sample-detail",params:{patientUid:t?.sample?.analysisRequest?.patient?.uid,sampleUid:t?.sample?.uid}}},{default:J(()=>[I(i(t?.sample?.sampleId),1)]),_:2},1032,["to"])):(n(),a("div",St,i(t?.sample?.sampleId),1))]),d(k)?(n(),a("span",Et,[e("span",null,i(t?.sample?.qcLevel?.level),1),e("div",null,i(t?.sample?.analysisRequest?.patient?.firstName)+" "+i(t?.sample?.analysisRequest?.patient?.lastName),1),e("div",null,i(t?.sample?.analysisRequest?.client?.name),1)])):X("",!0)]),e("td",At,[e("div",null,i(t?.analysis?.name),1)]),e("td",Tt,[e("div",null,i(t?.instrument?.name||"None"),1)]),e("td",Vt,[e("div",null,i(t?.method?.name||"None"),1)]),e("td",Dt,[!F(t)||(t?.analysis?.interims?.length??0)===0?(n(),a("div",Wt," --- ")):(n(),a("label",Bt,[r(e("select",{class:"form-input mt-1 block w-full","onUpdate:modelValue":l=>t.result=l,onChange:l=>A(t)},[$t,(n(!0),a(f,null,g(t?.analysis?.interims,(l,ke)=>(n(),a("option",{key:l.key,value:l.value},i(l.value),9,Ot))),128))],40,Nt),[[x,t.result]])]))]),e("td",It,[F(t)?t?.analysis?.resultOptions?.length===0?(n(),a("label",Mt,[r(e("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":l=>t.result=l,onKeyup:l=>A(t)},null,40,Pt),[[Be,t.result]])])):(n(),a("label",Ht,[r(e("select",{class:"form-input mt-1 block w-full","onUpdate:modelValue":l=>t.result=l,onChange:l=>A(t)},[qt,(n(!0),a(f,null,g(t?.analysis?.resultOptions,(l,ke)=>(n(),a("option",{key:l.optionKey,value:l.value},i(l.value),9,Lt))),128))],40,jt),[[x,t.result]])])):(n(),a("div",Kt,i(t?.result),1))]),e("td",Ft,[e("div",null,i(t?.analysis?.unit?.name||"---"),1)]),e("td",zt,[e("button",Yt,i(t?.status||"unknown"),1)])],2)),[[ve]])),128))])])])]),e("section",Gt,[r(e("button",{onClick:s[9]||(s[9]=p(t=>he(),["prevent"])),class:"px-2 py-1 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Un Assign ",512),[[h,w(R.CREATE,U.WORKSHEET)&&d($)]]),r(e("button",{onClick:s[10]||(s[10]=p(t=>me(),["prevent"])),class:"px-2 py-1 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Submit ",512),[[h,w(R.UPDATE,U.WORKSHEET)&&d(D)]]),r(e("button",{onClick:s[11]||(s[11]=p(t=>be(),["prevent"])),class:"px-2 py-1 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Retract ",512),[[h,w(R.UPDATE,U.WORKSHEET)&&d(W)]]),r(e("button",{onClick:s[12]||(s[12]=p(t=>ye(),["prevent"])),class:"px-2 py-1 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Approve ",512),[[h,w(R.UPDATE,U.WORKSHEET)&&d(B)]]),r(e("button",{onClick:s[13]||(s[13]=p(t=>_e(),["prevent"])),class:"px-2 py-1 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Retest ",512),[[h,w(R.UPDATE,U.WORKSHEET)&&d(N)]]),r(e("button",{onClick:p(fe,["prevent"]),class:"px-2 py-1 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Print Barcodes ",512),[[h,d(O)]])])])}}}),ts=Ie(Jt,[["__file","/home/aurthur/Documents/Development/felicity-lims/webapp/views/worksheet/_id/WorkSheetResults.vue"]]);export{ts as default};
