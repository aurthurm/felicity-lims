import{Y as Q,a7 as _,_ as W,c as m,o as n,z as s,C as I,F as h,H as F,I as k,N as z,P as he,$ as Fe,u as ke,a0 as E,av as ne,f as Z,an as de,c3 as De,a3 as Ve,r as B,A as w,a as l,K as a,M as i,a4 as G,J as Ie,B as L}from"./index-OdhKCqIc.js";import{Multiselect as Te}from"./vue-multiselect.esm-Cvm3ZCjW.js";import{u as Ae}from"./patient-BGl7pq_l.js";import{u as Re}from"./analysis-PB9AMevg.js";import{u as Me}from"./client-BNZY_Y1e.js";import{u as Pe}from"./billing-COaJ61t1.js";import{u as ce}from"./setup-BcFG_bXr.js";import{S as Ue}from"./Spinner-Bl8RfjFA.js";import{Z as Be}from"./analyses.mutations-DUxQZn1r.js";import{c as A,e as j,i as ie,d as Ne,f as me,a as q,u as qe,F as Ee}from"./index.esm-BfHj8iGm.js";import{f as ue}from"./index-CXV6PIcj.js";import{I as Le}from"./Input-BEm5S0CJ.js";import{T as je}from"./Textarea-T3VcJTEo.js";import{F as ze,a as He,b as Ye}from"./FormMessage-CgXFMXx9.js";import{F as Ke}from"./FormLabel-DxP9wnWS.js";import{S as Oe,a as Je,b as Ze,c as Ge,d as Qe}from"./SelectValue-Ds0cfAgl.js";/* empty css                                                                 */import"./location-zigt6URg.js";import"./billing.queries-CxKPIhZs.js";import"./Label-CS46LzLb.js";import"./useNonce-B4v0IDPb.js";import"./chevron-down-Dqf-ptA3.js";import"./useFocusGuards-Bjb6OG0k.js";import"./PopperContent-BfyCnGUj.js";const We=Q({__name:"SampleCostBreakdown",props:{profiles:{type:Array,default:()=>[]},analyses:{type:Array,default:()=>[]},priceMap:{type:Map,required:!0},loading:{type:Boolean,default:!1}},setup(R,{expose:t}){t();const g=ce(),e=R,C=_(()=>g.getLaboratory?.settings?.currency??"USD"),D=y=>y==null?"N/A":new Intl.NumberFormat("en-US",{style:"currency",currency:C.value}).format(y),b=_(()=>e.profiles?.map(y=>({name:y.name,price:e.priceMap.get(`profile_${y.uid}`)??null}))??[]),c=_(()=>e.analyses?.map(y=>({name:y.name,price:e.priceMap.get(`analysis_${y.uid}`)??null}))??[]),M=_(()=>{let y=0;return b.value.forEach(v=>{v.price!==null&&(y+=v.price)}),c.value.forEach(v=>{v.price!==null&&(y+=v.price)}),y}),p={setupStore:g,props:e,currency:C,formatCurrency:D,profileCosts:b,analysisCosts:c,subtotal:M};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}}),Xe={class:"space-y-2 text-sm"},$e={key:0,class:"animate-pulse space-y-2"},et={key:1},tt={key:0,class:"space-y-1"},lt={class:"text-foreground truncate flex-1 mr-2"},at={class:"text-foreground truncate flex-1 mr-2"},ot={key:2,class:"border-t border-border pt-2 mt-2"},rt={class:"flex justify-between items-center font-semibold"},st={class:"text-primary text-base"},nt={key:3,class:"text-muted-foreground italic"};function dt(R,t,g,e,C,D){return n(),m("div",Xe,[g.loading?(n(),m("div",$e,[...t[0]||(t[0]=[s("div",{class:"h-4 bg-muted rounded w-3/4"},null,-1),s("div",{class:"h-4 bg-muted rounded w-1/2"},null,-1),s("div",{class:"h-4 bg-muted rounded w-full"},null,-1)])])):(n(),m("div",et,[e.profileCosts.length>0?(n(),m("div",tt,[t[1]||(t[1]=s("div",{class:"text-xs font-semibold text-muted-foreground uppercase"},"Profiles",-1)),(n(!0),m(h,null,F(e.profileCosts,(b,c)=>(n(),m("div",{key:`profile-${c}`,class:"flex justify-between items-center"},[s("span",lt,k(b.name),1),s("span",{class:z(b.price===null?"text-destructive":"text-foreground font-medium")},k(e.formatCurrency(b.price)),3)]))),128))])):I("",!0),e.analysisCosts.length>0?(n(),m("div",{key:1,class:z(["space-y-1",{"mt-3":e.profileCosts.length>0}])},[t[2]||(t[2]=s("div",{class:"text-xs font-semibold text-muted-foreground uppercase"},"Analyses",-1)),(n(!0),m(h,null,F(e.analysisCosts,(b,c)=>(n(),m("div",{key:`analysis-${c}`,class:"flex justify-between items-center"},[s("span",at,k(b.name),1),s("span",{class:z(b.price===null?"text-destructive":"text-foreground font-medium")},k(e.formatCurrency(b.price)),3)]))),128))],2)):I("",!0),e.profileCosts.length>0||e.analysisCosts.length>0?(n(),m("div",ot,[s("div",rt,[t[3]||(t[3]=s("span",{class:"text-foreground"},"Subtotal:",-1)),s("span",st,k(e.formatCurrency(e.subtotal)),1)])])):I("",!0),e.profileCosts.length===0&&e.analysisCosts.length===0?(n(),m("div",nt," No tests selected ")):I("",!0)]))])}const it=W(We,[["render",dt],["__scopeId","data-v-d366cf69"],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/components/billing/SampleCostBreakdown.vue"]]),mt=Q({__name:"CostSummary",props:{sampleCosts:{type:Array,required:!0},grandTotal:{type:Number,required:!0},currency:{type:String,default:"USD"},loading:{type:Boolean,default:!1}},setup(R,{expose:t}){t();const g=R,e=b=>new Intl.NumberFormat("en-US",{style:"currency",currency:g.currency}).format(b),C=_(()=>g.sampleCosts.some(b=>b.subtotal>0)),D={props:g,formatCurrency:e,hasCosts:C};return Object.defineProperty(D,"__isScriptSetup",{enumerable:!1,value:!0}),D}}),ut={class:"bg-muted rounded-lg p-6 mt-6 border border-border"},ct={key:0,class:"animate-pulse space-y-3"},ft={key:1},bt={class:"space-y-2 mb-4"},pt={class:"text-foreground"},gt={class:"font-medium text-foreground"},yt={class:"border-t border-border pt-4 mt-4"},vt={class:"flex justify-between items-center"},St={class:"text-2xl font-bold text-primary"},_t={key:2,class:"text-muted-foreground italic text-sm"};function xt(R,t,g,e,C,D){return n(),m("div",ut,[t[3]||(t[3]=s("h3",{class:"text-lg font-semibold text-foreground mb-4"},"Cost Summary",-1)),g.loading?(n(),m("div",ct,[...t[0]||(t[0]=[s("div",{class:"h-4 bg-background rounded w-3/4"},null,-1),s("div",{class:"h-4 bg-background rounded w-1/2"},null,-1),s("div",{class:"h-6 bg-background rounded w-full mt-4"},null,-1)])])):e.hasCosts?(n(),m("div",ft,[s("div",bt,[(n(!0),m(h,null,F(g.sampleCosts,(b,c)=>(n(),m("div",{key:c,class:"flex justify-between items-center text-sm"},[s("span",pt,"Sample "+k(c+1)+":",1),s("span",gt,k(e.formatCurrency(b.subtotal)),1)]))),128))]),s("div",yt,[s("div",vt,[t[1]||(t[1]=s("span",{class:"text-xl font-bold text-foreground"},"Total:",-1)),s("span",St,k(e.formatCurrency(g.grandTotal)),1)])]),t[2]||(t[2]=s("div",{class:"mt-4 text-xs text-muted-foreground italic"}," * Final cost may vary after discounts and adjustments are applied ",-1))])):(n(),m("div",_t," No tests selected. Add profiles or analyses to see cost breakdown. "))])}const Ct=W(mt,[["render",xt],["__scopeId","data-v-8d1e035b"],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/components/billing/CostSummary.vue"]]),wt=Q({__name:"SamplesAdd",setup(R,{expose:t}){t();const g=he(),e=Ae(),C=Re(),D=Me(),b=Pe(),c=ce(),M=Fe(),{withClientMutation:p}=ke(),y=E(!1);let v=_(()=>e.getPatient),N=ne({first:void 0,after:"",text:"",sortBy:["name"],contacts:!0});D.fetchClients(N);const o=_(()=>D.getClients),d=E(null),S=r=>{d.value=r,P("clientContact",null)};g.fetchSampleTypes();const fe=_(()=>g.getSampleTypes);let H=ne({first:void 0,after:"",text:"",sortBy:["name"]});C.fetchAnalysesServices(H);const be=_(()=>{const r=C.getAnalysesServicesSimple;let u=new Set;return r.forEach((f,x)=>{f.profiles?.length===0&&u.add(f)}),[...u]});C.fetchAnalysesProfiles();const pe=_(()=>C.getAnalysesProfiles),Y=E(!1),ge=Z().endOf("day").toDate(),X=A({sampleType:A().required("Sample type is required").test("sample-type-uid","Sample type is required",r=>!!r?.uid),dateCollected:ie().nullable(),dateReceived:ie().nullable(),profiles:j().nullable(),analyses:j().nullable()}).test("profiles-or-analyses","Samples must have either profiles or services",r=>(r?.profiles?.length??0)+(r?.analyses?.length??0)>0),$=A({clientRequestId:q().required("Client Request ID is Required"),clinicalData:A({clinicalIndication:q().nullable(),symptoms:j().of(q()),symptomsRaw:q().nullable(),treatmentNotes:q().nullable(),pregnancyStatus:me().nullable(),breastFeeding:me().nullable(),vitals:A().nullable(),otherContext:A().nullable()}).nullable(),client:A().required("Client is Required"),clientContact:A().nullable().required("Client Contact is Required"),samples:j().of(X).required().min(1,"Add at least 1 sample"),priority:Ne()});function K(r){return{sampleType:null,dateCollected:Z(new Date),dateReceived:Z(new Date),profiles:[],analyses:[],...r}}function ee(){return{clinicalIndication:"",symptoms:[],symptomsRaw:"",treatmentNotes:"",pregnancyStatus:null,breastFeeding:null,vitals:{},otherContext:{}}}const{handleSubmit:te,values:T,setFieldValue:P}=qe({validationSchema:$,initialValues:{priority:0,client:v?.value?.client,samples:[K({})],clinicalData:ee()}});v?.value?.client&&(d.value=v.value.client),de(()=>T.client,r=>{d.value=r??null,T.clientContact&&T.clientContact?.clientUid!==r?.uid&&P("clientContact",null)},{immediate:!0});const U=_(()=>T.samples),O=E(""),ye=()=>{const r=O.value.trim();if(!r)return;const u=T.clinicalData?.symptoms??[];u.includes(r)||P("clinicalData.symptoms",[...u,r]),O.value=""},ve=r=>{const u=T.clinicalData?.symptoms??[];P("clinicalData.symptoms",u.filter((f,x)=>x!==r))},Se=te(r=>{Y.value=!0,le(r)});function le(r){const u={patientUid:v.value?.uid,clientRequestId:r.clientRequestId,clinicalData:r.clinicalData,clientUid:T.client?.uid,clientContactUid:T.clientContact?.uid,samples:r.samples?.map(f=>({...f,profiles:f.profiles?.map(x=>x.uid),analyses:f.analyses?.map(x=>x.uid),sampleType:f.sampleType?.uid,dateCollected:f.dateCollected?ue(f.dateCollected,"YYYY-MM-DD HH:mm"):null,dateReceived:f.dateReceived?ue(f.dateReceived,"YYYY-MM-DD HH:mm"):null}))};p(Be,{payload:u},"createAnalysisRequest").then(f=>{g.addAnalysisRequest(f),M.push({name:"patient-detail",params:{patientUid:v.value?.uid}})}).finally(()=>{Y.value=!1})}function _e(){const r=K({});P("samples",[...U.value,r])}function xe(r){U.value.length>1&&P("samples",U.value.filter((u,f)=>f!==r))}const Ce=_(()=>U.value.length>1),ae=_(()=>c.getLaboratory?.settings?.allowBilling??!1),J=_(()=>{const r=new Map;return b.profilePrices.forEach((u,f)=>{r.set(`profile_${f}`,u.amount)}),b.analysisPrices.forEach((u,f)=>{r.set(`analysis_${f}`,u.amount)}),r}),oe=_(()=>U.value.map(r=>{let u=0;const f={profiles:[],analyses:[],subtotal:0};return r.profiles?.forEach(x=>{const V=J.value.get(`profile_${x.uid}`);V!==void 0&&(u+=V,f.profiles.push({name:x.name,price:V}))}),r.analyses?.forEach(x=>{const V=J.value.get(`analysis_${x.uid}`);V!==void 0&&(u+=V,f.analyses.push({name:x.name,price:V}))}),f.subtotal=u,f})),we=_(()=>oe.value.reduce((r,u)=>r+u.subtotal,0)),re=De((r,u)=>{b.fetchBatchPrices(r,u)},300);de(()=>U.value.map(r=>({profiles:r.profiles?.map(u=>u.uid)??[],analyses:r.analyses?.map(u=>u.uid)??[]})),r=>{if(!ae.value)return;const u=new Set,f=new Set;r.forEach(x=>{x.profiles.forEach(V=>u.add(V)),x.analyses.forEach(V=>f.add(V))}),(u.size>0||f.size>0)&&re(Array.from(u),Array.from(f))},{deep:!0});const se={sampleStore:g,patientStore:e,analysisStore:C,clientStore:D,billingStore:b,setupStore:c,router:M,withClientMutation:p,clinicalDataExpanded:y,get patient(){return v},set patient(r){v=r},get clientParams(){return N},set clientParams(r){N=r},clients:o,selectedClient:d,selectContact:S,sampleTypes:fe,get analysesParams(){return H},set analysesParams(r){H=r},analysesServices:be,analysesProfiles:pe,arSaving:Y,maxDate:ge,sampleSchema:X,arSchema:$,createDefaultSample:K,createDefaultClinicalData:ee,handleSubmit:te,values:T,setFieldValue:P,samples:U,newSymptom:O,addSymptom:ye,removeSymptom:ve,submitARForm:Se,addAnalysesRequest:le,addSample:_e,removeSample:xe,canRemoveSample:Ce,billingEnabled:ae,priceMap:J,sampleCosts:oe,grandTotal:we,debouncedFetchPrices:re,contactLabel:r=>`${r.firstName} ${r.lastName}`,get VueMultiselect(){return Te},get Spinner(){return Ue},SampleCostBreakdown:it,CostSummary:Ct,get Button(){return Ve},get Input(){return Le},get Textarea(){return je},get FormControl(){return Ye},get FormField(){return Ee},get FormItem(){return He},get FormLabel(){return Ke},get FormMessage(){return ze},get Select(){return Qe},get SelectContent(){return Ge},get SelectItem(){return Ze},get SelectTrigger(){return Je},get SelectValue(){return Oe}};return Object.defineProperty(se,"__isScriptSetup",{enumerable:!1,value:!0}),se}}),ht={class:"space-y-6"},Ft={key:0,class:"absolute inset-0 bg-background/10 backdrop-blur-sm z-50 flex items-center justify-center rounded-lg",role:"status","aria-live":"polite"},kt={class:"flex flex-col items-center gap-4"},Dt={class:"inline-flex items-center gap-2"},Vt={class:"space-y-4"},It={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Tt={class:"border border-border rounded-lg bg-background/50"},At={key:0,class:"px-4 py-4 space-y-4 border-t border-border"},Rt={class:"flex flex-wrap mt-2"},Mt={class:"flex gap-2"},Pt={class:"flex flex-wrap gap-2 mt-2"},Ut={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Bt={id:"samples",class:"space-y-4"},Nt={class:"flex justify-between items-center"},qt={class:"flex items-center gap-4"},Et={class:"relative border border-border rounded-lg bg-background/50 overflow-visible"},Lt={class:"absolute left-0 top-0 bottom-0 w-48 bg-muted/30 border-r border-border z-10"},jt={class:"overflow-x-auto overflow-y-visible pl-48"},zt={class:"flex items-center justify-between"},Ht={class:"p-3 bg-muted/50 rounded-md text-sm space-y-1"},Yt={key:0,class:"text-xs text-destructive whitespace-nowrap"},Kt={key:1},Ot={class:"text-xs text-muted-foreground"},Jt={class:"text-xs text-muted-foreground"},Zt={class:"flex justify-end pt-4"};function Gt(R,t,g,e,C,D){const b=B("TableHead"),c=B("TableRow"),M=B("TableHeader"),p=B("TableCell"),y=B("TableBody"),v=B("Table"),N=B("VueDatePicker");return n(),m("div",ht,[t[44]||(t[44]=s("h5",{class:"text-xl font-semibold text-foreground mb-4"},"Add Analysis Request",-1)),s("form",{class:"relative p-6 bg-background rounded-lg shadow-sm space-y-6",onSubmit:t[6]||(t[6]=L((...o)=>e.submitARForm&&e.submitARForm(...o),["prevent"]))},[e.arSaving?(n(),m("div",Ft,[s("div",kt,[s("span",Dt,[l(e.Spinner,{class:"size-5"}),t[7]||(t[7]=s("span",{class:"text-base"},"Adding Samples...",-1))])])])):I("",!0),s("div",Vt,[s("div",It,[l(e.FormField,{name:"client"},{default:a(({value:o,handleChange:d})=>[l(e.FormItem,null,{default:a(()=>[l(e.FormLabel,null,{default:a(()=>[...t[8]||(t[8]=[i("Client",-1)])]),_:1}),l(e.FormControl,null,{default:a(()=>[l(e.VueMultiselect,{class:"w-full",placeholder:"Select a Client","model-value":o,"onUpdate:modelValue":S=>{d(S),e.selectContact(S)},options:e.clients,searchable:!0,disabled:e.arSaving,label:"name","track-by":"uid","option-height":60,"close-on-select":!0},null,8,["model-value","onUpdate:modelValue","options","disabled"])]),_:2},1024),l(e.FormMessage)]),_:2},1024)]),_:1}),l(e.FormField,{name:"clientContact"},{default:a(({value:o,handleChange:d})=>[l(e.FormItem,null,{default:a(()=>[l(e.FormLabel,null,{default:a(()=>[...t[9]||(t[9]=[i("Client Contact",-1)])]),_:1}),l(e.FormControl,null,{default:a(()=>[l(e.VueMultiselect,{class:"w-full",placeholder:"Select a Client Contact","model-value":o,"onUpdate:modelValue":d,options:e.selectedClient?.contacts??[],"custom-label":e.contactLabel,disabled:e.arSaving,"track-by":"uid","close-on-select":!0,searchable:!0},null,8,["model-value","onUpdate:modelValue","options","disabled"])]),_:2},1024),l(e.FormMessage)]),_:2},1024)]),_:1}),l(e.FormField,{name:"priority"},{default:a(({value:o})=>[l(e.FormItem,null,{default:a(()=>[l(e.FormLabel,null,{default:a(()=>[...t[10]||(t[10]=[i("Priority",-1)])]),_:1}),l(e.FormControl,null,{default:a(()=>[l(e.Select,{"model-value":String(o??0),"onUpdate:modelValue":t[0]||(t[0]=d=>e.setFieldValue("priority",Number(d))),disabled:e.arSaving},{default:a(()=>[l(e.SelectTrigger,null,{default:a(()=>[l(e.SelectValue,{placeholder:"Select priority"})]),_:1}),l(e.SelectContent,null,{default:a(()=>[l(e.SelectItem,{value:"0"},{default:a(()=>[...t[11]||(t[11]=[i("Low",-1)])]),_:1}),l(e.SelectItem,{value:"1"},{default:a(()=>[...t[12]||(t[12]=[i("Medium",-1)])]),_:1}),l(e.SelectItem,{value:"2"},{default:a(()=>[...t[13]||(t[13]=[i("High",-1)])]),_:1})]),_:1})]),_:1},8,["model-value","disabled"])]),_:2},1024),l(e.FormMessage)]),_:2},1024)]),_:1})]),l(e.FormField,{name:"clientRequestId"},{default:a(({componentField:o})=>[l(e.FormItem,null,{default:a(()=>[l(e.FormLabel,null,{default:a(()=>[...t[14]||(t[14]=[i("Client Request ID",-1)])]),_:1}),l(e.FormControl,null,{default:a(()=>[l(e.Input,G(o,{disabled:e.arSaving,placeholder:"CRID ..."}),null,16,["disabled"])]),_:2},1024),l(e.FormMessage)]),_:2},1024)]),_:1}),s("div",Tt,[l(e.Button,{type:"button",variant:"ghost",onClick:t[1]||(t[1]=o=>e.clinicalDataExpanded=!e.clinicalDataExpanded),disabled:e.arSaving,class:"w-full px-4 py-3 flex items-center justify-between text-left rounded-t-lg"},{default:a(()=>[t[16]||(t[16]=s("span",{class:"text-sm font-medium text-foreground whitespace-nowrap"},"Clinical Data (click to expand)",-1)),(n(),m("svg",{class:z(["w-5 h-5 transition-transform duration-200",{"rotate-180":e.clinicalDataExpanded}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...t[15]||(t[15]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))]),_:1},8,["disabled"]),e.clinicalDataExpanded?(n(),m("div",At,[l(e.FormField,{name:"clinicalData.clinicalIndication"},{default:a(({componentField:o})=>[l(e.FormItem,{class:"flex items-center gap-x-4"},{default:a(()=>[l(e.FormLabel,{class:"whitespace-nowrap w-40"},{default:a(()=>[...t[17]||(t[17]=[i("Clinical Indication",-1)])]),_:1}),l(e.FormControl,{class:"w-full"},{default:a(()=>[l(e.Input,G(o,{disabled:e.arSaving,placeholder:"Enter clinical indication..."}),null,16,["disabled"])]),_:2},1024),l(e.FormMessage)]),_:2},1024)]),_:1}),s("div",Rt,[t[20]||(t[20]=s("span",{class:"text-sm font-medium text-foreground w-40"},"Symptoms",-1)),s("div",Mt,[l(e.Input,{class:"flex-1",modelValue:e.newSymptom,"onUpdate:modelValue":t[2]||(t[2]=o=>e.newSymptom=o),disabled:e.arSaving,placeholder:"Add symptom...",onKeydown:Ie(L(e.addSymptom,["prevent","stop"]),["enter"])},null,8,["modelValue","disabled","onKeydown"]),l(e.Button,{type:"button",onClick:e.addSymptom,disabled:e.arSaving},{default:a(()=>[...t[18]||(t[18]=[i(" Add ",-1)])]),_:1},8,["disabled"])]),s("div",Pt,[(n(!0),m(h,null,F(e.values.clinicalData?.symptoms??[],(o,d)=>(n(),m("span",{key:d,class:"inline-flex items-center gap-1 px-2 py-1 bg-muted text-muted-foreground rounded-md text-sm"},[i(k(o)+" ",1),l(e.Button,{type:"button",variant:"ghost",size:"icon",onClick:S=>e.removeSymptom(d),disabled:e.arSaving},{default:a(()=>[...t[19]||(t[19]=[i(" × ",-1)])]),_:1},8,["onClick","disabled"])]))),128))])]),l(e.FormField,{name:"clinicalData.treatmentNotes"},{default:a(({componentField:o})=>[l(e.FormItem,{class:"flex items-center gap-x-4"},{default:a(()=>[l(e.FormLabel,{class:"whitespace-nowrap w-40"},{default:a(()=>[...t[21]||(t[21]=[i("Treatment Notes",-1)])]),_:1}),l(e.FormControl,{class:"w-full"},{default:a(()=>[l(e.Textarea,G(o,{disabled:e.arSaving,placeholder:"Enter treatment notes...",rows:"2"}),null,16,["disabled"])]),_:2},1024),l(e.FormMessage)]),_:2},1024)]),_:1}),s("div",Ut,[l(e.FormField,{name:"clinicalData.pregnancyStatus"},{default:a(({value:o})=>[l(e.FormItem,{class:"flex items-center gap-x-4"},{default:a(()=>[l(e.FormLabel,{class:"whitespace-nowrap w-40"},{default:a(()=>[...t[22]||(t[22]=[i("Pregnancy Status",-1)])]),_:1}),l(e.FormControl,{class:"w-full"},{default:a(()=>[l(e.Select,{"model-value":o==null?"null":String(o),"onUpdate:modelValue":t[3]||(t[3]=d=>e.setFieldValue("clinicalData.pregnancyStatus",d==="null"?null:d==="true")),disabled:e.arSaving},{default:a(()=>[l(e.SelectTrigger,null,{default:a(()=>[l(e.SelectValue,{placeholder:"Not specified"})]),_:1}),l(e.SelectContent,null,{default:a(()=>[l(e.SelectItem,{value:"null"},{default:a(()=>[...t[23]||(t[23]=[i("Not specified",-1)])]),_:1}),l(e.SelectItem,{value:"true"},{default:a(()=>[...t[24]||(t[24]=[i("Pregnant",-1)])]),_:1}),l(e.SelectItem,{value:"false"},{default:a(()=>[...t[25]||(t[25]=[i("Not pregnant",-1)])]),_:1})]),_:1})]),_:1},8,["model-value","disabled"])]),_:2},1024),l(e.FormMessage)]),_:2},1024)]),_:1}),l(e.FormField,{name:"clinicalData.breastFeeding"},{default:a(({value:o})=>[l(e.FormItem,{class:"flex items-center gap-x-4"},{default:a(()=>[l(e.FormLabel,{class:"whitespace-nowrap w-40"},{default:a(()=>[...t[26]||(t[26]=[i("Breastfeeding Status",-1)])]),_:1}),l(e.FormControl,{class:"w-full"},{default:a(()=>[l(e.Select,{"model-value":o==null?"null":String(o),"onUpdate:modelValue":t[4]||(t[4]=d=>e.setFieldValue("clinicalData.breastFeeding",d==="null"?null:d==="true")),disabled:e.arSaving},{default:a(()=>[l(e.SelectTrigger,null,{default:a(()=>[l(e.SelectValue,{placeholder:"Not specified"})]),_:1}),l(e.SelectContent,null,{default:a(()=>[l(e.SelectItem,{value:"null"},{default:a(()=>[...t[27]||(t[27]=[i("Not specified",-1)])]),_:1}),l(e.SelectItem,{value:"true"},{default:a(()=>[...t[28]||(t[28]=[i("Breastfeeding",-1)])]),_:1}),l(e.SelectItem,{value:"false"},{default:a(()=>[...t[29]||(t[29]=[i("Not breastfeeding",-1)])]),_:1})]),_:1})]),_:1},8,["model-value","disabled"])]),_:2},1024),l(e.FormMessage)]),_:2},1024)]),_:1})])])):I("",!0)])]),s("section",Bt,[s("div",Nt,[t[31]||(t[31]=s("h5",{class:"text-lg font-semibold text-foreground"},"Samples",-1)),s("div",qt,[l(e.FormField,{name:"samples"},{default:a(({})=>[l(e.FormItem,null,{default:a(()=>[l(e.FormMessage)]),_:1})]),_:1}),e.samples?.length!==20?(n(),w(e.Button,{key:0,type:"button",onClick:t[5]||(t[5]=L(o=>e.addSample(),["prevent"])),disabled:e.arSaving},{default:a(()=>[...t[30]||(t[30]=[i(" Add Sample ",-1)])]),_:1},8,["disabled"])):I("",!0)])]),s("div",Et,[s("div",Lt,[l(v,{class:"w-full h-full"},{default:a(()=>[l(M,null,{default:a(()=>[l(c,{class:"border-b border-border bg-muted/30"},{default:a(()=>[l(b,{class:"p-4 text-left text-sm font-medium text-foreground h-16"},{default:a(()=>[...t[32]||(t[32]=[i(" Field ",-1)])]),_:1})]),_:1})]),_:1}),l(y,null,{default:a(()=>[l(c,{class:"border-b border-border h-20 min-h-20 max-h-20"},{default:a(()=>[l(p,{class:"p-4 text-sm font-medium text-foreground bg-muted/10"},{default:a(()=>[...t[33]||(t[33]=[i(" Sample Type ",-1)])]),_:1})]),_:1}),l(c,{class:"border-b border-border h-20 min-h-20 max-h-20"},{default:a(()=>[l(p,{class:"p-4 text-sm font-medium text-foreground bg-muted/10"},{default:a(()=>[...t[34]||(t[34]=[i(" Date Collected ",-1)])]),_:1})]),_:1}),l(c,{class:"border-b border-border h-20 min-h-20 max-h-20"},{default:a(()=>[l(p,{class:"p-4 text-sm font-medium text-foreground bg-muted/10"},{default:a(()=>[...t[35]||(t[35]=[i(" Date Received ",-1)])]),_:1})]),_:1}),l(c,{class:"border-b border-border h-20 min-h-20 max-h-20"},{default:a(()=>[l(p,{class:"p-4 text-sm font-medium text-foreground bg-muted/10"},{default:a(()=>[...t[36]||(t[36]=[i(" Analysis Profiles ",-1)])]),_:1})]),_:1}),l(c,{class:"border-b border-border h-20 min-h-20 max-h-20"},{default:a(()=>[l(p,{class:"p-4 text-sm font-medium text-foreground bg-muted/10"},{default:a(()=>[...t[37]||(t[37]=[i(" Analysis Services ",-1)])]),_:1})]),_:1}),e.billingEnabled?(n(),w(c,{key:0,class:"border-b border-border"},{default:a(()=>[l(p,{class:"p-4 text-sm font-medium text-foreground bg-muted/10"},{default:a(()=>[...t[38]||(t[38]=[i(" Cost Breakdown ",-1)])]),_:1})]),_:1})):I("",!0),l(c,{class:"h-24"},{default:a(()=>[l(p,{class:"p-4 text-sm font-medium text-foreground bg-muted/10"},{default:a(()=>[...t[39]||(t[39]=[i(" Selection Summary ",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),s("div",jt,[l(v,{class:"w-80 min-w-80"},{default:a(()=>[l(M,null,{default:a(()=>[l(c,{class:"border-b border-border bg-muted/30"},{default:a(()=>[(n(!0),m(h,null,F(e.samples,(o,d)=>(n(),w(b,{key:d,class:"p-4 text-center text-sm font-medium text-foreground w-80 min-w-80 relative h-16 border-r"},{default:a(()=>[s("div",zt,[s("span",null,"Sample "+k(d+1),1),l(e.Button,{type:"button",variant:"destructive",size:"sm",onClick:L(S=>e.removeSample(d),["prevent"]),disabled:!e.canRemoveSample||e.arSaving,title:e.canRemoveSample&&!e.arSaving?"Remove sample":"At least one sample is required"},{default:a(()=>[...t[40]||(t[40]=[i(" Remove ",-1)])]),_:1},8,["onClick","disabled","title"])])]),_:2},1024))),128))]),_:1})]),_:1}),l(y,null,{default:a(()=>[l(c,{class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},{default:a(()=>[(n(!0),m(h,null,F(e.samples,(o,d)=>(n(),w(p,{key:d,class:"p-4 w-80 border-r"},{default:a(()=>[l(e.VueMultiselect,{class:"w-full",placeholder:"Select sample type",modelValue:o.sampleType,"onUpdate:modelValue":S=>o.sampleType=S,options:e.sampleTypes,searchable:!0,disabled:e.arSaving,label:"name","track-by":"uid",openDirection:"below"},null,8,["modelValue","onUpdate:modelValue","options","disabled"])]),_:2},1024))),128))]),_:1}),l(c,{class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},{default:a(()=>[(n(!0),m(h,null,F(e.samples,(o,d)=>(n(),w(p,{key:d,class:"p-4 w-80 border-r"},{default:a(()=>[l(N,{class:"w-full",modelValue:o.dateCollected,"onUpdate:modelValue":S=>o.dateCollected=S,"max-date":e.maxDate,disabled:e.arSaving,"time-picker-inline":"",teleport:!0},null,8,["modelValue","onUpdate:modelValue","max-date","disabled"])]),_:2},1024))),128))]),_:1}),l(c,{class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},{default:a(()=>[(n(!0),m(h,null,F(e.samples,(o,d)=>(n(),w(p,{key:d,class:"p-4 w-80 border-r"},{default:a(()=>[l(N,{class:"w-full",modelValue:o.dateReceived,"onUpdate:modelValue":S=>o.dateReceived=S,"min-date":o.dateCollected&&typeof o.dateCollected=="object"&&!(o.dateCollected instanceof Date)&&typeof o.dateCollected.toDate=="function"?o.dateCollected.toDate():o.dateCollected||null,"max-date":e.maxDate,disabled:e.arSaving,"time-picker-inline":"",teleport:!0},null,8,["modelValue","onUpdate:modelValue","min-date","max-date","disabled"])]),_:2},1024))),128))]),_:1}),l(c,{class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},{default:a(()=>[(n(!0),m(h,null,F(e.samples,(o,d)=>(n(),w(p,{key:d,class:"p-4 w-80 border-r"},{default:a(()=>[l(e.VueMultiselect,{class:"w-full whitespace-nowrap z-10",placeholder:"Select analysis profiles",modelValue:o.profiles,"onUpdate:modelValue":S=>o.profiles=S,options:e.analysesProfiles,searchable:!0,disabled:e.arSaving,multiple:!0,label:"name","track-by":"uid",openDirection:"below"},null,8,["modelValue","onUpdate:modelValue","options","disabled"])]),_:2},1024))),128))]),_:1}),l(c,{class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},{default:a(()=>[(n(!0),m(h,null,F(e.samples,(o,d)=>(n(),w(p,{key:d,class:"p-4 w-80 border-r"},{default:a(()=>[l(e.VueMultiselect,{class:"w-full whitespace-nowrap",placeholder:"Select analysis services",modelValue:o.analyses,"onUpdate:modelValue":S=>o.analyses=S,options:e.analysesServices,searchable:!0,disabled:e.arSaving,multiple:!0,label:"name","track-by":"uid",openDirection:"below"},null,8,["modelValue","onUpdate:modelValue","options","disabled"])]),_:2},1024))),128))]),_:1}),e.billingEnabled?(n(),w(c,{key:0,class:"border-b border-border hover:bg-muted/20"},{default:a(()=>[(n(!0),m(h,null,F(e.samples,(o,d)=>(n(),w(p,{key:d,class:"p-4 w-80 border-r align-top"},{default:a(()=>[l(e.SampleCostBreakdown,{profiles:o.profiles,analyses:o.analyses,"price-map":e.priceMap,loading:e.billingStore.fetchingPrices},null,8,["profiles","analyses","price-map","loading"])]),_:2},1024))),128))]),_:1})):I("",!0),l(c,{class:"hover:bg-muted/20 h-24"},{default:a(()=>[(n(!0),m(h,null,F(e.samples,(o,d)=>(n(),w(p,{key:d,class:"p-4 w-80 border-r"},{default:a(()=>[s("div",Ht,[o.profiles?.length===0&&o.analyses?.length===0?(n(),m("div",Yt," ⚠️ Select profiles or services ")):(n(),m("div",Kt,[s("div",Ot,[t[41]||(t[41]=s("strong",null,"Profiles:",-1)),i(" "+k(o.profiles?.length||0)+" selected ",1)]),s("div",Jt,[t[42]||(t[42]=s("strong",null,"Services:",-1)),i(" "+k(o.analyses?.length||0)+" selected ",1)])]))])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})])])]),e.billingEnabled?(n(),w(e.CostSummary,{key:1,"sample-costs":e.sampleCosts,"grand-total":e.grandTotal,currency:e.setupStore.getLaboratory?.settings?.currency??"USD",loading:e.billingStore.fetchingPrices},null,8,["sample-costs","grand-total","currency","loading"])):I("",!0),s("div",Zt,[l(e.Button,{type:"submit",disabled:e.arSaving},{default:a(()=>[...t[43]||(t[43]=[i(" Save Sample(s) ",-1)])]),_:1},8,["disabled"])])],32)])}const xl=W(wt,[["render",Gt],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/sample/SamplesAdd.vue"]]);export{xl as default};
