import{a0 as J,h as f,_ as Q,c as r,o as l,A as t,E as _,J as v,K as x,L as b,Q as E,u as De,a4 as Ve,f as Re,a7 as B,g as ae,e as K,i as Ae,a5 as Ue,bm as Pe,r as Me,C as qe,b as Ee,a as w,F as R,a9 as O,a2 as I,M as Ne,D as T,P as Z}from"./index-C5OmCQ1r.js";import{Multiselect as Be}from"./vue-multiselect.esm-Bo98CR0X.js";import{u as Ie}from"./patient-C-IqfSv4.js";import{u as Te}from"./analysis-CQxuKvI2.js";import{u as je}from"./client-BwrwvNZ7.js";import{u as Fe}from"./billing-wgiKFvJY.js";import{u as de}from"./setup-BMS7aX7t.js";import{_ as Le}from"./analyses.mutations-COGCX6rV.js";import{c as A,a as Ye,g as re,e as ne,d as q,u as ze,b as U}from"./index.esm-BwbUMDy_.js";import{f as ie}from"./index-BTVH4Z8d.js";/* empty css                                                                 */import"./location-D9jl_5ED.js";import"./billing.queries-CDSY4w04.js";const He=J({__name:"SampleCostBreakdown",props:{profiles:{type:Array,default:()=>[]},analyses:{type:Array,default:()=>[]},priceMap:{type:Map,required:!0},loading:{type:Boolean,default:!1}},setup(C,{expose:s}){s();const u=de(),e=C,g=f(()=>u.getLaboratory?.settings?.currency??"USD"),h=p=>p==null?"N/A":new Intl.NumberFormat("en-US",{style:"currency",currency:g.value}).format(p),d=f(()=>e.profiles?.map(p=>({name:p.name,price:e.priceMap.get(`profile_${p.uid}`)??null}))??[]),o=f(()=>e.analyses?.map(p=>({name:p.name,price:e.priceMap.get(`analysis_${p.uid}`)??null}))??[]),i=f(()=>{let p=0;return d.value.forEach(k=>{k.price!==null&&(p+=k.price)}),o.value.forEach(k=>{k.price!==null&&(p+=k.price)}),p}),m={setupStore:u,props:e,currency:g,formatCurrency:h,profileCosts:d,analysisCosts:o,subtotal:i};return Object.defineProperty(m,"__isScriptSetup",{enumerable:!1,value:!0}),m}}),Ke={class:"space-y-2 text-sm"},Oe={key:0,class:"animate-pulse space-y-2"},Ze={key:1},Je={key:0,class:"space-y-1"},Qe={class:"text-foreground truncate flex-1 mr-2"},Ge={class:"text-foreground truncate flex-1 mr-2"},We={key:2,class:"border-t border-border pt-2 mt-2"},Xe={class:"flex justify-between items-center font-semibold"},$e={class:"text-primary text-base"},et={key:3,class:"text-muted-foreground italic"};function tt(C,s,u,e,g,h){return l(),r("div",Ke,[u.loading?(l(),r("div",Oe,[...s[0]||(s[0]=[t("div",{class:"h-4 bg-muted rounded w-3/4"},null,-1),t("div",{class:"h-4 bg-muted rounded w-1/2"},null,-1),t("div",{class:"h-4 bg-muted rounded w-full"},null,-1)])])):(l(),r("div",Ze,[e.profileCosts.length>0?(l(),r("div",Je,[s[1]||(s[1]=t("div",{class:"text-xs font-semibold text-muted-foreground uppercase"},"Profiles",-1)),(l(!0),r(v,null,x(e.profileCosts,(d,o)=>(l(),r("div",{key:`profile-${o}`,class:"flex justify-between items-center"},[t("span",Qe,b(d.name),1),t("span",{class:E(d.price===null?"text-destructive":"text-foreground font-medium")},b(e.formatCurrency(d.price)),3)]))),128))])):_("",!0),e.analysisCosts.length>0?(l(),r("div",{key:1,class:E(["space-y-1",{"mt-3":e.profileCosts.length>0}])},[s[2]||(s[2]=t("div",{class:"text-xs font-semibold text-muted-foreground uppercase"},"Analyses",-1)),(l(!0),r(v,null,x(e.analysisCosts,(d,o)=>(l(),r("div",{key:`analysis-${o}`,class:"flex justify-between items-center"},[t("span",Ge,b(d.name),1),t("span",{class:E(d.price===null?"text-destructive":"text-foreground font-medium")},b(e.formatCurrency(d.price)),3)]))),128))],2)):_("",!0),e.profileCosts.length>0||e.analysisCosts.length>0?(l(),r("div",We,[t("div",Xe,[s[3]||(s[3]=t("span",{class:"text-foreground"},"Subtotal:",-1)),t("span",$e,b(e.formatCurrency(e.subtotal)),1)])])):_("",!0),e.profileCosts.length===0&&e.analysisCosts.length===0?(l(),r("div",et," No tests selected ")):_("",!0)]))])}const st=Q(He,[["render",tt],["__scopeId","data-v-d366cf69"],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/billing/SampleCostBreakdown.vue"]]),ot=J({__name:"CostSummary",props:{sampleCosts:{type:Array,required:!0},grandTotal:{type:Number,required:!0},currency:{type:String,default:"USD"},loading:{type:Boolean,default:!1}},setup(C,{expose:s}){s();const u=C,e=d=>new Intl.NumberFormat("en-US",{style:"currency",currency:u.currency}).format(d),g=f(()=>u.sampleCosts.some(d=>d.subtotal>0)),h={props:u,formatCurrency:e,hasCosts:g};return Object.defineProperty(h,"__isScriptSetup",{enumerable:!1,value:!0}),h}}),lt={class:"bg-muted rounded-lg p-6 mt-6 border border-border"},at={key:0,class:"animate-pulse space-y-3"},rt={key:1},nt={class:"space-y-2 mb-4"},it={class:"text-foreground"},dt={class:"font-medium text-foreground"},ct={class:"border-t border-border pt-4 mt-4"},ut={class:"flex justify-between items-center"},mt={class:"text-2xl font-bold text-primary"},pt={key:2,class:"text-muted-foreground italic text-sm"};function bt(C,s,u,e,g,h){return l(),r("div",lt,[s[3]||(s[3]=t("h3",{class:"text-lg font-semibold text-foreground mb-4"},"Cost Summary",-1)),u.loading?(l(),r("div",at,[...s[0]||(s[0]=[t("div",{class:"h-4 bg-background rounded w-3/4"},null,-1),t("div",{class:"h-4 bg-background rounded w-1/2"},null,-1),t("div",{class:"h-6 bg-background rounded w-full mt-4"},null,-1)])])):e.hasCosts?(l(),r("div",rt,[t("div",nt,[(l(!0),r(v,null,x(u.sampleCosts,(d,o)=>(l(),r("div",{key:o,class:"flex justify-between items-center text-sm"},[t("span",it,"Sample "+b(o+1)+":",1),t("span",dt,b(e.formatCurrency(d.subtotal)),1)]))),128))]),t("div",ct,[t("div",ut,[s[1]||(s[1]=t("span",{class:"text-xl font-bold text-foreground"},"Total:",-1)),t("span",mt,b(e.formatCurrency(u.grandTotal)),1)])]),s[2]||(s[2]=t("div",{class:"mt-4 text-xs text-muted-foreground italic"}," * Final cost may vary after discounts and adjustments are applied ",-1))])):(l(),r("div",pt," No tests selected. Add profiles or analyses to see cost breakdown. "))])}const ft=Q(ot,[["render",bt],["__scopeId","data-v-8d1e035b"],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/billing/CostSummary.vue"]]),gt=J({__name:"SamplesAdd",setup(C,{expose:s}){s();const u=De(),e=Ie(),g=Te(),h=je(),d=Fe(),o=de(),i=Ve(),{withClientMutation:m}=Re(),{swalError:p}=Ae(),k=B(!1);let D=f(()=>e.getPatient),j=ae({first:void 0,after:"",text:"",sortBy:["name"],contacts:!0});h.fetchClients(j);const ce=f(()=>h.getClients),F=B(null),ue=a=>{F.value=a,z.value=null};u.fetchSampleTypes();const me=f(()=>u.getSampleTypes);let L=ae({first:void 0,after:"",text:"",sortBy:["name"]});g.fetchAnalysesServices(L);const pe=f(()=>{const a=g.getAnalysesServicesSimple;let n=new Set;return a.forEach((c,y)=>{c.profiles?.length===0&&n.add(c)}),[...n]});g.fetchAnalysesProfiles();const be=f(()=>g.getAnalysesProfiles),P=B(!1),fe=K().endOf("day").toDate(),G=A({clientRequestId:q().required("Client Request ID is Required"),clinicalData:A({clinicalIndication:q().nullable(),symptoms:re().of(q()),symptomsRaw:q().nullable(),treatmentNotes:q().nullable(),pregnancyStatus:ne().nullable(),breastFeeding:ne().nullable(),vitals:A().nullable(),otherContext:A().nullable()}).nullable(),client:A().required("Client is Required"),clientContact:A().nullable().required("Client Contact is Required"),samples:re().required().min(1,"Add at least 1 sample"),priority:Ye()});function Y(a){return{sampleType:{},dateCollected:K(new Date),dateReceived:K(new Date),profiles:[],analyses:[],...a}}function W(){return{clinicalIndication:"",symptoms:[],symptomsRaw:"",treatmentNotes:"",pregnancyStatus:null,breastFeeding:null,vitals:{},otherContext:{}}}const{handleSubmit:X,errors:ge}=ze({validationSchema:G,initialValues:{priority:0,client:D?.value?.client,samples:[Y({})],clinicalData:W()}});D?.value?.client&&(F.value=D.value.client);const{value:ye}=U("clientRequestId"),{value:N}=U("clinicalData"),{value:$}=U("client"),{value:z}=U("clientContact"),{value:ve}=U("priority"),{value:V}=U("samples"),M=B(""),xe=()=>{M.value.trim()&&!N.value?.symptoms?.includes(M.value.trim())&&(N.value?.symptoms?.push(M.value.trim()),M.value="")},he=a=>{N.value?.symptoms?.splice(a,1)},Se=X(a=>{P.value=!0,console.log("values",a);for(let n of a.samples||[]){if([null,void 0,""].includes(n?.sampleType)){p("Samples must have sample types"),P.value=!1;return}if(n?.analyses?.length<=0&&n?.profiles?.length<=0){p("Samples must have either profiles/analyses or both"),P.value=!1;return}}ee(a)});function ee(a){const n={patientUid:D.value?.uid,clientRequestId:a.clientRequestId,clinicalData:a.clinicalData,clientUid:$?.value?.uid,clientContactUid:z?.value?.uid,samples:a.samples?.map(c=>({...c,profiles:c.profiles?.map(y=>y.uid),analyses:c.analyses?.map(y=>y.uid),sampleType:c.sampleType?.uid,dateCollected:ie(c.dateCollected,"YYYY-MM-DD HH:mm"),dateReceived:ie(c.dateReceived,"YYYY-MM-DD HH:mm")}))};console.log(n),m(Le,{payload:n},"createAnalysisRequest").then(c=>{u.addAnalysisRequest(c),i.push({name:"patient-detail",params:{patientUid:D.value?.uid}})}).finally(()=>{P.value=!1})}function _e(){const a=Y({});V.value.push(a)}function we(a){V.value.length>1&&V.value.splice(a,1)}const Ce=f(()=>V.value.length>1),te=f(()=>o.getLaboratory?.settings?.allowBilling??!1),H=f(()=>{const a=new Map;return d.profilePrices.forEach((n,c)=>{a.set(`profile_${c}`,n.amount)}),d.analysisPrices.forEach((n,c)=>{a.set(`analysis_${c}`,n.amount)}),a}),se=f(()=>V.value.map(a=>{let n=0;const c={profiles:[],analyses:[],subtotal:0};return a.profiles?.forEach(y=>{const S=H.value.get(`profile_${y.uid}`);S!==void 0&&(n+=S,c.profiles.push({name:y.name,price:S}))}),a.analyses?.forEach(y=>{const S=H.value.get(`analysis_${y.uid}`);S!==void 0&&(n+=S,c.analyses.push({name:y.name,price:S}))}),c.subtotal=n,c})),ke=f(()=>se.value.reduce((a,n)=>a+n.subtotal,0)),oe=Pe((a,n)=>{d.fetchBatchPrices(a,n)},300);Ue(()=>V.value.map(a=>({profiles:a.profiles?.map(n=>n.uid)??[],analyses:a.analyses?.map(n=>n.uid)??[]})),a=>{if(!te.value)return;const n=new Set,c=new Set;a.forEach(y=>{y.profiles.forEach(S=>n.add(S)),y.analyses.forEach(S=>c.add(S))}),(n.size>0||c.size>0)&&oe(Array.from(n),Array.from(c))},{deep:!0});const le={sampleStore:u,patientStore:e,analysisStore:g,clientStore:h,billingStore:d,setupStore:o,router:i,withClientMutation:m,swalError:p,clinicalDataExpanded:k,get patient(){return D},set patient(a){D=a},get clientParams(){return j},set clientParams(a){j=a},clients:ce,selectedClient:F,selectContact:ue,sampleTypes:me,get analysesParams(){return L},set analysesParams(a){L=a},analysesServices:pe,analysesProfiles:be,arSaving:P,maxDate:fe,arSchema:G,createDefaultSample:Y,createDefaultClinicalData:W,handleSubmit:X,errors:ge,clientRequestId:ye,clinicalData:N,client:$,clientContact:z,priority:ve,samples:V,newSymptom:M,addSymptom:xe,removeSymptom:he,submitARForm:Se,addAnalysesRequest:ee,addSample:_e,removeSample:we,canRemoveSample:Ce,billingEnabled:te,priceMap:H,sampleCosts:se,grandTotal:ke,debouncedFetchPrices:oe,contactLabel:a=>`${a.firstName} ${a.lastName}`,get VueMultiselect(){return Be},SampleCostBreakdown:st,CostSummary:ft};return Object.defineProperty(le,"__isScriptSetup",{enumerable:!1,value:!0}),le}}),yt={class:"space-y-6"},vt={key:0,class:"absolute inset-0 bg-background/10 backdrop-blur-sm z-50 flex items-center justify-center rounded-lg",role:"status","aria-live":"polite"},xt={class:"space-y-4"},ht={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},St={class:"flex items-center gap-x-4"},_t={class:"flex items-center gap-x-4"},wt={class:"text-sm text-destructive"},Ct={class:"flex items-center gap-x-4"},kt=["disabled"],Dt={class:"text-sm text-destructive"},Vt={class:"flex items-center gap-x-4"},Rt=["disabled"],At={class:"text-sm text-destructive"},Ut={class:"border border-border rounded-lg bg-background/50"},Pt=["disabled"],Mt={key:0,class:"px-4 py-4 space-y-4 border-t border-border"},qt={class:"flex items-center gap-x-4"},Et=["disabled"],Nt={class:"flex flex-wrap mt-2"},Bt={class:"flex gap-2"},It=["disabled","onKeydown"],Tt=["disabled"],jt={class:"flex flex-wrap gap-2 mt-2"},Ft=["onClick","disabled"],Lt={class:"flex items-center gap-x-4"},Yt=["disabled"],zt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ht={class:"flex items-center gap-x-4"},Kt=["disabled"],Ot={class:"flex items-center gap-x-4"},Zt=["disabled"],Jt={id:"samples",class:"space-y-4"},Qt={class:"flex justify-between items-center"},Gt={class:"flex items-center gap-4"},Wt={class:"text-sm text-destructive"},Xt=["disabled"],$t={class:"relative border border-border rounded-lg bg-background/50 overflow-visible"},es={class:"absolute left-0 top-0 bottom-0 w-48 bg-muted/30 border-r border-border z-10"},ts={class:"w-full h-full"},ss={key:0,class:"border-b border-border"},os={class:"overflow-x-auto overflow-y-visible pl-48"},ls={class:"w-80 min-w-80"},as={class:"border-b border-border bg-muted/30"},rs={class:"flex items-center justify-between"},ns=["onClick","disabled","title"],is={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},ds={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},cs={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},us={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},ms={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},ps={key:0,class:"border-b border-border hover:bg-muted/20"},bs={class:"hover:bg-muted/20 h-24"},fs={class:"p-3 bg-muted/50 rounded-md text-sm space-y-1"},gs={key:0,class:"text-xs text-destructive whitespace-nowrap"},ys={key:1},vs={class:"text-xs text-muted-foreground"},xs={class:"text-xs text-muted-foreground"},hs={class:"flex justify-end pt-4"},Ss=["disabled"];function _s(C,s,u,e,g,h){const d=Me("VueDatePicker");return l(),r("div",yt,[s[38]||(s[38]=t("h5",{class:"text-xl font-semibold text-foreground mb-4"},"Add Analysis Request",-1)),t("form",{action:"post",class:"relative p-6 bg-background rounded-lg shadow-sm space-y-6",onSubmit:s[11]||(s[11]=T((...o)=>e.submitARForm&&e.submitARForm(...o),["prevent"]))},[e.arSaving?(l(),r("div",vt,[...s[12]||(s[12]=[Ee('<div class="flex flex-col items-center gap-4"><svg class="w-12 h-12 text-primary animate-spin" viewBox="0 0 100 101" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z" fill="currentColor" fill-opacity="0.1"></path><path d="M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z" fill="currentColor"></path></svg><p class="text-sm font-medium text-foreground">Adding Samples...</p></div>',1)])])):_("",!0),t("div",xt,[t("div",ht,[t("label",St,[s[13]||(s[13]=t("span",{class:"text-sm font-medium text-foreground"},"Client",-1)),w(e.VueMultiselect,{class:"w-full",placeholder:"Select a Client",modelValue:e.client,"onUpdate:modelValue":s[0]||(s[0]=o=>e.client=o),options:e.clients,searchable:!0,disabled:e.arSaving,label:"name","track-by":"uid",onSelect:e.selectContact,"option-height":60,"close-on-select":!0},null,8,["modelValue","options","disabled"])]),t("label",_t,[s[14]||(s[14]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap"},"Client Contact",-1)),w(e.VueMultiselect,{class:"w-full",placeholder:"Select a Client Contact",modelValue:e.clientContact,"onUpdate:modelValue":s[1]||(s[1]=o=>e.clientContact=o),options:e.selectedClient?.contacts??[],"custom-label":e.contactLabel,disabled:e.arSaving,"track-by":"uid","close-on-select":!0,searchable:!0},null,8,["modelValue","options","disabled"]),t("div",wt,b(e.errors.clientContact),1)]),t("label",Ct,[s[16]||(s[16]=t("span",{class:"text-sm font-medium text-foreground"},"Priority",-1)),R(t("select",{name:"priority",id:"priority","onUpdate:modelValue":s[2]||(s[2]=o=>e.priority=o),disabled:e.arSaving,class:"w-full px-3 py-2 bg-background/10 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","aria-label":"Select priority level"},[...s[15]||(s[15]=[t("option",{value:"0"},"Low",-1),t("option",{value:"1"},"Medium",-1),t("option",{value:"2"},"High",-1)])],8,kt),[[O,e.priority]]),t("div",Dt,b(e.errors.priority),1)])]),t("label",Vt,[s[17]||(s[17]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap"},"Client Request ID",-1)),R(t("input",{class:"w-full px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","onUpdate:modelValue":s[3]||(s[3]=o=>e.clientRequestId=o),disabled:e.arSaving,placeholder:"CRID ..."},null,8,Rt),[[I,e.clientRequestId]]),t("div",At,b(e.errors.clientRequestId),1)]),t("div",Ut,[t("button",{type:"button",onClick:s[4]||(s[4]=o=>e.clinicalDataExpanded=!e.clinicalDataExpanded),disabled:e.arSaving,class:"w-full px-4 py-3 flex items-center justify-between text-left hover:bg-muted/20 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50 rounded-t-lg disabled:opacity-50 disabled:cursor-not-allowed"},[s[19]||(s[19]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap"},"Clinical Data (click to expand)",-1)),(l(),r("svg",{class:E(["w-5 h-5 transition-transform duration-200",{"rotate-180":e.clinicalDataExpanded}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...s[18]||(s[18]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))],8,Pt),e.clinicalDataExpanded?(l(),r("div",Mt,[t("label",qt,[s[20]||(s[20]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap w-40"},"Clinical Indication",-1)),R(t("input",{class:"w-full px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","onUpdate:modelValue":s[5]||(s[5]=o=>e.clinicalData.clinicalIndication=o),disabled:e.arSaving,placeholder:"Enter clinical indication..."},null,8,Et),[[I,e.clinicalData.clinicalIndication]])]),t("div",Nt,[s[21]||(s[21]=t("span",{class:"text-sm font-medium text-foreground w-40"},"Symptoms",-1)),t("div",Bt,[R(t("input",{class:"flex-1 px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","onUpdate:modelValue":s[6]||(s[6]=o=>e.newSymptom=o),disabled:e.arSaving,placeholder:"Add symptom...",onKeydown:Ne(T(e.addSymptom,["prevent","stop"]),["enter"])},null,40,It),[[I,e.newSymptom]]),t("button",{type:"button",onClick:e.addSymptom,disabled:e.arSaving,class:"px-3 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50 disabled:cursor-not-allowed"}," Add ",8,Tt)]),t("div",jt,[(l(!0),r(v,null,x(e.clinicalData.symptoms,(o,i)=>(l(),r("span",{key:i,class:"inline-flex items-center gap-1 px-2 py-1 bg-muted text-muted-foreground rounded-md text-sm"},[Z(b(o)+" ",1),t("button",{type:"button",onClick:m=>e.removeSymptom(i),disabled:e.arSaving,class:"text-destructive hover:text-destructive/80 ml-1 disabled:opacity-50 disabled:cursor-not-allowed"}," × ",8,Ft)]))),128))])]),t("label",Lt,[s[22]||(s[22]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap w-40"},"Treatment Notes",-1)),R(t("textarea",{class:"w-full px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","onUpdate:modelValue":s[7]||(s[7]=o=>e.clinicalData.treatmentNotes=o),disabled:e.arSaving,placeholder:"Enter treatment notes...",rows:"2"},null,8,Yt),[[I,e.clinicalData.treatmentNotes]])]),t("div",zt,[t("label",Ht,[s[24]||(s[24]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap w-40"},"Pregnancy Status",-1)),R(t("select",{"onUpdate:modelValue":s[8]||(s[8]=o=>e.clinicalData.pregnancyStatus=o),disabled:e.arSaving,class:"w-full ml-4 px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50"},[...s[23]||(s[23]=[t("option",{value:null},"Not specified",-1),t("option",{value:!0},"Pregnant",-1),t("option",{value:!1},"Not pregnant",-1)])],8,Kt),[[O,e.clinicalData.pregnancyStatus]])]),t("label",Ot,[s[26]||(s[26]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap w-40"},"Breastfeeding Status",-1)),R(t("select",{"onUpdate:modelValue":s[9]||(s[9]=o=>e.clinicalData.breastFeeding=o),disabled:e.arSaving,class:"w-full px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50"},[...s[25]||(s[25]=[t("option",{value:null},"Not specified",-1),t("option",{value:!0},"Breastfeeding",-1),t("option",{value:!1},"Not breastfeeding",-1)])],8,Zt),[[O,e.clinicalData.breastFeeding]])])])])):_("",!0)])]),t("section",Jt,[t("div",Qt,[s[27]||(s[27]=t("h5",{class:"text-lg font-semibold text-foreground"},"Samples",-1)),t("div",Gt,[t("span",Wt,b(e.errors.samples),1),e.samples?.length!==20?(l(),r("button",{key:0,type:"button",onClick:s[10]||(s[10]=T(o=>e.addSample(),["prevent"])),disabled:e.arSaving,class:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50 disabled:cursor-not-allowed"}," Add Sample ",8,Xt)):_("",!0)])]),t("div",$t,[t("div",es,[t("table",ts,[s[35]||(s[35]=t("thead",null,[t("tr",{class:"border-b border-border bg-muted/30"},[t("th",{class:"p-4 text-left text-sm font-medium text-foreground h-16"}," Field ")])],-1)),t("tbody",null,[s[29]||(s[29]=t("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Sample Type ")],-1)),s[30]||(s[30]=t("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Date Collected ")],-1)),s[31]||(s[31]=t("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Date Received ")],-1)),s[32]||(s[32]=t("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Analysis Profiles ")],-1)),s[33]||(s[33]=t("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Analysis Services ")],-1)),e.billingEnabled?(l(),r("tr",ss,[...s[28]||(s[28]=[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Cost Breakdown ",-1)])])):_("",!0),s[34]||(s[34]=t("tr",{class:"h-24"},[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Selection Summary ")],-1))])])]),t("div",os,[t("table",ls,[t("thead",null,[t("tr",as,[(l(!0),r(v,null,x(e.samples,(o,i)=>(l(),r("th",{key:i,class:"p-4 text-center text-sm font-medium text-foreground w-80 min-w-80 relative h-16 border-r"},[t("div",rs,[t("span",null,"Sample "+b(i+1),1),t("button",{type:"button",onClick:T(m=>e.removeSample(i),["prevent"]),disabled:!e.canRemoveSample||e.arSaving,class:E(["px-2 py-1 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 text-xs ml-2",e.canRemoveSample&&!e.arSaving?"bg-destructive text-destructive-foreground hover:bg-destructive/90 focus:ring-destructive/50":"bg-muted text-muted-foreground cursor-not-allowed"]),title:e.canRemoveSample&&!e.arSaving?"Remove sample":"At least one sample is required"}," Remove ",10,ns)])]))),128))])]),t("tbody",null,[t("tr",is,[(l(!0),r(v,null,x(e.samples,(o,i)=>(l(),r("td",{key:i,class:"p-4 w-80 border-r"},[w(e.VueMultiselect,{class:"w-full",placeholder:"Select sample type",modelValue:o.sampleType,"onUpdate:modelValue":m=>o.sampleType=m,options:e.sampleTypes,searchable:!0,disabled:e.arSaving,label:"name","track-by":"uid",openDirection:"below"},null,8,["modelValue","onUpdate:modelValue","options","disabled"])]))),128))]),t("tr",ds,[(l(!0),r(v,null,x(e.samples,(o,i)=>(l(),r("td",{key:i,class:"p-4 w-80 border-r"},[w(d,{class:"w-full",modelValue:o.dateCollected,"onUpdate:modelValue":m=>o.dateCollected=m,"max-date":e.maxDate,disabled:e.arSaving,"time-picker-inline":"",teleport:!0},null,8,["modelValue","onUpdate:modelValue","max-date","disabled"])]))),128))]),t("tr",cs,[(l(!0),r(v,null,x(e.samples,(o,i)=>(l(),r("td",{key:i,class:"p-4 w-80 border-r"},[w(d,{class:"w-full",modelValue:o.dateReceived,"onUpdate:modelValue":m=>o.dateReceived=m,"min-date":o.dateCollected&&typeof o.dateCollected=="object"&&!(o.dateCollected instanceof Date)&&typeof o.dateCollected.toDate=="function"?o.dateCollected.toDate():o.dateCollected||null,"max-date":e.maxDate,disabled:e.arSaving,"time-picker-inline":"",teleport:!0},null,8,["modelValue","onUpdate:modelValue","min-date","max-date","disabled"])]))),128))]),t("tr",us,[(l(!0),r(v,null,x(e.samples,(o,i)=>(l(),r("td",{key:i,class:"p-4 w-80 border-r"},[w(e.VueMultiselect,{class:"w-full whitespace-nowrap z-10",placeholder:"Select analysis profiles",modelValue:o.profiles,"onUpdate:modelValue":m=>o.profiles=m,options:e.analysesProfiles,searchable:!0,disabled:e.arSaving,multiple:!0,label:"name","track-by":"uid",openDirection:"below"},null,8,["modelValue","onUpdate:modelValue","options","disabled"])]))),128))]),t("tr",ms,[(l(!0),r(v,null,x(e.samples,(o,i)=>(l(),r("td",{key:i,class:"p-4 w-80 border-r"},[w(e.VueMultiselect,{class:"w-full whitespace-nowrap",placeholder:"Select analysis services",modelValue:o.analyses,"onUpdate:modelValue":m=>o.analyses=m,options:e.analysesServices,searchable:!0,disabled:e.arSaving,multiple:!0,label:"name","track-by":"uid",openDirection:"below"},null,8,["modelValue","onUpdate:modelValue","options","disabled"])]))),128))]),e.billingEnabled?(l(),r("tr",ps,[(l(!0),r(v,null,x(e.samples,(o,i)=>(l(),r("td",{key:i,class:"p-4 w-80 border-r align-top"},[w(e.SampleCostBreakdown,{profiles:o.profiles,analyses:o.analyses,"price-map":e.priceMap,loading:e.billingStore.fetchingPrices},null,8,["profiles","analyses","price-map","loading"])]))),128))])):_("",!0),t("tr",bs,[(l(!0),r(v,null,x(e.samples,(o,i)=>(l(),r("td",{key:i,class:"p-4 w-80 border-r"},[t("div",fs,[o.profiles?.length===0&&o.analyses?.length===0?(l(),r("div",gs," ⚠️ Select profiles or services ")):(l(),r("div",ys,[t("div",vs,[s[36]||(s[36]=t("strong",null,"Profiles:",-1)),Z(" "+b(o.profiles?.length||0)+" selected ",1)]),t("div",xs,[s[37]||(s[37]=t("strong",null,"Services:",-1)),Z(" "+b(o.analyses?.length||0)+" selected ",1)])]))])]))),128))])])])])])]),e.billingEnabled?(l(),qe(e.CostSummary,{key:1,"sample-costs":e.sampleCosts,"grand-total":e.grandTotal,currency:e.setupStore.getLaboratory?.settings?.currency??"USD",loading:e.billingStore.fetchingPrices},null,8,["sample-costs","grand-total","currency","loading"])):_("",!0),t("div",hs,[t("button",{type:"submit",disabled:e.arSaving,class:"px-6 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50 disabled:cursor-not-allowed"}," Save Sample(s) ",8,Ss)])],32)])}const Is=Q(gt,[["render",_s],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/sample/SamplesAdd.vue"]]);export{Is as default};
