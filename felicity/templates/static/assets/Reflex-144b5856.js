import{d as _e,aw as me,ar as he,N as fe,r as g,q as P,y as ve,m as ye,o,c as l,b as e,t as f,f as a,F as _,E as h,g as F,C as U,D as xe,A as E,B as Y,e as v,v as B,as as k,w as b,i as H,j as W,S as be,_ as z,M as ge,ax as ke,k as we}from"./index-4d0d48ab.js";import{D as Re,a as Ce,b as Ae,c as Ue,d as Ee}from"./reflex.mutations-35d09b48.js";const Be={class:"mt-4 mb-2 text-xl text-gray-600 font-semibold tracking-wide"},Ve={class:"leading-2 text-md italic tracking-wide"},De=e("hr",null,null,-1),Fe=e("hr",null,null,-1),Ne=["onClick"],Se={class:"flex justify-start items-center mb-2"},Te=e("h4",{class:"text-l leading-4 italic"},"Reflex Action Brains",-1),Oe=["onClick"],$e={class:"grid grid-cols-3 gap-4"},je={class:"flex justify-between items-center"},Le={class:"my-2 text-l text-gray-600 font-bold"},Me=["onClick"],Ie=["onClick"],Xe={class:"text-gray-500 text-sm"},qe={action:"post",class:"p-1"},Pe={class:"grid grid-cols-2 gap-x-4 mb-4"},Ye={class:"block col-span-1 mb-2"},He=e("span",{class:"text-gray-700"},"Level",-1),We={class:"block col-span-2 mb-2"},ze=e("span",{class:"text-gray-700"},"Target Analyses",-1),Ge=e("option",{value:""},null,-1),Je=["value"],Ke={class:"block col-span-2 mb-2"},Qe=e("span",{class:"text-gray-700"},"Description",-1),Ze=e("hr",null,null,-1),et={action:"post",class:"p-1"},tt={class:"mb-2"},st=e("span",{class:"text-gray-700"},"Description",-1),ot={class:"flex items-center justify-start my-4 font-bold text-l text-gray-600"},nt=e("span",null,"Conditions (OR)",-1),it=e("p",{class:"italic text-sm text-gray-400"},"Criteria under a condition are evaluated as AND whilst conditions are evaluated as OR",-1),lt={class:"grid grid-cols-2 gap-4 my-4"},at=e("hr",null,null,-1),rt={class:"flex justify-between items-center"},dt={class:"flex justify-start items-center py-2"},ct=e("h5",null,"Criteria (AND)",-1),ut=["onClick"],pt=["onClick"],_t=e("hr",{class:"mb-4"},null,-1),mt={class:"flex items-center justify-between"},ht={class:"flex items-bottom gap-x-2"},ft={class:"flex flex-col whitespace-nowrap mb-2"},vt=e("span",{class:"text-gray-700"},"Analysis",-1),yt=["onUpdate:modelValue","onChange"],xt=e("option",{value:""},null,-1),bt=["value"],gt={class:"flex flex-col whitespace-nowrap mb-2"},kt=e("span",{class:"text-white"},".",-1),wt=["onUpdate:modelValue"],Rt=e("option",{value:"eq"},"=",-1),Ct=e("option",{value:"gt"},">",-1),At=e("option",{value:"lt"},"<",-1),Ut=e("option",{value:"neq"},"â‰ ",-1),Et=[Rt,Ct,At,Ut],Bt={class:"block col-span-1 mt-1"},Vt=e("span",{class:"text-gray-700"},"Result",-1),Dt=["onUpdate:modelValue"],Ft=["onUpdate:modelValue"],Nt=e("option",{value:""},null,-1),St=["value"],Tt={class:""},Ot=["onClick"],$t=e("hr",null,null,-1),jt=e("h3",{class:"mt-4 font-bold text-l text-gray-600"},"Actions",-1),Lt=e("p",{class:"italic text-sm text-gray-400"},"If conditions are met, auto create new analyses and or set final results",-1),Mt={class:"flex justify-start items-center py-2"},It=e("h5",null,"Create Analyses",-1),Xt=e("span",{class:"text-orange-600"},null,-1),qt=["onClick"],Pt=e("hr",null,null,-1),Yt={class:"flex items-center justify-between"},Ht={class:"flex items-top gap-x-4"},Wt={class:"flex flex-col whitespace-nowrap mb-2"},zt=e("span",{class:"text-gray-700"},"Analysis",-1),Gt=["onUpdate:modelValue"],Jt=e("option",{value:""},null,-1),Kt=["value"],Qt={class:"block col-span-1 mb-2"},Zt=e("span",{class:"text-gray-700"},"Count",-1),es=["onUpdate:modelValue"],ts={class:""},ss=["onClick"],os={class:"flex justify-start items-center py-2"},ns=e("h5",null,"Set Final Analyses",-1),is=e("span",{class:"text-orange-600"},null,-1),ls=["onClick"],as=e("hr",null,null,-1),rs={class:"flex items-center justify-between"},ds={class:"flex items-top gap-x-4"},cs={class:"flex flex-col whitespace-nowrap mb-2"},us=e("span",{class:"text-gray-700"},"Analysis",-1),ps=["onUpdate:modelValue","onChange"],_s=e("option",{value:""},null,-1),ms=["value"],hs={class:"block col-span-1 mb-2"},fs=e("span",{class:"text-gray-700"},"Result",-1),vs=["onUpdate:modelValue"],ys=["onUpdate:modelValue"],xs=e("option",{value:""},null,-1),bs=["value"],gs={class:""},ks=["onClick"],ws=e("hr",null,null,-1),Rs=_e({__name:"Reflex",setup(Cs){const $=W(()=>z(()=>import("./FelModal-599b9c12.js"),["assets/FelModal-599b9c12.js","assets/index-4d0d48ab.js","assets/index-c2286288.css","assets/FelModal-780aeea9.css"])),G=W(()=>z(()=>import("./FelAccordion-85f8ed63.js"),["assets/FelAccordion-85f8ed63.js","assets/index-4d0d48ab.js","assets/index-c2286288.css"])),y=me(),J=he(),{withClientMutation:V}=ge(),K=fe();let w=g(!1),D=g(""),m=P({});const R=g(!0);let C=g(!1),d=P({description:"",priority:0,conditions:[],actions:[]});ve(async()=>{y.fetchReflexRuleByUid(K.params?.uid)});const Q=n=>{const t=ke(n);return t.charAt(0).toUpperCase()+t.slice(1)},A=J.getAnalysesServicesSimple;function Z(){const n={reflexRuleUid:y.reflexRule?.uid,level:m.level,description:m.description,analyses:m.analyses};V(Ce,{payload:n},"createReflexAction").then(t=>y.addReflexAction(t))}function ee(){const n={reflexRuleUid:y.reflexRule?.uid,level:m.level,description:m.description,analyses:m.analyses};V(Ae,{uid:m.uid,payload:n},"updateReflexAction").then(t=>y.updateReflexAction(t))}function j(n,t={}){if(R.value=n,w.value=!0,D.value=(n?"CREATE":"EDIT")+" REFLEX ACTION",n)Object.assign(m,{});else{let r=[];t.analyses?.forEach(s=>r.push(s?.uid)),Object.assign(m,{...t,analyses:r})}}function te(){R.value===!0&&Z(),R.value===!1&&ee(),w.value=!1}const N=g();function se(){const n={...d,reflexActionUid:N.value};V(Ue,{payload:n},"createReflexBrain").then(t=>y.updateReflexBrain(t))}function oe(){const n={reflexActionUid:N.value,priority:d.priority,description:d.description,conditions:d.conditions?.map(t=>({description:t.description,priority:t.priority,criteria:t.criteria?.map(r=>({analysisUid:r.analysisUid,operator:r.operator,value:r.value}))})),actions:d.actions?.map(t=>({addNew:t.addNew?.map(r=>({analysisUid:r.analysisUid,count:r.count})),finalise:t.finalise?.map(r=>({analysisUid:r.analysisUid,value:r.value}))}))};V(Ee,{uid:d.uid,payload:n},"updateReflexBrain").then(t=>y.updateReflexBrain(t))}function L(){d.conditions?.push({description:"",priority:0,criteria:[]})}function ne(n){d.conditions?.splice(n,1)}function ie(){d.actions?.push({addNew:[],finalise:[]})}function M(n){d.conditions[n].criteria?.push({operator:"eq"})}function le(n,t){d.conditions[n].criteria?.splice(t,1)}let S=g([]);function ae(n,t){const r=A?.find(s=>s.uid===t.analysisUid);t.value=void 0,S.value=r?.resultOptions||[]}function I(n){d.actions[n]?.addNew?.push({})}function re(n){d.actions[0]?.addNew?.splice(n,1)}function X(n){d.actions[0]?.finalise?.push({})}function de(n){d.actions[n]?.finalise?.splice(n,1)}let T=g([]);function ce(n,t){const r=A?.find(s=>s.uid===t.analysisUid);t.value=void 0,T.value=r?.resultOptions||[]}function q(n,t,r={}){R.value=n,C.value=!0,D.value=(n?"CREATE":"EDIT")+" REFLEX BRAIN",N.value=t,n?(Object.assign(d,{priority:0,description:"",conditions:[],actions:[]}),L(),M(0),ie(),I(0),X()):Object.assign(d,{...r})}function ue(){R.value===!0&&se(),R.value===!1&&oe(),C.value=!1}function pe(n,t){be.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(r=>{r.isConfirmed&&V(Re,{uid:t},"deleteReflexBrain").then(s=>y.deleteReflexBrain(n,t))})}return(n,t)=>{const r=ye("font-awesome-icon");return o(),l(_,null,[e("h3",Be,f(a(y).reflexRule?.name),1),e("p",Ve,f(a(y).reflexRule?.description),1),De,e("button",{onClick:t[0]||(t[0]=s=>j(!0)),class:"my-4 px-2 py-1 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Add Reflex Action "),Fe,(o(!0),l(_,null,h(a(y).reflexRule?.reflexActions,s=>(o(),l("section",{class:"col-span-1",key:s?.uid},[F(a(G),null,{title:U(()=>[e("span",{class:"p-2",onClick:p=>j(!1,s)},[F(r,{icon:"edit",class:"text-md text-gray-400 mr-1"})],8,Ne),xe(" Reflex Action Level "+f(s?.level)+" targeting ",1),(o(!0),l(_,null,h(s?.analyses,p=>(o(),l("span",{key:p.uid,class:"ml-1"},f(p?.name)+",",1))),128))]),body:U(()=>[e("div",Se,[Te,e("button",{onClick:p=>q(!0,s?.uid,{}),class:"ml-4 px-2 py-1 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Add Brain ",8,Oe)]),e("div",$e,[(o(!0),l(_,null,h(s?.brains,(p,c)=>(o(),l("div",{key:p?.uid,class:"block col-span-1 bg-white py-2 px-4 m"},[e("div",je,[e("h2",Le,f(Q(c+1))+" Brain ",1),e("div",null,[e("span",{class:"p-2",onClick:x=>q(!1,s.uid,p)},[F(r,{icon:"edit",class:"text-md text-gray-400 mr-1"})],8,Me),e("span",{class:"p-2",onClick:x=>pe(s.uid,p.uid)},[F(r,{icon:"trash",class:"text-md text-red-400 mr-1"})],8,Ie)])]),e("p",Xe,f(p?.description),1)]))),128))])]),_:2},1024)]))),128)),E(" Reflex Action Edit Form Modal "),a(w)?(o(),Y(a($),{key:0,onClose:t[5]||(t[5]=s=>H(w)?w.value=!1:w=!1)},{header:U(()=>[e("h3",null,f(a(D)),1)]),body:U(()=>[e("form",qe,[e("div",Pe,[e("label",Ye,[He,v(e("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":t[1]||(t[1]=s=>a(m).level=s),type:"number",min:"1",placeholder:"Name ..."},null,512),[[B,a(m).level]])]),e("label",We,[ze,v(e("select",{name:"analyses",id:"analyses","onUpdate:modelValue":t[2]||(t[2]=s=>a(m).analyses=s),class:"form-input mt-1 block w-full",multiple:""},[Ge,(o(!0),l(_,null,h(a(A),s=>(o(),l("option",{key:s.uid,value:s.uid},f(s.name),9,Je))),128))],512),[[k,a(m).analyses]])]),e("label",Ke,[Qe,v(e("textarea",{cols:"2",class:"form-input mt-1 block w-full","onUpdate:modelValue":t[3]||(t[3]=s=>a(m).description=s),placeholder:"Description ..."},null,512),[[B,a(m).description]])])]),Ze,e("button",{type:"button",onClick:t[4]||(t[4]=b(s=>te(),["prevent"])),class:"-mb-4 w-full border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):E("v-if",!0),E(" Reflex Brain Edit Form Modal "),a(C)?(o(),Y(a($),{key:1,onClose:t[9]||(t[9]=s=>H(C)?C.value=!1:C=!1),contentWidth:"w-4/5"},{header:U(()=>[e("h3",null,f(a(D)),1)]),body:U(()=>[e("form",et,[e("label",tt,[st,v(e("textarea",{cols:"2",class:"form-input mt-1 block w-full","onUpdate:modelValue":t[6]||(t[6]=s=>a(d).description=s),placeholder:"Description ..."},null,512),[[B,a(d).description]])]),e("h3",ot,[nt,e("button",{onClick:t[7]||(t[7]=b(s=>L(),["prevent"])),class:"px-2 py-1 ml-4 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Add ")]),it,e("div",lt,[(o(!0),l(_,null,h(a(d).conditions,(s,p)=>(o(),l("section",{class:"bg-slate-100 px-1",id:"criteria",key:p},[at,e("div",rt,[e("div",dt,[ct,e("button",{onClick:b(c=>M(p),["prevent"]),class:"px-2 py-1 ml-4 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," + criteria ",8,ut)]),e("button",{onClick:b(c=>ne(p),["prevent"]),class:"px-2 py-1 mr-2 border-orange-600 border text-orange-600rounded-smtransition duration-300 hover:bg-orange-600 hover:text-white focus:outline-none"}," - condition ",8,pt)]),_t,(o(!0),l(_,null,h(s.criteria,(c,x)=>(o(),l("div",{key:x},[e("div",mt,[e("div",ht,[e("label",ft,[vt,v(e("select",{name:"analysisService",id:"analysisService","onUpdate:modelValue":i=>c.analysisUid=i,class:"form-input mt-1",onChange:i=>ae(i,c)},[xt,(o(!0),l(_,null,h(a(A),i=>(o(),l("option",{key:i.uid,value:i.uid},f(i.name),9,bt))),128))],40,yt),[[k,c.analysisUid]])]),e("label",gt,[kt,v(e("select",{name:"operator",id:"operator","onUpdate:modelValue":i=>c.operator=i,class:"form-input mt-1"},[...Et],8,wt),[[k,c.operator]])]),e("label",Bt,[Vt,a(S).length==0?v((o(),l("input",{key:0,class:"form-input mt-1 block w-full","onUpdate:modelValue":i=>c.value=i,type:"text",placeholder:"Result ..."},null,8,Dt)),[[B,c.value]]):v((o(),l("select",{key:1,name:"criteriaValue",id:"criteriaValue","onUpdate:modelValue":i=>c.value=i,class:"form-input"},[Nt,(o(!0),l(_,null,h(a(S),i=>(o(),l("option",{key:i.uid,value:i.value},f(i.value),9,St))),128))],8,Ft)),[[k,c.value]])])]),e("div",Tt,[e("button",{onClick:b(i=>le(p,x),["prevent"]),class:"px-2 py-1 mt-5 ml-2 border-orange-600 border text-orange-600rounded-smtransition duration-300 hover:bg-orange-600 hover:text-white focus:outline-none"}," - criteria ",8,Ot)])]),$t]))),128))]))),128))]),jt,Lt,(o(!0),l(_,null,h(a(d).actions,(s,p)=>(o(),l("section",{class:"grid grid-cols-2 gap-x-4 my-4",key:p},[E(" Add New "),(o(!0),l(_,null,h(s.addNew,(c,x)=>(o(),l("div",{class:"bg-green-50 px-1",key:x},[e("div",Mt,[It,Xt,e("button",{onClick:b(i=>I(x),["prevent"]),class:"px-2 py-1 ml-4 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Add ",8,qt)]),Pt,e("div",Yt,[e("div",Ht,[e("label",Wt,[zt,v(e("select",{name:"analysisService",id:"analysisService","onUpdate:modelValue":i=>c.analysisUid=i,class:"form-input mt-1"},[Jt,(o(!0),l(_,null,h(a(A),i=>(o(),l("option",{key:i.uid,value:i.uid},f(i.name),9,Kt))),128))],8,Gt),[[k,c.analysisUid]])]),e("label",Qt,[Zt,v(e("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":i=>c.count=i,type:"number",placeholder:"How Many ...",default:"1"},null,8,es),[[B,c.count]])])]),e("div",ts,[e("button",{onClick:b(i=>re(x),["prevent"]),class:"px-2 py-1 mr-2 border-orange-600 border text-orange-600rounded-smtransition duration-300 hover:bg-orange-600 hover:text-white focus:outline-none"}," Remove ",8,ss)])])]))),128)),E(" Finalise "),(o(!0),l(_,null,h(a(d).actions,(c,x)=>(o(),l("div",{key:x},[(o(!0),l(_,null,h(c.finalise,(i,O)=>(o(),l("div",{class:"bg-orange-50 px-1",key:O},[e("div",os,[ns,is,e("button",{onClick:b(u=>X(O),["prevent"]),class:"px-2 py-1 ml-4 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Add ",8,ls)]),as,e("div",rs,[e("div",ds,[e("label",cs,[us,v(e("select",{name:"analysisService",id:"analysisService","onUpdate:modelValue":u=>i.analysisUid=u,class:"form-input mt-1",onChange:u=>ce(u,i)},[_s,(o(!0),l(_,null,h(a(A),u=>(o(),l("option",{key:u.uid,value:u.uid},f(u.name),9,ms))),128))],40,ps),[[k,i.analysisUid]])]),e("label",hs,[fs,a(T).length==0?v((o(),l("input",{key:0,class:"form-input mt-1 block w-full","onUpdate:modelValue":u=>i.value=u,type:"text",placeholder:"Result ..."},null,8,vs)),[[B,i.value]]):v((o(),l("select",{key:1,name:"finalValue",id:"finalValue","onUpdate:modelValue":u=>i.value=u,class:"form-input mt-1"},[xs,(o(!0),l(_,null,h(a(T),u=>(o(),l("option",{key:u.uid,value:u.value},f(u.value),9,bs))),128))],8,ys)),[[k,i.value]])])]),e("div",gs,[e("button",{onClick:b(u=>de(O),["prevent"]),class:"px-2 py-1 mr-2 border-orange-600 border text-orange-600rounded-smtransition duration-300 hover:bg-orange-600 hover:text-white focus:outline-none"}," Remove ",8,ks)])])]))),128))]))),128))]))),128)),ws,e("button",{type:"button",onClick:t[8]||(t[8]=b(s=>ue(),["prevent"])),class:"-mb-4 border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Save ")])]),_:1})):E("v-if",!0)],64)}}}),Es=we(Rs,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/admin/reflex/_id/Reflex.vue"]]);export{Es as default};
