import{P as se,Z as b,a3 as y,a5 as oe,aj as P,u as ae,e as le,ai as ne,f as w,h as m,aa as re,o as f,c as v,a as p,a2 as a,b as s,A as R,C as ie,z as h,a7 as T,K as S,L as ue,x as de,F as k,D as L,E as ce,a4 as me,J as E,X as C,Y as x,_ as fe}from"./index-03a7f0eb.js";import{u as pe}from"./setup-4fedd75c.js";import{u as ve}from"./analysis-625e9fcd.js";import{h as be,o as ge,a as ye}from"./constants-1e14befe.js";import{j as he}from"./analyses.mutations-e92e836e.js";import"./_queries-175415ec.js";const Se={action:"post",class:"mb-8 bg-white"},Ce={class:"grid grid-cols-3 gap-x-4 mb-4"},xe={class:"block col-span-1"},we=["value"],ke={id:"samples"},Ae={class:"flex justify-between items-center py-2"},_e={class:"flex items-center justify-between"},qe={class:""},Qe={class:"grid grid-cols-4 gap-x-4"},Ve={class:"block col-span-1 mb-2"},Pe={class:"block col-span-1 mb-2"},Re={class:"block col-span-1 mb-2"},Te={class:"block col-span-1 mb-2"},Le={class:"ml-4"},Ee=["onClick"],Ue=se({__name:"QualityControlListing",setup(De){const g=C(()=>x(()=>import("./vue-multiselect.esm-e5326598.js"),["assets/vue-multiselect.esm-e5326598.js","assets/index-03a7f0eb.js","assets/index-81d3252e.css"])),U=C(()=>x(()=>import("./FelDataTable-16a5936f.js"),["assets/FelDataTable-16a5936f.js","assets/index-03a7f0eb.js","assets/index-81d3252e.css"])),D=C(()=>x(()=>import("./index-03a7f0eb.js").then(o=>o.cM),["assets/index-03a7f0eb.js","assets/index-81d3252e.css"])),I=C(()=>x(()=>import("./index-03a7f0eb.js").then(o=>o.cN),["assets/index-03a7f0eb.js","assets/index-81d3252e.css"])),M=b([{name:"All",value:""},{name:"Pending",value:"pending"},{name:"Awaiting",value:"awaiting"},{name:"Approved",value:"approved"}]),B=b([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Date Created",value:"createdAt",sortable:!1,defaultSort:!0,showInToggler:!1,hidden:!1,customRender:function(o,e){return y("div",oe(o.createdAt))}},{name:"Run Sets (samples)",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(o,e){return y("div",X(o.samples??[]))}},{name:"Test(s)",value:"code",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(o,e){return y("div",Y(o.samples??[]))}},{name:"Status",value:"status",sortable:!1,defaultSort:!1,showInToggler:!0},{name:"",value:"",sortable:!1,hidden:!1,showInToggler:!1,customRender:function(o,e){return y(P,{to:{name:"qc-set-detail",params:{qcSetUid:o.uid}},class:"px-2 mr-2 border-sky-800 border text-gray-500rounded-smtransition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none",innerHTML:"View Run Set"})}}]),u=ae(),i=ve(),A=pe(),{withClientMutation:j}=le(),{qcSets:_,fetchingQCSets:N}=ne(u);let O=w({first:void 0,after:"",text:"",sortBy:["name"]});i.fetchAnalysesServices(O),i.fetchQCLevels(),i.fetchQCTemplates(),i.fetchAnalysesProfiles(),A.fetchDepartments({}),u.resetQCSets();let q=b(25),$=m(()=>`Showing ${_?.value?.length} of ${u.getQCSetCount} QC Sets`),l=w({first:q.value,after:"",status:"",sortBy:["-uid"],filterAction:!1});u.fetchQCSets(l);function F(o){l.first=25,l.after="",l.status=o.filterStatus,l.filterAction=!0,u.fetchQCSets(l)}const H=m(()=>i.getAnalysesProfiles);m(()=>{const o=i.getAnalysesServicesSimple;let e=new Set;return o.forEach(t=>{t.profiles?.length===0&&e.add(t)}),[...e]});let r=b(!1),Z=b(!0),c=w({departmentUid:void 0,samples:[]});re(()=>Q());function Q(){c.samples?.push({qcTemplate:void 0,qcLevels:[],analysisProfiles:[],analysisServices:[]})}function z(){const o=c.samples?.map(e=>({qcTemplateUid:e.qcTemplate?.uid,qcLevels:e.qcLevels?.map(t=>t.uid),analysisProfiles:e.analysisProfiles?.map(t=>t.uid),analysisServices:e.analysisServices?.map(t=>t.uid)}));j(he,{samples:o},"createQcSet").then(e=>u.addQCSets(e?.qcSets))}function J(o){c.samples?.splice(o,1)}function K(){Z.value===!0&&z(),r.value=!1}const V=m(()=>u.getQCSetPageInfo);function W(){l.first=+q.value,l.after=V?.value?.pageInfo?.endCursor??"",l.text="",l.filterAction=!1,u.fetchQCSets(l)}function X(o){let e=[];return o?.forEach(t=>{t?.sampleId+""+t.status;let n=t?.qcLevel?.level?.match(/\b([A-Z])/g).join("")+" ("+t.status+")";e.includes(n)||e.push(n)}),e.join(", ")}function Y(o){let e=[];return o?.forEach(t=>{t?.profiles?.forEach(n=>{e.includes(n.name)||e.push(n.name)})}),o?.forEach(t=>{t?.analyses?.forEach(n=>{e.includes(n.name)||e.push(n.name)})}),e.join(", ")}const G=m(()=>A.getDepartments),ee=m(()=>i.getQCTemplates),te=m(()=>i.getQCLevels);return(o,e)=>(f(),v(k,null,[p(a(D),{title:"Reference Runs (QC)"}),s("div",null,[R(s("button",{type:"button",class:"border border-sky-800 text-sky-800 rounded-sm px-2 py-1 transition-colors duration-500 ease select-none hover:bg-sky-800 hover:text-white focus:outline-none focus:shadow-outline",onClick:e[0]||(e[0]=h(t=>T(r)?r.value=!a(r):r=!a(r),["prevent"]))}," Add Reference Runs ",512),[[ie,be(ye.CREATE,ge.SAMPLE)]]),p(a(P),{to:"/quality-control/charts",id:"control-charts",class:"border border-orange-800 text-orange-800 rounded-sm px-2 py-1 m-2 transition-colors duration-500 ease select-none hover:bg-orange-800 hover:text-white focus:outline-none focus:shadow-outline"},{default:S(()=>e[5]||(e[5]=[ue(" View Run Charts ")])),_:1})]),e[19]||(e[19]=s("hr",null,null,-1)),p(a(U),{columns:B.value,data:a(_),toggleColumns:!0,loading:a(N),paginable:!0,pageMeta:{fetchCount:a(l).first,hasNextPage:V.value?.pageInfo?.hasNextPage,qcSetCount:a($)},searchable:!1,onOnSearch:F,filterable:!0,filterMeta:{defaultFilter:a(l).status,filters:M.value},onOnPaginate:W,selectable:!1},{footer:S(()=>e[6]||(e[6]=[])),_:1},8,["columns","data","loading","pageMeta","filterMeta"]),a(r)?(f(),de(a(I),{key:0,onClose:e[4]||(e[4]=t=>T(r)?r.value=!1:r=!1),contentWidth:"w-4/5"},{header:S(()=>e[7]||(e[7]=[s("h3",null,"Create QC Analyses Requests",-1)])),body:S(()=>[s("form",Se,[s("div",Ce,[s("label",xe,[e[9]||(e[9]=s("span",{class:"text-gray-700"},"Department",-1)),R(s("select",{name:"clientContacts",id:"clientContacts","onUpdate:modelValue":e[1]||(e[1]=t=>a(c).departmentUid=t),class:"form-input mt-1 block w-full"},[e[8]||(e[8]=s("option",{value:""},null,-1)),(f(!0),v(k,null,L(G.value,t=>(f(),v("option",{key:t.uid,value:t.uid},ce(t.name),9,we))),128))],512),[[me,a(c).departmentUid]])])]),s("section",ke,[e[16]||(e[16]=s("hr",null,null,-1)),s("div",Ae,[e[10]||(e[10]=s("h5",null,"Add Control Samples",-1)),a(c).samples?.length<20?(f(),v("button",{key:0,onClick:e[2]||(e[2]=h(t=>Q(),["prevent"])),class:"px-2 py-1 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"},"Add QCSet")):E("",!0)]),e[17]||(e[17]=s("hr",{class:"mb-4"},null,-1)),(f(!0),v(k,null,L(a(c).samples,(t,n)=>(f(),v("div",{key:n},[s("div",_e,[s("div",qe,[s("div",Qe,[s("label",Ve,[e[11]||(e[11]=s("span",{class:"text-gray-700"},"QC Template",-1)),p(a(g),{class:"max-w-[300px]",modelValue:t.qcTemplateUid,"onUpdate:modelValue":d=>t.qcTemplateUid=d,options:ee.value,multiple:!1,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","onUpdate:modelValue","options"])]),s("label",Pe,[e[12]||(e[12]=s("span",{class:"text-gray-700"},"QC Levels",-1)),p(a(g),{class:"max-w-[300px]",modelValue:t.qcLevels,"onUpdate:modelValue":d=>t.qcLevels=d,options:te.value,multiple:!0,searchable:!0,label:"level","track-by":"uid"},null,8,["modelValue","onUpdate:modelValue","options"])]),s("label",Re,[e[13]||(e[13]=s("span",{class:"text-gray-700"},"Analysis Profiles",-1)),p(a(g),{class:"max-w-[300px]",modelValue:t.analysisProfiles,"onUpdate:modelValue":d=>t.analysisProfiles=d,options:H.value,multiple:!0,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","onUpdate:modelValue","options"])]),s("label",Te,[e[14]||(e[14]=s("span",{class:"text-gray-700"},"Analysis Services",-1)),p(a(g),{class:"max-w-[300px]",modelValue:t.analysisServices,"onUpdate:modelValue":d=>t.analysisServices=d,options:a(i).getAnalysesServicesSimple,multiple:!0,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","onUpdate:modelValue","options"])])])]),s("div",Le,[s("button",{onClick:h(d=>J(n),["prevent"]),class:"px-2 py-1 mr-2 border-orange-600 border text-orange-600rounded-smtransition duration-300 hover:bg-orange-600 hover:text-white focus:outline-none"},"Remove",8,Ee)])]),e[15]||(e[15]=s("hr",null,null,-1))]))),128))]),e[18]||(e[18]=s("hr",null,null,-1)),s("button",{type:"button",onClick:e[3]||(e[3]=h(t=>K(),["prevent"])),class:"-mb-4 w-full border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):E("",!0)],64))}}),$e=fe(Ue,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/qcontrol/QualityControlListing.vue"]]);export{$e as default};
