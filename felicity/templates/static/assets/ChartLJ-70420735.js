import{a8 as K,d as $,y as Y,o as X,c as M,b as S,k as j}from"./index-53659ec0.js";import{C as nn}from"./index-c6c812f9.js";var Z={exports:{}};(function(J,W){(function(b,u){J.exports=u()})(K,function(){var b=function(u,f){var _=Array.prototype.concat,g=Array.prototype.slice,w=Object.prototype.toString;function d(m,v){var c=m>v?m:v;return u.pow(10,17-~~(u.log(c>0?c:-c)*u.LOG10E))}var i=Array.isArray||function(v){return w.call(v)==="[object Array]"};function n(m){return w.call(m)==="[object Function]"}function r(m){return typeof m=="number"?m-m===0:!1}function e(m){return _.apply([],m)}function o(){return new o._init(arguments)}o.fn=o.prototype,o._init=function(v){if(i(v[0]))if(i(v[0][0])){n(v[1])&&(v[0]=o.map(v[0],v[1]));for(var c=0;c<v[0].length;c++)this[c]=v[0][c];this.length=v[0].length}else this[0]=n(v[1])?o.map(v[0],v[1]):v[0],this.length=1;else if(r(v[0]))this[0]=o.seq.apply(null,v),this.length=1;else{if(v[0]instanceof o)return o(v[0].toArray());this[0]=[],this.length=1}return this},o._init.prototype=o.prototype,o._init.constructor=o,o.utils={calcRdx:d,isArray:i,isFunction:n,isNumber:r,toVector:e},o._random_fn=u.random,o.setRandom=function(v){if(typeof v!="function")throw new TypeError("fn is not a function");o._random_fn=v},o.extend=function(v){var c,p;if(arguments.length===1){for(p in v)o[p]=v[p];return this}for(c=1;c<arguments.length;c++)for(p in arguments[c])v[p]=arguments[c][p];return v},o.rows=function(v){return v.length||1},o.cols=function(v){return v[0].length||1},o.dimensions=function(v){return{rows:o.rows(v),cols:o.cols(v)}},o.row=function(v,c){return i(c)?c.map(function(p){return o.row(v,p)}):v[c]},o.rowa=function(v,c){return o.row(v,c)},o.col=function(v,c){if(i(c)){var p=o.arange(v.length).map(function(){return new Array(c.length)});return c.forEach(function(h,D){o.arange(v.length).forEach(function(R){p[R][D]=v[R][h]})}),p}for(var y=new Array(v.length),q=0;q<v.length;q++)y[q]=[v[q][c]];return y},o.cola=function(v,c){return o.col(v,c).map(function(p){return p[0]})},o.diag=function(v){for(var c=o.rows(v),p=new Array(c),y=0;y<c;y++)p[y]=[v[y][y]];return p},o.antidiag=function(v){for(var c=o.rows(v)-1,p=new Array(c),y=0;c>=0;c--,y++)p[y]=[v[y][c]];return p},o.transpose=function(v){var c=[],p,y,q,h,D;for(i(v[0])||(v=[v]),y=v.length,q=v[0].length,D=0;D<q;D++){for(p=new Array(y),h=0;h<y;h++)p[h]=v[h][D];c.push(p)}return c.length===1?c[0]:c},o.map=function(v,c,p){var y,q,h,D,R;for(i(v[0])||(v=[v]),q=v.length,h=v[0].length,D=p?v:new Array(q),y=0;y<q;y++)for(D[y]||(D[y]=new Array(h)),R=0;R<h;R++)D[y][R]=c(v[y][R],y,R);return D.length===1?D[0]:D},o.cumreduce=function(v,c,p){var y,q,h,D,R;for(i(v[0])||(v=[v]),q=v.length,h=v[0].length,D=p?v:new Array(q),y=0;y<q;y++)for(D[y]||(D[y]=new Array(h)),h>0&&(D[y][0]=v[y][0]),R=1;R<h;R++)D[y][R]=c(D[y][R-1],v[y][R]);return D.length===1?D[0]:D},o.alter=function(v,c){return o.map(v,c,!0)},o.create=function(v,c,p){var y=new Array(v),q,h;for(n(c)&&(p=c,c=v),q=0;q<v;q++)for(y[q]=new Array(c),h=0;h<c;h++)y[q][h]=p(q,h);return y};function l(){return 0}o.zeros=function(v,c){return r(c)||(c=v),o.create(v,c,l)};function t(){return 1}o.ones=function(v,c){return r(c)||(c=v),o.create(v,c,t)},o.rand=function(v,c){return r(c)||(c=v),o.create(v,c,o._random_fn)};function s(m,v){return m===v?1:0}o.identity=function(v,c){return r(c)||(c=v),o.create(v,c,s)},o.symmetric=function(v){var c=v.length,p,y;if(v.length!==v[0].length)return!1;for(p=0;p<c;p++)for(y=0;y<c;y++)if(v[y][p]!==v[p][y])return!1;return!0},o.clear=function(v){return o.alter(v,l)},o.seq=function(v,c,p,y){n(y)||(y=!1);var q=[],h=d(v,c),D=(c*h-v*h)/((p-1)*h),R=v,z;for(z=0;R<=c&&z<p;z++,R=(v*h+D*h*z)/h)q.push(y?y(R,z):R);return q},o.arange=function(v,c,p){var y=[],q;if(p=p||1,c===f&&(c=v,v=0),v===c||p===0)return[];if(v<c&&p<0)return[];if(v>c&&p>0)return[];if(p>0)for(q=v;q<c;q+=p)y.push(q);else for(q=v;q>c;q+=p)y.push(q);return y},o.slice=function(){function m(c,p,y,q){var h,D=[],R=c.length;if(p===f&&y===f&&q===f)return o.copy(c);if(p=p||0,y=y||c.length,p=p>=0?p:R+p,y=y>=0?y:R+y,q=q||1,p===y||q===0)return[];if(p<y&&q<0)return[];if(p>y&&q>0)return[];if(q>0)for(h=p;h<y;h+=q)D.push(c[h]);else for(h=p;h>y;h+=q)D.push(c[h]);return D}function v(c,p){var y,q;if(p=p||{},r(p.row)){if(r(p.col))return c[p.row][p.col];var h=o.rowa(c,p.row);return y=p.col||{},m(h,y.start,y.end,y.step)}if(r(p.col)){var D=o.cola(c,p.col);return q=p.row||{},m(D,q.start,q.end,q.step)}q=p.row||{},y=p.col||{};var R=m(c,q.start,q.end,q.step);return R.map(function(z){return m(z,y.start,y.end,y.step)})}return v}(),o.sliceAssign=function(v,c,p){var y,q;if(r(c.row)){if(r(c.col))return v[c.row][c.col]=p;c.col=c.col||{},c.col.start=c.col.start||0,c.col.end=c.col.end||v[0].length,c.col.step=c.col.step||1,y=o.arange(c.col.start,u.min(v.length,c.col.end),c.col.step);var h=c.row;return y.forEach(function(R,z){v[h][R]=p[z]}),v}if(r(c.col)){c.row=c.row||{},c.row.start=c.row.start||0,c.row.end=c.row.end||v.length,c.row.step=c.row.step||1,q=o.arange(c.row.start,u.min(v[0].length,c.row.end),c.row.step);var D=c.col;return q.forEach(function(R,z){v[R][D]=p[z]}),v}return p[0].length===f&&(p=[p]),c.row.start=c.row.start||0,c.row.end=c.row.end||v.length,c.row.step=c.row.step||1,c.col.start=c.col.start||0,c.col.end=c.col.end||v[0].length,c.col.step=c.col.step||1,q=o.arange(c.row.start,u.min(v.length,c.row.end),c.row.step),y=o.arange(c.col.start,u.min(v[0].length,c.col.end),c.col.step),q.forEach(function(R,z){y.forEach(function(P,E){v[R][P]=p[z][E]})}),v},o.diagonal=function(v){var c=o.zeros(v.length,v.length);return v.forEach(function(p,y){c[y][y]=p}),c},o.copy=function(v){return v.map(function(c){return r(c)?c:c.map(function(p){return p})})};var a=o.prototype;return a.length=0,a.push=Array.prototype.push,a.sort=Array.prototype.sort,a.splice=Array.prototype.splice,a.slice=Array.prototype.slice,a.toArray=function(){return this.length>1?g.call(this):g.call(this)[0]},a.map=function(v,c){return o(o.map(this,v,c))},a.cumreduce=function(v,c){return o(o.cumreduce(this,v,c))},a.alter=function(v){return o.alter(this,v),this},function(m){for(var v=0;v<m.length;v++)(function(c){a[c]=function(p){var y=this,q;return p?(setTimeout(function(){p.call(y,a[c].call(y))}),this):(q=o[c](this),i(q)?o(q):q)}})(m[v])}("transpose clear symmetric rows cols dimensions diag antidiag".split(" ")),function(m){for(var v=0;v<m.length;v++)(function(c){a[c]=function(p,y){var q=this;return y?(setTimeout(function(){y.call(q,a[c].call(q,p))}),this):o(o[c](this,p))}})(m[v])}("row col".split(" ")),function(m){for(var v=0;v<m.length;v++)(function(c){a[c]=function(){return o(o[c].apply(null,arguments))}})(m[v])}("create zeros ones rand identity".split(" ")),o}(Math);return function(u,f){var _=u.utils.isFunction;function g(i,n){return i-n}function w(i,n,r){return f.max(n,f.min(i,r))}u.sum=function(n){for(var r=0,e=n.length;--e>=0;)r+=n[e];return r},u.sumsqrd=function(n){for(var r=0,e=n.length;--e>=0;)r+=n[e]*n[e];return r},u.sumsqerr=function(n){for(var r=u.mean(n),e=0,o=n.length,l;--o>=0;)l=n[o]-r,e+=l*l;return e},u.sumrow=function(n){for(var r=0,e=n.length;--e>=0;)r+=n[e];return r},u.product=function(n){for(var r=1,e=n.length;--e>=0;)r*=n[e];return r},u.min=function(n){for(var r=n[0],e=0;++e<n.length;)n[e]<r&&(r=n[e]);return r},u.max=function(n){for(var r=n[0],e=0;++e<n.length;)n[e]>r&&(r=n[e]);return r},u.unique=function(n){for(var r={},e=[],o=0;o<n.length;o++)r[n[o]]||(r[n[o]]=!0,e.push(n[o]));return e},u.mean=function(n){return u.sum(n)/n.length},u.meansqerr=function(n){return u.sumsqerr(n)/n.length},u.geomean=function(n){var r=n.map(f.log),e=u.mean(r);return f.exp(e)},u.median=function(n){var r=n.length,e=n.slice().sort(g);return r&1?e[r/2|0]:(e[r/2-1]+e[r/2])/2},u.cumsum=function(n){return u.cumreduce(n,function(r,e){return r+e})},u.cumprod=function(n){return u.cumreduce(n,function(r,e){return r*e})},u.diff=function(n){var r=[],e=n.length,o;for(o=1;o<e;o++)r.push(n[o]-n[o-1]);return r},u.rank=function(i){var n,r=[],e={};for(n=0;n<i.length;n++){var o=i[n];e[o]?e[o]++:(e[o]=1,r.push(o))}var l=r.sort(g),t={},s=1;for(n=0;n<l.length;n++){var o=l[n],a=e[o],m=s,v=s+a-1,c=(m+v)/2;t[o]=c,s+=a}return i.map(function(p){return t[p]})},u.mode=function(n){var r=n.length,e=n.slice().sort(g),o=1,l=0,t=0,s=[],a;for(a=0;a<r;a++)e[a]===e[a+1]?o++:(o>l?(s=[e[a]],l=o,t=0):o===l&&(s.push(e[a]),t++),o=1);return t===0?s[0]:s},u.range=function(n){return u.max(n)-u.min(n)},u.variance=function(n,r){return u.sumsqerr(n)/(n.length-(r?1:0))},u.pooledvariance=function(n){var r=n.reduce(function(o,l){return o+u.sumsqerr(l)},0),e=n.reduce(function(o,l){return o+l.length},0);return r/(e-n.length)},u.deviation=function(i){for(var n=u.mean(i),r=i.length,e=new Array(r),o=0;o<r;o++)e[o]=i[o]-n;return e},u.stdev=function(n,r){return f.sqrt(u.variance(n,r))},u.pooledstdev=function(n){return f.sqrt(u.pooledvariance(n))},u.meandev=function(n){for(var r=u.mean(n),e=[],o=n.length-1;o>=0;o--)e.push(f.abs(n[o]-r));return u.mean(e)},u.meddev=function(n){for(var r=u.median(n),e=[],o=n.length-1;o>=0;o--)e.push(f.abs(n[o]-r));return u.median(e)},u.coeffvar=function(n){return u.stdev(n)/u.mean(n)},u.quartiles=function(n){var r=n.length,e=n.slice().sort(g);return[e[f.round(r/4)-1],e[f.round(r/2)-1],e[f.round(r*3/4)-1]]},u.quantiles=function(n,r,e,o){var l=n.slice().sort(g),t=[r.length],s=n.length,a,m,v,c,p,y;for(typeof e>"u"&&(e=3/8),typeof o>"u"&&(o=3/8),a=0;a<r.length;a++)m=r[a],v=e+m*(1-e-o),c=s*m+v,p=f.floor(w(c,1,s-1)),y=w(c-p,0,1),t[a]=(1-y)*l[p-1]+y*l[p];return t},u.percentile=function(n,r,e){var o=n.slice().sort(g),l=r*(o.length+(e?1:-1))+(e?0:1),t=parseInt(l),s=l-t;return t+1<o.length?o[t-1]+s*(o[t]-o[t-1]):o[t-1]},u.percentileOfScore=function(n,r,e){var o=0,l=n.length,t=!1,s,a;for(e==="strict"&&(t=!0),a=0;a<l;a++)s=n[a],(t&&s<r||!t&&s<=r)&&o++;return o/l},u.histogram=function(n,r){r=r||4;var e=u.min(n),o=(u.max(n)-e)/r,l=n.length,t=[],s;for(s=0;s<r;s++)t[s]=0;for(s=0;s<l;s++)t[f.min(f.floor((n[s]-e)/o),r-1)]+=1;return t},u.covariance=function(n,r){var e=u.mean(n),o=u.mean(r),l=n.length,t=new Array(l),s;for(s=0;s<l;s++)t[s]=(n[s]-e)*(r[s]-o);return u.sum(t)/(l-1)},u.corrcoeff=function(n,r){return u.covariance(n,r)/u.stdev(n,1)/u.stdev(r,1)},u.spearmancoeff=function(i,n){return i=u.rank(i),n=u.rank(n),u.corrcoeff(i,n)},u.stanMoment=function(n,r){for(var e=u.mean(n),o=u.stdev(n),l=n.length,t=0,s=0;s<l;s++)t+=f.pow((n[s]-e)/o,r);return t/n.length},u.skewness=function(n){return u.stanMoment(n,3)},u.kurtosis=function(n){return u.stanMoment(n,4)-3};var d=u.prototype;(function(i){for(var n=0;n<i.length;n++)(function(r){d[r]=function(e,o){var l=[],t=0,s=this;if(_(e)&&(o=e,e=!1),o)return setTimeout(function(){o.call(s,d[r].call(s,e))}),this;if(this.length>1){for(s=e===!0?this:this.transpose();t<s.length;t++)l[t]=u[r](s[t]);return l}return u[r](this[0],e)}})(i[n])})("cumsum cumprod".split(" ")),function(i){for(var n=0;n<i.length;n++)(function(r){d[r]=function(e,o){var l=[],t=0,s=this;if(_(e)&&(o=e,e=!1),o)return setTimeout(function(){o.call(s,d[r].call(s,e))}),this;if(this.length>1){for(r!=="sumrow"&&(s=e===!0?this:this.transpose());t<s.length;t++)l[t]=u[r](s[t]);return e===!0?u[r](u.utils.toVector(l)):l}return u[r](this[0],e)}})(i[n])}("sum sumsqrd sumsqerr sumrow product min max unique mean meansqerr geomean median diff rank mode range variance deviation stdev meandev meddev coeffvar quartiles histogram skewness kurtosis".split(" ")),function(i){for(var n=0;n<i.length;n++)(function(r){d[r]=function(){var e=[],o=0,l=this,t=Array.prototype.slice.call(arguments),s;if(_(t[t.length-1])){s=t[t.length-1];var a=t.slice(0,t.length-1);return setTimeout(function(){s.call(l,d[r].apply(l,a))}),this}else{s=void 0;var m=function(c){return u[r].apply(l,[c].concat(t))}}if(this.length>1){for(l=l.transpose();o<l.length;o++)e[o]=m(l[o]);return e}return m(this[0])}})(i[n])}("quantiles percentileOfScore".split(" "))}(b,Math),function(u,f){u.gammaln=function(g){var w=0,d=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],i=1.000000000190015,n,r,e;for(e=(r=n=g)+5.5,e-=(n+.5)*f.log(e);w<6;w++)i+=d[w]/++r;return f.log(2.5066282746310007*i/n)-e},u.loggam=function(g){var w,d,i,n,r,e,o,l=[.08333333333333333,-.002777777777777778,.0007936507936507937,-.0005952380952380952,.0008417508417508418,-.001917526917526918,.00641025641025641,-.02955065359477124,.1796443723688307,-1.3924322169059];if(w=g,o=0,g==1||g==2)return 0;for(g<=7&&(o=f.floor(7-g),w=g+o),d=1/(w*w),i=2*f.PI,r=l[9],e=8;e>=0;e--)r*=d,r+=l[e];if(n=r/w+.5*f.log(i)+(w-.5)*f.log(w)-w,g<=7)for(e=1;e<=o;e++)n-=f.log(w-1),w-=1;return n},u.gammafn=function(g){var w=[-1.716185138865495,24.76565080557592,-379.80425647094563,629.3311553128184,866.9662027904133,-31451.272968848367,-36144.413418691176,66456.14382024054],d=[-30.8402300119739,315.35062697960416,-1015.1563674902192,-3107.771671572311,22538.11842098015,4755.846277527881,-134659.9598649693,-115132.2596755535],i=!1,n=0,r=0,e=0,o=g,l,t,s,a;if(g>171.6243769536076)return 1/0;if(o<=0)if(a=o%1+36e-17,a)i=(o&1?-1:1)*f.PI/f.sin(f.PI*a),o=1-o;else return 1/0;for(s=o,o<1?t=o++:t=(o-=n=(o|0)-1)-1,l=0;l<8;++l)e=(e+w[l])*t,r=r*t+d[l];if(a=e/r+1,s<o)a/=s;else if(s>o)for(l=0;l<n;++l)a*=o,o++;return i&&(a=i/a),a},u.gammap=function(g,w){return u.lowRegGamma(g,w)*u.gammafn(g)},u.lowRegGamma=function(g,w){var d=u.gammaln(g),i=g,n=1/g,r=n,e=w+1-g,o=1/1e-30,l=1/e,t=l,s=1,a=-~(f.log(g>=1?g:1/g)*8.5+g*.4+17),m;if(w<0||g<=0)return NaN;if(w<g+1){for(;s<=a;s++)n+=r*=w/++i;return n*f.exp(-w+g*f.log(w)-d)}for(;s<=a;s++)m=-s*(s-g),e+=2,l=m*l+e,o=e+m/o,l=1/l,t*=l*o;return 1-t*f.exp(-w+g*f.log(w)-d)},u.factorialln=function(g){return g<0?NaN:u.gammaln(g+1)},u.factorial=function(g){return g<0?NaN:u.gammafn(g+1)},u.combination=function(g,w){return g>170||w>170?f.exp(u.combinationln(g,w)):u.factorial(g)/u.factorial(w)/u.factorial(g-w)},u.combinationln=function(g,w){return u.factorialln(g)-u.factorialln(w)-u.factorialln(g-w)},u.permutation=function(g,w){return u.factorial(g)/u.factorial(g-w)},u.betafn=function(g,w){if(!(g<=0||w<=0))return g+w>170?f.exp(u.betaln(g,w)):u.gammafn(g)*u.gammafn(w)/u.gammafn(g+w)},u.betaln=function(g,w){return u.gammaln(g)+u.gammaln(w)-u.gammaln(g+w)},u.betacf=function(g,w,d){var i=1e-30,n=1,r=w+d,e=w+1,o=w-1,l=1,t=1-r*g/e,s,a,m,v;for(f.abs(t)<i&&(t=i),t=1/t,v=t;n<=100&&(s=2*n,a=n*(d-n)*g/((o+s)*(w+s)),t=1+a*t,f.abs(t)<i&&(t=i),l=1+a/l,f.abs(l)<i&&(l=i),t=1/t,v*=t*l,a=-(w+n)*(r+n)*g/((w+s)*(e+s)),t=1+a*t,f.abs(t)<i&&(t=i),l=1+a/l,f.abs(l)<i&&(l=i),t=1/t,m=t*l,v*=m,!(f.abs(m-1)<3e-7));n++);return v},u.gammapinv=function(g,w){var d=0,i=w-1,n=1e-8,r=u.gammaln(w),e,o,l,t,s,a,m;if(g>=1)return f.max(100,w+100*f.sqrt(w));if(g<=0)return 0;for(w>1?(a=f.log(i),m=f.exp(i*(a-1)-r),s=g<.5?g:1-g,l=f.sqrt(-2*f.log(s)),e=(2.30753+l*.27061)/(1+l*(.99229+l*.04481))-l,g<.5&&(e=-e),e=f.max(.001,w*f.pow(1-1/(9*w)-e/(3*f.sqrt(w)),3))):(l=1-w*(.253+w*.12),g<l?e=f.pow(g/l,1/w):e=1-f.log(1-(g-l)/(1-l)));d<12;d++){if(e<=0)return 0;if(o=u.lowRegGamma(w,e)-g,w>1?l=m*f.exp(-(e-i)+i*(f.log(e)-a)):l=f.exp(-e+i*f.log(e)-r),t=o/l,e-=l=t/(1-.5*f.min(1,t*((w-1)/e-1))),e<=0&&(e=.5*(e+l)),f.abs(l)<n*e)break}return e},u.erf=function(g){var w=[-1.3026537197817094,.6419697923564902,.019476473204185836,-.00956151478680863,-.000946595344482036,.000366839497852761,42523324806907e-18,-20278578112534e-18,-1624290004647e-18,130365583558e-17,15626441722e-18,-85238095915e-18,6529054439e-18,5059343495e-18,-991364156e-18,-227365122e-18,96467911e-18,2394038e-18,-6886027e-18,894487e-18,313092e-18,-112708e-18,381e-18,7106e-18,-1523e-18,-94e-18,121e-18,-28e-18],d=w.length-1,i=!1,n=0,r=0,e,o,l,t;for(g<0&&(g=-g,i=!0),e=2/(2+g),o=4*e-2;d>0;d--)l=n,n=o*n-r+w[d],r=l;return t=e*f.exp(-g*g+.5*(w[0]+o*n)-r),i?t-1:1-t},u.erfc=function(g){return 1-u.erf(g)},u.erfcinv=function(g){var w=0,d,i,n,r;if(g>=2)return-100;if(g<=0)return 100;for(r=g<1?g:2-g,n=f.sqrt(-2*f.log(r/2)),d=-.70711*((2.30753+n*.27061)/(1+n*(.99229+n*.04481))-n);w<2;w++)i=u.erfc(d)-r,d+=i/(1.1283791670955126*f.exp(-d*d)-d*i);return g<1?d:-d},u.ibetainv=function(g,w,d){var i=1e-8,n=w-1,r=d-1,e=0,o,l,t,s,a,m,v,c,p,y,q;if(g<=0)return 0;if(g>=1)return 1;for(w>=1&&d>=1?(t=g<.5?g:1-g,s=f.sqrt(-2*f.log(t)),v=(2.30753+s*.27061)/(1+s*(.99229+s*.04481))-s,g<.5&&(v=-v),c=(v*v-3)/6,p=2/(1/(2*w-1)+1/(2*d-1)),y=v*f.sqrt(c+p)/p-(1/(2*d-1)-1/(2*w-1))*(c+5/6-2/(3*p)),v=w/(w+d*f.exp(2*y))):(o=f.log(w/(w+d)),l=f.log(d/(w+d)),s=f.exp(w*o)/w,a=f.exp(d*l)/d,y=s+a,g<s/y?v=f.pow(w*y*g,1/w):v=1-f.pow(d*y*(1-g),1/d)),q=-u.gammaln(w)-u.gammaln(d)+u.gammaln(w+d);e<10;e++){if(v===0||v===1)return v;if(m=u.ibeta(v,w,d)-g,s=f.exp(n*f.log(v)+r*f.log(1-v)+q),a=m/s,v-=s=a/(1-.5*f.min(1,a*(n/v-r/(1-v)))),v<=0&&(v=.5*(v+s)),v>=1&&(v=.5*(v+s+1)),f.abs(s)<i*v&&e>0)break}return v},u.ibeta=function(g,w,d){var i=g===0||g===1?0:f.exp(u.gammaln(w+d)-u.gammaln(w)-u.gammaln(d)+w*f.log(g)+d*f.log(1-g));return g<0||g>1?!1:g<(w+1)/(w+d+2)?i*u.betacf(g,w,d)/w:1-i*u.betacf(1-g,d,w)/d},u.randn=function(g,w){var d,i,n,r,e;if(w||(w=g),g)return u.create(g,w,function(){return u.randn()});do d=u._random_fn(),i=1.7156*(u._random_fn()-.5),n=d-.449871,r=f.abs(i)+.386595,e=n*n+r*(.196*r-.25472*n);while(e>.27597&&(e>.27846||i*i>-4*f.log(d)*d*d));return i/d},u.randg=function(g,w,d){var i=g,n,r,e,o,l,t;if(d||(d=w),g||(g=1),w)return t=u.zeros(w,d),t.alter(function(){return u.randg(g)}),t;g<1&&(g+=1),n=g-1/3,r=1/f.sqrt(9*n);do{do l=u.randn(),o=1+r*l;while(o<=0);o=o*o*o,e=u._random_fn()}while(e>1-.331*f.pow(l,4)&&f.log(e)>.5*l*l+n*(1-o+f.log(o)));if(g==i)return n*o;do e=u._random_fn();while(e===0);return f.pow(e,1/i)*n*o},function(_){for(var g=0;g<_.length;g++)(function(w){u.fn[w]=function(){return u(u.map(this,function(d){return u[w](d)}))}})(_[g])}("gammaln gammafn factorial factorialln".split(" ")),function(_){for(var g=0;g<_.length;g++)(function(w){u.fn[w]=function(){return u(u[w].apply(null,arguments))}})(_[g])}("randn".split(" "))}(b,Math),function(u,f){(function(i){for(var n=0;n<i.length;n++)(function(r){u[r]=function e(o,l,t){return this instanceof e?(this._a=o,this._b=l,this._c=t,this):new e(o,l,t)},u.fn[r]=function(e,o,l){var t=u[r](e,o,l);return t.data=this,t},u[r].prototype.sample=function(e){var o=this._a,l=this._b,t=this._c;return e?u.alter(e,function(){return u[r].sample(o,l,t)}):u[r].sample(o,l,t)},function(e){for(var o=0;o<e.length;o++)(function(l){u[r].prototype[l]=function(t){var s=this._a,a=this._b,m=this._c;return!t&&t!==0&&(t=this.data),typeof t!="number"?u.fn.map.call(t,function(v){return u[r][l](v,s,a,m)}):u[r][l](t,s,a,m)}})(e[o])}("pdf cdf inv".split(" ")),function(e){for(var o=0;o<e.length;o++)(function(l){u[r].prototype[l]=function(){return u[r][l](this._a,this._b,this._c)}})(e[o])}("mean median mode variance".split(" "))})(i[n])})("beta centralF cauchy chisquare exponential gamma invgamma kumaraswamy laplace lognormal noncentralt normal pareto studentt weibull uniform binomial negbin hypgeom poisson triangular tukey arcsine".split(" ")),u.extend(u.beta,{pdf:function(n,r,e){return n>1||n<0?0:r==1&&e==1?1:r<512&&e<512?f.pow(n,r-1)*f.pow(1-n,e-1)/u.betafn(r,e):f.exp((r-1)*f.log(n)+(e-1)*f.log(1-n)-u.betaln(r,e))},cdf:function(n,r,e){return n>1||n<0?(n>1)*1:u.ibeta(n,r,e)},inv:function(n,r,e){return u.ibetainv(n,r,e)},mean:function(n,r){return n/(n+r)},median:function(n,r){return u.ibetainv(.5,n,r)},mode:function(n,r){return(n-1)/(n+r-2)},sample:function(n,r){var e=u.randg(n);return e/(e+u.randg(r))},variance:function(n,r){return n*r/(f.pow(n+r,2)*(n+r+1))}}),u.extend(u.centralF,{pdf:function(n,r,e){var o,l,t;return n<0?0:r<=2?n===0&&r<2?1/0:n===0&&r===2?1:1/u.betafn(r/2,e/2)*f.pow(r/e,r/2)*f.pow(n,r/2-1)*f.pow(1+r/e*n,-(r+e)/2):(o=r*n/(e+n*r),l=e/(e+n*r),t=r*l/2,t*u.binomial.pdf((r-2)/2,(r+e-2)/2,o))},cdf:function(n,r,e){return n<0?0:u.ibeta(r*n/(r*n+e),r/2,e/2)},inv:function(n,r,e){return e/(r*(1/u.ibetainv(n,r/2,e/2)-1))},mean:function(n,r){return r>2?r/(r-2):void 0},mode:function(n,r){return n>2?r*(n-2)/(n*(r+2)):void 0},sample:function(n,r){var e=u.randg(n/2)*2,o=u.randg(r/2)*2;return e/n/(o/r)},variance:function(n,r){if(!(r<=4))return 2*r*r*(n+r-2)/(n*(r-2)*(r-2)*(r-4))}}),u.extend(u.cauchy,{pdf:function(n,r,e){return e<0?0:e/(f.pow(n-r,2)+f.pow(e,2))/f.PI},cdf:function(n,r,e){return f.atan((n-r)/e)/f.PI+.5},inv:function(i,n,r){return n+r*f.tan(f.PI*(i-.5))},median:function(n){return n},mode:function(n){return n},sample:function(n,r){return u.randn()*f.sqrt(1/(2*u.randg(.5)))*r+n}}),u.extend(u.chisquare,{pdf:function(n,r){return n<0?0:n===0&&r===2?.5:f.exp((r/2-1)*f.log(n)-n/2-r/2*f.log(2)-u.gammaln(r/2))},cdf:function(n,r){return n<0?0:u.lowRegGamma(r/2,n/2)},inv:function(i,n){return 2*u.gammapinv(i,.5*n)},mean:function(i){return i},median:function(n){return n*f.pow(1-2/(9*n),3)},mode:function(n){return n-2>0?n-2:0},sample:function(n){return u.randg(n/2)*2},variance:function(n){return 2*n}}),u.extend(u.exponential,{pdf:function(n,r){return n<0?0:r*f.exp(-r*n)},cdf:function(n,r){return n<0?0:1-f.exp(-r*n)},inv:function(i,n){return-f.log(1-i)/n},mean:function(i){return 1/i},median:function(i){return 1/i*f.log(2)},mode:function(){return 0},sample:function(n){return-1/n*f.log(u._random_fn())},variance:function(i){return f.pow(i,-2)}}),u.extend(u.gamma,{pdf:function(n,r,e){return n<0?0:n===0&&r===1?1/e:f.exp((r-1)*f.log(n)-n/e-u.gammaln(r)-r*f.log(e))},cdf:function(n,r,e){return n<0?0:u.lowRegGamma(r,n/e)},inv:function(i,n,r){return u.gammapinv(i,n)*r},mean:function(i,n){return i*n},mode:function(n,r){if(n>1)return(n-1)*r},sample:function(n,r){return u.randg(n)*r},variance:function(n,r){return n*r*r}}),u.extend(u.invgamma,{pdf:function(n,r,e){return n<=0?0:f.exp(-(r+1)*f.log(n)-e/n-u.gammaln(r)+r*f.log(e))},cdf:function(n,r,e){return n<=0?0:1-u.lowRegGamma(r,e/n)},inv:function(i,n,r){return r/u.gammapinv(1-i,n)},mean:function(i,n){return i>1?n/(i-1):void 0},mode:function(n,r){return r/(n+1)},sample:function(n,r){return r/u.randg(n)},variance:function(n,r){if(!(n<=2))return r*r/((n-1)*(n-1)*(n-2))}}),u.extend(u.kumaraswamy,{pdf:function(n,r,e){return n===0&&r===1?e:n===1&&e===1?r:f.exp(f.log(r)+f.log(e)+(r-1)*f.log(n)+(e-1)*f.log(1-f.pow(n,r)))},cdf:function(n,r,e){return n<0?0:n>1?1:1-f.pow(1-f.pow(n,r),e)},inv:function(n,r,e){return f.pow(1-f.pow(1-n,1/e),1/r)},mean:function(i,n){return n*u.gammafn(1+1/i)*u.gammafn(n)/u.gammafn(1+1/i+n)},median:function(n,r){return f.pow(1-f.pow(2,-1/r),1/n)},mode:function(n,r){if(n>=1&&r>=1&&n!==1&&r!==1)return f.pow((n-1)/(n*r-1),1/n)},variance:function(){throw new Error("variance not yet implemented")}}),u.extend(u.lognormal,{pdf:function(n,r,e){return n<=0?0:f.exp(-f.log(n)-.5*f.log(2*f.PI)-f.log(e)-f.pow(f.log(n)-r,2)/(2*e*e))},cdf:function(n,r,e){return n<0?0:.5+.5*u.erf((f.log(n)-r)/f.sqrt(2*e*e))},inv:function(i,n,r){return f.exp(-1.4142135623730951*r*u.erfcinv(2*i)+n)},mean:function(n,r){return f.exp(n+r*r/2)},median:function(n){return f.exp(n)},mode:function(n,r){return f.exp(n-r*r)},sample:function(n,r){return f.exp(u.randn()*r+n)},variance:function(n,r){return(f.exp(r*r)-1)*f.exp(2*n+r*r)}}),u.extend(u.noncentralt,{pdf:function(n,r,e){var o=1e-14;return f.abs(e)<o?u.studentt.pdf(n,r):f.abs(n)<o?f.exp(u.gammaln((r+1)/2)-e*e/2-.5*f.log(f.PI*r)-u.gammaln(r/2)):r/n*(u.noncentralt.cdf(n*f.sqrt(1+2/r),r+2,e)-u.noncentralt.cdf(n,r,e))},cdf:function(n,r,e){var o=1e-14,l=200;if(f.abs(e)<o)return u.studentt.cdf(n,r);var t=!1;n<0&&(t=!0,e=-e);for(var s=u.normal.cdf(-e,0,1),a=o+1,m=a,v=n*n/(n*n+r),c=0,p=f.exp(-e*e/2),y=f.exp(-e*e/2-.5*f.log(2)-u.gammaln(3/2))*e;c<l||m>o||a>o;)m=a,c>0&&(p*=e*e/(2*c),y*=e*e/(2*(c+1/2))),a=p*u.beta.cdf(v,c+.5,r/2)+y*u.beta.cdf(v,c+1,r/2),s+=.5*a,c++;return t?1-s:s}}),u.extend(u.normal,{pdf:function(n,r,e){return f.exp(-.5*f.log(2*f.PI)-f.log(e)-f.pow(n-r,2)/(2*e*e))},cdf:function(n,r,e){return .5*(1+u.erf((n-r)/f.sqrt(2*e*e)))},inv:function(i,n,r){return-1.4142135623730951*r*u.erfcinv(2*i)+n},mean:function(i){return i},median:function(n){return n},mode:function(i){return i},sample:function(n,r){return u.randn()*r+n},variance:function(i,n){return n*n}}),u.extend(u.pareto,{pdf:function(n,r,e){return n<r?0:e*f.pow(r,e)/f.pow(n,e+1)},cdf:function(n,r,e){return n<r?0:1-f.pow(r/n,e)},inv:function(n,r,e){return r/f.pow(1-n,1/e)},mean:function(n,r){if(!(r<=1))return r*f.pow(n,r)/(r-1)},median:function(n,r){return n*(r*f.SQRT2)},mode:function(n){return n},variance:function(i,n){if(!(n<=2))return i*i*n/(f.pow(n-1,2)*(n-2))}}),u.extend(u.studentt,{pdf:function(n,r){return r=r>1e100?1e100:r,1/(f.sqrt(r)*u.betafn(.5,r/2))*f.pow(1+n*n/r,-((r+1)/2))},cdf:function(n,r){var e=r/2;return u.ibeta((n+f.sqrt(n*n+r))/(2*f.sqrt(n*n+r)),e,e)},inv:function(i,n){var r=u.ibetainv(2*f.min(i,1-i),.5*n,.5);return r=f.sqrt(n*(1-r)/r),i>.5?r:-r},mean:function(n){return n>1?0:void 0},median:function(){return 0},mode:function(){return 0},sample:function(n){return u.randn()*f.sqrt(n/(2*u.randg(n/2)))},variance:function(n){return n>2?n/(n-2):n>1?1/0:void 0}}),u.extend(u.weibull,{pdf:function(n,r,e){return n<0||r<0||e<0?0:e/r*f.pow(n/r,e-1)*f.exp(-f.pow(n/r,e))},cdf:function(n,r,e){return n<0?0:1-f.exp(-f.pow(n/r,e))},inv:function(i,n,r){return n*f.pow(-f.log(1-i),1/r)},mean:function(i,n){return i*u.gammafn(1+1/n)},median:function(n,r){return n*f.pow(f.log(2),1/r)},mode:function(n,r){return r<=1?0:n*f.pow((r-1)/r,1/r)},sample:function(n,r){return n*f.pow(-f.log(u._random_fn()),1/r)},variance:function(n,r){return n*n*u.gammafn(1+2/r)-f.pow(u.weibull.mean(n,r),2)}}),u.extend(u.uniform,{pdf:function(n,r,e){return n<r||n>e?0:1/(e-r)},cdf:function(n,r,e){return n<r?0:n<e?(n-r)/(e-r):1},inv:function(i,n,r){return n+i*(r-n)},mean:function(n,r){return .5*(n+r)},median:function(n,r){return u.mean(n,r)},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,r){return n/2+r/2+(r/2-n/2)*(2*u._random_fn()-1)},variance:function(n,r){return f.pow(r-n,2)/12}});function _(i,n,r,e){for(var o=0,l=1,t=1,s=1,a=0,m=0,v;f.abs((t-m)/t)>e;)m=t,v=-(n+a)*(n+r+a)*i/(n+2*a)/(n+2*a+1),o=t+v*o,l=s+v*l,a=a+1,v=a*(r-a)*i/(n+2*a-1)/(n+2*a),t=o+v*t,s=l+v*s,o=o/s,l=l/s,t=t/s,s=1;return t/n}u.extend(u.binomial,{pdf:function(n,r,e){return e===0||e===1?r*e===n?1:0:u.combination(r,n)*f.pow(e,n)*f.pow(1-e,r-n)},cdf:function(n,r,e){var o,l=1e-10;if(n<0)return 0;if(n>=r)return 1;if(e<0||e>1||r<=0)return NaN;n=f.floor(n);var t=e,s=n+1,a=r-n,m=s+a,v=f.exp(u.gammaln(m)-u.gammaln(a)-u.gammaln(s)+s*f.log(t)+a*f.log(1-t));return t<(s+1)/(m+2)?o=v*_(t,s,a,l):o=1-v*_(1-t,a,s,l),f.round((1-o)*(1/l))/(1/l)}}),u.extend(u.negbin,{pdf:function(n,r,e){return n!==n>>>0?!1:n<0?0:u.combination(n+r-1,r-1)*f.pow(1-e,n)*f.pow(e,r)},cdf:function(n,r,e){var o=0,l=0;if(n<0)return 0;for(;l<=n;l++)o+=u.negbin.pdf(l,r,e);return o}}),u.extend(u.hypgeom,{pdf:function(n,r,e,o){if(n!==n|0)return!1;if(n<0||n<e-(r-o))return 0;if(n>o||n>e)return 0;if(e*2>r)return o*2>r?u.hypgeom.pdf(r-e-o+n,r,r-e,r-o):u.hypgeom.pdf(o-n,r,r-e,o);if(o*2>r)return u.hypgeom.pdf(e-n,r,e,r-o);if(e<o)return u.hypgeom.pdf(n,r,o,e);for(var l=1,t=0,s=0;s<n;s++){for(;l>1&&t<o;)l*=1-e/(r-t),t++;l*=(o-s)*(e-s)/((s+1)*(r-e-o+s+1))}for(;t<o;t++)l*=1-e/(r-t);return f.min(1,f.max(0,l))},cdf:function(n,r,e,o){if(n<0||n<e-(r-o))return 0;if(n>=o||n>=e)return 1;if(e*2>r)return o*2>r?u.hypgeom.cdf(r-e-o+n,r,r-e,r-o):1-u.hypgeom.cdf(o-n-1,r,r-e,o);if(o*2>r)return 1-u.hypgeom.cdf(e-n-1,r,e,r-o);if(e<o)return u.hypgeom.cdf(n,r,o,e);for(var l=1,t=1,s=0,a=0;a<n;a++){for(;l>1&&s<o;){var m=1-e/(r-s);t*=m,l*=m,s++}t*=(o-a)*(e-a)/((a+1)*(r-e-o+a+1)),l+=t}for(;s<o;s++)l*=1-e/(r-s);return f.min(1,f.max(0,l))}}),u.extend(u.poisson,{pdf:function(n,r){return r<0||n%1!==0||n<0?0:f.pow(r,n)*f.exp(-r)/u.factorial(n)},cdf:function(n,r){var e=[],o=0;if(n<0)return 0;for(;o<=n;o++)e.push(u.poisson.pdf(o,r));return u.sum(e)},mean:function(i){return i},variance:function(i){return i},sampleSmall:function(n){var r=1,e=0,o=f.exp(-n);do e++,r*=u._random_fn();while(r>o);return e-1},sampleLarge:function(n){var r=n,e,o,l,t,s,a,m,v,c,p;for(t=f.sqrt(r),s=f.log(r),m=.931+2.53*t,a=-.059+.02483*m,v=1.1239+1.1328/(m-3.4),c=.9277-3.6224/(m-2);;){if(o=f.random()-.5,l=f.random(),p=.5-f.abs(o),e=f.floor((2*a/p+m)*o+r+.43),p>=.07&&l<=c)return e;if(!(e<0||p<.013&&l>p)&&f.log(l)+f.log(v)-f.log(a/(p*p)+m)<=-r+e*s-u.loggam(e+1))return e}},sample:function(n){return n<10?this.sampleSmall(n):this.sampleLarge(n)}}),u.extend(u.triangular,{pdf:function(n,r,e,o){return e<=r||o<r||o>e?NaN:n<r||n>e?0:n<o?2*(n-r)/((e-r)*(o-r)):n===o?2/(e-r):2*(e-n)/((e-r)*(e-o))},cdf:function(n,r,e,o){return e<=r||o<r||o>e?NaN:n<=r?0:n>=e?1:n<=o?f.pow(n-r,2)/((e-r)*(o-r)):1-f.pow(e-n,2)/((e-r)*(e-o))},inv:function(n,r,e,o){return e<=r||o<r||o>e?NaN:n<=(o-r)/(e-r)?r+(e-r)*f.sqrt(n*((o-r)/(e-r))):r+(e-r)*(1-f.sqrt((1-n)*(1-(o-r)/(e-r))))},mean:function(n,r,e){return(n+r+e)/3},median:function(n,r,e){if(e<=(n+r)/2)return r-f.sqrt((r-n)*(r-e))/f.sqrt(2);if(e>(n+r)/2)return n+f.sqrt((r-n)*(e-n))/f.sqrt(2)},mode:function(n,r,e){return e},sample:function(n,r,e){var o=u._random_fn();return o<(e-n)/(r-n)?n+f.sqrt(o*(r-n)*(e-n)):r-f.sqrt((1-o)*(r-n)*(r-e))},variance:function(n,r,e){return(n*n+r*r+e*e-n*r-n*e-r*e)/18}}),u.extend(u.arcsine,{pdf:function(n,r,e){return e<=r?NaN:n<=r||n>=e?0:2/f.PI*f.pow(f.pow(e-r,2)-f.pow(2*n-r-e,2),-.5)},cdf:function(n,r,e){return n<r?0:n<e?2/f.PI*f.asin(f.sqrt((n-r)/(e-r))):1},inv:function(i,n,r){return n+(.5-.5*f.cos(f.PI*i))*(r-n)},mean:function(n,r){return r<=n?NaN:(n+r)/2},median:function(n,r){return r<=n?NaN:(n+r)/2},mode:function(){throw new Error("mode is not yet implemented")},sample:function(n,r){return(n+r)/2+(r-n)/2*f.sin(2*f.PI*u.uniform.sample(0,1))},variance:function(n,r){return r<=n?NaN:f.pow(r-n,2)/8}});function g(i){return i/f.abs(i)}u.extend(u.laplace,{pdf:function(n,r,e){return e<=0?0:f.exp(-f.abs(n-r)/e)/(2*e)},cdf:function(n,r,e){return e<=0?0:n<r?.5*f.exp((n-r)/e):1-.5*f.exp(-(n-r)/e)},mean:function(i){return i},median:function(i){return i},mode:function(i){return i},variance:function(i,n){return 2*n*n},sample:function(n,r){var e=u._random_fn()-.5;return n-r*g(e)*f.log(1-2*f.abs(e))}});function w(i,n,r){var e=12,o=6,l=-30,t=-50,s=60,a=8,m=3,v=2,c=3,p=[.9815606342467192,.9041172563704749,.7699026741943047,.5873179542866175,.3678314989981802,.1252334085114689],y=[.04717533638651183,.10693932599531843,.16007832854334622,.20316742672306592,.2334925365383548,.24914704581340277],q=i*.5;if(q>=a)return 1;var h=2*u.normal.cdf(q,0,1,1,0)-1;h>=f.exp(t/r)?h=f.pow(h,r):h=0;var D;i>m?D=v:D=c;for(var R=q,z=(a-q)/D,P=R+z,E=0,I=r-1,G=1;G<=D;G++){for(var Q=0,x=.5*(P+R),N=.5*(P-R),L=1;L<=e;L++){var A,O;o<L?(A=e-L+1,O=p[A-1]):(A=L,O=-p[A-1]);var V=N*O,k=x+V,C=k*k;if(C>s)break;var B=2*u.normal.cdf(k,0,1,1,0),U=2*u.normal.cdf(k,i,1,1,0),F=B*.5-U*.5;F>=f.exp(l/I)&&(F=y[A-1]*f.exp(-(.5*C))*f.pow(F,I),Q+=F)}Q*=2*N*r/f.sqrt(2*f.PI),E+=Q,R=P,P+=z}return h+=E,h<=f.exp(l/n)?0:(h=f.pow(h,n),h>=1?1:h)}function d(i,n,r){var e=.322232421088,o=.099348462606,l=-1,t=.588581570495,s=-.342242088547,a=.531103462366,m=-.204231210125,v=.10353775285,c=-453642210148e-16,p=.0038560700634,y=.8832,q=.2368,h=1.214,D=1.208,R=1.4142,z=120,P=.5-.5*i,E=f.sqrt(f.log(1/(P*P))),I=E+((((E*c+m)*E+s)*E+l)*E+e)/((((E*p+v)*E+a)*E+t)*E+o);r<z&&(I+=(I*I*I+I)/r/4);var G=y-q*I;return r<z&&(G+=-h/r+D*I/r),I*(G*f.log(n-1)+R)}u.extend(u.tukey,{cdf:function(n,r,e){var o=1,l=r,t=16,s=8,a=-30,m=1e-14,v=100,c=800,p=5e3,y=25e3,q=1,h=.5,D=.25,R=.125,z=[.9894009349916499,.9445750230732326,.8656312023878318,.755404408355003,.6178762444026438,.45801677765722737,.2816035507792589,.09501250983763744],P=[.027152459411754096,.062253523938647894,.09515851168249279,.12462897125553388,.14959598881657674,.16915651939500254,.18260341504492358,.1894506104550685];if(n<=0)return 0;if(e<2||o<1||l<2)return NaN;if(!Number.isFinite(n))return 1;if(e>y)return w(n,o,l);var E=e*.5,I=E*f.log(e)-e*f.log(2)-u.gammaln(E),G=E-1,Q=e*.25,x;e<=v?x=q:e<=c?x=h:e<=p?x=D:x=R,I+=f.log(x);for(var N=0,L=1;L<=50;L++){for(var A=0,O=(2*L-1)*x,V=1;V<=t;V++){var k,C;s<V?(k=V-s-1,C=I+G*f.log(O+z[k]*x)-(z[k]*x+O)*Q):(k=V-1,C=I+G*f.log(O-z[k]*x)+(z[k]*x-O)*Q);var B;if(C>=a){s<V?B=n*f.sqrt((z[k]*x+O)*.5):B=n*f.sqrt((-(z[k]*x)+O)*.5);var U=w(B,o,l),F=U*P[k]*f.exp(C);A+=F}}if(L*x>=1&&A<=m)break;N+=A}if(A>m)throw new Error("tukey.cdf failed to converge");return N>1&&(N=1),N},inv:function(i,n,r){var e=1,o=n,l=1e-4,t=50;if(r<2||e<1||o<2)return NaN;if(i<0||i>1)return NaN;if(i===0)return 0;if(i===1)return 1/0;var s=d(i,o,r),a=u.tukey.cdf(s,n,r)-i,m;a>0?m=f.max(0,s-1):m=s+1;for(var v=u.tukey.cdf(m,n,r)-i,c,p=1;p<t;p++){c=m-v*(m-s)/(v-a),a=v,s=m,c<0&&(c=0,v=-i),v=u.tukey.cdf(c,n,r)-i,m=c;var y=f.abs(m-s);if(y<l)return c}throw new Error("tukey.inv failed to converge")}})}(b,Math),function(u,f){var _=Array.prototype.push,g=u.utils.isArray;function w(d){return g(d)||d instanceof u}u.extend({add:function(i,n){return w(n)?(w(n[0])||(n=[n]),u.map(i,function(r,e,o){return r+n[e][o]})):u.map(i,function(r){return r+n})},subtract:function(i,n){return w(n)?(w(n[0])||(n=[n]),u.map(i,function(r,e,o){return r-n[e][o]||0})):u.map(i,function(r){return r-n})},divide:function(i,n){return w(n)?(w(n[0])||(n=[n]),u.multiply(i,u.inv(n))):u.map(i,function(r){return r/n})},multiply:function(i,n){var r,e,o,l,t,s,a,m;if(i.length===void 0&&n.length===void 0)return i*n;if(t=i.length,s=i[0].length,a=u.zeros(t,o=w(n)?n[0].length:s),m=0,w(n)){for(;m<o;m++)for(r=0;r<t;r++){for(l=0,e=0;e<s;e++)l+=i[r][e]*n[e][m];a[r][m]=l}return t===1&&m===1?a[0][0]:a}return u.map(i,function(v){return v*n})},outer:function(i,n){return u.multiply(i.map(function(r){return[r]}),[n])},dot:function(i,n){w(i[0])||(i=[i]),w(n[0])||(n=[n]);for(var r=i[0].length===1&&i.length!==1?u.transpose(i):i,e=n[0].length===1&&n.length!==1?u.transpose(n):n,o=[],l=0,t=r.length,s=r[0].length,a,m;l<t;l++){for(o[l]=[],a=0,m=0;m<s;m++)a+=r[l][m]*e[l][m];o[l]=a}return o.length===1?o[0]:o},pow:function(i,n){return u.map(i,function(r){return f.pow(r,n)})},exp:function(i){return u.map(i,function(n){return f.exp(n)})},log:function(i){return u.map(i,function(n){return f.log(n)})},abs:function(i){return u.map(i,function(n){return f.abs(n)})},norm:function(i,n){var r=0,e=0;for(isNaN(n)&&(n=2),w(i[0])&&(i=i[0]);e<i.length;e++)r+=f.pow(f.abs(i[e]),n);return f.pow(r,1/n)},angle:function(i,n){return f.acos(u.dot(i,n)/(u.norm(i)*u.norm(n)))},aug:function(i,n){var r=[],e;for(e=0;e<i.length;e++)r.push(i[e].slice());for(e=0;e<r.length;e++)_.apply(r[e],n[e]);return r},inv:function(i){for(var n=i.length,r=i[0].length,e=u.identity(n,r),o=u.gauss_jordan(i,e),l=[],t=0,s;t<n;t++)for(l[t]=[],s=r;s<o[0].length;s++)l[t][s-r]=o[t][s];return l},det:function d(i){if(i.length===2)return i[0][0]*i[1][1]-i[0][1]*i[1][0];for(var n=0,r=0;r<i.length;r++){for(var e=[],o=1;o<i.length;o++){e[o-1]=[];for(var l=0;l<i.length;l++)l<r?e[o-1][l]=i[o][l]:l>r&&(e[o-1][l-1]=i[o][l])}var t=r%2?-1:1;n+=d(e)*i[0][r]*t}return n},gauss_elimination:function(i,n){var r=0,e=0,o=i.length,l=i[0].length,t=1,s=0,a=[],m,v,c,p;for(i=u.aug(i,n),m=i[0].length,r=0;r<o;r++){for(v=i[r][r],e=r,p=r+1;p<l;p++)v<f.abs(i[p][r])&&(v=i[p][r],e=p);if(e!=r)for(p=0;p<m;p++)c=i[r][p],i[r][p]=i[e][p],i[e][p]=c;for(e=r+1;e<o;e++)for(t=i[e][r]/i[r][r],p=r;p<m;p++)i[e][p]=i[e][p]-t*i[r][p]}for(r=o-1;r>=0;r--){for(s=0,e=r+1;e<=o-1;e++)s=s+a[e]*i[r][e];a[r]=(i[r][m-1]-s)/i[r][r]}return a},gauss_jordan:function(i,n){var r=u.aug(i,n),e=r.length,o=r[0].length,l=0,t,s,a;for(s=0;s<e;s++){var m=s;for(a=s+1;a<e;a++)f.abs(r[a][s])>f.abs(r[m][s])&&(m=a);var v=r[s];for(r[s]=r[m],r[m]=v,a=s+1;a<e;a++)for(l=r[a][s]/r[s][s],t=s;t<o;t++)r[a][t]-=r[s][t]*l}for(s=e-1;s>=0;s--){for(l=r[s][s],a=0;a<s;a++)for(t=o-1;t>s-1;t--)r[a][t]-=r[s][t]*r[a][s]/l;for(r[s][s]/=l,t=e;t<o;t++)r[s][t]/=l}return r},triaUpSolve:function(i,n){var r=i[0].length,e=u.zeros(1,r)[0],o,l=!1;return n[0].length!=null&&(n=n.map(function(t){return t[0]}),l=!0),u.arange(r-1,-1,-1).forEach(function(t){o=u.arange(t+1,r).map(function(s){return e[s]*i[t][s]}),e[t]=(n[t]-u.sum(o))/i[t][t]}),l?e.map(function(t){return[t]}):e},triaLowSolve:function(i,n){var r=i[0].length,e=u.zeros(1,r)[0],o,l=!1;return n[0].length!=null&&(n=n.map(function(t){return t[0]}),l=!0),u.arange(r).forEach(function(t){o=u.arange(t).map(function(s){return i[t][s]*e[s]}),e[t]=(n[t]-u.sum(o))/i[t][t]}),l?e.map(function(t){return[t]}):e},lu:function(i){var n=i.length,r=u.identity(n),e=u.zeros(i.length,i[0].length),o;return u.arange(n).forEach(function(l){e[0][l]=i[0][l]}),u.arange(1,n).forEach(function(l){u.arange(l).forEach(function(t){o=u.arange(t).map(function(s){return r[l][s]*e[s][t]}),r[l][t]=(i[l][t]-u.sum(o))/e[t][t]}),u.arange(l,n).forEach(function(t){o=u.arange(l).map(function(s){return r[l][s]*e[s][t]}),e[l][t]=i[o.length][t]-u.sum(o)})}),[r,e]},cholesky:function(i){var n=i.length,r=u.zeros(i.length,i[0].length),e;return u.arange(n).forEach(function(o){e=u.arange(o).map(function(l){return f.pow(r[o][l],2)}),r[o][o]=f.sqrt(i[o][o]-u.sum(e)),u.arange(o+1,n).forEach(function(l){e=u.arange(o).map(function(t){return r[o][t]*r[l][t]}),r[l][o]=(i[o][l]-u.sum(e))/r[o][o]})}),r},gauss_jacobi:function(i,n,r,e){for(var o=0,l=0,t=i.length,s=[],a=[],m=[],v,c,p,y;o<t;o++)for(s[o]=[],a[o]=[],m[o]=[],l=0;l<t;l++)o>l?(s[o][l]=i[o][l],a[o][l]=m[o][l]=0):o<l?(a[o][l]=i[o][l],s[o][l]=m[o][l]=0):(m[o][l]=i[o][l],s[o][l]=a[o][l]=0);for(p=u.multiply(u.multiply(u.inv(m),u.add(s,a)),-1),c=u.multiply(u.inv(m),n),v=r,y=u.add(u.multiply(p,r),c),o=2;f.abs(u.norm(u.subtract(y,v)))>e;)v=y,y=u.add(u.multiply(p,v),c),o++;return y},gauss_seidel:function(i,n,r,e){for(var o=0,l=i.length,t=[],s=[],a=[],m,v,c,p,y;o<l;o++)for(t[o]=[],s[o]=[],a[o]=[],m=0;m<l;m++)o>m?(t[o][m]=i[o][m],s[o][m]=a[o][m]=0):o<m?(s[o][m]=i[o][m],t[o][m]=a[o][m]=0):(a[o][m]=i[o][m],t[o][m]=s[o][m]=0);for(p=u.multiply(u.multiply(u.inv(u.add(a,t)),s),-1),c=u.multiply(u.inv(u.add(a,t)),n),v=r,y=u.add(u.multiply(p,r),c),o=2;f.abs(u.norm(u.subtract(y,v)))>e;)v=y,y=u.add(u.multiply(p,v),c),o=o+1;return y},SOR:function(i,n,r,e,o){for(var l=0,t=i.length,s=[],a=[],m=[],v,c,p,y,q;l<t;l++)for(s[l]=[],a[l]=[],m[l]=[],v=0;v<t;v++)l>v?(s[l][v]=i[l][v],a[l][v]=m[l][v]=0):l<v?(a[l][v]=i[l][v],s[l][v]=m[l][v]=0):(m[l][v]=i[l][v],s[l][v]=a[l][v]=0);for(y=u.multiply(u.inv(u.add(m,u.multiply(s,o))),u.subtract(u.multiply(m,1-o),u.multiply(a,o))),p=u.multiply(u.multiply(u.inv(u.add(m,u.multiply(s,o))),n),o),c=r,q=u.add(u.multiply(y,r),p),l=2;f.abs(u.norm(u.subtract(q,c)))>e;)c=q,q=u.add(u.multiply(y,c),p),l++;return q},householder:function(i){for(var n=i.length,r=i[0].length,e=0,o=[],l=[],t,s,a,m,v;e<n-1;e++){for(t=0,m=e+1;m<r;m++)t+=i[m][e]*i[m][e];for(v=i[e+1][e]>0?-1:1,t=v*f.sqrt(t),s=f.sqrt((t*t-i[e+1][e]*t)/2),o=u.zeros(n,1),o[e+1][0]=(i[e+1][e]-t)/(2*s),a=e+2;a<n;a++)o[a][0]=i[a][e]/(2*s);l=u.subtract(u.identity(n,r),u.multiply(u.multiply(o,u.transpose(o)),2)),i=u.multiply(l,u.multiply(i,l))}return i},QR:function(){var d=u.sum,i=u.arange;function n(r){var e=r.length,o=r[0].length,l=u.zeros(o,o);r=u.copy(r);var t,s,a;for(s=0;s<o;s++){for(l[s][s]=f.sqrt(d(i(e).map(function(m){return r[m][s]*r[m][s]}))),t=0;t<e;t++)r[t][s]=r[t][s]/l[s][s];for(a=s+1;a<o;a++)for(l[s][a]=d(i(e).map(function(m){return r[m][s]*r[m][a]})),t=0;t<e;t++)r[t][a]=r[t][a]-r[t][s]*l[s][a]}return[r,l]}return n}(),lstsq:function(){function d(n){n=u.copy(n);var r=n.length,e=u.identity(r);return u.arange(r-1,-1,-1).forEach(function(o){u.sliceAssign(e,{row:o},u.divide(u.slice(e,{row:o}),n[o][o])),u.sliceAssign(n,{row:o},u.divide(u.slice(n,{row:o}),n[o][o])),u.arange(o).forEach(function(l){var t=u.multiply(n[l][o],-1),s=u.slice(n,{row:l}),a=u.multiply(u.slice(n,{row:o}),t);u.sliceAssign(n,{row:l},u.add(s,a));var m=u.slice(e,{row:l}),v=u.multiply(u.slice(e,{row:o}),t);u.sliceAssign(e,{row:l},u.add(m,v))})}),e}function i(n,r){var e=!1;r[0].length===void 0&&(r=r.map(function(y){return[y]}),e=!0);var o=u.QR(n),l=o[0],t=o[1],s=n[0].length,a=u.slice(l,{col:{end:s}}),m=u.slice(t,{row:{end:s}}),v=d(m),c=u.transpose(a);c[0].length===void 0&&(c=[c]);var p=u.multiply(u.multiply(v,c),r);return p.length===void 0&&(p=[[p]]),e?p.map(function(y){return y[0]}):p}return i}(),jacobi:function(i){for(var n=1,r=i.length,e=u.identity(r,r),o=[],l,t,s,a,m,v,c,p;n===1;){for(v=i[0][1],a=0,m=1,t=0;t<r;t++)for(s=0;s<r;s++)t!=s&&v<f.abs(i[t][s])&&(v=f.abs(i[t][s]),a=t,m=s);for(i[a][a]===i[m][m]?c=i[a][m]>0?f.PI/4:-f.PI/4:c=f.atan(2*i[a][m]/(i[a][a]-i[m][m]))/2,p=u.identity(r,r),p[a][a]=f.cos(c),p[a][m]=-f.sin(c),p[m][a]=f.sin(c),p[m][m]=f.cos(c),e=u.multiply(e,p),l=u.multiply(u.multiply(u.inv(p),i),p),i=l,n=0,t=1;t<r;t++)for(s=1;s<r;s++)t!=s&&f.abs(i[t][s])>.001&&(n=1)}for(t=0;t<r;t++)o.push(i[t][t]);return[e,o]},rungekutta:function(i,n,r,e,o,l){var t,s,a,m,v;if(l===2)for(;e<=r;)t=n*i(e,o),s=n*i(e+n,o+t),a=o+(t+s)/2,o=a,e=e+n;if(l===4)for(;e<=r;)t=n*i(e,o),s=n*i(e+n/2,o+t/2),m=n*i(e+n/2,o+s/2),v=n*i(e+n,o+m),a=o+(t+2*s+2*m+v)/6,o=a,e=e+n;return o},romberg:function(i,n,r,e){for(var o=0,l=(r-n)/2,t=[],s=[],a=[],m,v,c,p,y;o<e/2;){for(y=i(n),c=n,p=0;c<=r;c=c+l,p++)t[p]=c;for(m=t.length,c=1;c<m-1;c++)y+=(c%2!==0?4:2)*i(t[c]);y=l/3*(y+i(r)),a[o]=y,l/=2,o++}for(v=a.length,m=1;v!==1;){for(c=0;c<v-1;c++)s[c]=(f.pow(4,m)*a[c+1]-a[c])/(f.pow(4,m)-1);v=s.length,a=s,s=[],m++}return a},richardson:function(i,n,r,e){function o(q,h){for(var D=0,R=q.length,z;D<R;D++)q[D]===h&&(z=D);return z}for(var l=f.abs(r-i[o(i,r)+1]),t=0,s=[],a=[],m,v,c,p,y;e>=l;)m=o(i,r+e),v=o(i,r),s[t]=(n[m]-2*n[v]+n[2*v-m])/(e*e),e/=2,t++;for(p=s.length,c=1;p!=1;){for(y=0;y<p-1;y++)a[y]=(f.pow(4,c)*s[y+1]-s[y])/(f.pow(4,c)-1);p=a.length,s=a,a=[],c++}return s},simpson:function(i,n,r,e){for(var o=(r-n)/e,l=i(n),t=[],s=n,a=0,m=1,v;s<=r;s=s+o,a++)t[a]=s;for(v=t.length;m<v-1;m++)l+=(m%2!==0?4:2)*i(t[m]);return o/3*(l+i(r))},hermite:function(i,n,r,e){for(var o=i.length,l=0,t=0,s=[],a=[],m=[],v=[],c;t<o;t++){for(s[t]=1,c=0;c<o;c++)t!=c&&(s[t]*=(e-i[c])/(i[t]-i[c]));for(a[t]=0,c=0;c<o;c++)t!=c&&(a[t]+=1/(i[t]-i[c]));m[t]=(1-2*(e-i[t])*a[t])*(s[t]*s[t]),v[t]=(e-i[t])*(s[t]*s[t]),l+=m[t]*n[t]+v[t]*r[t]}return l},lagrange:function(i,n,r){for(var e=0,o=0,l,t,s=i.length;o<s;o++){for(t=n[o],l=0;l<s;l++)o!=l&&(t*=(r-i[l])/(i[o]-i[l]));e+=t}return e},cubic_spline:function(i,n,r){for(var e=i.length,o=0,l,t=[],s=[],a=[],m=[],v=[],c=[],p=[];o<e-1;o++)v[o]=i[o+1]-i[o];for(a[0]=0,o=1;o<e-1;o++)a[o]=3/v[o]*(n[o+1]-n[o])-3/v[o-1]*(n[o]-n[o-1]);for(o=1;o<e-1;o++)t[o]=[],s[o]=[],t[o][o-1]=v[o-1],t[o][o]=2*(v[o-1]+v[o]),t[o][o+1]=v[o],s[o][0]=a[o];for(m=u.multiply(u.inv(t),s),l=0;l<e-1;l++)c[l]=(n[l+1]-n[l])/v[l]-v[l]*(m[l+1][0]+2*m[l][0])/3,p[l]=(m[l+1][0]-m[l][0])/(3*v[l]);for(l=0;l<e&&!(i[l]>r);l++);return l-=1,n[l]+(r-i[l])*c[l]+u.sq(r-i[l])*m[l]+(r-i[l])*u.sq(r-i[l])*p[l]},gauss_quadrature:function(){throw new Error("gauss_quadrature not yet implemented")},PCA:function(i){var n=i.length,r=i[0].length,e=0,o,l,t=[],s=[],a=[],m=[],v=[],c=[],p=[],y=[],q=[],h=[];for(e=0;e<n;e++)t[e]=u.sum(i[e])/r;for(e=0;e<r;e++)for(p[e]=[],o=0;o<n;o++)p[e][o]=i[o][e]-t[o];for(p=u.transpose(p),e=0;e<n;e++)for(y[e]=[],o=0;o<n;o++)y[e][o]=u.dot([p[e]],[p[o]])/(r-1);for(a=u.jacobi(y),q=a[0],s=a[1],h=u.transpose(q),e=0;e<s.length;e++)for(o=e;o<s.length;o++)s[e]<s[o]&&(l=s[e],s[e]=s[o],s[o]=l,m=h[e],h[e]=h[o],h[o]=m);for(c=u.transpose(p),e=0;e<n;e++)for(v[e]=[],o=0;o<c.length;o++)v[e][o]=u.dot([h[e]],[c[o]]);return[i,s,h,v]}}),function(d){for(var i=0;i<d.length;i++)(function(n){u.fn[n]=function(r,e){var o=this;return e?(setTimeout(function(){e.call(o,u.fn[n].call(o,r))},15),this):typeof u[n](this,r)=="number"?u[n](this,r):u(u[n](this,r))}})(d[i])}("add divide multiply subtract dot pow exp log abs norm angle".split(" "))}(b,Math),function(u,f){var _=[].slice,g=u.utils.isNumber,w=u.utils.isArray;u.extend({zscore:function(){var n=_.call(arguments);return g(n[1])?(n[0]-n[1])/n[2]:(n[0]-u.mean(n[1]))/u.stdev(n[1],n[2])},ztest:function(){var n=_.call(arguments),r;return w(n[1])?(r=u.zscore(n[0],n[1],n[3]),n[2]===1?u.normal.cdf(-f.abs(r),0,1):u.normal.cdf(-f.abs(r),0,1)*2):n.length>2?(r=u.zscore(n[0],n[1],n[2]),n[3]===1?u.normal.cdf(-f.abs(r),0,1):u.normal.cdf(-f.abs(r),0,1)*2):(r=n[0],n[1]===1?u.normal.cdf(-f.abs(r),0,1):u.normal.cdf(-f.abs(r),0,1)*2)}}),u.extend(u.fn,{zscore:function(n,r){return(n-this.mean())/this.stdev(r)},ztest:function(n,r,e){var o=f.abs(this.zscore(n,e));return r===1?u.normal.cdf(-o,0,1):u.normal.cdf(-o,0,1)*2}}),u.extend({tscore:function(){var n=_.call(arguments);return n.length===4?(n[0]-n[1])/(n[2]/f.sqrt(n[3])):(n[0]-u.mean(n[1]))/(u.stdev(n[1],!0)/f.sqrt(n[1].length))},ttest:function(){var n=_.call(arguments),r;return n.length===5?(r=f.abs(u.tscore(n[0],n[1],n[2],n[3])),n[4]===1?u.studentt.cdf(-r,n[3]-1):u.studentt.cdf(-r,n[3]-1)*2):g(n[1])?(r=f.abs(n[0]),n[2]==1?u.studentt.cdf(-r,n[1]-1):u.studentt.cdf(-r,n[1]-1)*2):(r=f.abs(u.tscore(n[0],n[1])),n[2]==1?u.studentt.cdf(-r,n[1].length-1):u.studentt.cdf(-r,n[1].length-1)*2)}}),u.extend(u.fn,{tscore:function(n){return(n-this.mean())/(this.stdev(!0)/f.sqrt(this.cols()))},ttest:function(n,r){return r===1?1-u.studentt.cdf(f.abs(this.tscore(n)),this.cols()-1):u.studentt.cdf(-f.abs(this.tscore(n)),this.cols()-1)*2}}),u.extend({anovafscore:function(){var n=_.call(arguments),r,e,o,l,t,s,a,m;if(n.length===1){for(t=new Array(n[0].length),a=0;a<n[0].length;a++)t[a]=n[0][a];n=t}for(e=new Array,a=0;a<n.length;a++)e=e.concat(n[a]);for(o=u.mean(e),r=0,a=0;a<n.length;a++)r=r+n[a].length*f.pow(u.mean(n[a])-o,2);for(r/=n.length-1,s=0,a=0;a<n.length;a++)for(l=u.mean(n[a]),m=0;m<n[a].length;m++)s+=f.pow(n[a][m]-l,2);return s/=e.length-n.length,r/s},anovaftest:function(){var n=_.call(arguments),r,e,o,l;if(g(n[0]))return 1-u.centralF.cdf(n[0],n[1],n[2]);var t=u.anovafscore(n);for(r=n.length-1,o=0,l=0;l<n.length;l++)o=o+n[l].length;return e=o-r-1,1-u.centralF.cdf(t,r,e)},ftest:function(n,r,e){return 1-u.centralF.cdf(n,r,e)}}),u.extend(u.fn,{anovafscore:function(){return u.anovafscore(this.toArray())},anovaftes:function(){var n=0,r;for(r=0;r<this.length;r++)n=n+this[r].length;return u.ftest(this.anovafscore(),this.length-1,n-this.length)}}),u.extend({qscore:function(){var n=_.call(arguments),r,e,o,l,t;return g(n[0])?(r=n[0],e=n[1],o=n[2],l=n[3],t=n[4]):(r=u.mean(n[0]),e=u.mean(n[1]),o=n[0].length,l=n[1].length,t=n[2]),f.abs(r-e)/(t*f.sqrt((1/o+1/l)/2))},qtest:function(){var n=_.call(arguments),r;n.length===3?(r=n[0],n=n.slice(1)):n.length===7?(r=u.qscore(n[0],n[1],n[2],n[3],n[4]),n=n.slice(5)):(r=u.qscore(n[0],n[1],n[2]),n=n.slice(3));var e=n[0],o=n[1];return 1-u.tukey.cdf(r,o,e-o)},tukeyhsd:function(n){for(var r=u.pooledstdev(n),e=n.map(function(m){return u.mean(m)}),o=n.reduce(function(m,v){return m+v.length},0),l=[],t=0;t<n.length;++t)for(var s=t+1;s<n.length;++s){var a=u.qtest(e[t],e[s],n[t].length,n[s].length,r,o,n.length);l.push([[t,s],a])}return l}}),u.extend({normalci:function(){var n=_.call(arguments),r=new Array(2),e;return n.length===4?e=f.abs(u.normal.inv(n[1]/2,0,1)*n[2]/f.sqrt(n[3])):e=f.abs(u.normal.inv(n[1]/2,0,1)*u.stdev(n[2])/f.sqrt(n[2].length)),r[0]=n[0]-e,r[1]=n[0]+e,r},tci:function(){var n=_.call(arguments),r=new Array(2),e;return n.length===4?e=f.abs(u.studentt.inv(n[1]/2,n[3]-1)*n[2]/f.sqrt(n[3])):e=f.abs(u.studentt.inv(n[1]/2,n[2].length-1)*u.stdev(n[2],!0)/f.sqrt(n[2].length)),r[0]=n[0]-e,r[1]=n[0]+e,r},significant:function(n,r){return n<r}}),u.extend(u.fn,{normalci:function(n,r){return u.normalci(n,r,this.toArray())},tci:function(n,r){return u.tci(n,r,this.toArray())}});function d(i,n,r,e){if(i>1||r>1||i<=0||r<=0)throw new Error("Proportions should be greater than 0 and less than 1");var o=(i*n+r*e)/(n+e),l=f.sqrt(o*(1-o)*(1/n+1/e));return(i-r)/l}u.extend(u.fn,{oneSidedDifferenceOfProportions:function(n,r,e,o){var l=d(n,r,e,o);return u.ztest(l,1)},twoSidedDifferenceOfProportions:function(n,r,e,o){var l=d(n,r,e,o);return u.ztest(l,2)}})}(b,Math),b.models=function(){function u(d){var i=d[0].length,n=b.arange(i).map(function(r){var e=b.arange(i).filter(function(o){return o!==r});return f(b.col(d,r).map(function(o){return o[0]}),b.col(d,e))});return n}function f(d,i){var n=d.length,r=i[0].length-1,e=n-r-1,o=b.lstsq(i,d),l=b.multiply(i,o.map(function(p){return[p]})).map(function(p){return p[0]}),t=b.subtract(d,l),s=b.mean(d),a=b.sum(l.map(function(p){return Math.pow(p-s,2)})),m=b.sum(d.map(function(p,y){return Math.pow(p-l[y],2)})),v=a+m,c=a/v;return{exog:i,endog:d,nobs:n,df_model:r,df_resid:e,coef:o,predict:l,resid:t,ybar:s,SST:v,SSE:a,SSR:m,R2:c}}function _(d){var i=u(d.exog),n=Math.sqrt(d.SSR/d.df_resid),r=i.map(function(s){var a=s.SST,m=s.R2;return n/Math.sqrt(a*(1-m))}),e=d.coef.map(function(s,a){return(s-0)/r[a]}),o=e.map(function(s){var a=b.studentt.cdf(s,d.df_resid);return(a>.5?1-a:a)*2}),l=b.studentt.inv(.975,d.df_resid),t=d.coef.map(function(s,a){var m=l*r[a];return[s-m,s+m]});return{se:r,t:e,p:o,sigmaHat:n,interval95:t}}function g(d){var i=d.R2/d.df_model/((1-d.R2)/d.df_resid),n=function(e,o,l){return b.beta.cdf(e/(l/o+e),o/2,l/2)},r=1-n(i,d.df_model,d.df_resid);return{F_statistic:i,pvalue:r}}function w(d,i){var n=f(d,i),r=_(n),e=g(n),o=1-(1-n.R2)*((n.nobs-1)/n.df_resid);return n.t=r,n.f=e,n.adjust_R2=o,n}return{ols:w}}(),b.extend({buildxmatrix:function(){for(var f=new Array(arguments.length),_=0;_<arguments.length;_++){var g=[1];f[_]=g.concat(arguments[_])}return b(f)},builddxmatrix:function(){for(var f=new Array(arguments[0].length),_=0;_<arguments[0].length;_++){var g=[1];f[_]=g.concat(arguments[0][_])}return b(f)},buildjxmatrix:function(f){for(var _=new Array(f.length),g=0;g<f.length;g++)_[g]=f[g];return b.builddxmatrix(_)},buildymatrix:function(f){return b(f).transpose()},buildjymatrix:function(f){return f.transpose()},matrixmult:function(f,_){var g,w,d,i,n;if(f.cols()==_.rows()){if(_.rows()>1){for(i=[],g=0;g<f.rows();g++)for(i[g]=[],w=0;w<_.cols();w++){for(n=0,d=0;d<f.cols();d++)n+=f.toArray()[g][d]*_.toArray()[d][w];i[g][w]=n}return b(i)}for(i=[],g=0;g<f.rows();g++)for(i[g]=[],w=0;w<_.cols();w++){for(n=0,d=0;d<f.cols();d++)n+=f.toArray()[g][d]*_.toArray()[w];i[g][w]=n}return b(i)}},regress:function(f,_){var g=b.xtranspxinv(f),w=f.transpose(),d=b.matrixmult(b(g),w);return b.matrixmult(d,_)},regresst:function(f,_,g){var w=b.regress(f,_),d={};d.anova={};var i=b.jMatYBar(f,w);d.yBar=i;var n=_.mean();d.anova.residuals=b.residuals(_,i),d.anova.ssr=b.ssr(i,n),d.anova.msr=d.anova.ssr/(f[0].length-1),d.anova.sse=b.sse(_,i),d.anova.mse=d.anova.sse/(_.length-(f[0].length-1)-1),d.anova.sst=b.sst(_,n),d.anova.mst=d.anova.sst/(_.length-1),d.anova.r2=1-d.anova.sse/d.anova.sst,d.anova.r2<0&&(d.anova.r2=0),d.anova.fratio=d.anova.msr/d.anova.mse,d.anova.pvalue=b.anovaftest(d.anova.fratio,f[0].length-1,_.length-(f[0].length-1)-1),d.anova.rmse=Math.sqrt(d.anova.mse),d.anova.r2adj=1-d.anova.mse/d.anova.mst,d.anova.r2adj<0&&(d.anova.r2adj=0),d.stats=new Array(f[0].length);for(var r=b.xtranspxinv(f),e,o,l,t=0;t<w.length;t++)e=Math.sqrt(d.anova.mse*Math.abs(r[t][t])),o=Math.abs(w[t]/e),l=b.ttest(o,_.length-f[0].length-1,g),d.stats[t]=[w[t],e,o,l];return d.regress=w,d},xtranspx:function(f){return b.matrixmult(f.transpose(),f)},xtranspxinv:function(f){var _=b.matrixmult(f.transpose(),f),g=b.inv(_);return g},jMatYBar:function(f,_){var g=b.matrixmult(f,_);return new b(g)},residuals:function(f,_){return b.matrixsubtract(f,_)},ssr:function(f,_){for(var g=0,w=0;w<f.length;w++)g+=Math.pow(f[w]-_,2);return g},sse:function(f,_){for(var g=0,w=0;w<f.length;w++)g+=Math.pow(f[w]-_[w],2);return g},sst:function(f,_){for(var g=0,w=0;w<f.length;w++)g+=Math.pow(f[w]-_,2);return g},matrixsubtract:function(f,_){for(var g=new Array(f.length),w=0;w<f.length;w++){g[w]=new Array(f[w].length);for(var d=0;d<f[w].length;d++)g[w][d]=f[w][d]-_[w][d]}return b(g)}}),b.jStat=b,b})})(Z);var T=Z.exports;const rn={class:""},en=S("div",{id:"lj-chart"},null,-1),on=[en],H="#FF0000",un="#FEB900",fn="#00FF00",tn=$({__name:"ChartLJ",props:{series:{type:Array,required:!0}},setup(J){const{series:W}=J;function b(_,g){let w=[];_?.forEach(t=>{typeof t[g]=="number"&&w.push(t[g])});const d=w.length,i=T.jStat.mean(w),n=T.jStat.stdev(w),r=[-4,-3,-2,-1,0,1,2,3,4].map(t=>Math.round(t*(i+n)*100)/100),e=Math.round((i+n)*100)/100,o=Math.round(2*(i+n)*100)/100,l=Math.round(3*(i+n)*100)/100;for(let[t,s]of _.entries()){const a=T.jStat.abs([s[g]])[0];let m,v,c;if(s.color=fn,s.rule=null,a>l){s.color=H,s.rule="1_3s";continue}if(a>o){if(s.color=un,s.rule="1_2s",t>1&&_[t-1]&&(m=T.jStat.abs([_[t-1][g]])[0],m<=l&&m>o)){s.color=H,s.rule="2_2s";continue}continue}if(t>1&&_[t-1]&&(m=T.jStat.abs([_[t-1][g]])[0],T.jStat.abs([a-m])[0]>=n*4)){s.color=H,s.rule="R_4s";continue}if(t>3&&_[t-3]&&(m=T.jStat.abs([_[t-1][g]])[0],v=T.jStat.abs([_[t-2][g]])[0],c=T.jStat.abs([_[t-3][g]])[0],a>e&&a<=o&&m>e&&m<=o&&v>e&&v<=o&&c>e&&c<=o)){const p=[_[t][g],_[t-1][g],_[t-2][g],_[t-3][g]],y=p.every(h=>h>0),q=p.every(h=>h<0);(y||q)&&(s.color=H,s.rule="4_1s"),_[t-1].rule=="4_1s"&&(s.rule="!!!"),_[t-2].rule=="4_1s"&&(s.rule="!!!"),_[t-3].rule=="4_1s"&&(s.rule="!!!"),_[t-4].rule=="4_1s"&&(s.rule="!!!");continue}}return{rules:_,stats:{n:d,mu:i,sd:n,x_sds:r}}}const u=W||[{date:new Date(2021,1,1).toDateString(),value:1.2},{date:new Date(2021,1,2).toDateString(),value:3.3},{date:new Date(2021,1,3).toDateString(),value:2.1},{date:new Date(2021,1,4).toDateString(),value:.2},{date:new Date(2021,1,5).toDateString(),value:3},{date:new Date(2021,1,6).toDateString(),value:-19.5},{date:new Date(2021,1,7).toDateString(),value:-22.1},{date:new Date(2021,1,8).toDateString(),value:0},{date:new Date(2021,1,9).toDateString(),value:-1.3},{date:new Date(2021,1,10).toDateString(),value:2.4},{date:new Date(2021,1,11).toDateString(),value:-1.3},{date:new Date(2021,1,12).toDateString(),value:2.3},{date:new Date(2021,1,13).toDateString(),value:29.9},{date:new Date(2021,1,14).toDateString(),value:2.1},{date:new Date(2021,1,15).toDateString(),value:1.4},{date:new Date(2021,1,16).toDateString(),value:-1.2},{date:new Date(2021,1,17).toDateString(),value:-6.4},{date:new Date(2021,1,18).toDateString(),value:6.2},{date:new Date(2021,1,19).toDateString(),value:-6.5},{date:new Date(2021,1,20).toDateString(),value:-6.4},{date:new Date(2021,1,21).toDateString(),value:-2.8},{date:new Date(2021,1,22).toDateString(),value:1.3},{date:new Date(2021,1,23).toDateString(),value:-1.5},{date:new Date(2021,1,24).toDateString(),value:5.5},{date:new Date(2021,1,25).toDateString(),value:5.7},{date:new Date(2021,1,26).toDateString(),value:5.4},{date:new Date(2021,1,27).toDateString(),value:5.6},{date:new Date(2021,1,28).toDateString(),value:5.3},{date:new Date(2021,1,29).toDateString(),value:4.5},{date:new Date(2021,1,30).toDateString(),value:4.2}],f=()=>{document.getElementById("lj-chart").innerHTML="";const _=new nn({container:"lj-chart",autoFit:!0,height:250}),g=b(u,"value");_.data(g.rules),_.scale({date:{range:[0,1]},value:{ticks:g.stats.x_sds,nice:!0,alias:"Value"}}),_.tooltip({showTitle:!0,showCrosshairs:!0}),_.line().position("date*value").label("value"),_.point().position("date*value").color("value*color*rule",(w,d,i)=>typeof d=="string"?d:""),_.legend("rule",{position:"bottom"}),_.render()};return Y(()=>{f()}),(_,g)=>(X(),M("div",rn,[...on]))}}),vn=j(tn,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/analysis/quality/ChartLJ.vue"]]);export{vn as default};
