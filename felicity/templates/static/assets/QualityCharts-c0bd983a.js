import{S as R,f as T,a7 as q,i as C,a0 as u,W as D,r as x,o as c,c as d,N as y,a as m,a5 as o,ac as V,F as k,M as B,E as F,Z as A,ak as b,$ as w,_ as N}from"./index-8d0a01b3.js";import{u as U}from"./analysis-250c489a.js";const j={class:"min-h-[500px]"},O={class:"flex justify-between"},I={class:"flex justify-start items-center gap-x-2"},z=R({__name:"QualityCharts",setup(G){const S=A(()=>w(()=>import("./vue-multiselect.esm-46eec9fe.js"),["assets/vue-multiselect.esm-46eec9fe.js","assets/index-8d0a01b3.js","assets/index-a402b5a2.css"])),L=A(()=>w(()=>import("./ChartLJ-914096e4.js"),["assets/ChartLJ-914096e4.js","assets/index-8d0a01b3.js","assets/index-a402b5a2.css","assets/index-5bd8638f.js","assets/value-c2034ca5.js","assets/string-6dabfbe0.js"])),v=U(),{withClientQuery:h}=T();q(()=>{v.fetchAnalysesServices({})});const g=C(()=>v.getAnalysesServicesSimple),i=u([]),f=new Date;let l=u({month:f.getMonth(),year:f.getFullYear()}),r=u(null);const p=u(!1),E=async a=>{if(!l.value)return;const e={analyses:[a.uid],month:l.value.month+1,year:l.value.year};await h(b,e,"qcChartData").then(t=>{i.value=t??[]}).finally(()=>p.value=!1)},P=async a=>{if(!r.value)return;const e={analyses:[r.value?.uid],month:a.month+1,year:a.year};await h(b,e,"qcChartData").then(t=>{i.value=t??[]}).finally(()=>p.value=!1)},_=C(()=>i.value?Q(M(i.value)):[]);function M(a){return a.reduce((e,t)=>{const n=t.sample.qcLevel.level;return e[n]||(e[n]={results:[],dates:[]}),e[n].results.push(parseFloat(t.result)),e[n].dates.push(t.dateVerified),e},{})}function Q(a){return Object.entries(a).map(([e,t])=>({name:e,data:t.results.map((n,s)=>({date:t.dates[s],value:n}))}))}return D(r,async a=>{a&&await E(a)}),D(l,async a=>{a&&await P(a)}),(a,e)=>{const t=x("fel-heading"),n=x("VueDatePicker");return c(),d("div",j,[y("div",O,[m(t,{title:"Analyses Service Control Charts"}),y("div",I,[m(n,{class:"z-60 disabled:bg-muted",modelValue:o(l),"onUpdate:modelValue":e[0]||(e[0]=s=>V(l)?l.value=s:l=s),"max-date":o(f),"month-picker":""},null,8,["modelValue","max-date"]),m(o(S),{class:"max-w-[300px]",modelValue:o(r),"onUpdate:modelValue":e[1]||(e[1]=s=>V(r)?r.value=s:r=s),options:g.value,multiple:!1,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","options"])])]),e[2]||(e[2]=y("hr",{class:"my-4"},null,-1)),_.value?.length==0?(c(),d(k,{key:0},[B(" The selected analysis has no data for the selected period. ")],64)):(c(!0),d(k,{key:1},F(_.value,s=>(c(),d("div",{class:"mb-4",key:s.name},[m(o(L),{title:s.name,series:s.data},null,8,["title","series"])]))),128))])}}}),Y=N(z,[["__file","/Users/admin/Documents/Development/felicity/felicity-lims/webapp/views/qcontrol/QualityCharts.vue"]]);export{Y as default};
