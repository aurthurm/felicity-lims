import{Y as O,u as q,$ as K,ah as Q,a7 as B,a0 as v,b1 as Y,a_ as G,e as J,a3 as W,_ as X,r as m,c as L,o as f,z as p,A as M,C as k,a as t,K as a,M as l,F as x,H,I as _,B as Z,a4 as D,aK as j,aL as $}from"./index-OdhKCqIc.js";import{u as ee}from"./user-DYsgscqA.js";import{u as te}from"./setup-BcFG_bXr.js";import{c as ae,a as C,u as re,F as oe}from"./index.esm-BfHj8iGm.js";import{I as le}from"./Input-BEm5S0CJ.js";import{F as ne,a as se,b as ie}from"./FormMessage-CgXFMXx9.js";import{F as de}from"./FormLabel-DxP9wnWS.js";import{S as me,a as ue,b as fe,c as ge,d as be}from"./SelectValue-Ds0cfAgl.js";import{E as ce,a as pe,b as _e,c as ye,d as Fe}from"./EmptyTitle-aCQRDpx3.js";import{P as ve}from"./PageHeading-Czi_4opS.js";import"./Label-CS46LzLb.js";import"./useNonce-B4v0IDPb.js";import"./chevron-down-Dqf-ptA3.js";import"./useFocusGuards-Bjb6OG0k.js";import"./PopperContent-BfyCnGUj.js";const Me=O({__name:"LaboratoryListing",setup(V,{expose:r}){r();const{toastSuccess:E,toastError:e}=J(),{withClientQuery:h,withClientMutation:F}=q(),g=K(),u=ee(),d=te();Q(()=>{d.fetchOrganization(),u.fetchUsers({}),d.fetchLaboratories()});const b=B(()=>u.getUsers),S=B(()=>d.getLaboratories),T=n=>{if(n.labManagerUid){const s=u.getUsers?.filter(R=>R.uid==n.labManagerUid);if(s?.length>0)return`${s[0]?.firstName} ${s[0]?.lastName}`}return"No Manager Assigned"};let c=v(!1),y=v("");const o=v(!0),i=v(null),w=ae({name:C().required("Laboratory name is required"),labManagerUid:C().nullable(),businessPhone:C().nullable()}),{handleSubmit:P,resetForm:I,setValues:N}=re({validationSchema:w,initialValues:{name:"",labManagerUid:null,businessPhone:""}});function A(n,s){o.value=n,c.value=!0,y.value=(n?"CREATE":"EDIT")+" Laboratory",n?(i.value=null,I({values:{name:"",labManagerUid:null,businessPhone:""}})):(i.value=s?.uid??null,N({name:s?.name??"",labManagerUid:s?.labManagerUid??null,businessPhone:s?.businessPhone??""}))}const z=P(n=>{if(o.value===!0)F(Y,{payload:{...n,organizationUid:d.getOrganization?.uid}},"createLaboratory").then(s=>d.addLaboratory(s));else{if(!i.value)return;F(G,{uid:i.value,payload:n},"updateLaboratory").then(s=>d.updateLaboratory(s,!0))}c.value=!1}),U={toastSuccess:E,toastError:e,withClientQuery:h,withClientMutation:F,router:g,userStore:u,setupStore:d,users:b,laboratories:S,getManagerName:T,get showModal(){return c},set showModal(n){c=n},get formTitle(){return y},set formTitle(n){y=n},formAction:o,currentUid:i,formSchema:w,handleSubmit:P,resetForm:I,setValues:N,FormManager:A,saveForm:z,get Button(){return W},get Input(){return le},get FormControl(){return ie},get FormField(){return oe},get FormItem(){return se},get FormLabel(){return de},get FormMessage(){return ne},get Select(){return be},get SelectContent(){return ge},get SelectItem(){return fe},get SelectTrigger(){return ue},get SelectValue(){return me},get Empty(){return Fe},get EmptyContent(){return ye},get EmptyDescription(){return _e},get EmptyHeader(){return pe},get EmptyTitle(){return ce},PageHeading:ve};return Object.defineProperty(U,"__isScriptSetup",{enumerable:!1,value:!0}),U}}),Se={class:"space-y-6"},Te={class:"border border-border bg-card rounded-lg shadow-md"},Le={class:"relative w-full overflow-auto"},xe={class:"text-lg font-semibold text-foreground"};function Ce(V,r,E,e,h,F){const g=m("TableHead"),u=m("TableRow"),d=m("TableHeader"),b=m("TableCell"),S=m("TableEmpty"),T=m("TableBody"),c=m("Table"),y=m("Modal");return f(),L(x,null,[p("div",Se,[t(e.PageHeading,{title:"Laboratories",description:"Manage your laboratories and their details."},{default:a(()=>[t(e.Button,{onClick:r[0]||(r[0]=o=>e.FormManager(!0,null))},{default:a(()=>[...r[3]||(r[3]=[l("Add Laboratory",-1)])]),_:1})]),_:1}),p("div",Te,[p("div",Le,[t(c,{class:"w-full caption-bottom text-sm"},{default:a(()=>[t(d,{class:"[&_tr]:border-b"},{default:a(()=>[t(u,{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:a(()=>[t(g,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:a(()=>[...r[4]||(r[4]=[l("Name",-1)])]),_:1}),t(g,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:a(()=>[...r[5]||(r[5]=[l("Manager",-1)])]),_:1}),t(g,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:a(()=>[...r[6]||(r[6]=[l("Contact Phone",-1)])]),_:1}),t(g,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"})]),_:1})]),_:1}),t(T,{class:"[&_tr:last-child]:border-0"},{default:a(()=>[(f(!0),L(x,null,H(e.laboratories,o=>(f(),M(u,{key:o?.uid,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:a(()=>[t(b,{class:"px-4 py-2 align-middle"},{default:a(()=>[l(_(o?.name),1)]),_:2},1024),t(b,{class:"px-4 py-2 align-middle"},{default:a(()=>[l(_(e.getManagerName(o)),1)]),_:2},1024),t(b,{class:"px-4 py-2 align-middle"},{default:a(()=>[l(_(o?.businessPhone),1)]),_:2},1024),t(b,{class:"px-4 py-2 align-middle text-right"},{default:a(()=>[t(e.Button,{variant:"outline",size:"sm",onClick:i=>e.FormManager(!1,o)},{default:a(()=>[...r[7]||(r[7]=[l(" Edit ",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),!e.laboratories||e.laboratories.length===0?(f(),M(S,{key:0,colspan:4},{default:a(()=>[t(e.Empty,{class:"border-0 bg-transparent p-0"},{default:a(()=>[t(e.EmptyContent,null,{default:a(()=>[t(e.EmptyHeader,null,{default:a(()=>[t(e.EmptyTitle,null,{default:a(()=>[...r[8]||(r[8]=[l("No laboratories found",-1)])]),_:1}),t(e.EmptyDescription,null,{default:a(()=>[...r[9]||(r[9]=[l("Add a laboratory to get started.",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):k("",!0)]),_:1})]),_:1})])])]),e.showModal?(f(),M(y,{key:0,onClose:r[2]||(r[2]=o=>e.showModal=!1)},{header:a(()=>[p("h3",xe,_(e.formTitle),1)]),body:a(()=>[p("form",{class:"space-y-6",onSubmit:r[1]||(r[1]=Z((...o)=>e.saveForm&&e.saveForm(...o),["prevent"]))},[t(e.FormField,{name:"name"},{default:a(({componentField:o})=>[t(e.FormItem,null,{default:a(()=>[t(e.FormLabel,null,{default:a(()=>[...r[10]||(r[10]=[l("Laboratory Name",-1)])]),_:1}),t(e.FormControl,null,{default:a(()=>[t(e.Input,D(o,{placeholder:"Name ..."}),null,16)]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1}),t(e.FormField,{name:"labManagerUid"},{default:a(({componentField:o})=>[t(e.FormItem,null,{default:a(()=>[t(e.FormLabel,null,{default:a(()=>[...r[11]||(r[11]=[l("Lab Manager",-1)])]),_:1}),t(e.FormControl,null,{default:a(()=>[t(e.Select,j($(o)),{default:a(()=>[t(e.SelectTrigger,null,{default:a(()=>[t(e.SelectValue,{placeholder:"Select Manager"})]),_:1}),t(e.SelectContent,null,{default:a(()=>[t(e.SelectItem,{value:""},{default:a(()=>[...r[12]||(r[12]=[l("Select Manager",-1)])]),_:1}),(f(!0),L(x,null,H(e.users,i=>(f(),M(e.SelectItem,{key:i?.uid,value:i.uid},{default:a(()=>[l(_(i?.firstName)+" "+_(i?.lastName),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},16)]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1}),t(e.FormField,{name:"businessPhone"},{default:a(({componentField:o})=>[t(e.FormItem,null,{default:a(()=>[t(e.FormLabel,null,{default:a(()=>[...r[13]||(r[13]=[l("Business Phone",-1)])]),_:1}),t(e.FormControl,null,{default:a(()=>[t(e.Input,D(o,{placeholder:"Business Phone ..."}),null,16)]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1}),r[15]||(r[15]=p("hr",{class:"border-border"},null,-1)),t(e.Button,{type:"submit",class:"w-full"},{default:a(()=>[...r[14]||(r[14]=[l("Save Form",-1)])]),_:1})],32)]),_:1})):k("",!0)],64)}const Oe=X(Me,[["render",Ce],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/laboratory/LaboratoryListing.vue"]]);export{Oe as default};
