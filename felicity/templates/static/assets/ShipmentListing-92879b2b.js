import{P as K,e as W,ai as X,a9 as Y,Z as p,a3 as i,aj as Z,f as G,h as Q,o as u,c as f,a as L,a2 as l,b as t,z as M,a7 as m,K as b,A as c,W as ee,L as te,x as se,F as S,D as _,E as A,a4 as ae,V as k,al as ne,J as le,X as V,Y as B,_ as oe}from"./index-e1b11e1a.js";import{u as re,a as ie}from"./shipment-7e229a17.js";import{c as ue,d as D,a as R,u as me,b as v}from"./array-81ccc855.js";const de={class:"flex justify-between items-center"},fe={class:"flex"},ce={action:"post",class:"p-1"},pe={class:"grid grid-cols-3 gap-x-4 mb-4"},be={class:"block col-span-1 mb-2"},ve=["value"],he={class:"block col-span-1 mb-2"},ge={class:"block col-span-1 mb-2"},ye={class:"grid grid-cols-3 gap-x-4 mb-4"},xe={class:"block col-span-3 mb-2"},Se=K({__name:"ShipmentListing",setup(ke){const T=V(()=>B(()=>import("./index-e1b11e1a.js").then(s=>s.cM),["assets/index-e1b11e1a.js","assets/index-78b87750.css"])),U=V(()=>B(()=>import("./FelDataTable-3747b614.js"),["assets/FelDataTable-3747b614.js","assets/index-e1b11e1a.js","assets/index-78b87750.css"])),o=re(),{withClientMutation:I}=W(),{shipments:w,fetchingShipments:P,shipmentPageInfo:C}=X(o);Y();let r=p(!1);const d=p(!1),E=p([{name:"All",value:""},{name:"Due",value:"due"},{name:"Awaiting",value:"awaiting"},{name:"Failed",value:"failed"}]),N=p([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Shipment Id",value:"shipmentId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(s,e){return i(Z,{to:{name:"shipment-detail",params:{shipmentUid:s?.uid}},innerHTML:s?.shipmentId})}},{name:"External Laboratory",value:"laboratory.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Courier",value:"courier",sortable:!1,sortBy:"asc",hidden:!1},{name:"Flow Detail",value:"",sortable:!1,sortBy:"asc",hidden:!1},{name:"Assigned Count",value:"assignedCount",sortable:!1,sortBy:"asc",hidden:!1},{name:"Current Status",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(s,e){return i("button",{type:"button",class:"bg-sky-800 text-white py-1 px-2 rounded-sm leading-none",innerHTML:s?.state||"unknown"})}},{name:"",value:"",sortable:!1,showInToggler:!1,hidden:!1,customRender:function(s,e){return s.incoming?i("span",{class:"text-green-600"},i("i",{class:"fa fa-reply-all"})):i("span",{class:"text-orange-600"},i("i",{class:"fa fa-share-from-square"}))}}]);o.removeShipment();let n=G({first:25,before:"",incoming:d.value,status:"",text:"",sort:["-uid"],filterAction:!1});o.fetcShipments(n),o.fetchReferralLaboratories();const F=ue({laboratoryUid:D().required("Laboratory is Required").typeError("Laboratory is Required"),comment:R().nullable(),courier:R().required("Courier is required"),count:D()}),{handleSubmit:q,errors:O}=me({validationSchema:F,initialValues:{laboratoryUid:void 0,comment:"",courier:"",count:1}}),{value:h}=v("laboratoryUid"),{value:g}=v("comment"),{value:y}=v("courier"),{value:x}=v("count"),$=q(s=>{r.value=!1,I(ie,{payload:s},"createShipment").then(e=>{o.addShipment(e),r.value=!1})});function H(s){n.first=s.fetchCount,n.before=C?.value?.endCursor??"",n.text=s.filterText,n.status=s.filterStatus,n.incoming=d.value,n.filterAction=!1,o.fetcShipments(n)}function j(s){n.first=25,n.before="",n.text=s.filterText,n.status=s.filterStatus,n.incoming=d.value,n.filterAction=!0,o.clearShipment(),o.fetcShipments(n)}const z=Q(()=>w?.value?.length+" of "+o.getShipmentCount+" Shipments");return(s,e)=>(u(),f(S,null,[L(l(T),{title:"Shipments"}),t("div",de,[t("div",null,[t("button",{onClick:e[0]||(e[0]=M(a=>m(r)?r.value=!0:r=!0,["prevent"])),class:"p-2 h-10 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Add Shipment ")])]),L(l(U),{columns:N.value,data:l(w),toggleColumns:!0,loading:l(P),paginable:!0,pageMeta:{fetchCount:l(n).first,hasNextPage:l(C)?.hasNextPage,countNone:z.value},searchable:!0,filterable:!0,filterMeta:{defaultFilter:l(n).status,filters:E.value},onOnSearch:j,onOnPaginate:H,selectable:!1},{"pre-filter":b(()=>[t("label",fe,[c(t("input",{type:"checkbox","onUpdate:modelValue":e[1]||(e[1]=a=>d.value=a)},null,512),[[ee,d.value]]),e[8]||(e[8]=te()),e[9]||(e[9]=t("span",{class:"mx-2"},"InBound",-1))])]),footer:b(()=>e[10]||(e[10]=[])),_:1},8,["columns","data","loading","pageMeta","filterMeta"]),l(r)?(u(),se(ne,{key:0,onClose:e[7]||(e[7]=a=>m(r)?r.value=!1:r=!1)},{header:b(()=>[t("div",null,[e[11]||(e[11]=t("h3",null,"Create Shipment",-1)),e[12]||(e[12]=t("hr",null,null,-1)),t("ul",null,[(u(!0),f(S,null,_(Object.values(l(O)),(a,J)=>(u(),f("li",{key:J,class:"text-orange-600"},A(a),1))),128))])])]),body:b(()=>[t("form",ce,[t("div",pe,[t("label",be,[e[13]||(e[13]=t("span",{class:"text-gray-700"},"External Laboratory",-1)),c(t("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[2]||(e[2]=a=>m(h)?h.value=a:null)},[(u(!0),f(S,null,_(l(o).laboratories,a=>(u(),f("option",{key:a.uid,value:a.uid},A(a.name),9,ve))),128))],512),[[ae,l(h)]])]),t("label",he,[e[14]||(e[14]=t("span",{class:"text-gray-700"},"Courier",-1)),c(t("input",{type:"text",class:"form-input mt-1 block w-full","onUpdate:modelValue":e[3]||(e[3]=a=>m(y)?y.value=a:null)},null,512),[[k,l(y)]])]),t("label",ge,[e[15]||(e[15]=t("span",{class:"text-gray-700"},"How Many",-1)),c(t("input",{type:"number",class:"form-input mt-1 block w-full","onUpdate:modelValue":e[4]||(e[4]=a=>m(x)?x.value=a:null),min:"1",default:"1/"},null,512),[[k,l(x)]])])]),t("div",ye,[t("label",xe,[e[16]||(e[16]=t("span",{class:"text-gray-700"},"Comment",-1)),c(t("textarea",{class:"form-input mt-1 block w-full",rows:"2",placeholder:"Notes ...","onUpdate:modelValue":e[5]||(e[5]=a=>m(g)?g.value=a:null)},null,512),[[k,l(g)]])])]),e[17]||(e[17]=t("hr",null,null,-1)),t("button",{type:"button",onClick:e[6]||(e[6]=M(a=>l($)(),["prevent"])),class:"-mb-4 w-full border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Create Shipment ")])]),_:1})):le("",!0)],64))}}),Me=oe(Se,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/shipment/ShipmentListing.vue"]]);export{Me as default};
