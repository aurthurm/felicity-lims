import{S as me,O as ce,a6 as fe,V as ge,a0 as n,i as ve,h as xe,o as g,c as v,K as $,N as o,C as r,D as x,a5 as a,a as l,L as c,M as f,ad as B,Y as O,F as ye,E as he,a3 as j,H as y,X as ke,Z as W,$ as M,am as be,_ as we}from"./index-56caabce.js";import{u as Re}from"./worksheet-b0ceb781.js";import{u as Se}from"./analysis-21df1d64.js";import{u as Ue}from"./user-9e32552f.js";import{u as _e}from"./setup-4becf527.js";import{h,o as k,a as b}from"./constants-0d1ca1f9.js";import"./analyses.mutations-ead3a15c.js";import"./_queries-a1c5c7fd.js";const Ve={class:"space-y-6"},Ce={class:"flex items-center justify-between bg-background rounded-lg shadow-sm p-4"},Ae={class:"flex items-center space-x-4"},Ie={class:"flex items-center space-x-4"},Ee={class:"bg-background rounded-lg shadow-sm overflow-hidden"},De={class:"p-4 border-b border-border"},Ne={class:"grid grid-cols-3 gap-4"},Le={class:"block space-y-2"},Te={class:"block space-y-2"},Be={class:"block space-y-2"},We={class:"mt-4 flex justify-end"},Me={class:"overflow-x-auto"},ze={class:"w-full"},Ye={class:"bg-muted"},Fe={class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},Pe={class:"divide-y divide-border"},$e={class:"px-4 py-3 whitespace-nowrap"},Oe=["onUpdate:modelValue","disabled"],je={class:"px-4 py-3 whitespace-nowrap"},Ge={class:"px-4 py-3 whitespace-nowrap"},He={class:"px-4 py-3 whitespace-nowrap"},Je={class:"px-4 py-3 whitespace-nowrap"},Ke=["onUpdate:modelValue"],Xe={key:1},Ze={class:"px-4 py-3 whitespace-nowrap"},qe=me({__name:"WorkSheetResults",setup(Qe){const d=W(()=>M(()=>import("./index-56caabce.js").then(s=>s.cJ),["assets/index-56caabce.js","assets/index-f2df9813.css"])),_=W(()=>M(()=>import("./FelSelect-2e1f76d5.js"),["assets/FelSelect-2e1f76d5.js","assets/index-56caabce.js","assets/index-f2df9813.css"])),z=W(()=>M(()=>import("./FelSwitch-24b6a4ae.js"),["assets/FelSwitch-24b6a4ae.js","assets/index-56caabce.js","assets/index-f2df9813.css"])),V=ce(),w=_e(),Y=Ue(),F=fe();ge();let C=n(!1),A=n(!1),I=n(!1),E=n(!1),D=n(!1),p=n(!1),i=n(!1),R=n(!1),m=ve(()=>V.getWorkSheet);const G=()=>{V.fetchWorksheetByUid(F.params.workSheetUid)};Y.fetchUsers({}),w.fetchLaboratoryInstruments(),w.fetchMethods();const u=xe({analystUid:null,instrumentUid:null,methodUid:null}),N=n(!1),H=()=>{N.value=!0,V.updateWorksheet({worksheetUid:F.params.workSheetUid,...u}).then(()=>{N.value=!1,G()})};function J(){return m.value?.analysisResults?.every(s=>s.checked===!0)}function L(){let s=[];return m.value?.analysisResults?.forEach(e=>{e.checked&&s.push(e)}),s}function K(){J()?i.value=!0:i.value=!1,S()}function X(s){if(Z(s)){P(s);return}s.checked=!0,S()}function Z(s){return["retracted","approved"].includes(s.status)}function P(s){s.checked=!1,S()}function q(){m?.value?.analysisResults?.forEach(s=>i.value?X(s):P(s)),S()}function Q(s){s.editable=!0}function ee(s){return s.status!=="pending"?!1:s?.editable||be(s?.result)?(Q(s),!0):!1}function te(){let s=L(),e=[];return s?.forEach(t=>e.push({uid:t.uid,result:t.result,laboratoryInstrumentUid:t.laboratoryInstrumentUid,methodUid:t.methodUid})),e}function T(){const s=L();let e=[];return s?.forEach(t=>e.push(t.uid)),e}function se(s){switch(s?.status){case"retracted":return"bg-muted text-sm italic text-muted-foreground";default:return"text-sm leading-5 text-primary"}}function oe(s){switch(s?.status){case"retracted":return!0;case"approved":return s?.reportable===!1;default:return!1}}function S(){C.value=!1,D.value=!1,A.value=!1,I.value=!1,E.value=!1,p.value=!1;const s=L();s.length!==0&&(p.value=!0,s.every(e=>e.status==="pending")&&(C.value=!0,D.value=!0),s.every(e=>e.status==="resulted")&&(A.value=!0,I.value=!0,E.value=!0))}const{submitResults:ae,approveResults:le,retractResults:ne,retestResults:re}=Se();Re();const ie=()=>ae(te(),"worksheet",m.value?.uid),ue=()=>le(T(),"worksheet",m.value?.uid),de=()=>ne(T()),pe=()=>re(T());return(s,e)=>(g(),v("div",Ve,[$(" Actions Bar "),o("div",Ce,[o("div",Ae,[r(l(a(d),{onClick:e[0]||(e[0]=t=>ie()),loading:s.submitting,variant:"primary",size:"sm"},{default:c(()=>e[14]||(e[14]=[f(" Submit Results ")])),_:1},8,["loading"]),[[x,a(C)&&h(b.SUBMIT,k.ANALYSIS)]]),r(l(a(d),{onClick:e[1]||(e[1]=t=>ue()),loading:s.approving,variant:"primary",size:"sm"},{default:c(()=>e[15]||(e[15]=[f(" Approve Results ")])),_:1},8,["loading"]),[[x,a(I)&&h(b.VERIFY,k.ANALYSIS)]]),r(l(a(d),{onClick:e[2]||(e[2]=t=>de()),loading:s.retracting,variant:"destructive",size:"sm"},{default:c(()=>e[16]||(e[16]=[f(" Retract Results ")])),_:1},8,["loading"]),[[x,a(A)&&h(b.RETRACT,k.ANALYSIS)]]),r(l(a(d),{onClick:e[3]||(e[3]=t=>pe()),loading:s.retesting,variant:"secondary",size:"sm"},{default:c(()=>e[17]||(e[17]=[f(" Retest ")])),_:1},8,["loading"]),[[x,a(E)&&h(b.RETEST,k.ANALYSIS)]]),r(l(a(d),{onClick:e[4]||(e[4]=t=>s.unassignResults()),loading:s.unassigning,variant:"secondary",size:"sm"},{default:c(()=>e[18]||(e[18]=[f(" Unassign ")])),_:1},8,["loading"]),[[x,a(D)&&h(b.UNASSIGN,k.ANALYSIS)]])]),o("div",Ie,[l(a(z),{modelValue:a(R),"onUpdate:modelValue":e[5]||(e[5]=t=>B(R)?R.value=t:R=t),label:"View Detail"},null,8,["modelValue"]),l(a(z),{modelValue:a(p),"onUpdate:modelValue":e[6]||(e[6]=t=>B(p)?p.value=t:p=t),label:"Print Barcodes"},null,8,["modelValue"])])]),$(" Results Table "),o("div",Ee,[o("div",De,[o("div",Ne,[o("label",Le,[e[19]||(e[19]=o("span",{class:"text-sm font-medium text-foreground"},"Analyst",-1)),l(a(_),{modelValue:u.analystUid,"onUpdate:modelValue":e[7]||(e[7]=t=>u.analystUid=t),options:a(Y).getUsers,"option-label":"firstName","option-value":"uid",placeholder:"Select Analyst",class:"w-full"},null,8,["modelValue","options"])]),o("label",Te,[e[20]||(e[20]=o("span",{class:"text-sm font-medium text-foreground"},"Instrument",-1)),l(a(_),{modelValue:u.instrumentUid,"onUpdate:modelValue":e[8]||(e[8]=t=>u.instrumentUid=t),options:a(w).getLaboratoryInstruments,"option-label":"name","option-value":"uid",placeholder:"Select Instrument",class:"w-full"},null,8,["modelValue","options"])]),o("label",Be,[e[21]||(e[21]=o("span",{class:"text-sm font-medium text-foreground"},"Method",-1)),l(a(_),{modelValue:u.methodUid,"onUpdate:modelValue":e[9]||(e[9]=t=>u.methodUid=t),options:a(w).getMethods,"option-label":"name","option-value":"uid",placeholder:"Select Method",class:"w-full"},null,8,["modelValue","options"])])]),o("div",We,[l(a(d),{onClick:e[10]||(e[10]=t=>H()),loading:N.value,variant:"primary",size:"sm"},{default:c(()=>e[22]||(e[22]=[f(" Apply Changes ")])),_:1},8,["loading"])])]),o("div",Me,[o("table",ze,[o("thead",Ye,[o("tr",null,[o("th",Fe,[r(o("input",{type:"checkbox","onUpdate:modelValue":e[11]||(e[11]=t=>B(i)?i.value=t:i=t),onClick:e[12]||(e[12]=t=>q()),class:"rounded border-input text-primary focus:ring-primary"},null,512),[[O,a(i)]])]),e[23]||(e[23]=o("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Sample ID",-1)),e[24]||(e[24]=o("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Client Sample ID",-1)),e[25]||(e[25]=o("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Analysis",-1)),e[26]||(e[26]=o("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Result",-1)),e[27]||(e[27]=o("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Status",-1))])]),o("tbody",Pe,[(g(!0),v(ye,null,he(a(m)?.analysisResults,t=>(g(),v("tr",{key:t.uid,class:j(se(t))},[o("td",$e,[r(o("input",{type:"checkbox","onUpdate:modelValue":U=>t.checked=U,onClick:e[13]||(e[13]=U=>K()),disabled:oe(t),class:"rounded border-input text-primary focus:ring-primary"},null,8,Oe),[[O,t.checked]])]),o("td",je,y(t.sample?.sampleId),1),o("td",Ge,y(t.sample?.clientSampleId),1),o("td",He,y(t.analysis?.name),1),o("td",Je,[ee(t)?r((g(),v("input",{key:0,type:"text","onUpdate:modelValue":U=>t.result=U,class:"w-full px-2 py-1 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary"},null,8,Ke)),[[ke,t.result]]):(g(),v("span",Xe,y(t.result),1))]),o("td",Ze,[o("span",{class:j(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",{"bg-primary/10 text-primary":t.status==="pending","bg-warning/10 text-warning":t.status==="awaiting","bg-success/10 text-success":t.status==="approved","bg-destructive/10 text-destructive":t.status==="retracted"}])},y(t.status),3)])],2))),128))])])])])]))}}),it=we(qe,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/worksheet/_id/WorkSheetResults.vue"]]);export{it as default};
