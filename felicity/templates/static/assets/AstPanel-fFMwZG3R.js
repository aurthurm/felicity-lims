import{a0 as te,f as se,a7 as u,ad as oe,aj as ie,_ as ne,r as F,c as a,o as r,a as G,A as e,C as re,E as A,N as k,P as ae,J as g,K as h,L as c,D as le,F as x,a2 as O,a3 as z}from"./index-Daoe3XS9.js";import{c as de,e as J,a as M,u as ce,b as C}from"./index.esm-BT7_X8h2.js";import{g as ue,a as me,X as fe,Y as be,Z as ge}from"./microbiology.mutations-t5_lptzK.js";const xe=te({__name:"AstPanel",setup(K,{expose:s}){s();const{withClientMutation:_,withClientQuery:t}=se(),y=u(!1),P=u(""),p=u(!0),b=u(null),v=u(""),o=u(""),i=u([]),m=u([]),w=u([]),f=u([]),S=u([]),E=de({name:M().trim().required("Panel name is required"),selectedAntibiotics:J().of(M().trim()).min(1,"Select at least one antibiotic"),selectedOrganisms:J().of(M().trim()).min(1,"Select at least one organism")}),{handleSubmit:V,resetForm:L,setValues:N,errors:Q}=ce({validationSchema:E,initialValues:{name:"",description:"",selectedAntibiotics:[],selectedOrganisms:[]}}),{value:W}=C("name"),{value:X}=C("description"),{value:Y}=C("selectedAntibiotics"),{value:j}=C("selectedOrganisms");oe(()=>{B(),D(),U()});function B(){t(ue,{},"abxLaboratoryAntibiotics").then(n=>{n&&(m.value=n,w.value=[...m.value])})}function D(){t(me,{text:v.value,pageSize:25,sortBy:["name"]},"abxOrganismAll").then(n=>{f.value=f.value?.filter(l=>j.value.includes(l.uid))||[],f.value=ie(f.value,n?.items,"uid"),S.value=[...f.value]})}function U(){t(fe,{},"abxAstPanelAll").then(n=>{n&&(i.value=n,i.value.forEach(l=>l.organisms?.forEach(d=>f.value.push(d))))})}function Z(n,l={}){p.value=n,y.value=!0,P.value=(n?"Create":"Edit")+" AST Panel",n?(b.value=null,L()):(b.value=l.uid??null,N({name:l.name??"",description:l.description??"",selectedAntibiotics:l.antibiotics?.map(d=>d.uid)||[],selectedOrganisms:l.organisms?.map(d=>d.uid)||[]}))}const H=V(n=>{const l={name:n.name,description:n.description,antibiotics:n.selectedAntibiotics,organisms:n.selectedOrganisms};p.value?_(be,{payload:l},"createAbxAstPanel").then(d=>{d&&i.value.unshift(d)}):b.value&&_(ge,{uid:b.value,payload:l},"updateAbxAstPanel").then(d=>{if(d){const q=i.value.findIndex(T=>T.uid===d.uid);q>-1&&(i.value=[...i.value.map((T,ee)=>ee===q?d:T)])}}),y.value=!1});function R(){if(!o.value){w.value=[...m.value];return}w.value=m.value.filter(n=>n.name.toLowerCase().includes(o.value.toLowerCase()))}function $(){if(!v.value){S.value=[...f.value];return}D()}const I={withClientMutation:_,withClientQuery:t,showModal:y,formTitle:P,formAction:p,currentUid:b,searchOrgText:v,searchAbxText:o,panels:i,antibiotics:m,filteredAntibiotics:w,organisms:f,filteredOrganisms:S,astPanelSchema:E,handleSubmit:V,resetForm:L,setValues:N,errors:Q,name:W,description:X,selectedAntibiotics:Y,selectedOrganisms:j,fetchAntibiotics:B,fetchOrganisms:D,fetchPanels:U,FormManager:Z,saveForm:H,filterAntibiotics:R,filterOrganisms:$};return Object.defineProperty(I,"__isScriptSetup",{enumerable:!1,value:!0}),I}}),pe={class:"overflow-x-auto"},ve={class:"align-middle inline-block min-w-full shadow overflow-hidden bg-background shadow-dashboard rounded-lg"},he={class:"min-w-full divide-y divide-border fel-table"},_e={class:"bg-background divide-y divide-border"},ye={class:"px-3 py-3.5 whitespace-nowrap text-sm text-foreground"},we={class:"px-3 py-3.5 whitespace-nowrap text-sm text-foreground"},Ae={class:"px-3 py-3.5 whitespace-nowrap text-sm text-foreground"},ke={class:"px-3 py-3.5 whitespace-nowrap text-sm text-foreground"},Oe={class:"px-3 py-3.5 whitespace-nowrap text-right text-sm"},Ce=["onClick"],Pe={class:"text-xl font-semibold text-foreground"},Se={class:"space-y-4"},De={class:"grid grid-cols-1 gap-4"},Te={class:"block"},Fe={key:0,class:"text-sm text-destructive"},Me={class:"block"},Ee={class:"flex gap-4"},Ve={class:"w-2/3 space-y-2"},Le={class:"block"},Ne={class:"border border-border rounded-md p-2 h-64 overflow-y-auto"},je=["value"],Be={class:"ml-2 text-sm text-foreground"},Ue={key:0,class:"text-sm text-destructive"},Ie={class:"w-1/3"},qe={class:"border border-border rounded-md p-2 h-72 overflow-y-auto bg-background"},Ge={class:"text-sm text-foreground"},ze=["onClick"],Je={class:"flex gap-4"},Ke={class:"w-2/3 space-y-2"},Qe={class:"block"},We={class:"border border-border rounded-md p-2 h-64 overflow-y-auto"},Xe=["value"],Ye={class:"ml-2 text-sm text-foreground"},Ze={key:0,class:"text-sm text-destructive"},He={class:"w-1/3"},Re={class:"border border-border rounded-md p-2 h-72 overflow-y-auto bg-background"},$e={class:"text-sm text-foreground"},et=["onClick"];function tt(K,s,_,t,y,P){const p=F("fel-button"),b=F("fel-heading"),v=F("fel-modal");return r(),a(g,null,[G(b,{title:"AST Panels"},{default:k(()=>[G(p,{onClick:s[0]||(s[0]=o=>t.FormManager(!0))},{default:k(()=>[...s[9]||(s[9]=[ae("Add Panel",-1)])]),_:1})]),_:1}),e("div",pe,[e("div",ve,[e("table",he,[s[10]||(s[10]=e("thead",null,[e("tr",null,[e("th",{class:"px-3 py-3.5 text-left text-sm font-semibold text-foreground"},"Name"),e("th",{class:"px-3 py-3.5 text-left text-sm font-semibold text-foreground"},"Description"),e("th",{class:"px-3 py-3.5 text-left text-sm font-semibold text-foreground"},"Organisms"),e("th",{class:"px-3 py-3.5 text-left text-sm font-semibold text-foreground"},"Antibiotics"),e("th",{class:"px-3 py-3.5"})])],-1)),e("tbody",_e,[(r(!0),a(g,null,h(t.panels,o=>(r(),a("tr",{key:o?.uid},[e("td",ye,c(o?.name),1),e("td",we,c(o?.description),1),e("td",Ae,c(o?.organisms?.map(i=>i.name).join(", ")),1),e("td",ke,c(o?.antibiotics?.map(i=>i.name).join(", ")),1),e("td",Oe,[e("button",{onClick:i=>t.FormManager(!1,o),class:"px-3 py-1.5 bg-primary text-primary-foreground rounded-sm transition duration-300 hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Edit ",8,Ce)])]))),128))])])])]),t.showModal?(r(),re(v,{key:0,onClose:s[8]||(s[8]=o=>t.showModal=!1),contentWidth:"w-1/2"},{header:k(()=>[e("h3",Pe,c(t.formTitle),1)]),body:k(()=>[e("form",{onSubmit:s[7]||(s[7]=le((...o)=>t.saveForm&&t.saveForm(...o),["prevent"])),class:"space-y-6 p-4"},[e("div",Se,[e("div",De,[e("label",Te,[s[11]||(s[11]=e("span",{class:"text-sm font-medium text-foreground"},"Panel Name",-1)),x(e("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>t.name=o),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:"Enter panel name"},null,512),[[O,t.name]]),t.errors.name?(r(),a("p",Fe,c(t.errors.name),1)):A("",!0)]),e("label",Me,[s[12]||(s[12]=e("span",{class:"text-sm font-medium text-foreground"},"Description",-1)),x(e("textarea",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.description=o),rows:"2",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:"Enter description"},null,512),[[O,t.description]])])]),e("div",Ee,[e("div",Ve,[e("label",Le,[s[13]||(s[13]=e("span",{class:"text-sm font-medium text-foreground"},"Search Organisms",-1)),x(e("input",{"onUpdate:modelValue":s[3]||(s[3]=o=>t.searchOrgText=o),onInput:t.filterOrganisms,class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:"Search organisms..."},null,544),[[O,t.searchOrgText]])]),e("div",Ne,[(r(!0),a(g,null,h(t.filteredOrganisms,o=>(r(),a("div",{key:o.uid,class:"flex items-center py-1"},[x(e("input",{type:"checkbox",value:o.uid,"onUpdate:modelValue":s[4]||(s[4]=i=>t.selectedOrganisms=i),class:"rounded border-border text-primary shadow-sm focus:border-primary focus:ring focus:ring-primary/50"},null,8,je),[[z,t.selectedOrganisms]]),e("span",Be,c(o.name),1)]))),128))]),t.errors.selectedOrganisms?(r(),a("p",Ue,c(t.errors.selectedOrganisms),1)):A("",!0)]),e("div",Ie,[s[14]||(s[14]=e("div",{class:"text-sm font-medium text-foreground mb-1"},"Selected Organisms",-1)),e("div",qe,[(r(!0),a(g,null,h(t.selectedOrganisms,o=>(r(),a("div",{key:o,class:"flex items-center justify-between py-1 px-2 mb-1 bg-background rounded-md shadow-sm"},[e("span",Ge,c(t.organisms?.find(i=>i.uid===o)?.name),1),e("button",{onClick:i=>t.selectedOrganisms=t.selectedOrganisms.filter(m=>m!==o),class:"text-destructive hover:text-destructive/80 text-sm"}," × ",8,ze)]))),128))])])]),e("div",Je,[e("div",Ke,[e("label",Qe,[s[15]||(s[15]=e("span",{class:"text-sm font-medium text-foreground"},"Search Antibiotics",-1)),x(e("input",{"onUpdate:modelValue":s[5]||(s[5]=o=>t.searchAbxText=o),onInput:t.filterAntibiotics,class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:"Search antibiotics..."},null,544),[[O,t.searchAbxText]])]),e("div",We,[(r(!0),a(g,null,h(t.filteredAntibiotics,o=>(r(),a("div",{key:o.uid,class:"flex items-center py-1"},[x(e("input",{type:"checkbox",value:o.uid,"onUpdate:modelValue":s[6]||(s[6]=i=>t.selectedAntibiotics=i),class:"rounded border-border text-primary shadow-sm focus:border-primary focus:ring focus:ring-primary/50"},null,8,Xe),[[z,t.selectedAntibiotics]]),e("span",Ye,c(o.name),1)]))),128))]),t.errors.selectedAntibiotics?(r(),a("p",Ze,c(t.errors.selectedAntibiotics),1)):A("",!0)]),e("div",He,[s[16]||(s[16]=e("div",{class:"text-sm font-medium text-foreground mb-1"},"Selected Antibiotics",-1)),e("div",Re,[(r(!0),a(g,null,h(t.selectedAntibiotics,o=>(r(),a("div",{key:o,class:"flex items-center justify-between py-1 px-2 mb-1 bg-background rounded-md shadow-sm"},[e("span",$e,c(t.antibiotics.find(i=>i.uid==o)?.name),1),e("button",{onClick:i=>t.selectedAntibiotics=t.selectedAntibiotics.filter(m=>m!==o),class:"text-destructive hover:text-destructive/80 text-sm"}," × ",8,et)]))),128))])])])]),s[17]||(s[17]=e("div",{class:"mt-6"},[e("button",{type:"submit",class:"w-full bg-primary text-primary-foreground rounded-sm px-4 py-2 transition-colors duration-300 hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Save Panel ")],-1))],32)]),_:1})):A("",!0)],64)}const nt=ne(xe,[["render",tt],["__scopeId","data-v-195d3b3a"],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/microbiology/astpanel/AstPanel.vue"]]);export{nt as default};
