import{P as J,e as W,Z as B,o as m,c as v,L as ee,E as o,a2 as s,b as t,A as i,a4 as x,a7 as n,a as T,F,D as h,V as f,C as A,z as te,X as le,Y as se,_ as oe}from"./index-f86d8273.js";import ae from"./vue-multiselect.esm-1db37a44.js";import{c as E,a as b,d as w,f as L,u as ie,b as u}from"./array-6bfc3b39.js";import{u as ne,R as ue,n as re}from"./inventory-2dbb1a67.js";import{a as de}from"./storage-99ec424d.js";import{u as ce}from"./setup-dcd94d2b.js";import{u as pe}from"./user-ccef6161.js";import"./_queries-4c7a9cfd.js";const me=["inert"],ve={class:"mt-2 grid grid-cols-6 whitespace-nowrap w-full"},fe={class:"text-orange-600 w-4/12"},we={class:"mt-2 grid grid-cols-6 whitespace-nowrap w-full"},ge={class:"w-full col-span-4"},ye={class:"text-orange-600 w-4/12"},be={class:"mt-2 grid grid-cols-6 whitespace-nowrap w-full"},ke=["value"],xe={class:"text-orange-600 w-4/12"},Re={class:"mt-2 grid grid-cols-6 whitespace-nowrap w-full"},Se=["value"],Ue={class:"text-orange-600 w-4/12"},_e={class:"mt-2 grid grid-cols-6 whitespace-nowrap w-full"},Ve={class:"w-full col-span-4"},De={class:"text-orange-600 w-4/12"},qe={class:"mt-2 grid grid-cols-6 whitespace-nowrap w-full"},Pe={class:"w-full col-span-4"},Fe={class:"text-orange-600 w-4/12"},he={class:"mt-2 grid grid-cols-6 whitespace-nowrap w-full"},Ie={class:"w-full col-span-4"},Ne={class:"text-orange-600 w-4/12"},Be={class:"mt-2 grid grid-cols-6 whitespace-nowrap w-full"},Te={class:"w-full col-span-4"},Ae={class:"text-orange-600 w-4/12"},Ee={class:"mt-2 grid grid-cols-6 whitespace-nowrap w-full"},Le={class:"w-full col-span-4"},Ce={class:"text-orange-600 w-4/12"},Me={class:"mt-2 grid grid-cols-6 whitespace-nowrap w-full"},Qe={class:"w-full col-span-4"},$e={class:"text-orange-600 w-4/12"},Ke={class:"mt-2 grid grid-cols-6 whitespace-nowrap w-full"},ze={class:"w-full col-span-4"},Ge={class:"text-orange-600 w-4/12"},Oe={class:"mt-2 grid grid-cols-6 whitespace-nowrap w-full"},Xe=["value"],Ye={class:"text-orange-600 w-4/12"},Ze={type:"submit",class:"-mb-4 w-1/5 border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"},je=J({__name:"StockReceiveForm",emits:["close"],setup(He,{emit:C}){const M=le(()=>se(()=>import("./FelLoadingMessage-e1e357b9.js"),["assets/FelLoadingMessage-e1e357b9.js","assets/index-f86d8273.js","assets/index-ba19faea.css"])),Q=C,$=ne(),K=ce();de();const z=pe(),{withClientMutation:G,withClientQuery:O}=W(),I=B([]),g=B(!1),X=E({stockItemVariant:E().required("StockItem is required"),supplierUid:b().required(),unitUid:b().required(),lotNumber:b().required(),unitPrice:w().nullable().default(0),totalPrice:w().nullable().default(0),singlesReceived:w().required().default(0),packagesReceived:w().required().default(0),packageFactor:w().required().default(1),quantityReceived:w().default(0),receiptType:b().required().default("purchase"),receiptDate:L().required("Date received is required"),receiptByUid:b().required("Receiver is required"),expiryDate:L().required("Date expiring is required")}),{handleSubmit:Y,errors:a}=ie({validationSchema:X,initialValues:{singlesReceived:0,packagesReceived:0,packageFactor:1,quantityReceived:0}}),{value:k}=u("stockItemVariant"),{value:R}=u("supplierUid"),{value:S}=u("unitUid"),{value:U}=u("lotNumber"),{value:c}=u("totalPrice"),{value:r}=u("packagesReceived"),{value:y}=u("packageFactor"),{value:p}=u("quantityReceived"),{value:_}=u("receiptType"),{value:V}=u("receiptDate"),{value:D}=u("receiptByUid"),{value:q}=u("expiryDate"),N=Y(d=>Z(d));function Z(d){g.value=!0;const e={...d,productUid:k?.value?.uid,unitPrice:0,totalPrice:0};delete e.stockItemVariant,G(ue,{payload:e},"createStockReceipt").then(l=>{}).finally(()=>{g.value=!1,Q("close")})}const j=async d=>{d.length>3&&O(re,{first:50,after:"",text:d,sortBy:["name"]},"stockProductAll").then(l=>{I.value=l?.items})},H=(d,e)=>`${d.stockItem?.name} - ${d.name}`,P=()=>{!c.value&&!r.value&&(p.value=0),!c.value&&r.value&&(p.value=r.value*y.value),c.value&&!r.value&&(p.value=c.value),r.value||(r.value=0),p.value=c.value+r.value*y.value};return(d,e)=>(m(),v("form",{onSubmit:e[15]||(e[15]=te((...l)=>s(N)&&s(N)(...l),["prevent"])),class:"rounded-sm py-2",autocomplete:"off",inert:g.value},[ee(o(s(a))+" ",1),t("label",ve,[e[17]||(e[17]=t("span",{class:"col-span-2 text-gray-700 w-4/12"},"Reveice Type",-1)),i(t("select",{class:"col-span-4 form-select ml-1 mt-1 w-full","onUpdate:modelValue":e[0]||(e[0]=l=>n(_)?_.value=l:null)},e[16]||(e[16]=[t("option",{value:"null"},null,-1),t("option",{value:"purchase"},"Purchased",-1),t("option",{value:"pushed"},"Pushed",-1),t("option",{value:"transfer_in"},"Transfer In",-1)]),512),[[x,s(_)]])]),t("div",fe,o(s(a).receiptType),1),t("label",we,[e[18]||(e[18]=t("span",{class:"col-span-2 text-gray-700 w-4/12"},"Stock Item",-1)),t("div",ge,[T(s(ae),{placeholder:"Select a Stock Item",modelValue:s(k),"onUpdate:modelValue":e[1]||(e[1]=l=>n(k)?k.value=l:null),options:I.value,searchable:!0,"track-by":"uid",customLabel:H,onSearchChange:j},null,8,["modelValue","options"]),t("div",ye,o(s(a).stockItemVariantUid),1)])]),t("label",be,[e[20]||(e[20]=t("span",{class:"col-span-2 text-gray-700 w-4/12"},"Supplier",-1)),i(t("select",{class:"col-span-4 form-select ml-1 mt-1 w-full","onUpdate:modelValue":e[2]||(e[2]=l=>n(R)?R.value=l:null)},[e[19]||(e[19]=t("option",{value:"null"},null,-1)),(m(!0),v(F,null,h(s(K).suppliers,l=>(m(),v("option",{key:l.uid,value:l.uid},o(l.name),9,ke))),128))],512),[[x,s(R)]])]),t("div",xe,o(s(a).supplierUid),1),t("label",Re,[e[22]||(e[22]=t("span",{class:"col-span-2 text-gray-700 w-4/12"},"Unit (Single)",-1)),i(t("select",{class:"col-span-4 form-select ml-1 mt-1 w-full","onUpdate:modelValue":e[3]||(e[3]=l=>n(S)?S.value=l:null)},[e[21]||(e[21]=t("option",{value:"null"},null,-1)),(m(!0),v(F,null,h(s($).units,l=>(m(),v("option",{key:l.uid,value:l.uid},o(l.name),9,Se))),128))],512),[[x,s(S)]])]),t("div",Ue,o(s(a).unitUid),1),t("label",_e,[e[23]||(e[23]=t("span",{class:"col-span-2 text-gray-700 w-4/12"},"Lot Number",-1)),t("div",Ve,[i(t("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":e[4]||(e[4]=l=>n(U)?U.value=l:null),placeholder:"Lot Number..."},null,512),[[f,s(U)]]),t("div",De,o(s(a).lotNumber),1)])]),t("label",qe,[e[24]||(e[24]=t("span",{class:"col-span-2 text-gray-700 w-4/12"},"Packages Received",-1)),t("div",Pe,[i(t("input",{class:"form-input mt-1 block w-full",type:"number","onUpdate:modelValue":e[5]||(e[5]=l=>n(r)?r.value=l:null),placeholder:"Quantity Received...",onKeyup:P,onFocus:e[6]||(e[6]=l=>l.target.select())},null,544),[[f,s(r)]]),t("div",Fe,o(s(a).packagesReceived),1)])]),t("label",he,[e[25]||(e[25]=t("span",{class:"col-span-2 text-gray-700 w-4/12"},"Package Factor",-1)),t("div",Ie,[i(t("input",{class:"form-input mt-1 block w-full",type:"number","onUpdate:modelValue":e[7]||(e[7]=l=>n(y)?y.value=l:null),placeholder:"Quantity Received...",onKeyup:P,onFocus:e[8]||(e[8]=l=>l.target.select())},null,544),[[f,s(y)]]),t("div",Ne,o(s(a).packageFactor),1)])]),t("label",Be,[e[26]||(e[26]=t("span",{class:"col-span-2 text-gray-700 w-4/12"},"Singles Received",-1)),t("div",Te,[i(t("input",{class:"form-input mt-1 block w-full",type:"number","onUpdate:modelValue":e[9]||(e[9]=l=>n(c)?c.value=l:null),placeholder:"Quantity Received...",onKeyup:P,onFocus:e[10]||(e[10]=l=>l.target.select())},null,544),[[f,s(c)]]),t("div",Ae,o(s(a).singlesReceived),1)])]),t("label",Ee,[e[27]||(e[27]=t("span",{class:"col-span-2 text-gray-700 w-4/12"},"Quantity Received",-1)),t("div",Le,[i(t("input",{class:"form-input mt-1 block w-full",type:"number","onUpdate:modelValue":e[11]||(e[11]=l=>n(p)?p.value=l:null),disabled:""},null,512),[[f,s(p)]]),t("div",Ce,o(s(a).quantityReceived),1)])]),t("label",Me,[e[28]||(e[28]=t("span",{class:"col-span-2 text-gray-700 w-4/12"},"Expiry Date",-1)),t("div",Qe,[i(t("input",{class:"form-input mt-1 w-full",type:"date","onUpdate:modelValue":e[12]||(e[12]=l=>n(q)?q.value=l:null),placeholder:"Expiry Date"},null,512),[[f,s(q)]]),t("div",$e,o(s(a).expiryDate),1)])]),t("label",Ke,[e[29]||(e[29]=t("span",{class:"col-span-2 text-gray-700 w-4/12"},"Received Date",-1)),t("div",ze,[i(t("input",{class:"form-input mt-1 w-full",type:"date","onUpdate:modelValue":e[13]||(e[13]=l=>n(V)?V.value=l:null),placeholder:"Expiry Date"},null,512),[[f,s(V)]]),t("div",Ge,o(s(a).receiptDate),1)])]),t("label",Oe,[e[31]||(e[31]=t("span",{class:"col-span-2 text-gray-700 w-4/12"},"Received By",-1)),i(t("select",{class:"col-span-4 form-select ml-1 mt-1 w-full","onUpdate:modelValue":e[14]||(e[14]=l=>n(D)?D.value=l:null)},[e[30]||(e[30]=t("option",{value:"null"},null,-1)),(m(!0),v(F,null,h(s(z).users,l=>(m(),v("option",{key:l.uid,value:l.uid},o(l.firstName)+" "+o(l.lastName),9,Xe))),128))],512),[[x,s(D)]])]),t("div",Ye,o(s(a).receiptByUid),1),e[32]||(e[32]=t("hr",{class:"my-4"},null,-1)),i(t("button",Ze," Save ",512),[[A,!g.value]]),i(T(s(M),{message:"Adding Inventory ..."},null,512),[[A,g.value]])],40,me))}}),it=oe(je,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/inventory/StockReceiveForm.vue"]]);export{it as default};
