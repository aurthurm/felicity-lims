import{d as I,ab as U,aL as V,aM as j,s as E,D as O,n as R,o as r,c as d,f as p,g as z,e as C,F as m,p as g,b as n,t as a,H as b,aH as l,j as H,_ as M,k as P}from"./index-a40c2365.js";const q={class:"relative mt-4"},G=n("div",{class:"border-r-2 border-gray-400 border-dotted absolute h-full top-0 z-0",style:{left:"7px"}},null,-1),J={key:0,class:"py-4 text-center"},K={key:1,initial:{opacity:0,y:100},enter:{opacity:1,y:0,scale:1},variants:{custom:{scale:2}},delay:200,class:"list-none m-0 p-0"},Q={class:"flex items-center mb-1"},W=n("div",{class:"bg-indigo-600 rounded-full h-4 w-4 border-gray-200 border-2 z-10"},null,-1),X={class:"ml-4 font-medium italic"},Y={class:"ml-12 w-100"},Z={class:"col-span-1"},$={class:"text-sm text-gray-600 italic"},v={class:"col-span-3"},k={class:"text-muted text-xs text-orange-600"},B={class:"text-muted text-xs text-sky-800"},A=I({__name:"FelAuditLog",props:{targetId:String,targetType:String},setup(h){const x=H(()=>M(()=>import("./FelLoadingMessage-6fa0dda4.js"),["assets/FelLoadingMessage-6fa0dda4.js","assets/index-a40c2365.js","assets/index-12195ca3.css"])),y=h,{targetType:L,targetId:S}=U(y),f=V(),u=j();u.restLogs();const{auditLogs:D,fetchingAudits:w}=E(u);f.fetchUsers({}),u.fetchAuditLogs({targetType:L?.value,targetId:S?.value});let T=O(()=>f.getUsers);function i(o){const c=T?.value?.find(_=>_.uid?.toString()===o?.toString());return c?c.userName:""}function N(o){return o===1?"created":o===2?"updated":o===3?"deleted":""}function F(o){let c=new Set;return Object.entries(o?.stateBefore)?.map(([_,e])=>{Object.entries(o?.stateAfter)?.map(([t,s])=>{_===t&&e!==s&&(t&&t==="updated_by_uid"&&(t="updated_by",e=i(e),s=i(s)),t&&t==="submitted_by_uid"&&(t="submitted_by",e=i(e),s=i(s)),t&&t==="verified_by_uid"&&(t="verified_by",e=i(e),s=i(s)),t&&t==="updated_at"&&(t="updated_on",e=l(e),s=l(s)),t&&t==="cancelled_by_uid"&&(t="cancelled_by",e=i(e),s=i(s)),t&&t==="received_by_uid"&&(t="received_by",e=i(e),s=i(s)),c.add({key:t,old:e?.length>0?e:"None",new:s?.toString()?.length>0?s:"None"}))})}),c}return(o,c)=>{const _=R("motion");return r(),d("div",q,[G,p(w)?(r(),d("div",J,[z(p(x),{message:"Fetching audit logs ..."})])):C((r(),d("ul",K,[(r(!0),d(m,null,g(p(D),e=>(r(),d("li",{key:e.uid,class:"mb-2"},[n("div",Q,[W,n("div",X,[n("span",null,a(i(e?.userId))+" "+a(N(e?.action))+" "+a(e?.targetType),1),b(" on "),n("span",null,a(p(l)(e?.stateAfter?.updated_at)),1)])]),n("div",Y,[(r(!0),d(m,null,g(F(e),t=>(r(),d("div",{key:t.key,class:"grid grid-cols-4"},[n("span",Z,[n("span",$,a(t?.key),1)]),n("span",v,[n("span",k,a(t?.old),1),b(" â†’ "),n("span",B,a(t?.new),1)])]))),128))])]))),128))])),[[_]])])}}}),et=P(A,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/audit/FelAuditLog.vue"]]);export{et as default};
