import{S as T,f as W,ai as z,i as H,a7 as K,W as X,a0 as Y,r as h,o as l,c,a5 as r,a as w,N as o,F as G,E as J,H as x,K as k,y as O,L as U,C as y,a3 as A,ad as f,X as L,Y as P,A as Q,_ as Z}from"./index-56caabce.js";import{u as ee,g as oe,h as se}from"./billing-eb26955b.js";import{c as te,a as m,b as ie,g as re,u as ne,e as a}from"./array-956ab147.js";const de={class:"space-y-6"},ue={key:0,class:"rounded-lg border border-border bg-card p-4"},le={key:1,class:"space-y-6"},ae={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"},ce={class:"flex items-center justify-between"},fe={class:"space-y-1"},me={class:"font-medium text-foreground"},pe={class:"text-sm text-muted-foreground"},ge=["onClick"],be={class:"space-y-6"},ve={class:"grid grid-cols-2 gap-4"},he={class:"space-y-2"},xe={class:"space-y-2"},ye={class:"flex items-center space-x-2"},_e={class:"flex justify-end"},Ce=T({__name:"VoucherCodes",props:{voucherUid:String},setup(F){const d=F,{withClientMutation:_}=W();let u=ee();const{fetchingVoucherCodes:S}=z(u),M=H(()=>{const s=u.getVouchers,e=s?.findIndex(v=>v.uid===d.voucherUid);return e>-1?s[e]?.codes:[]});K(()=>u.fetchVoucherCodes(d.voucherUid)),X(()=>d.voucherUid,s=>{u.fetchVoucherCodes(d.voucherUid)});let n=Y(!1);const j=te({uid:m().nullable(),voucherUid:m().required(),code:m().required("Code is Required"),usageLimit:ie().required("Usage Limit is Required"),used:m().nullable(),isActive:re().default(!0)}),{handleSubmit:D,errors:C,setFieldValue:i}=ne({validationSchema:j,initialValues:{isActive:!0,voucherUid:d.voucherUid}}),{value:q}=a("uid");a("voucherUid");const{value:p}=a("code"),{value:g}=a("usageLimit");a("used");const{value:b}=a("isActive"),V=D(s=>{s.uid||N(s),s.uid&&R(s)});let B=s=>{i("uid",s.uid),i("code",s.code),i("usageLimit",s.usageLimit),i("used",s.used),i("isActive",s.isActive),n.value=!0};const $=()=>{i("uid",void 0),i("voucherUid",d.voucherUid),i("code",void 0),i("usageLimit",void 0),i("used",void 0),i("isActive",!0),n.value=!0},N=s=>{delete s.uid,_(oe,{payload:s},"createVoucherCode").then(e=>u.addVoucherCode(e)).finally(()=>n.value=!1)},R=s=>{delete s.uid,delete s.used,_(se,{uid:q?.value,payload:s},"updateVoucherCode").then(e=>u.updateVoucherCode(e)).finally(()=>n.value=!1)};return(s,e)=>{const v=h("fel-loader"),E=h("font-awesome-icon"),I=h("fel-modal");return l(),c("div",de,[r(S)?(l(),c("div",ue,[w(v,{message:"Fetching voucher codes ..."})])):(l(),c("section",le,[o("div",{class:"flex justify-between items-center"},[e[5]||(e[5]=o("h4",{class:"text-lg font-semibold text-foreground"},"Voucher Codes",-1)),o("button",{class:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-9 px-4 py-2",onClick:$}," Add Voucher Code ")]),o("div",ae,[(l(!0),c(G,null,J(M.value,t=>(l(),c("div",{key:t.uid,class:"rounded-lg border border-border bg-card p-4 transition-colors hover:bg-accent hover:text-accent-foreground"},[o("div",ce,[o("div",fe,[o("h5",me,x(t.code),1),o("p",pe,x(t.used)+" of "+x(t.usageLimit),1)]),o("button",{class:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-9 w-9",onClick:Ve=>r(B)(t)},[w(E,{icon:"pen",class:"text-muted-foreground"})],8,ge)])]))),128))])])),k(" Voucher Code Form Modal "),r(n)?(l(),O(I,{key:2,onClose:e[4]||(e[4]=t=>f(n)?n.value=!1:n=!1),contentWidth:"w-2/6"},{header:U(()=>e[6]||(e[6]=[o("h3",{class:"text-lg font-semibold text-foreground"},"Voucher Code Form",-1)])),body:U(()=>[o("form",be,[o("div",ve,[o("label",he,[e[7]||(e[7]=o("span",{class:"text-sm font-medium text-foreground"},"Voucher Code",-1)),y(o("input",{class:A(["form-input w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive animate-pulse":r(C).code}]),type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>f(p)?p.value=t:null),placeholder:"Code ..."},null,2),[[L,r(p)]])]),o("label",xe,[e[8]||(e[8]=o("span",{class:"text-sm font-medium text-foreground"},"Usage Limit",-1)),y(o("input",{class:A(["form-input w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive animate-pulse":r(C).usageLimit}]),type:"number",min:"1","onUpdate:modelValue":e[1]||(e[1]=t=>f(g)?g.value=t:null)},null,2),[[L,r(g)]])])]),o("div",ye,[y(o("input",{class:"form-checkbox h-4 w-4 rounded border-input text-primary focus:ring-primary",type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=t=>f(b)?b.value=t:null),checked:""},null,512),[[P,r(b)]]),e[9]||(e[9]=o("label",{class:"text-sm font-medium text-foreground"},"Is Active",-1))]),o("div",_e,[o("button",{type:"submit",class:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-9 px-4 py-2",onClick:e[3]||(e[3]=Q((...t)=>r(V)&&r(V)(...t),["prevent"]))}," Save Voucher Code ")])])]),_:1})):k("v-if",!0)])}}});const Ae=Z(Ce,[["__scopeId","data-v-8e7b96f9"],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/admin/billing/VoucherCodes.vue"]]);export{Ae as default};
