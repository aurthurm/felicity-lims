import{a0 as E,a7 as _,h as k,_ as j,r as H,c,o as l,A as r,E as O,D as v,C as h,aP as M,Q as D,L as N,a as p,F as P,J as I,K as S,f as z,a2 as B,M as L,P as q,R}from"./index-v7Q387fb.js";import{c as x,u as V,F as U}from"./DocumentEntry-C9_2wlaq.js";import{P as T,C as K}from"./plus-CxaiSruo.js";import{A as J}from"./document.mutations-ChjOFWEu.js";import"./document.queries-B_ZcQjnK.js";import"./_isIterateeCall-cQ3M92JU.js";import"./toFinite-OkJ8cEgS.js";const Q=x("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const Z=x("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);const G=x("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);const W=x("folder-plus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);const X=x("trash",[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),Y=E({__name:"FolderItem",props:{folder:{type:Object,required:!0},level:{type:Number,default:0}},emits:["add-subfolder"],setup(m,{expose:o,emit:n}){o();const e=m,u=n,d=V(),t=_(!1),s=k(()=>d.getChildFolders(e.folder.uid)),b=k(()=>d.currentFolder===e.folder.uid),y=k(()=>!!e.folder.expanded);function w(){d.setCurrentFolder(e.folder.uid)}function C(){d.toggleFolderExpanded(e.folder.uid)}function F(){const i=s.value.length>0,A=d.documents.some(g=>g.folderUid===e.folder.uid);i||A?window.confirm("Delete this folder and all its contents?")&&d.deleteFolder(e.folder.uid):d.deleteFolder(e.folder.uid),t.value=!1}const f={props:e,emit:u,store:d,isMenuOpen:t,childFolders:s,isActive:b,isExpanded:y,handleFolderClick:w,handleToggleExpand:C,handleDeleteFolder:F,vClickOutside:{mounted(i,A){i._clickOutside=g=>{i===g.target||i.contains(g.target)||A.value(g)},document.addEventListener("click",i._clickOutside)},unmounted(i){i._clickOutside&&document.removeEventListener("click",i._clickOutside)}},get Folder(){return U},get FolderOpen(){return G},get ChevronRight(){return Q},get ChevronDown(){return K},get Plus(){return T},get MoreHorizontal(){return Z},get Trash(){return X}};return Object.defineProperty(f,"__isScriptSetup",{enumerable:!1,value:!0}),f}}),$=["aria-expanded","aria-label"],ee=["aria-label"],oe={key:1,class:"w-4"},re={class:"mr-2 text-muted-foreground"},te={class:"flex items-center opacity-0 group-hover:opacity-100 transition-opacity duration-200"},ne=["aria-label"],de={class:"relative"},le=["aria-label","aria-expanded","aria-controls"],ie={key:0,id:"folder-menu",class:"absolute right-0 mt-1 w-48 rounded-md border border-border bg-card p-1 text-card-foreground shadow-md z-10",role:"menu","aria-orientation":"vertical","aria-labelledby":"folder-menu-button"},ae=["aria-label"];function se(m,o,n,e,u,d){const t=H("FolderItem",!0);return l(),c("div",null,[r("div",{class:D(["flex justify-start items-center p-2 rounded-md cursor-pointer group transition-colors duration-200",n.level>0&&"ml-2",e.isActive&&"bg-accent text-accent-foreground",!e.isActive&&"hover:bg-accent/50"]),onClick:e.handleFolderClick,role:"button","aria-expanded":e.isExpanded,"aria-label":`${n.folder.name} folder${e.childFolders.length>0?` with ${e.childFolders.length} subfolders`:""}`},[r("div",{class:"flex items-center mr-2",onClick:v(e.handleToggleExpand,["stop"]),role:"button","aria-label":`${e.isExpanded?"Collapse":"Expand"} ${n.folder.name} folder`},[e.childFolders.length>0?(l(),h(M(e.childFolders.length>0?e.isExpanded?e.ChevronDown:e.ChevronRight:"div"),{key:0,class:"w-4 h-4 text-muted-foreground","aria-hidden":"true"})):(l(),c("div",oe))],8,ee),r("div",re,[(l(),h(M(e.isExpanded?e.FolderOpen:e.Folder),{class:D(["w-[18px] h-[18px]",e.isActive&&"text-accent-foreground"]),"aria-hidden":"true"},null,8,["class"]))]),r("div",{class:D(["flex-1 truncate",e.isActive&&"text-accent-foreground"])},N(n.folder.name),3),r("div",te,[r("button",{onClick:o[0]||(o[0]=v(s=>m.$emit("add-subfolder",n.folder.uid),["stop"])),class:"h-7 w-7 flex items-center justify-center rounded-full hover:bg-accent/80 transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","aria-label":`Add subfolder to ${n.folder.name}`},[p(e.Plus,{class:"text-muted-foreground w-4 h-4","aria-hidden":"true"})],8,ne),r("div",de,[r("button",{onClick:o[1]||(o[1]=v(s=>e.isMenuOpen=!e.isMenuOpen,["stop"])),class:"h-7 w-7 flex items-center justify-center rounded-full hover:bg-accent/80 transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","aria-label":`Open menu for ${n.folder.name}`,"aria-expanded":e.isMenuOpen,"aria-controls":e.isMenuOpen?"folder-menu":void 0},[p(e.MoreHorizontal,{class:"text-muted-foreground w-4 h-4","aria-hidden":"true"})],8,le),e.isMenuOpen?P((l(),c("div",ie,[r("button",{onClick:v(e.handleDeleteFolder,["stop"]),class:"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground text-destructive w-full text-left hover:bg-accent/80",role:"menuitem"},[p(e.Trash,{class:"mr-2 w-4 h-4","aria-hidden":"true"}),o[3]||(o[3]=r("span",null,"Delete Folder",-1))])])),[[e.vClickOutside,()=>e.isMenuOpen=!1]]):O("",!0)])])],10,$),e.isExpanded&&e.childFolders.length>0?(l(),c("div",{key:0,class:"mt-1 ml-1 pl-1 border-l border-border",role:"group","aria-label":`Subfolders of ${n.folder.name}`},[(l(!0),c(I,null,S(e.childFolders,s=>(l(),h(t,{key:s.uid,folder:s,level:n.level+1,onAddSubfolder:o[2]||(o[2]=b=>m.$emit("add-subfolder",b))},null,8,["folder","level"]))),128))],8,ae)):O("",!0)])}const ce=j(Y,[["render",se],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/components/document/FolderItem.vue"]]),ue=E({__name:"FolderNavigation",setup(m,{expose:o}){o();const{withClientMutation:n}=z(),e=V(),u=_(!1),d=_(""),t=_(null),s=k(()=>e.getChildFolders(null));function b(a){t.value=a,u.value=!0}function y(){u.value=!1,d.value="",t.value=null}async function w(){if(d.value.trim())try{const a=await n(J,{payload:{name:d.value.trim(),parentUid:t.value}},"createDocumentFolder");if(a&&"uid"in a&&(e.addFolder(a),t.value)){const f=e.folders.find(i=>i.uid===t.value);f&&!f.expanded&&e.toggleFolderExpanded(t.value)}}catch(a){console.error("Failed to create folder:",a)}finally{y()}}function C(a){return e.folders.find(f=>f.uid===a)}const F={withClientMutation:n,store:e,isAddFolderOpen:u,folderName:d,parentFolderId:t,rootFolders:s,openAddFolderDialog:b,closeAddFolderDialog:y,handleAddFolder:w,folderById:C,get Plus(){return T},get FolderPlus(){return W},FolderItem:ce};return Object.defineProperty(F,"__isScriptSetup",{enumerable:!1,value:!0}),F}}),fe={class:"h-full overflow-hidden flex flex-col bg-card border border-border rounded-lg",role:"navigation","aria-label":"Folder navigation"},me={class:"p-4 flex items-center justify-between border-b border-border"},be={class:"flex-1 overflow-auto p-2"},ge={class:"space-y-1"},ve={key:0,class:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center",role:"dialog","aria-labelledby":"add-folder-title","aria-modal":"true"},he={id:"add-folder-title",class:"text-lg font-medium text-card-foreground mb-4"},pe={class:"mb-4"},xe={class:"flex justify-end gap-2"},ye=["disabled"];function Fe(m,o,n,e,u,d){return l(),c("div",fe,[r("div",me,[o[3]||(o[3]=r("h2",{class:"font-semibold text-sm text-card-foreground"},"Folders",-1)),r("button",{onClick:o[0]||(o[0]=t=>e.openAddFolderDialog(null)),class:"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none hover:bg-accent hover:text-accent-foreground h-8 w-8","aria-label":"Add new folder"},[p(e.Plus,{class:"w-4 h-4","aria-hidden":"true"})])]),r("div",be,[r("div",ge,[(l(!0),c(I,null,S(e.rootFolders,t=>(l(),h(e.FolderItem,{key:t.uid,folder:t,onAddSubfolder:e.openAddFolderDialog},null,8,["folder"]))),128))])]),(l(),h(R,{to:"body"},[e.isAddFolderOpen?(l(),c("div",ve,[r("div",{class:"bg-card rounded-lg shadow-lg p-6 max-w-md w-full mx-4 border border-border",onClick:o[2]||(o[2]=v(()=>{},["stop"]))},[r("h3",he,N(e.parentFolderId?`Add subfolder to ${e.folderById(e.parentFolderId)?.name}`:"Add new folder"),1),r("div",pe,[o[4]||(o[4]=r("label",{for:"folderName",class:"block text-sm font-medium text-card-foreground mb-1"},"Folder Name",-1)),P(r("input",{id:"folderName","onUpdate:modelValue":o[1]||(o[1]=t=>e.folderName=t),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:"Enter folder name",onKeyup:L(e.handleAddFolder,["enter"]),"aria-required":"true"},null,544),[[B,e.folderName]])]),r("div",xe,[r("button",{onClick:e.closeAddFolderDialog,class:"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Cancel "),r("button",{onClick:e.handleAddFolder,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2",disabled:!e.folderName.trim()},[p(e.FolderPlus,{class:"w-4 h-4 mr-2","aria-hidden":"true"}),o[5]||(o[5]=q(" Add Folder ",-1))],8,ye)])])])):O("",!0)]))])}const Me=j(ue,[["render",Fe],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/components/document/FolderNavigation.vue"]]);export{Me as default};
