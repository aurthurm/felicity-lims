import{d as N,bk as P,s as z,x as G,y as W,V as J,r as K,m as Q,o as u,c as m,b as e,f as i,g as w,F as U,E as X,t as y,A as Y,B as A,e as x,I as L,i as _,v as D,at as Z,w as ee,D as oe,j as E,_ as S,M as se,G as te,H as ie,k as de}from"./index-53659ec0.js";import{g as ae,h as le}from"./billing.mutations-192c755c.js";import{c as ne,a as p,d as re,g as ue,u as ce,b as c}from"./array-acbc0ce2.js";const l=h=>(te("data-v-8e7b96f9"),h=h(),ie(),h),he={class:"mt-4"},me={key:0},_e={key:1},pe=l(()=>e("h4",{class:"text-gray-800 text-l font-semibold"},"Voucher Codes",-1)),ve=l(()=>e("hr",null,null,-1)),fe={class:"grid grid-cols-5 gap-2 mt-2"},be={class:"font-semibold text-gray-800 flex justify-between items-center"},ge={class:"text-sm text-gray-500 flex-grow text-right"},ye=["onClick"],xe=l(()=>e("h3",null,"Voucher Code Form",-1)),Ce={class:"grid grid-cols-2 gap-x-4 mb-4"},Ve={class:"block col-span-1 mb-2"},ke=l(()=>e("span",{class:"text-gray-700"},"Voucher Code",-1)),we={class:"block col-span-1 mb-2"},Ue=l(()=>e("span",{class:"text-gray-700"},"Usage Limit",-1)),Ae={class:"grid grid-cols-2 gap-x-4 mb-4"},Le={class:"block col-span-1 mb-2"},De=l(()=>e("span",{class:"text-gray-700"},"Is Active",-1)),Ee=l(()=>e("hr",null,null,-1)),Se=N({__name:"VoucherCodes",props:{voucherUid:String},setup(h){const I=E(()=>S(()=>import("./FelLoadingMessage-95452cc5.js"),["assets/FelLoadingMessage-95452cc5.js","assets/index-53659ec0.js","assets/index-5e1ff226.css"])),F=E(()=>S(()=>import("./FelModal-48146e4b.js"),["assets/FelModal-48146e4b.js","assets/index-53659ec0.js","assets/index-5e1ff226.css","assets/FelModal-780aeea9.css"])),n=h,{withClientMutation:C}=se();let r=P();const{fetchingVoucherCodes:M}=z(r),R=G(()=>{const o=r.getVouchers,s=o?.findIndex(g=>g.uid===n.voucherUid);return s>-1?o[s]?.codes:[]});W(()=>r.fetchVoucherCodes(n.voucherUid)),J(()=>n.voucherUid,o=>{r.fetchVoucherCodes(n.voucherUid)});let a=K(!1);const B=ne({uid:p().nullable(),voucherUid:p().required(),code:p().required("Code is Required"),usageLimit:re().required("Usage Limit is Required"),used:p().nullable(),isActive:ue().default(!0)}),{handleSubmit:O,errors:V,setFieldValue:d}=ce({validationSchema:B,initialValues:{isActive:!0,voucherUid:n.voucherUid}}),{value:q}=c("uid");c("voucherUid");const{value:v}=c("code"),{value:f}=c("usageLimit");c("used");const{value:b}=c("isActive"),k=O(o=>{o.uid||j(o),o.uid&&H(o)});let T=o=>{d("uid",o.uid),d("code",o.code),d("usageLimit",o.usageLimit),d("used",o.used),d("isActive",o.isActive),a.value=!0};const $=()=>{d("uid",void 0),d("voucherUid",n.voucherUid),d("code",void 0),d("usageLimit",void 0),d("used",void 0),d("isActive",!0),a.value=!0},j=o=>{delete o.uid,C(ae,{payload:o},"createVoucherCode").then(s=>r.addVoucherCode(s)).finally(()=>a.value=!1)},H=o=>{delete o.uid,delete o.used,C(le,{uid:q?.value,payload:o},"updateVoucherCode").then(s=>r.updateVoucherCode(s)).finally(()=>a.value=!1)};return(o,s)=>{const g=Q("font-awesome-icon");return u(),m(U,null,[e("div",he,[i(M)?(u(),m("div",me,[w(i(I),{message:"Fetching voucher codes ..."})])):(u(),m("section",_e,[e("div",{class:"flex justify-between"},[pe,e("button",{class:"px-4 my-2 p-1 text-sm border-sky-800 border text-dark-700 transition-colors duration-150 rounded-sm focus:outline-none hover:bg-sky-800 hover:text-gray-100",onClick:$}," Add Voucher Code ")]),ve,e("div",fe,[(u(!0),m(U,null,X(R.value,t=>(u(),m("div",{key:t.uid,class:"col-span-1 bg-white rounded-sm shadow-sm hover:shadow-md duration-500 px-2 py-2"},[e("div",be,[e("h5",null,y(t.code),1),e("div",ge,y(t.used)+" of "+y(t.usageLimit),1),e("a",{class:"ml-2 pl-2 text-gray-400 border-l-2 border-l-gray-400",onClick:Ie=>i(T)(t)},[w(g,{class:"text-xs hover:text-gray-800",icon:"pen"})],8,ye)])]))),128))])]))]),i(a)?(u(),Y(i(F),{key:0,onClose:s[4]||(s[4]=t=>_(a)?a.value=!1:a=!1),contentWidth:"w-3/6"},{header:A(()=>[xe]),body:A(()=>[e("form",null,[e("div",Ce,[e("label",Ve,[ke,x(e("input",{class:L(["form-input mt-1 block w-full",{"border-red-500 animate-pulse":i(V).code}]),type:"text","onUpdate:modelValue":s[0]||(s[0]=t=>_(v)?v.value=t:null),placeholder:"Code ..."},null,2),[[D,i(v)]])]),e("label",we,[Ue,x(e("input",{class:L(["form-input mt-1 block w-full",{"border-red-500 animate-pulse":i(V).usageLimit}]),type:"number",min:"1","onUpdate:modelValue":s[1]||(s[1]=t=>_(f)?f.value=t:null)},null,2),[[D,i(f)]])])]),e("div",Ae,[e("label",Le,[De,x(e("input",{class:"form-checkbox ml-4",type:"checkbox","onUpdate:modelValue":s[2]||(s[2]=t=>_(b)?b.value=t:null),checked:""},null,512),[[Z,i(b)]])])]),Ee,e("button",{type:"submit",class:"-mb-4 border border-sky-800 bg-sky-800 text-white rounded-sm px-2 py-1 mt-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline",onClick:s[3]||(s[3]=ee((...t)=>i(k)&&i(k)(...t),["prevent"]))}," Save Voucher ")])]),_:1})):oe("",!0)],64)}}});const Be=de(Se,[["__scopeId","data-v-8e7b96f9"],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/admin/billing/VoucherCodes.vue"]]);export{Be as default};
