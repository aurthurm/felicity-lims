import{V as T,f as q,a8 as B,i as C,a1 as u,X as D,r as V,o as c,c as d,O as y,a as m,a6 as o,ae as x,F as A,N as F,H as M,$ as b,am as k,a0 as w,_ as N}from"./index-74595aff.js";import{u as O}from"./analysis-7c37619c.js";const j={class:"min-h-[500px]"},U={class:"flex justify-between"},I={class:"flex justify-start items-center gap-x-2"},z=T({__name:"QualityCharts",setup(G){const S=b(()=>w(()=>import("./vue-multiselect.esm-b1f61583.js"),["assets/vue-multiselect.esm-b1f61583.js","assets/index-74595aff.js","assets/index-8412b2a5.css"])),L=b(()=>w(()=>import("./ChartLJ-8073aec6.js"),["assets/ChartLJ-8073aec6.js","assets/index-74595aff.js","assets/index-8412b2a5.css","assets/index-60bba1e7.js","assets/value-c2034ca5.js","assets/string-6dabfbe0.js"])),h=O(),{withClientQuery:v}=q();B(()=>{h.fetchAnalysesServices({})});const g=C(()=>h.getAnalysesServicesSimple),i=u([]),f=new Date;let l=u({month:f.getMonth(),year:f.getFullYear()}),r=u(null);const p=u(!1),P=async a=>{if(!l.value)return;const e={analyses:[a.uid],month:l.value.month+1,year:l.value.year};await v(k,e,"qcChartData").then(t=>{i.value=t??[]}).finally(()=>p.value=!1)},E=async a=>{if(!r.value)return;const e={analyses:[r.value?.uid],month:a.month+1,year:a.year};await v(k,e,"qcChartData").then(t=>{i.value=t??[]}).finally(()=>p.value=!1)},_=C(()=>i.value?R(Q(i.value)):[]);function Q(a){return a.reduce((e,t)=>{const n=t.sample.qcLevel.level;return e[n]||(e[n]={results:[],dates:[]}),e[n].results.push(parseFloat(t.result)),e[n].dates.push(t.dateVerified),e},{})}function R(a){return Object.entries(a).map(([e,t])=>({name:e,data:t.results.map((n,s)=>({date:t.dates[s],value:n}))}))}return D(r,async a=>{a&&await P(a)}),D(l,async a=>{a&&await E(a)}),(a,e)=>{const t=V("fel-heading"),n=V("VueDatePicker");return c(),d("div",j,[y("div",U,[m(t,{title:"Analyses Service Control Charts"}),y("div",I,[m(n,{class:"z-60 disabled:bg-muted",modelValue:o(l),"onUpdate:modelValue":e[0]||(e[0]=s=>x(l)?l.value=s:l=s),"max-date":o(f),"month-picker":""},null,8,["modelValue","max-date"]),m(o(S),{class:"max-w-[300px]",modelValue:o(r),"onUpdate:modelValue":e[1]||(e[1]=s=>x(r)?r.value=s:r=s),options:g.value,multiple:!1,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","options"])])]),e[2]||(e[2]=y("hr",{class:"my-4"},null,-1)),_.value?.length==0?(c(),d(A,{key:0},[F(" The selected analysis has no data for the selected period. ")],64)):(c(!0),d(A,{key:1},M(_.value,s=>(c(),d("div",{class:"mb-4",key:s.name},[m(o(L),{title:s.name,series:s.data},null,8,["title","series"])]))),128))])}}}),X=N(z,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/qcontrol/QualityCharts.vue"]]);export{X as default};
