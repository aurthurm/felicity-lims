import{a0 as J,f as Q,a4 as j,ad as G,h as T,a7 as c,aK as W,aH as X,i as Y,_ as Z,r as h,c as f,o as d,A as e,C as $,E as ee,a as V,N as g,P as te,J as x,K as A,L as i,D as oe,F as _,a2 as D,a9 as se}from"./index-DApeomWQ.js";import{u as ne}from"./user-B9RFIqrA.js";import{u as re}from"./setup-HNpvekU2.js";import{c as ae,a as w,u as ie,b as M}from"./index.esm-Cx9agkcQ.js";const le=J({__name:"LaboratoryListing",setup(E,{expose:t}){t();const{toastSuccess:L,toastError:s}=Y(),{withClientQuery:U,withClientMutation:m}=Q(),p=j(),l=ne(),a=re();G(()=>{a.fetchOrganization(),l.fetchUsers({}),a.fetchLaboratories()});const o=T(()=>l.getUsers),k=T(()=>a.getLaboratories),B=n=>{if(n.labManagerUid){const r=l.getUsers?.filter(I=>I.uid==n.labManagerUid);if(r?.length>0)return`${r[0]?.firstName} ${r[0]?.lastName}`}return"No Manager Assigned"};let b=c(!1),v=c("");const y=c(!0),u=c(null),N=ae({name:w().required("Laboratory name is required"),labManagerUid:w().nullable(),businessPhone:w().nullable()}),{handleSubmit:S,errors:z,resetForm:P,setValues:C}=ie({validationSchema:N,initialValues:{name:"",labManagerUid:null,businessPhone:""}}),{value:O}=M("name"),{value:q}=M("labManagerUid"),{value:K}=M("businessPhone");function R(n,r){y.value=n,b.value=!0,v.value=(n?"CREATE":"EDIT")+" Laboratory",n?(u.value=null,P({values:{name:"",labManagerUid:null,businessPhone:""}})):(u.value=r?.uid??null,C({name:r?.name??"",labManagerUid:r?.labManagerUid??null,businessPhone:r?.businessPhone??""}))}const H=S(n=>{if(y.value===!0)m(W,{payload:{...n,organizationUid:a.getOrganization?.uid}},"createLaboratory").then(r=>a.addLaboratory(r));else{if(!u.value)return;m(X,{uid:u.value,payload:n},"updateLaboratory").then(r=>a.updateLaboratory(r,!0))}b.value=!1}),F={toastSuccess:L,toastError:s,withClientQuery:U,withClientMutation:m,router:p,userStore:l,setupStore:a,users:o,laboratories:k,getManagerName:B,get showModal(){return b},set showModal(n){b=n},get formTitle(){return v},set formTitle(n){v=n},formAction:y,currentUid:u,formSchema:N,handleSubmit:S,errors:z,resetForm:P,setValues:C,name:O,labManagerUid:q,businessPhone:K,FormManager:R,saveForm:H};return Object.defineProperty(F,"__isScriptSetup",{enumerable:!1,value:!0}),F}}),de={class:"space-y-6"},ue={class:"shadow-sm rounded-lg bg-card p-6"},fe={class:"overflow-x-auto"},me={class:"min-w-full divide-y divide-border fel-table"},be={class:"divide-y divide-border bg-background"},ce={class:"whitespace-nowrap text-sm text-foreground"},ge={class:"whitespace-nowrap text-sm text-foreground"},pe={class:"whitespace-nowrap text-sm text-foreground"},ve={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6"},ye=["onClick"],he={class:"text-lg font-semibold text-foreground"},xe={class:"space-y-2"},_e={class:"text-sm text-destructive"},we={class:"space-y-2"},Me=["value"],Le={class:"space-y-2"};function Ue(E,t,L,s,U,m){const p=h("fel-button"),l=h("fel-heading"),a=h("fel-modal");return d(),f(x,null,[e("div",de,[V(l,{title:"Laboratories",description:"Manage your laboratories and their details."},{default:g(()=>[V(p,{onClick:t[0]||(t[0]=o=>s.FormManager(!0,null))},{default:g(()=>[...t[6]||(t[6]=[te("Add Laboratory",-1)])]),_:1})]),_:1}),e("div",ue,[e("div",fe,[e("table",me,[t[7]||(t[7]=e("thead",null,[e("tr",null,[e("th",{class:"text-left text-sm font-semibold text-foreground"},"Name"),e("th",{class:"text-left text-sm font-semibold text-foreground"},"Manager"),e("th",{class:"text-left text-sm font-semibold text-foreground"},"Contact Phone"),e("th",{class:"relative py-3.5 pl-3 pr-4 sm:pr-6"},[e("span",{class:"sr-only"},"Actions")])])],-1)),e("tbody",be,[(d(!0),f(x,null,A(s.laboratories,o=>(d(),f("tr",{key:o?.uid,class:"hover:bg-muted/50"},[e("td",ce,i(o?.name),1),e("td",ge,i(s.getManagerName(o)),1),e("td",pe,i(o?.businessPhone),1),e("td",ve,[e("button",{onClick:k=>s.FormManager(!1,o),class:"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 px-4 py-2"}," Edit ",8,ye)])]))),128))])])])])]),s.showModal?(d(),$(a,{key:0,onClose:t[5]||(t[5]=o=>s.showModal=!1)},{header:g(()=>[e("h3",he,i(s.formTitle),1)]),body:g(()=>[e("form",{class:"space-y-6",onSubmit:t[4]||(t[4]=oe((...o)=>s.saveForm&&s.saveForm(...o),["prevent"]))},[e("div",xe,[t[8]||(t[8]=e("label",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"}," Laboratory Name ",-1)),_(e("input",{class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","onUpdate:modelValue":t[1]||(t[1]=o=>s.name=o),placeholder:"Name ..."},null,512),[[D,s.name]]),e("div",_e,i(s.errors.name),1)]),e("div",we,[t[10]||(t[10]=e("label",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"}," Lab Manager ",-1)),_(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.labManagerUid=o),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[t[9]||(t[9]=e("option",{value:""},"Select Manager",-1)),(d(!0),f(x,null,A(s.users,o=>(d(),f("option",{key:o?.uid,value:o.uid},i(o?.firstName)+" "+i(o?.lastName),9,Me))),128))],512),[[se,s.labManagerUid]])]),e("div",Le,[t[11]||(t[11]=e("label",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"}," Business Phone ",-1)),_(e("input",{class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","onUpdate:modelValue":t[3]||(t[3]=o=>s.businessPhone=o),placeholder:"Business Phone ..."},null,512),[[D,s.businessPhone]])]),t[12]||(t[12]=e("hr",{class:"border-border"},null,-1)),t[13]||(t[13]=e("button",{type:"submit",class:"inline-flex w-full items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"}," Save Form ",-1))],32)]),_:1})):ee("",!0)],64)}const Ce=Z(le,[["render",Ue],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/laboratory/LaboratoryListing.vue"]]);export{Ce as default};
