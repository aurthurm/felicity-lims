import{a0 as W,f as X,a7 as g,h as k,_ as Y,r as y,c as a,o as l,A as e,C as Z,E as p,a as M,N as x,P as j,J as C,K as F,L as i,D as $,F as T,a2 as S,a9 as ee}from"./index-Daoe3XS9.js";import{c as te,e as D,a as N,u as oe,b}from"./index.esm-BT7_X8h2.js";import{q as re,r as se}from"./analyses.mutations-DmiK7cfK.js";import{u as ne}from"./analysis-D7-3mDtD.js";const le=W({__name:"QCTemplates",setup(V,{expose:t}){t();const d=ne(),{withClientMutation:o}=X();let m=g(!1),f=g("");const c=g(!0),u=g(null),v=te({name:N().trim().required("Template name is required"),description:N().trim().nullable(),qcLevels:D().nullable(),departments:D().nullable()}),{handleSubmit:r,resetForm:_,setValues:w}=oe({validationSchema:v,initialValues:{name:"",description:"",qcLevels:[],departments:[]}}),{value:A,errorMessage:U}=b("name"),{value:B,errorMessage:P}=b("description"),{value:z,errorMessage:H}=b("qcLevels"),{value:I}=b("departments");d.fetchQCLevels(),d.fetchQCTemplates();const J=k(()=>d.getQCTemplates),K=k(()=>d.getQCLevels);function L(s){o(re,{payload:s},"createQcTemplate").then(n=>d.addQcTemplate(n))}function q(s){u.value&&o(se,{uid:u.value,payload:s},"updateQcTemplate").then(n=>d.updateQcTemplate(n))}function Q(s){if(s?.length<=0)return[];let n=[];return s?.forEach(h=>n.push(h.uid)),n}function O(s,n={}){c.value=s,m.value=!0,f.value=(s?"CREATE":"EDIT")+" QC Template",s?(u.value=null,_({values:{name:"",description:"",qcLevels:[],departments:[]}})):(u.value=n.uid??null,w({name:n.name??"",description:n.description??"",qcLevels:n.qcLevels??[],departments:n.departments??[]}))}function R(s){if(s?.length<=0)return"";let n=[];return s?.forEach(h=>n.push(h.level)),n.join(", ")}const G=r(s=>{const n={name:s.name,description:s.description??null,levels:Q(s.qcLevels??[]),departments:s.departments??[]};c.value===!0&&L(n),c.value===!1&&q(n),m.value=!1}),E={analysisStore:d,withClientMutation:o,get showModal(){return m},set showModal(s){m=s},get formTitle(){return f},set formTitle(s){f=s},formAction:c,currentUid:u,qcTemplateSchema:v,handleSubmit:r,resetForm:_,setValues:w,name:A,nameError:U,description:B,descriptionError:P,qcLevelsField:z,qcLevelsError:H,departments:I,qcTemplates:J,qcLevels:K,addQCTemplate:L,editQCTemplate:q,levelsUids:Q,FormManager:O,levelsNames:R,saveForm:G};return Object.defineProperty(E,"__isScriptSetup",{enumerable:!1,value:!0}),E}}),ae={class:"rounded-md border bg-card p-6 shadow-sm"},ie={class:"overflow-x-auto"},de={class:"w-full fel-table"},ue={class:"px-6 py-4 whitespace-nowrap border-b border-border"},ce={class:"font-medium text-foreground"},me={key:0,class:"text-sm text-muted-foreground"},pe={class:"px-6 py-4 whitespace-nowrap border-b border-border"},fe={class:"text-sm text-foreground"},ve={class:"px-6 py-4 whitespace-nowrap border-b border-border"},ge={class:"text-sm text-foreground"},xe={class:"px-6 py-4 whitespace-nowrap text-right border-b border-border"},be=["onClick"],_e={class:"text-xl font-semibold text-foreground"},he={class:"space-y-4"},ye={class:"space-y-2"},Ce={key:0,class:"text-sm text-destructive"},Te={class:"space-y-2"},we={key:0,class:"text-sm text-destructive"},Le={class:"space-y-2"},qe=["value"],Qe={key:0,class:"text-sm text-destructive"};function Ee(V,t,d,o,m,f){const c=y("fel-button"),u=y("fel-heading"),v=y("fel-modal");return l(),a(C,null,[e("div",null,[M(u,{title:"QC Templates"},{default:x(()=>[M(c,{onClick:t[0]||(t[0]=r=>o.FormManager(!0))},{default:x(()=>[...t[6]||(t[6]=[j("Add QC Template",-1)])]),_:1})]),_:1}),e("div",ae,[e("div",ie,[e("table",de,[t[7]||(t[7]=e("thead",null,[e("tr",{class:"border-b border-border bg-muted/50"},[e("th",{class:"px-6 py-3 text-left text-sm font-medium text-muted-foreground"},"QC Template Name"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-muted-foreground"},"Quality Control level(s)"),e("th",{class:"px-6 py-3 text-left text-sm font-medium text-muted-foreground"},"Department(s)"),e("th",{class:"px-6 py-3 text-right text-sm font-medium text-muted-foreground"},"Actions")])],-1)),e("tbody",null,[(l(!0),a(C,null,F(o.qcTemplates,r=>(l(),a("tr",{key:r?.uid,class:"hover:bg-accent/50 transition-colors duration-200"},[e("td",ue,[e("div",ce,i(r?.name),1),r?.description?(l(),a("div",me,i(r?.description),1)):p("",!0)]),e("td",pe,[e("div",fe,i(o.levelsNames(r?.qcLevels??[])),1)]),e("td",ve,[e("div",ge,i(r?.category),1)]),e("td",xe,[e("button",{onClick:_=>o.FormManager(!1,r),class:"inline-flex items-center px-3 py-1.5 border border-border bg-background text-foreground text-sm font-medium transition-colors duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-ring hover:bg-accent hover:text-accent-foreground"}," Edit ",8,be)])]))),128))])])])])]),o.showModal?(l(),Z(v,{key:0,onClose:t[5]||(t[5]=r=>o.showModal=!1)},{header:x(()=>[e("h3",_e,i(o.formTitle),1)]),body:x(()=>[e("form",{onSubmit:t[4]||(t[4]=$((...r)=>o.saveForm&&o.saveForm(...r),["prevent"])),class:"p-6 space-y-6"},[e("div",he,[e("div",ye,[t[8]||(t[8]=e("label",{for:"name",class:"text-sm font-medium text-muted-foreground"},"QC Template Name",-1)),T(e("input",{id:"name",class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring placeholder:text-muted-foreground","onUpdate:modelValue":t[1]||(t[1]=r=>o.name=r),placeholder:"Enter template name"},null,512),[[S,o.name]]),o.nameError?(l(),a("p",Ce,i(o.nameError),1)):p("",!0)]),e("div",Te,[t[9]||(t[9]=e("label",{for:"description",class:"text-sm font-medium text-muted-foreground"},"Description",-1)),T(e("textarea",{id:"description",class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring placeholder:text-muted-foreground resize-none","onUpdate:modelValue":t[2]||(t[2]=r=>o.description=r),placeholder:"Enter template description",rows:"3"},null,512),[[S,o.description]]),o.descriptionError?(l(),a("p",we,i(o.descriptionError),1)):p("",!0)]),e("div",Le,[t[11]||(t[11]=e("label",{for:"controlLevels",class:"text-sm font-medium text-muted-foreground"},"Quality Control Sample Levels",-1)),T(e("select",{name:"controlLevels",id:"controlLevels","onUpdate:modelValue":t[3]||(t[3]=r=>o.qcLevelsField=r),class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring",multiple:""},[t[10]||(t[10]=e("option",{disabled:"",value:""},"Select QC Levels",-1)),(l(!0),a(C,null,F(o.qcLevels,r=>(l(),a("option",{key:r.uid,value:r,class:"py-1"},i(r.level),9,qe))),128))],512),[[ee,o.qcLevelsField]]),t[12]||(t[12]=e("p",{class:"text-xs text-muted-foreground mt-1"},"Hold Ctrl/Cmd to select multiple levels",-1)),o.qcLevelsError?(l(),a("p",Qe,i(o.qcLevelsError),1)):p("",!0)])]),t[13]||(t[13]=e("div",{class:"pt-4"},[e("button",{type:"submit",class:"w-full inline-flex items-center justify-center bg-primary text-primary-foreground hover:bg-primary/90 rounded-lg px-4 py-2.5 text-sm font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"}," Save Changes ")],-1))],32)]),_:1})):p("",!0)],64)}const De=Y(le,[["render",Ee],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/analyses/QCTemplates.vue"]]);export{De as default};
