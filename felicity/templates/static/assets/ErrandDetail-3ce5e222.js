import{S as ye,a0 as i,a7 as xe,a6 as he,i as G,f as _e,V as ke,r as R,a5 as o,o as d,c as m,K as n,N as t,a as l,H as p,C as F,X as De,J as we,aS as Ue,y as Ve,D as Ce,aQ as Ee,a3 as E,L as j,Z as S,aT as Se,$ as T,_ as Te}from"./index-628f1f8f.js";import{p as K,f as B}from"./index-1c874f2e.js";import{d as Be,e as Me,f as Ae,g as He,h as Pe}from"./grind.queries-fdab5e7e.js";import{S as Q}from"./schema-378e3777.js";import{C as $e,A as Le,a as Ye,b as Ie,B as Ne,c as Ge,E as Re,H as Fe,I as je,d as Ke,e as Qe,L as Oe,P as ze,S as Je,T as We,f as Xe,U as Ze,g as qe}from"./index-1c872656.js";import g from"./vue-multiselect.esm-c818a0fb.js";import{U as et}from"./_queries-ce4032f2.js";import{r as tt}from"./ArrowLeftIcon-9d367942.js";import"./_baseForOwn-722c92e8.js";import"./merge-7b43ed1c.js";import"./_isIterateeCall-a5b9a491.js";import"./isArray-513c67aa.js";import"./mapValues-d21c088f.js";import"./isString-0ed7bec4.js";import"./clone-4446d02a.js";import"./_baseSet-dfdad323.js";const ot={key:0,class:"bg-background rounded-lg shadow-sm border border-border"},st={class:"flex flex-col md:flex-row"},rt={class:"flex-1 p-6 border-r border-border"},at={class:"space-y-6 pb-6 border-b border-border"},nt={class:"flex justify-between items-center"},it={class:"relative w-full"},lt={class:"flex items-center space-x-2 text-sm text-muted-foreground"},dt={class:"h-8 w-8 rounded-full bg-muted flex items-center justify-center text-destructive font-medium"},ut={class:"font-medium text-foreground"},ct=["innerHTML"],mt={key:1,class:"space-y-4"},pt={class:"prose max-w-none"},ft={class:"editor-container editor-container_balloon-editor",ref:"editorContainerElement"},gt={class:"editor-container__editor"},bt={ref:"editorElement"},vt={class:"flex items-center space-x-3 mt-6"},yt={class:"flex-1 h-2 bg-muted rounded-full overflow-hidden"},xt={class:"text-sm font-medium text-muted-foreground"},ht={class:"border-b border-border mt-6"},_t={class:"flex space-x-1"},kt={class:"py-6"},Dt={key:0,class:"space-y-6"},wt={key:1,class:"space-y-6"},Ut={key:2,class:"space-y-6"},Vt={class:"w-full md:w-80 p-6 border-l border-border"},Ct={class:"space-y-8"},Et={class:"space-y-2"},St={class:"space-y-2"},Tt={class:"space-y-2"},Bt={class:"space-y-2"},Mt={class:"space-y-2"},At={class:"multiselect-tag bg-primary/10 text-primary px-2 py-1 rounded-md text-sm flex items-center space-x-1 hover:bg-primary/20 transition-colors duration-200"},Ht=["onClick"],Pt={class:"space-y-2"},$t={class:"space-y-2"},Lt={class:"multiselect-tag bg-primary/10 text-primary px-2 py-1 rounded-md text-sm flex items-center space-x-1 hover:bg-primary/20 transition-colors duration-200"},Yt=["onClick"],It=ye({__name:"ErrandDetail",setup(Nt){const O=S(()=>T(()=>import("./CommentSystem-d869a9fc.js"),["assets/CommentSystem-d869a9fc.js","assets/index-628f1f8f.js","assets/index-f2df9813.css","assets/grind.queries-fdab5e7e.js"])),z=S(()=>T(()=>import("./ErrandFile-c69b276d.js"),["assets/ErrandFile-c69b276d.js","assets/index-628f1f8f.js","assets/index-f2df9813.css","assets/grind.queries-fdab5e7e.js","assets/schema-378e3777.js","assets/ErrandFile-0009cac1.css"])),J=S(()=>T(()=>import("./ErrandMilestone-2701be2a.js"),["assets/ErrandMilestone-2701be2a.js","assets/index-628f1f8f.js","assets/index-f2df9813.css","assets/_queries-ce4032f2.js","assets/grind.queries-fdab5e7e.js","assets/index-7fc73f2d.js","assets/vue-multiselect.esm-c818a0fb.js","assets/ErrandMilestone-d56b378c.css"])),M=i(!1),A=i(null),W=i($e);function X(){A.value={toolbar:{items:["undo","redo","|","heading","|","bold","italic","underline","|","link","insertTable","blockQuote","|","bulletedList","numberedList","todoList","outdent","indent"],shouldNotGroupWhenFull:!1},plugins:[Le,Ye,Ie,Ne,Ge,Re,Fe,je,Ke,Qe,Oe,ze,Je,We,Xe,Ze,qe],heading:{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h1",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h2",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h3",title:"Heading 3",class:"ck-heading_heading3"},{model:"heading4",view:"h4",title:"Heading 4",class:"ck-heading_heading4"},{model:"heading5",view:"h5",title:"Heading 5",class:"ck-heading_heading5"},{model:"heading6",view:"h6",title:"Heading 6",class:"ck-heading_heading6"}]},placeholder:"Begin typing..."},M.value=!0}xe(()=>{X(),h(),ae(),ie(),pe()});const u=i("discussions"),H=he(),P=G(()=>H.params.errandUid),Z=G(()=>H.params.boardUid);let s=i();const{withClientQuery:v,withClientMutation:$}=_e();function h(){v(Be,{uid:P.value},"grindErrandByUid").then(r=>{s.value=r;const e=K(s.value.startDate,!0)??new Date,f=K(s.value.endDate,!0)??new Date(new Date().setDate(e.getDate()+7));D.value=[e,f]})}function c(r){$(Pe,{uid:P.value,payload:r},"updateGrindErrand").then(()=>h())}const _=i(!1),k=i(null),q=()=>{_.value=!0,Se(()=>{k.value?.focus(),k.value?.select()})},L=()=>{_.value=!1,c({title:s.value?.title})},y=i(!1),Y=i(""),ee=()=>{y.value=!0,Y.value=s.value?.description??""},te=()=>{y.value=!1,c({description:s.value?.description})},oe=()=>{s.value.description=Y.value,y.value=!1},D=i(),se=r=>{const e=r[0]?.getDate(),f=r[0]?.getMonth()+1,V=r[0]?.getFullYear(),a=r[1]?.getDate(),b=r[1]?.getMonth()+1,C=r[1]?.getFullYear();return`${e}/${f}/${V} - ${a}/${b}/${C}`},re=r=>{if(r.length!==2){alert("Invalid date range");return}c({startDate:B(r[0],"YYYY-MM-DD HH:mm"),endDate:B(r[1],"YYYY-MM-DD HH:mm")})},I=i([]);function ae(){v(Me,{boardUid:Z.value},"grindPostersByBoard").then(r=>{I.value=r.filter(e=>e.uid!==s.value?.posterUid)})}function ne(r){c({posterUid:r.uid})}const x=i();function ie(){v(et,{first:100},"userAll").then(r=>{x.value=r.items})}function w({firstName:r,lastName:e}){return`${r} ${e}`}function le(r){c({assigneeUid:r.uid})}function de(r){c({reporterUid:r.uid})}function ue(r){c({members:r.map(e=>e.uid)})}const ce=["Low","Normal","High","Critical"];function me(r){c({priority:r})}const U=i([]);function pe(){v(Ae,{category:Q.Project},"grindStampByCategory").then(r=>{U.value=r})}function N(r){c({stamps:r?.map(e=>e.uid)})}const fe=r=>{$(He,{payload:{title:r,category:Q.Project}},"createGrindStamp").then(e=>{if(e.uid){U.value.push(e);const f=s.value?.stamps??[];f.push(e),N(f)}})},ge=()=>h(),be=ke();function ve(){be.back()}return(r,e)=>{const f=R("ckeditor"),V=R("VueDatePicker");return o(s)?(d(),m("div",ot,[n(" Content area with sidebar "),t("div",st,[n(" Main content "),t("div",rt,[n(" Header "),t("div",at,[t("div",nt,[t("div",it,[t("button",{onClick:ve,class:"absolute -left-2 -top-2 p-1 text-muted-foreground hover:text-foreground transition-colors duration-200"},[l(o(tt),{class:"w-5 h-5"})]),_.value?F((d(),m("input",{key:1,type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>o(s).title=a),onBlur:L,onKeyup:we(L,["enter"]),ref_key:"titleInput",ref:k,class:"text-2xl font-semibold text-foreground w-full px-3 py-2 border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-background"},null,544)),[[De,o(s).title]]):(d(),m("h1",{key:0,onClick:q,class:"text-3xl font-bold text-foreground cursor-pointer hover:bg-muted rounded px-2 py-1 transition-colors duration-200"},p(o(s).title),1))])]),t("div",lt,[t("div",dt,p(o(Ue)(o(s).createdBy?.firstName,o(s).createdBy?.lastName)),1),e[12]||(e[12]=t("span",null,"by",-1)),t("span",ut,p(o(s).createdBy?.firstName)+" "+p(o(s).createdBy?.lastName),1),t("span",null,"on "+p(o(B)(o(s).createdAt,"D MMMM YYYY")),1)]),y.value?(d(),m("div",mt,[t("div",pt,[t("div",ft,[t("div",gt,[t("div",bt,[M.value?(d(),Ve(f,{key:0,modelValue:o(s).description,"onUpdate:modelValue":e[1]||(e[1]=a=>o(s).description=a),editor:W.value,config:A.value,"tag-name":"textarea",class:"ck-editor"},null,8,["modelValue","editor","config"])):n("v-if",!0)],512)])],512)]),t("div",{class:"flex space-x-3"},[t("button",{onClick:te,class:"px-4 py-2 text-sm font-medium text-primary-foreground bg-primary border border-transparent rounded-md shadow-sm hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors duration-200"}," Save "),t("button",{onClick:oe,class:"px-4 py-2 text-sm font-medium text-foreground bg-background border border-border rounded-md shadow-sm hover:bg-muted focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors duration-200"}," Cancel ")])])):(d(),m("div",{key:0,class:"prose max-w-none",onClick:ee},[o(s).description?(d(),m("article",{key:0,class:"text-lg text-foreground",innerHTML:o(s).description},null,8,ct)):n("v-if",!0)]))]),n(" Progress Bar "),F(t("div",vt,[t("div",yt,[t("div",{class:"h-full bg-success rounded-full transition-all duration-300",style:Ee(`width: ${o(s)?.milestonesAt}%`)},null,4)]),t("span",xt,p(o(s)?.milestonesAt)+"%",1)],512),[[Ce,o(s)?.milestonesAt]]),n(" Tabs "),t("div",ht,[t("div",_t,[t("button",{onClick:e[2]||(e[2]=a=>u.value="discussions"),class:E(["py-3 px-4 text-sm font-medium border-b-2 transition-colors duration-200 focus:outline-none",u.value==="discussions"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"])}," Discussions ",2),t("button",{onClick:e[3]||(e[3]=a=>u.value="milestones"),class:E(["py-3 px-4 text-sm font-medium border-b-2 transition-colors duration-200 focus:outline-none",u.value==="milestones"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"])}," Milestones ",2),t("button",{onClick:e[4]||(e[4]=a=>u.value="files"),class:E(["py-3 px-4 text-sm font-medium border-b-2 transition-colors duration-200 focus:outline-none",u.value==="files"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"])}," Files ",2)])]),n(" Tab Content "),t("div",kt,[n(" Discussions Tab "),u.value==="discussions"?(d(),m("div",Dt,[l(o(O),{errandUid:o(s).uid},null,8,["errandUid"])])):n("v-if",!0),n(" Milestones Tab "),u.value==="milestones"?(d(),m("div",wt,[l(o(J),{errandUid:o(s).uid,onMilestoneUpdated:ge},null,8,["errandUid"])])):n("v-if",!0),n(" Files Tab "),u.value==="files"?(d(),m("div",Ut,[l(o(z),{errandUid:o(s).uid},null,8,["errandUid"])])):n("v-if",!0)])]),n(" Sidebar "),t("div",Vt,[t("div",Ct,[n(" Dates "),t("div",Et,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-foreground"},"Date Range",-1)),l(V,{class:"w-full",modelValue:D.value,"onUpdate:modelValue":[e[5]||(e[5]=a=>D.value=a),re],range:"",format:se},null,8,["modelValue"])]),n(" Status "),t("div",St,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-foreground"},"Status",-1)),l(o(g),{modelValue:o(s).poster,"onUpdate:modelValue":[e[6]||(e[6]=a=>o(s).poster=a),ne],options:I.value,label:"title","track-by":"uid",placeholder:"Select status",class:"multiselect-primary"},null,8,["modelValue","options"])]),n(" Assignee "),t("div",Tt,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-foreground"},"Assignee",-1)),l(o(g),{modelValue:o(s).assignee,"onUpdate:modelValue":[e[7]||(e[7]=a=>o(s).assignee=a),le],options:x.value,"track-by":"uid",searchable:!0,"custom-label":w,placeholder:"Select assignee",class:"multiselect-primary"},null,8,["modelValue","options"])]),n(" Reporter "),t("div",Bt,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-foreground"},"Reporter",-1)),l(o(g),{modelValue:o(s).reporter,"onUpdate:modelValue":[e[8]||(e[8]=a=>o(s).reporter=a),de],options:x.value,"track-by":"uid",searchable:!0,"custom-label":w,placeholder:"Select reporter",class:"multiselect-primary"},null,8,["modelValue","options"])]),n(" Team Members "),t("div",Mt,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-foreground"},"Team Members",-1)),l(o(g),{modelValue:o(s).members,"onUpdate:modelValue":[e[9]||(e[9]=a=>o(s).members=a),ue],options:x.value,multiple:!0,searchable:!0,"custom-label":w,"track-by":"uid",placeholder:"Select members",class:"multiselect-primary"},{tag:j(({option:a,remove:b})=>[t("div",At,[t("span",null,p(a.firstName)+" "+p(a.lastName),1),t("button",{onClick:C=>b(a),class:"text-primary hover:text-primary/80 focus:outline-none transition-colors duration-200"}," × ",8,Ht)])]),_:1},8,["modelValue","options"])]),n(" Priority "),t("div",Pt,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-foreground"},"Priority",-1)),l(o(g),{modelValue:o(s).priority,"onUpdate:modelValue":[e[10]||(e[10]=a=>o(s).priority=a),me],options:ce,searchable:!1,"show-labels":!1,placeholder:"Select priority",class:"multiselect-primary"},null,8,["modelValue"])]),n(" Tags "),t("div",$t,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-foreground"},"Tags",-1)),l(o(g),{modelValue:o(s).stamps,"onUpdate:modelValue":[e[11]||(e[11]=a=>o(s).stamps=a),N],options:U.value,multiple:!0,taggable:!0,searchable:!0,"track-by":"uid","show-labels":!1,placeholder:"Select or add tags",onTag:fe,"custom-label":({title:a})=>`${a}`,class:"multiselect-primary"},{tag:j(({option:a,remove:b})=>[t("div",Lt,[t("span",null,p(a.title),1),t("button",{onClick:C=>b(a),class:"text-primary hover:text-primary/80 focus:outline-none transition-colors duration-200"}," × ",8,Yt)])]),_:1},8,["modelValue","options","custom-label"])])])])])])):n("v-if",!0)}}});const so=Te(It,[["__scopeId","data-v-2d23bea1"],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/grind/_id/ErrandDetail.vue"]]);export{so as default};
