const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FelSwitch-DcZ9LTNs.js","assets/index-v7Q387fb.js","assets/index-c4lX_LAY.css"])))=>i.map(i=>d[i]);
import{a0 as Z,ae as i,f as $,h as I,a7 as f,g as ee,aD as se,aE as te,a1 as h,a6 as x,aF as oe,_ as re,r as ie,c,o as u,A as e,C as ne,E as y,J as E,K as O,L as m,N as L,D as ae,F as R,a2 as le,a9 as de}from"./index-v7Q387fb.js";import{c as ue,e as ce,a as V,u as me,b as B}from"./index.esm-D-THTBXR.js";import{u as pe}from"./user-COlWaJ-j.js";const fe=Z({__name:"Groups",setup(U,{expose:t}){t();const A=h(()=>x(()=>import("./FelSwitch-DcZ9LTNs.js"),__vite__mapDeps([0,1,2]))),r=h(()=>x(()=>import("./index-v7Q387fb.js").then(s=>s.cl),__vite__mapDeps([1,2]))),S=h(()=>x(()=>import("./index-v7Q387fb.js").then(s=>s.co),__vite__mapDeps([1,2]))),G=[i.ADMINISTRATION,i.DASHBOARD,i.CLIENTS,i.PATIENTS,i.PATIENTS_COMPACT,i.SAMPLES,i.QC_SAMPLES,i.WORKSHEETS,i.NOTICE_MANAGER,i.BIO_BANKING,i.INVENTORY,i.REFERRAL,i.SCHEMES,i.DOCUMENT,i.BILLING];let l=pe();const{withClientMutation:o}=$();l.fetchGroupsAndPermissions();const T=I(()=>l.getGroups);let w=f("permissions");const j=["permissions"];let g=f(!1),_=f("");const b=f(!0);let v=ee({});const p=f(null),k=ue({name:V().trim().required("Group name is required"),pages:ce().of(V()).nullable()}),{handleSubmit:M,resetForm:C,setValues:N}=me({validationSchema:k,initialValues:{name:"",pages:[]}}),{value:H,errorMessage:K}=B("name"),{value:q,errorMessage:z}=B("pages");function Y(s){const n=s.pages;Object.assign(v,{...s,pages:n?.split(",")||[]}),F.value?.forEach(a=>{a[1].forEach(d=>{d.checked=!1,v.permissions?.some(X=>X?.uid==d?.uid||!1)&&(d.checked=!0)})})}function J(s,n={}){b.value=s,g.value=!0,_.value=(s?"CREATE":"EDIT")+" ANALYSES PROFILE",s?(p.value=null,C({values:{name:"",pages:[]}})):(p.value=n.uid??null,N({name:n.name??"",pages:n.pages??[]}))}const Q=M(s=>{const n={name:s.name,pages:(s.pages??[]).join(",")};if(b.value===!0&&o(se,{payload:n},"createGroup").then(a=>l.addGroup(a)),b.value===!1){if(!p.value)return;o(te,{uid:p.value,payload:{name:n.name,pages:n.pages}},"updateGroup").then(a=>l.updateGroup(a))}g.value=!1}),P=(s,n)=>s?.reduce(function(a,d){return(a[d[n]]=a[d[n]]||[]).push(d),a},{}),F=I(()=>Array.from(Object.entries(P(l.getPermissions,"target"))));function W(s,n){o(oe,{groupUid:s?.uid,permissionUid:n?.uid},"updateGroupPermissions").then(a=>l.updateGroupsAndPermissions(a))}const D={FelSwitch:A,modal:r,accordion:S,pages:G,get userStore(){return l},set userStore(s){l=s},withClientMutation:o,groups:T,get currentTab(){return w},set currentTab(s){w=s},tabs:j,get showModal(){return g},set showModal(s){g=s},get formTitle(){return _},set formTitle(s){_=s},formAction:b,get userGroup(){return v},set userGroup(s){v=s},currentUid:p,groupSchema:k,handleSubmit:M,resetForm:C,setValues:N,name:H,nameError:K,pagesField:q,pagesError:z,selectGroup:Y,FormManager:J,saveForm:Q,groupBy:P,permissions:F,updateGroupPerms:W};return Object.defineProperty(D,"__isScriptSetup",{enumerable:!1,value:!0}),D}}),ge={class:"space-y-6"},be={class:"flex items-center justify-between"},ve={class:"border border-border bg-card rounded-lg shadow-sm"},_e={class:"relative w-full overflow-auto"},he={class:"w-full caption-bottom text-sm"},xe={class:"[&_tr:last-child]:border-0"},ye={class:"px-4 py-2 align-middle"},Ee={class:"px-4 py-2 align-middle text-primary"},Ae={class:"px-4 py-2 align-middle text-right"},Se=["onClick"],Ge={class:"text-lg font-semibold text-foreground"},Te={class:"space-y-4"},we={class:"space-y-2"},ke={key:0,class:"text-sm text-destructive"},Me={class:"space-y-2"},Ce=["size"],Ne=["value"],Pe={key:0,class:"text-sm text-destructive"};function Fe(U,t,A,r,S,G){const l=ie("fel-modal");return u(),c(E,null,[e("div",ge,[e("div",be,[t[5]||(t[5]=e("h2",{class:"text-2xl font-semibold text-foreground"},"Groups",-1)),e("button",{onClick:t[0]||(t[0]=o=>r.FormManager(!0)),class:"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"}," Add Group ")]),e("div",ve,[e("div",_e,[e("table",he,[t[6]||(t[6]=e("thead",{class:"[&_tr]:border-b"},[e("tr",{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[e("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Group Name"),e("th",{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},"Access Pages"),e("th",{class:"h-12 px-4 text-right align-middle font-medium text-muted-foreground"},"Actions")])],-1)),e("tbody",xe,[(u(!0),c(E,null,O(r.groups,o=>(u(),c("tr",{key:o.uid,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},[e("td",ye,m(o.name),1),e("td",Ee,m(o.pages),1),e("td",Ae,[e("button",{onClick:T=>r.FormManager(!1,o),class:"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 px-3"}," Edit ",8,Se)])]))),128))])])])])]),r.showModal?(u(),ne(l,{key:0,onClose:t[4]||(t[4]=o=>r.showModal=!1)},{header:L(()=>[e("h3",Ge,m(r.formTitle),1)]),body:L(()=>[e("form",{onSubmit:t[3]||(t[3]=ae((...o)=>r.saveForm&&r.saveForm(...o),["prevent"])),class:"space-y-4"},[e("div",Te,[e("div",we,[t[7]||(t[7]=e("label",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"}," Group Name ",-1)),R(e("input",{"onUpdate:modelValue":t[1]||(t[1]=o=>r.name=o),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:"Enter group name..."},null,512),[[le,r.name]]),r.nameError?(u(),c("p",ke,m(r.nameError),1)):y("",!0)]),e("div",Me,[t[8]||(t[8]=e("label",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"}," Pages ",-1)),R(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>r.pagesField=o),multiple:"",size:r.pages.length,class:"flex w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[(u(),c(E,null,O(r.pages,o=>e("option",{key:o,value:o,class:"py-1"},m(o),9,Ne)),64))],8,Ce),[[de,r.pagesField]]),r.pagesError?(u(),c("p",Pe,m(r.pagesError),1)):y("",!0)])]),t[9]||(t[9]=e("div",{class:"flex justify-end"},[e("button",{type:"submit",class:"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"}," Save Changes ")],-1))],32)]),_:1})):y("",!0)],64)}const Le=re(fe,[["render",Fe],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/users/Groups.vue"]]);export{Le as default};
