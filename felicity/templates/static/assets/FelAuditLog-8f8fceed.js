import{d as F,ab as V,aL as j,aM as E,s as O,D as R,n as z,o as r,c as d,f as p,g as C,e as H,F as m,p as g,b as i,t as a,H as b,aH as l,j as M,_ as P,k as I}from"./index-e48f6898.js";const q={class:"relative mt-4"},G=i("div",{class:"border-r-2 border-gray-400 border-dotted absolute h-full top-0 z-0",style:{left:"7px"}},null,-1),J={key:0,class:"py-4 text-center"},K={key:1,initial:{opacity:0,y:100},enter:{opacity:1,y:0,scale:1},variants:{custom:{scale:2}},delay:200,class:"list-none m-0 p-0"},Q={class:"flex items-center mb-1"},W=i("div",{class:"bg-indigo-600 rounded-full h-4 w-4 border-gray-200 border-2 z-10"},null,-1),X={class:"ml-4 font-medium italic"},Y={class:"ml-12 w-100"},Z={class:"col-span-1"},$={class:"text-sm text-gray-600 italic"},v={class:"col-span-3"},k={class:"text-muted text-xs text-orange-600"},B={class:"text-muted text-xs text-sky-800"},A=F({__name:"FelAuditLog",props:{targetUid:String,targetType:String},setup(h){const x=M(()=>P(()=>import("./FelLoadingMessage-df6010ac.js"),["assets/FelLoadingMessage-df6010ac.js","assets/index-e48f6898.js","assets/index-7d22ceed.css"])),y=h,{targetType:L,targetUid:S}=V(y),f=j(),u=E();u.restLogs();const{auditLogs:D,fetchingAudits:U}=O(u);f.fetchUsers({}),u.fetchAuditLogs({targetType:L?.value,targetUid:S?.value});let w=R(()=>f.getUsers);function n(o){const c=w?.value?.find(_=>_.uid?.toString()===o?.toString());return c?c.userName:""}function T(o){return o===1?"created":o===2?"updated":o===3?"deleted":""}function N(o){let c=new Set;return Object.entries(o?.stateBefore)?.map(([_,e])=>{Object.entries(o?.stateAfter)?.map(([t,s])=>{_===t&&e!==s&&(t&&t==="updated_by_uid"&&(t="updated_by",e=n(e),s=n(s)),t&&t==="submitted_by_uid"&&(t="submitted_by",e=n(e),s=n(s)),t&&t==="verified_by_uid"&&(t="verified_by",e=n(e),s=n(s)),t&&t==="updated_at"&&(t="updated_on",e=l(e),s=l(s)),t&&t==="cancelled_by_uid"&&(t="cancelled_by",e=n(e),s=n(s)),t&&t==="received_by_uid"&&(t="received_by",e=n(e),s=n(s)),c.add({key:t,old:e?.length>0?e:"None",new:s?.toString()?.length>0?s:"None"}))})}),c}return(o,c)=>{const _=z("motion");return r(),d("div",q,[G,p(U)?(r(),d("div",J,[C(p(x),{message:"Fetching audit logs ..."})])):H((r(),d("ul",K,[(r(!0),d(m,null,g(p(D),e=>(r(),d("li",{key:e.uid,class:"mb-2"},[i("div",Q,[W,i("div",X,[i("span",null,a(n(e?.userUid))+" "+a(T(e?.action))+" "+a(e?.targetType),1),b(" on "),i("span",null,a(p(l)(e?.stateAfter?.updated_at)),1)])]),i("div",Y,[(r(!0),d(m,null,g(N(e),t=>(r(),d("div",{key:t.key,class:"grid grid-cols-4"},[i("span",Z,[i("span",$,a(t?.key),1)]),i("span",v,[i("span",k,a(t?.old),1),b(" â†’ "),i("span",B,a(t?.new),1)])]))),128))])]))),128))])),[[_]])])}}}),et=I(A,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/audit/FelAuditLog.vue"]]);export{et as default};
