import{a0 as Z,u as $,ac as ee,a4 as te,g as se,as as oe,a5 as L,h as u,_ as ae,r as S,aa as ne,c as p,o as c,A as e,F as i,a as v,C as re,E as k,P as j,N as P,L as a,H as l,J as ie,K as le}from"./index-C5OmCQ1r.js";import{u as de}from"./samples-D39eME_l.js";import{p as ue}from"./index-BTVH4Z8d.js";import"./analyses.mutations-COGCX6rV.js";import"./storage.mutations-CuzJ0nEv.js";const ce=Z({__name:"Sample",setup(T,{expose:s}){s();const d=$(),t=ee(),x=te();d.resetSample();const{cancelSamples:w,reInstateSamples:f,receiveSamples:g,invalidateSamples:b,publishSamples:_,verifySamples:h,recoverSamples:n}=de(),B=se({dropdownOpen:!1}),{sample:o,fetchingSample:I,repeatSample:O}=oe(d);d.fetchSampleByUid(t.params.sampleUid),L(()=>o?.value?.status,(r,m)=>{if(r)if(r!=="invalidated"){d.resetRepeatSample();return}else d.fetchRepeatSampleByParentId(t.params.sampleUid)}),L(()=>t.params.sampleUid,(r,m)=>{d.fetchSampleByUid(r)});function U(r,m){let y=[];return r?.forEach(R=>y.push(R.name)),m?.forEach(R=>y.push(R.name)),y.join(", ")}const q=u(()=>!!["expected"].includes(o?.value?.status?.toLowerCase())),N=async()=>g([o?.value?.uid]),V=u(()=>!!["received","expected"].includes(o?.value?.status?.toLowerCase())),A=async()=>w([o?.value?.uid]),E=u(()=>!!["cancelled"].includes(o?.value?.status?.toLowerCase())),J=async()=>f([o?.value?.uid]),F=u(()=>o?.value?.status?.toLowerCase()==="awaiting"),z=async()=>h([o?.value?.uid]),W=u(()=>o?.value?.status?.toLowerCase()==="published"),C=u(()=>["approved"].includes(o?.value?.status?.toLowerCase())?"Publish":["published"].includes(o?.value?.status?.toLowerCase())?"Re publish":"Pre publish"),H=u(()=>{if(["awaiting","approved","published"].includes(o?.value?.status?.toLowerCase()))return!0;const r=d.analysisResults;return!!(["received","paired"].includes(o?.value?.status?.toLowerCase()??"")&&r?.some(m=>["approved"].includes(m.status?.toLowerCase()??"")))}),K=async()=>{const r=C.value.startsWith("Pre")?"pre-publish":C.value.startsWith("Re")?"re-publish":"publish";_([{uid:o?.value?.uid,action:r}])},G=async()=>b([o?.value?.uid]).then(r=>{let m=r?.filter(y=>y.uid!==o?.value?.uid);m.length>0&&d.setRepeatSample(m[0])}),M=async()=>x.push({name:"print-barcodes",state:{sampleUids:JSON.stringify([o?.value?.uid])}}),Q=u(()=>!!["received","expected"].includes(o?.value?.status?.toLowerCase())),X=async()=>{x.push({name:"reject-samples",state:{samples:JSON.stringify([o?.value])}})},Y=u(()=>!!["stored"].includes(o?.value?.status?.toLowerCase())),D={sampleStore:d,route:t,router:x,cancelSamples:w,reInstateSamples:f,receiveSamples:g,invalidateSamples:b,publishSamples:_,verifySamples:h,recoverSamples:n,state:B,sample:o,fetchingSample:I,repeatSample:O,profileAnalysesText:U,canReceive:q,receiveSample:N,canCancel:V,cancelSample:A,canReinstate:E,reInstateSample:J,canVerify:F,verifySample:z,canInvalidate:W,publishText:C,canPublish:H,publishSample:K,invalidateSample:G,printBarCooe:M,canReject:Q,rejectSample:X,canRecover:Y,recoverSample:async()=>n([o?.value?.uid]),goToStorage:async r=>{x.push({path:"/bio-banking",state:{sample:JSON.stringify(r)}})},get parseDate(){return ue}};return Object.defineProperty(D,"__isScriptSetup",{enumerable:!1,value:!0}),D}}),me={class:"space-y-6"},pe={class:"flex justify-between items-center"},fe={class:"flex items-center space-x-4"},ve={class:"flex items-center"},xe={class:"bg-background rounded-lg shadow-sm p-6 space-y-6"},ge={key:0,class:"py-4 text-center"},ye={key:1,class:"space-y-6"},be={class:"space-y-4"},_e={class:"flex items-center justify-between"},he={class:"flex items-center space-x-2"},Se={key:0,class:"text-destructive"},we={class:"text-lg font-semibold text-foreground"},Ce={key:1,class:"flex items-center space-x-2"},Re={class:"text-muted-foreground"},ke={class:"relative"},je={type:"button",class:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50"},De={class:"absolute right-0 mt-2 py-2 bg-background rounded-lg shadow-lg border border-border z-20 min-w-[200px]"},Le={class:"grid grid-cols-3 gap-6"},Pe={class:"space-y-4"},Te={class:"flex justify-between"},Be={class:"text-sm text-muted-foreground"},Ie={class:"flex justify-between"},Oe={class:"text-sm text-muted-foreground"},Ue={class:"space-y-4"},qe={class:"flex justify-between"},Ne={class:"text-sm text-muted-foreground"},Ve={class:"flex justify-between"},Ae={class:"text-sm text-muted-foreground"},Ee={class:"flex justify-between"},Je={class:"text-sm text-muted-foreground"},Fe={class:"flex justify-between"},ze={class:"text-sm text-muted-foreground"},We={class:"space-y-4"},He={class:"flex justify-between"},Ke={class:"text-sm text-muted-foreground"},Ge={class:"flex justify-between"},Me={class:"text-sm text-muted-foreground"},Qe={class:"flex justify-between"},Xe={class:"text-sm text-muted-foreground"},Ye={class:"flex justify-between"},Ze={class:"text-sm text-muted-foreground"},$e={class:"bg-muted rounded-lg shadow-sm p-6"},et={class:"flex items-center space-x-4"},tt={class:"flex items-center space-x-2"},st={class:"bg-destructive/10 text-destructive rounded-lg shadow-sm p-6"},ot={class:"space-y-2"};function at(T,s,d,t,x,w){const f=S("font-awesome-icon"),g=S("router-link"),b=S("fel-loader"),_=S("router-view"),h=ne("motion-slide-right");return c(),p("div",me,[e("div",pe,[s[13]||(s[13]=e("h3",{class:"text-xl font-semibold text-foreground"},"Sample Detail",-1)),e("div",fe,[e("button",{class:"px-4 py-2 bg-background border border-border text-foreground rounded-md hover:bg-accent hover:text-accent-foreground transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50",onClick:t.printBarCooe},[e("span",ve,[s[11]||(s[11]=j(" Barcode ",-1)),v(f,{icon:"barcode",class:"ml-2"})])]),t.sample?.analysisRequest?.patient?.uid?(c(),re(g,{key:0,to:{name:"patient-detail",params:{patientUid:t.sample?.analysisRequest?.patient?.uid}},class:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50"},{default:P(()=>[...s[12]||(s[12]=[j(" ... other samples ",-1)])]),_:1},8,["to"])):k("",!0)])]),i((c(),p("div",xe,[t.fetchingSample?(c(),p("div",ge,[v(b,{message:"Fetching sample details ..."})])):(c(),p("div",ye,[e("div",be,[e("div",_e,[e("div",he,[t.sample?.priority??!0?(c(),p("span",Se,[v(f,{icon:"fa-star"})])):k("",!0),e("span",we,a(t.sample?.sampleId),1),t.sample?.analysisRequest?.patient?.uid&&t.repeatSample?.uid?(c(),p("span",Ce,[v(f,{icon:"angle-double-right"}),v(g,{to:{name:"sample-detail",params:{patientUid:t.sample?.analysisRequest?.patient?.uid,sampleUid:t.repeatSample?.uid}},class:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50"},{default:P(()=>[j(a(t.repeatSample?.sampleId),1)]),_:1},8,["to"])])):k("",!0)]),e("span",Re,a(t.profileAnalysesText(t.sample?.profiles,t.sample?.analyses??[])),1),e("div",ke,[e("div",{onClick:s[0]||(s[0]=n=>t.state.dropdownOpen=!t.state.dropdownOpen),class:"flex items-center space-x-2 cursor-pointer"},[e("button",je,a(t.sample?.status),1),v(f,{icon:"chevron-down",class:"text-muted-foreground"})]),i(e("div",{onClick:s[1]||(s[1]=n=>t.state.dropdownOpen=!1),class:"fixed inset-0 h-full w-full z-10"},null,512),[[l,t.state.dropdownOpen]]),i(e("div",De,[i(e("button",{onClick:s[2]||(s[2]=n=>t.receiveSample()),class:"w-full px-4 py-2 text-left text-foreground hover:bg-primary hover:text-primary-foreground transition-colors duration-200"}," Receive ",512),[[l,t.canReceive]]),i(e("button",{onClick:s[3]||(s[3]=n=>t.verifySample()),class:"w-full px-4 py-2 text-left text-foreground hover:bg-primary hover:text-primary-foreground transition-colors duration-200"}," Approve ",512),[[l,t.canVerify]]),i(e("button",{onClick:s[4]||(s[4]=n=>t.rejectSample()),class:"w-full px-4 py-2 text-left text-foreground hover:bg-destructive hover:text-destructive-foreground transition-colors duration-200"}," Reject ",512),[[l,t.canReject]]),i(e("button",{onClick:s[5]||(s[5]=n=>t.cancelSample()),class:"w-full px-4 py-2 text-left text-foreground hover:bg-destructive hover:text-destructive-foreground transition-colors duration-200"}," Cancel ",512),[[l,t.canCancel]]),i(e("button",{onClick:s[6]||(s[6]=n=>t.reInstateSample()),class:"w-full px-4 py-2 text-left text-foreground hover:bg-destructive hover:text-destructive-foreground transition-colors duration-200"}," Reinstate ",512),[[l,t.canReinstate]]),i(e("button",{onClick:s[7]||(s[7]=n=>t.publishSample()),class:"w-full px-4 py-2 text-left text-foreground hover:bg-primary hover:text-primary-foreground transition-colors duration-200"},a(t.publishText),513),[[l,t.canPublish]]),i(e("button",{onClick:s[8]||(s[8]=n=>t.invalidateSample()),class:"w-full px-4 py-2 text-left text-foreground hover:bg-primary hover:text-primary-foreground transition-colors duration-200"}," Invalidate ",512),[[l,t.canInvalidate]]),i(e("button",{onClick:s[9]||(s[9]=n=>t.recoverSample()),class:"w-full px-4 py-2 text-left text-foreground hover:bg-primary hover:text-primary-foreground transition-colors duration-200"}," Recover ",512),[[l,t.canRecover]])],512),[[l,t.state.dropdownOpen]])])]),e("div",Le,[e("div",Pe,[e("div",Te,[s[14]||(s[14]=e("span",{class:"text-sm font-medium text-foreground"},"Client Request ID",-1)),e("span",Be,a(t.sample?.analysisRequest?.clientRequestId),1)]),e("div",Ie,[s[15]||(s[15]=e("span",{class:"text-sm font-medium text-foreground"},"Client",-1)),e("span",Oe,a(t.sample?.analysisRequest?.client?.name),1)]),s[16]||(s[16]=e("div",{class:"flex justify-between"},[e("span",{class:"text-sm font-medium text-foreground"},"Client Contact"),e("span",{class:"text-sm text-muted-foreground"},"Sister in Charge")],-1))]),e("div",Ue,[e("div",qe,[s[17]||(s[17]=e("span",{class:"text-sm font-medium text-foreground"},"Sample Type",-1)),e("span",Ne,a(t.sample?.sampleType?.name),1)]),e("div",Ve,[s[18]||(s[18]=e("span",{class:"text-sm font-medium text-foreground"},"Date Sampled",-1)),e("span",Ae,a(t.parseDate(t.sample?.dateCollected,!0)),1)]),e("div",Ee,[s[19]||(s[19]=e("span",{class:"text-sm font-medium text-foreground"},"Date Registered",-1)),e("span",Je,a(t.parseDate(t.sample?.createdAt,!0)),1)]),e("div",Fe,[s[20]||(s[20]=e("span",{class:"text-sm font-medium text-foreground"},"Date Received",-1)),e("span",ze,a(t.parseDate(t.sample?.dateReceived,!0)),1)])]),e("div",We,[e("div",He,[s[21]||(s[21]=e("span",{class:"text-sm font-medium text-foreground"},"Date Submitted",-1)),e("span",Ke,a(t.parseDate(t.sample?.dateSubmitted,!0)),1)]),e("div",Ge,[s[22]||(s[22]=e("span",{class:"text-sm font-medium text-foreground"},"Date Verified",-1)),e("span",Me,a(t.parseDate(t.sample?.dateVerified,!0)),1)]),e("div",Qe,[s[23]||(s[23]=e("span",{class:"text-sm font-medium text-foreground"},"Date Published",-1)),e("span",Xe,a(t.parseDate(t.sample?.datePublished,!0)),1)]),e("div",Ye,[s[24]||(s[24]=e("span",{class:"text-sm font-medium text-foreground"},"Date Printed",-1)),e("span",Ze,a(t.parseDate(t.sample?.datePrinted,!0)),1)])])])])]))])),[[h]]),i(e("div",$e,[e("div",et,[s[29]||(s[29]=e("span",{class:"font-medium text-foreground"},"Storage:",-1)),e("button",{class:"text-primary hover:text-primary/80 transition-colors",onClick:s[10]||(s[10]=n=>t.goToStorage(t.sample))},[e("span",tt,[e("span",null,a(t.sample?.storageContainer?.storageSection?.storageLocation?.storeRoom?.name),1),s[25]||(s[25]=e("span",null,"›",-1)),e("span",null,a(t.sample?.storageContainer?.storageSection?.storageLocation?.name),1),s[26]||(s[26]=e("span",null,"›",-1)),e("span",null,a(t.sample?.storageContainer?.storageSection?.name),1),s[27]||(s[27]=e("span",null,"›",-1)),e("span",null,a(t.sample?.storageContainer?.name),1),s[28]||(s[28]=e("span",null,"›",-1)),e("span",null,a(t.sample?.storageSlot),1)])])])],512),[[l,t.sample?.status==="stored"]]),i(e("div",st,[e("ul",ot,[(c(!0),p(ie,null,le(t.sample?.rejectionReasons,n=>(c(),p("li",{key:n.uid},a(n.reason),1))),128))])],512),[[l,t.sample?.status==="rejected"]]),v(_)])}const mt=ae(ce,[["render",at],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/sample/_id/Sample.vue"]]);export{mt as default};
