import{f as n,d as u,k as a}from"./index-93739211.js";import{U as p,G as f}from"./_queries-2ba61825.js";const{withClientQuery:i}=n(),{toastError:o}=a(),c=u("user",{state:()=>({users:[],usersPageInfo:void 0,usersTotalCount:0,fetchingUsers:!1,groups:[],fetchingGroups:!1,permissions:[]}),getters:{getUsers:s=>s.users,getSamplePageInfo:s=>s.usersPageInfo,getGroups:s=>s.groups,getPermissions:s=>s.permissions},actions:{async fetchUsers(s){try{this.fetchingUsers=!0;const r=await i(p,s,"userAll");this.users=r.items?.filter(t=>t.email!="system_daemon@system.daemon")??[],this.usersTotalCount=r.totalCount,this.usersPageInfo=r.pageInfo}catch(e){e instanceof Error&&o(e.message),this.users=[]}finally{this.fetchingUsers=!1}},addUser(s){this.users?.unshift(s)},updateUser(s){const e=this.users?.findIndex(r=>r.uid===s?.uid);e&&e>-1&&(this.users[e]=s)},async fetchGroupsAndPermissions(){try{this.fetchingGroups=!0;const s=await i(f,{},void 0);if(s&&typeof s=="object"){const e=s;this.groups=e.groupAll||[],this.permissions=e.permissionAll||[]}else this.groups=[],this.permissions=[],console.error("Unexpected response format:",s)}catch(s){s instanceof Error&&o(s.message),this.groups=[],this.permissions=[]}finally{this.fetchingGroups=!1}},addGroup(s){this.groups?.unshift(s)},updateGroup(s){const e=this.groups?.findIndex(r=>r.uid===s?.uid);e>-1&&(this.groups[e]=s)},updateGroupsAndPermissions(s){let e=s?.group;const r=this.groups?.findIndex(t=>t.uid===e?.uid);r>-1&&(e.permissions=e?.permissions||[],this.groups[r]=e)},getRoles(){const s=new Map;for(const e of this.groups)s.set(e.name,e.name);return s},addUserAuth(s){},updateUserAuth(s){}}});export{c as u};
