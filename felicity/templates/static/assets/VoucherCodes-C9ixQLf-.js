import{Y as U,u as B,aB as A,a7 as q,ah as D,an as j,a0 as z,aM as N,a3 as P,_ as R,r as k,c as f,o as m,A as E,C as K,z as d,a as t,K as i,M as h,F as T,H,I as b,B as O,a4 as M,aK as W,aL as Y}from"./index-OdhKCqIc.js";import{e as G,f as J}from"./billing.mutations-BKsnFCTJ.js";import{u as Q}from"./billing-COaJ61t1.js";import{c as X,f as Z,a as g,d as $,u as ee,F as oe}from"./index.esm-BfHj8iGm.js";import{I as te}from"./Input-BEm5S0CJ.js";import{S as re}from"./Spinner-Bl8RfjFA.js";import{F as se,a as ie,b as de}from"./FormMessage-CgXFMXx9.js";import{F as ne}from"./FormLabel-DxP9wnWS.js";import"./billing.queries-CxKPIhZs.js";import"./Label-CS46LzLb.js";const ae=U({__name:"VoucherCodes",props:{voucherUid:String},setup(p,{expose:r}){r();const l=p,{withClientMutation:e}=B();let a=Q();const{fetchingVoucherCodes:F}=A(a),_=q(()=>{const o=a.getVouchers,c=o?.findIndex(I=>I.uid===l.voucherUid);return c>-1?o[c]?.codes:[]});D(()=>a.fetchVoucherCodes(l.voucherUid)),j(()=>l.voucherUid,o=>{a.fetchVoucherCodes(l.voucherUid)});let u=z(!1);const s=X({uid:g().nullable(),voucherUid:g().required(),code:g().required("Code is Required"),usageLimit:$().required("Usage Limit is Required"),used:g().nullable(),isActive:Z().default(!0)}),{handleSubmit:C,setFieldValue:n,values:v}=ee({validationSchema:s,initialValues:{isActive:!0,voucherUid:l.voucherUid}}),S=C(o=>{o.uid||x(o),o.uid&&y(o)});let V=o=>{n("uid",o.uid),n("code",o.code),n("usageLimit",o.usageLimit),n("used",o.used),n("isActive",o.isActive),u.value=!0};const L=()=>{n("uid",void 0),n("voucherUid",l.voucherUid),n("code",void 0),n("usageLimit",void 0),n("used",void 0),n("isActive",!0),u.value=!0},x=o=>{delete o.uid,e(G,{payload:o},"createVoucherCode").then(c=>a.addVoucherCode(c)).finally(()=>u.value=!1)},y=o=>{delete o.uid,delete o.used,e(J,{uid:v.uid,payload:o},"updateVoucherCode").then(c=>a.updateVoucherCode(c)).finally(()=>u.value=!1)},w={props:l,withClientMutation:e,get billingStore(){return a},set billingStore(o){a=o},fetchingVoucherCodes:F,codes:_,get showModal(){return u},set showModal(o){u=o},codeSchema:s,handleSubmit:C,setFieldValue:n,values:v,submitVoucherForm:S,get editCode(){return V},set editCode(o){V=o},newVoucherCode:L,addVoucherCode:x,updateVoucherCode:y,get Button(){return P},get Checkbox(){return N},get Input(){return te},get Spinner(){return re},get FormControl(){return de},get FormField(){return oe},get FormItem(){return ie},get FormLabel(){return ne},get FormMessage(){return se}};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}}),le={class:"space-y-6"},ue={key:0,class:"rounded-lg border border-border bg-card p-4"},ce={class:"inline-flex items-center gap-2"},me={key:1,class:"space-y-6"},fe={class:"flex justify-between items-center"},he={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"},ge={class:"flex items-center justify-between"},_e={class:"space-y-1"},Ce={class:"font-medium text-foreground"},be={class:"text-sm text-muted-foreground"},pe={class:"grid grid-cols-2 gap-4"},Fe={class:"flex justify-end"};function ve(p,r,l,e,a,F){const _=k("font-awesome-icon"),u=k("Modal");return m(),f("div",le,[e.fetchingVoucherCodes?(m(),f("div",ue,[d("span",ce,[t(e.Spinner,{class:"size-4"}),r[2]||(r[2]=d("span",{class:"text-sm"},"Fetching voucher codes ...",-1))])])):(m(),f("section",me,[d("div",fe,[r[4]||(r[4]=d("h4",{class:"text-lg font-semibold text-foreground"},"Voucher Codes",-1)),t(e.Button,{onClick:e.newVoucherCode},{default:i(()=>[...r[3]||(r[3]=[h(" Add Voucher Code ",-1)])]),_:1})]),d("div",he,[(m(!0),f(T,null,H(e.codes,s=>(m(),f("div",{key:s.uid,class:"rounded-lg border border-border bg-card p-4 transition-colors hover:bg-accent hover:text-accent-foreground"},[d("div",ge,[d("div",_e,[d("h5",Ce,b(s.code),1),d("p",be,b(s.used)+" of "+b(s.usageLimit),1)]),t(e.Button,{variant:"outline",size:"icon",onClick:C=>e.editCode(s)},{default:i(()=>[t(_,{icon:"pen",class:"text-muted-foreground"})]),_:1},8,["onClick"])])]))),128))])])),e.showModal?(m(),E(u,{key:2,onClose:r[1]||(r[1]=s=>e.showModal=!1),contentWidth:"w-2/6"},{header:i(()=>[...r[5]||(r[5]=[d("h3",{class:"text-lg font-semibold text-foreground"},"Voucher Code Form",-1)])]),body:i(()=>[d("form",{class:"space-y-6",onSubmit:r[0]||(r[0]=O((...s)=>e.submitVoucherForm&&e.submitVoucherForm(...s),["prevent"]))},[d("div",pe,[t(e.FormField,{name:"code"},{default:i(({componentField:s})=>[t(e.FormItem,null,{default:i(()=>[t(e.FormLabel,null,{default:i(()=>[...r[6]||(r[6]=[h("Voucher Code",-1)])]),_:1}),t(e.FormControl,null,{default:i(()=>[t(e.Input,M(s,{placeholder:"Code ..."}),null,16)]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1}),t(e.FormField,{name:"usageLimit"},{default:i(({componentField:s})=>[t(e.FormItem,null,{default:i(()=>[t(e.FormLabel,null,{default:i(()=>[...r[7]||(r[7]=[h("Usage Limit",-1)])]),_:1}),t(e.FormControl,null,{default:i(()=>[t(e.Input,M(s,{type:"number",min:"1"}),null,16)]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1})]),t(e.FormField,{name:"isActive",type:"checkbox","checked-value":!0,"unchecked-value":!1},{default:i(({componentField:s})=>[t(e.FormItem,{class:"flex items-center space-x-2"},{default:i(()=>[t(e.FormControl,null,{default:i(()=>[t(e.Checkbox,W(Y(s)),null,16)]),_:2},1024),t(e.FormLabel,null,{default:i(()=>[...r[8]||(r[8]=[h("Is Active",-1)])]),_:1}),t(e.FormMessage)]),_:2},1024)]),_:1}),d("div",Fe,[t(e.Button,{type:"submit"},{default:i(()=>[...r[9]||(r[9]=[h("Save Voucher Code",-1)])]),_:1})])],32)]),_:1})):K("",!0)])}const Be=R(ae,[["render",ve],["__scopeId","data-v-8e7b96f9"],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/billing/VoucherCodes.vue"]]);export{Be as default};
