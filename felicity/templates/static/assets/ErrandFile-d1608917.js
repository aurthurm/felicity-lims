import{d as T,I as N,r as d,q,p as K,o as a,c as n,b as t,y as l,t as u,F as h,C as R,G as O,B as Q,h as F,D as Y,E as J,k as X}from"./index-fc86f1fc.js";import{l as Z,m as I}from"./grind.queries-5040943e.js";import{M as D}from"./schema-f3233b53.js";const r=p=>(Y("data-v-334d1478"),p=p(),J(),p),ee={class:"flex justify-between items-start"},te={class:"w-3/4 pr-4"},se=r(()=>t("h3",{class:"text-lg font-medium mb-3"},"Uploaded Files",-1)),oe={key:0,class:"py-6 text-center text-gray-500 bg-gray-50 rounded-lg border border-dashed border-gray-300"},ae={key:1,class:"mb-3 p-3 bg-red-50 text-red-700 rounded-md"},ne={key:2,class:"space-y-2"},le={class:"file-icon mr-3 text-blue-500 flex-shrink-0"},re={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},ie=r(()=>t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"},null,-1)),de=[ie],ce=r(()=>t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M7 21h10a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v14a2 2 0 002 2z"})],-1)),ue=r(()=>t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),he=r(()=>t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),ve=r(()=>t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),pe={class:"flex-grow min-w-0 mr-3"},_e=["title"],ge={class:"text-sm text-gray-500 flex items-center gap-2"},fe=r(()=>t("span",{class:"h-1 w-1 rounded-full bg-gray-300"},null,-1)),we={class:"flex gap-2 flex-shrink-0"},me=["onClick"],xe=r(()=>t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),ke=[xe],ye=["onClick","disabled"],be={key:0,class:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},Ce=r(()=>t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1)),De=r(()=>t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)),Fe=[Ce,De],Me={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Be=r(()=>t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"},null,-1)),Ue=[Be],Ve={class:"file-upload-container"},ze=F('<div class="w-16 h-16 mb-2 mx-auto text-gray-400" data-v-334d1478><svg xmlns="http://www.w3.org/2000/svg" class="w-full h-full" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-334d1478><path stroke-linecap="round" stroke-linejoin="round" stroke-width="1" d="M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4" data-v-334d1478></path></svg></div><p class="text-center text-gray-500 mb-2" data-v-334d1478>Drag and drop file here</p><p class="text-center text-gray-400 text-sm mb-3" data-v-334d1478>or</p>',3),Ee={class:"file-input-button"},je={class:"file-preview"},Se={key:0,class:"image-preview mb-3"},$e=["src"],Ae={key:1,class:"file-icon w-16 h-16 mx-auto mb-3 text-blue-500"},He=r(()=>t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-full h-full",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})],-1)),Le=[He],We={class:"file-info mb-4 text-center"},Ge={class:"font-medium text-gray-800"},Pe={class:"text-sm text-gray-500"},Te={class:"flex justify-center gap-3"},Ne=["disabled"],qe={key:0},Ke={key:1},Re={key:2,class:"mt-3 text-red-500 text-center"},Oe=F('<div class="success-icon w-16 h-16 mx-auto mb-3 text-green-500" data-v-334d1478><svg xmlns="http://www.w3.org/2000/svg" class="w-full h-full" fill="none" viewBox="0 0 24 24" stroke="currentColor" data-v-334d1478><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" data-v-334d1478></path></svg></div><p class="text-center text-gray-800 font-medium mb-2" data-v-334d1478>Upload Successful</p><p class="text-center text-gray-500 text-sm mb-4" data-v-334d1478>Your file has been uploaded successfully</p>',3),Qe=T({__name:"ErrandFile",props:{errandUid:{type:String,required:!0}},setup(p){const y=p,{withClientMutation:M,withClientQuery:B}=N(),x=d(null),k=d(null);q(()=>{U()});const _=d(!1),i=d(null),g=d(null),w=d(!1),c=d(null),f=d(!1),v=d([]),U=()=>{B(Z,{target:D.Errand,targetUid:y.errandUid},"grindMediaByTarget").then(e=>{e&&(v.value=e)})},V=e=>{M(I,{payload:e},"createGrindMedia").then(s=>{s&&(v.value=[s,...v.value])})},z=e=>{x.value=e,k.value=null},E=e=>{const s=parseInt(e);return s<1024?`${s} B`:s<1024*1024?`${(s/1024).toFixed(1)} KB`:`${(s/(1024*1024)).toFixed(1)} MB`},m=e=>{const{mimetype:s,filename:o}=e;return s?.startsWith("image/")?"image":s?.includes("pdf")||o.endsWith(".pdf")?"pdf":s?.includes("word")||o.endsWith(".doc")||o.endsWith(".docx")?"doc":s?.includes("sheet")||o.endsWith(".xls")||o.endsWith(".xlsx")?"excel":"file"},j=e=>{window.open(`/${e.path}`,"_blank")},b=e=>{if(c.value=null,i.value=e,e.type.startsWith("image/")){const s=new FileReader;s.onload=o=>{g.value=o.target?.result},s.readAsDataURL(e)}else g.value=null},S=async()=>{if(i.value){w.value=!0,c.value=null;try{const e=await V({file:i.value,target:D.Errand,targetUid:y.errandUid});e?.error?c.value=e.error.message:f.value=!0}catch(e){c.value=e instanceof Error?e.message:"Upload failed"}finally{w.value=!1}}},$=e=>{const s=e.target;s.files&&s.files.length>0&&b(s.files[0])},A=e=>{e.preventDefault(),e.stopPropagation(),_.value=!0},H=e=>{e.preventDefault(),e.stopPropagation(),_.value=!1},L=e=>{e.preventDefault(),e.stopPropagation(),_.value=!0},W=e=>{e.preventDefault(),e.stopPropagation(),_.value=!1,e.dataTransfer&&e.dataTransfer.files.length>0&&b(e.dataTransfer.files[0])},C=()=>{i.value=null,g.value=null,f.value=!1,c.value=null},G=K(()=>{if(!i.value)return"";const e=i.value.size;return e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`});return(e,s)=>(a(),n("div",ee,[t("div",te,[se,l(" Loading or empty state "),v.value.length===0?(a(),n("div",oe," No files uploaded yet ")):l("v-if",!0),l(" Error message "),k.value?(a(),n("div",ae,u(k.value),1)):l("v-if",!0),l(" File list "),v.value.length>0?(a(),n("ul",ne,[(a(!0),n(h,null,R(v.value,o=>(a(),n("li",{key:o.uid,class:"p-3 border rounded-md flex items-center hover:bg-gray-50 transition-colors"},[l(" File icon based on type "),t("div",le,[l(" Image icon "),m(o)==="image"?(a(),n("svg",re,[...de])):m(o)==="pdf"?(a(),n(h,{key:1},[l(" PDF icon "),ce],2112)):m(o)==="doc"?(a(),n(h,{key:2},[l(" Word/Doc icon "),ue],2112)):m(o)==="excel"?(a(),n(h,{key:3},[l(" Excel icon "),he],2112)):(a(),n(h,{key:4},[l(" Generic file icon "),ve],2112))]),l(" File info "),t("div",pe,[t("div",{class:"font-medium text-gray-800 truncate",title:o.filename},u(o.filename),9,_e),t("div",ge,[t("span",null,u(E(o.size)),1),fe,t("span",null,u(o.mimetype),1)])]),l(" Actions "),t("div",we,[l(" Download button "),t("button",{onClick:P=>j(o),class:"p-2 text-blue-600 hover:bg-blue-50 rounded transition-colors",title:"Download file"},[...ke],8,me),l(" Delete button "),t("button",{onClick:P=>z(o.uid),class:"p-2 text-red-600 hover:bg-red-50 rounded transition-colors",title:"Delete file",disabled:x.value===o.uid},[x.value===o.uid?(a(),n("svg",be,[...Fe])):(a(),n("svg",Me,[...Ue]))],8,ye)])]))),128))])):l("v-if",!0)]),t("div",Ve,[l(" Upload area "),!i.value&&!f.value?(a(),n("div",{key:0,class:O(["upload-area",{dragging:_.value}]),onDragenter:A,onDragleave:H,onDragover:L,onDrop:W},[ze,t("label",Ee,[Q(" Browse Files "),t("input",{type:"file",class:"hidden",onChange:$},null,32)])],34)):i.value&&!f.value?(a(),n(h,{key:1},[l(" File preview "),t("div",je,[g.value?(a(),n("div",Se,[t("img",{src:g.value,alt:"File preview",class:"rounded-md max-h-64 max-w-full"},null,8,$e)])):(a(),n("div",Ae,[...Le])),t("div",We,[t("p",Ge,u(i.value.name),1),t("p",Pe,u(G.value),1)]),t("div",Te,[t("button",{onClick:C,class:"cancel-button"}," Cancel "),t("button",{onClick:S,class:"upload-button",disabled:w.value},[w.value?(a(),n("span",qe,"Uploading...")):(a(),n("span",Ke,"Upload"))],8,Ne)]),c.value?(a(),n("div",Re,u(c.value),1)):l("v-if",!0)])],2112)):f.value?(a(),n(h,{key:2},[l(" Upload success "),t("div",{class:"upload-success"},[Oe,t("button",{onClick:C,class:"upload-new-button"}," Upload Another File ")])],2112)):l("v-if",!0)])]))}});const Ze=X(Qe,[["__scopeId","data-v-334d1478"],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/grind/_id/ErrandFile.vue"]]);export{Ze as default};
