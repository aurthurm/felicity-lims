import{Y as K,u as Y,aw as W,a0 as F,an as G,a7 as k,bb as J,a9 as Q,aa as X,ab as Z,ad as j,ae as $,af as ee,a3 as te,_ as le,c as S,o as m,a as t,z as s,A as v,C as re,K as l,M as n,F as p,H as h,I as u,B as ae,a4 as B}from"./index-OdhKCqIc.js";import{c as oe,d as H,a as q,u as ne,F as ie}from"./index.esm-BfHj8iGm.js";import{K as de,L as me}from"./analyses.mutations-DUxQZn1r.js";import{u as se}from"./analysis-PB9AMevg.js";import{u as ue}from"./setup-BcFG_bXr.js";import{I as fe}from"./Input-BEm5S0CJ.js";import{F as ce,a as ge,b as be}from"./FormMessage-CgXFMXx9.js";import{F as _e}from"./FormLabel-DxP9wnWS.js";import{S as Le,a as Fe,b as Se,c as ve,d as pe}from"./SelectValue-Ds0cfAgl.js";import{P as Te}from"./PageHeading-Czi_4opS.js";import"./Label-CS46LzLb.js";import"./useNonce-B4v0IDPb.js";import"./chevron-down-Dqf-ptA3.js";import"./useFocusGuards-Bjb6OG0k.js";import"./PopperContent-BfyCnGUj.js";const C="__none__",we=K({__name:"DetectionLimit",props:{analysis:{type:Object,required:!0,default:()=>({})},analysisUid:{type:String,required:!0,default:""}},setup(I,{expose:r}){r();const g=se(),e=ue(),{withClientMutation:b}=Y(),_=I,{analysis:o}=W(_);let d=F(!1),T=F("");const L=F(!0),c=F(null),U=oe({instrumentUid:q().trim().required("Instrument is required"),methodUid:q().trim().required("Method is required"),lowerLimit:H().typeError("Lower limit must be a number").required("Lower limit is required"),upperLimit:H().typeError("Upper limit must be a number").required("Upper limit is required")}),{handleSubmit:M,resetForm:E,setValues:N,setFieldValue:w}=ne({validationSchema:U,initialValues:{instrumentUid:"",methodUid:"",lowerLimit:"",upperLimit:""}});G(()=>_.analysisUid,(a,i)=>{}),e.fetchInstruments();const x=k(()=>e.getInstruments);e.fetchMethods();const y=k(()=>e.getMethods);function O(a){w("instrumentUid",a===C?"":a)}function R(a){w("methodUid",a===C?"":a)}function D(a){b(de,{payload:a},"createAnalysisDetectionLimit").then(i=>g.addAnalysisDetectionLimit(i))}function A(a){c.value&&b(me,{uid:c.value,payload:a},"updateAnalysisDetectionLimit").then(i=>g.updateAnalysisDetectionLimit(i))}function P(a,i={}){L.value=a,d.value=!0,T.value=(a?"CREATE":"EDIT")+" ANALYSIS DETECTION_LIMIT",a?(c.value=null,E({values:{instrumentUid:"",methodUid:"",lowerLimit:"",upperLimit:""}})):(c.value=i.uid??null,N({instrumentUid:i.instrumentUid??"",methodUid:i.methodUid??"",lowerLimit:i.lowerLimit??"",upperLimit:i.upperLimit??""}))}const z=M(a=>{const i=o?.value?.uid;if(!i)return;const f={instrumentUid:a.instrumentUid,methodUid:a.methodUid,lowerLimit:Number(a.lowerLimit),upperLimit:Number(a.upperLimit),analysisUid:i};L.value===!0&&D(f),L.value===!1&&A(f),d.value=!1}),V={SELECT_NONE:C,analysisStore:g,setupStore:e,withClientMutation:b,props:_,analysis:o,get showModal(){return d},set showModal(a){d=a},get formTitle(){return T},set formTitle(a){T=a},formAction:L,currentUid:c,detectionSchema:U,handleSubmit:M,resetForm:E,setValues:N,setFieldValue:w,instruments:x,methods:y,onInstrumentChange:O,onMethodChange:R,addAnalysisDetectionLimit:D,editAnalysisDetectionLimit:A,FormManager:P,saveForm:z,instrumentName:a=>{const i=x?.value?.findIndex(f=>f.uid===a);return x?.value[i]?.name||"unknown"},methodName:a=>{const i=y?.value?.findIndex(f=>f.uid===a);return y?.value[i]?.name||"unknown"},get Button(){return te},get Input(){return fe},get FormControl(){return be},get FormField(){return ie},get FormItem(){return ge},get FormLabel(){return _e},get FormMessage(){return ce},get Select(){return pe},get SelectContent(){return ve},get SelectItem(){return Se},get SelectTrigger(){return Fe},get SelectValue(){return Le},get Table(){return ee},get TableBody(){return $},get TableCell(){return j},get TableHead(){return Z},get TableHeader(){return X},get TableRow(){return Q},Modal:J,PageHeading:Te};return Object.defineProperty(V,"__isScriptSetup",{enumerable:!1,value:!0}),V}}),xe={class:"mt-4 border border-border bg-card rounded-lg shadow-md"},ye={class:"relative w-full overflow-auto"},he={class:"text-sm text-foreground"},Ce={class:"text-lg font-bold text-foreground"},Ie={class:"space-y-4"},Ue={class:"grid grid-cols-4 gap-4"},Me={class:"pt-4"};function Ee(I,r,g,e,b,_){return m(),S(p,null,[t(e.PageHeading,{title:"Detection Limits"},{default:l(()=>[t(e.Button,{onClick:r[0]||(r[0]=o=>e.FormManager(!0))},{default:l(()=>[...r[3]||(r[3]=[n("Add Detection Limit",-1)])]),_:1})]),_:1}),s("div",xe,[s("div",ye,[t(e.Table,{class:"w-full caption-bottom text-sm"},{default:l(()=>[t(e.TableHeader,{class:"[&_tr]:border-b"},{default:l(()=>[t(e.TableRow,{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:l(()=>[t(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...r[4]||(r[4]=[n("Instrument",-1)])]),_:1}),t(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...r[5]||(r[5]=[n("Method",-1)])]),_:1}),t(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...r[6]||(r[6]=[n("Lower Limit",-1)])]),_:1}),t(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...r[7]||(r[7]=[n("Upper Limit",-1)])]),_:1}),t(e.TableHead,{class:"h-12 px-4 text-right align-middle font-medium text-muted-foreground"},{default:l(()=>[...r[8]||(r[8]=[n("Actions",-1)])]),_:1})]),_:1})]),_:1}),t(e.TableBody,{class:"[&_tr:last-child]:border-0"},{default:l(()=>[(m(!0),S(p,null,h(e.analysis?.detectionLimits,o=>(m(),v(e.TableRow,{key:o?.uid,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:l(()=>[t(e.TableCell,{class:"px-4 py-3 align-middle whitespace-nowrap text-sm text-foreground"},{default:l(()=>[s("div",he,u(e.instrumentName(o?.instrumentUid)),1)]),_:2},1024),t(e.TableCell,{class:"px-4 py-3 align-middle whitespace-nowrap text-sm text-foreground"},{default:l(()=>[n(u(e.methodName(o?.methodUid)),1)]),_:2},1024),t(e.TableCell,{class:"px-4 py-3 align-middle whitespace-nowrap text-sm text-foreground"},{default:l(()=>[n(u(o.lowerLimit),1)]),_:2},1024),t(e.TableCell,{class:"px-4 py-3 align-middle whitespace-nowrap text-sm text-foreground"},{default:l(()=>[n(u(o.upperLimit),1)]),_:2},1024),t(e.TableCell,{class:"px-4 py-3 align-middle text-right"},{default:l(()=>[t(e.Button,{variant:"outline",size:"sm",onClick:d=>e.FormManager(!1,o)},{default:l(()=>[...r[9]||(r[9]=[n(" Edit ",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),e.showModal?(m(),v(e.Modal,{key:0,onClose:r[2]||(r[2]=o=>e.showModal=!1),contentWidth:"w-2/4"},{header:l(()=>[s("h3",Ce,u(e.formTitle),1)]),body:l(()=>[s("form",{onSubmit:r[1]||(r[1]=ae((...o)=>e.saveForm&&e.saveForm(...o),["prevent"])),class:"p-6 space-y-6"},[s("div",Ie,[s("div",Ue,[t(e.FormField,{name:"instrumentUid"},{default:l(({componentField:o})=>[t(e.FormItem,null,{default:l(()=>[t(e.FormLabel,null,{default:l(()=>[...r[10]||(r[10]=[n("Instrument",-1)])]),_:1}),t(e.FormControl,null,{default:l(()=>[t(e.Select,{"model-value":o.modelValue||e.SELECT_NONE,"onUpdate:modelValue":e.onInstrumentChange},{default:l(()=>[t(e.SelectTrigger,null,{default:l(()=>[t(e.SelectValue,{placeholder:"Select Instrument"})]),_:1}),t(e.SelectContent,null,{default:l(()=>[t(e.SelectItem,{value:e.SELECT_NONE},{default:l(()=>[...r[11]||(r[11]=[n("Select Instrument",-1)])]),_:1}),(m(!0),S(p,null,h(e.instruments,d=>(m(),v(e.SelectItem,{key:d?.uid,value:d.uid},{default:l(()=>[n(u(d?.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1}),t(e.FormField,{name:"methodUid"},{default:l(({componentField:o})=>[t(e.FormItem,null,{default:l(()=>[t(e.FormLabel,null,{default:l(()=>[...r[12]||(r[12]=[n("Method",-1)])]),_:1}),t(e.FormControl,null,{default:l(()=>[t(e.Select,{"model-value":o.modelValue||e.SELECT_NONE,"onUpdate:modelValue":e.onMethodChange},{default:l(()=>[t(e.SelectTrigger,null,{default:l(()=>[t(e.SelectValue,{placeholder:"Select Method"})]),_:1}),t(e.SelectContent,null,{default:l(()=>[t(e.SelectItem,{value:e.SELECT_NONE},{default:l(()=>[...r[13]||(r[13]=[n("Select Method",-1)])]),_:1}),(m(!0),S(p,null,h(e.methods,d=>(m(),v(e.SelectItem,{key:d?.uid,value:d.uid},{default:l(()=>[n(u(d?.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1}),t(e.FormField,{name:"lowerLimit"},{default:l(({componentField:o})=>[t(e.FormItem,null,{default:l(()=>[t(e.FormLabel,null,{default:l(()=>[...r[14]||(r[14]=[n("Lower Limit",-1)])]),_:1}),t(e.FormControl,null,{default:l(()=>[t(e.Input,B(o,{type:"number",placeholder:"Value ..."}),null,16)]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1}),t(e.FormField,{name:"upperLimit"},{default:l(({componentField:o})=>[t(e.FormItem,null,{default:l(()=>[t(e.FormLabel,null,{default:l(()=>[...r[15]||(r[15]=[n("Upper Limit",-1)])]),_:1}),t(e.FormControl,null,{default:l(()=>[t(e.Input,B(o,{type:"number",placeholder:"Value ..."}),null,16)]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1})])]),s("div",Me,[t(e.Button,{type:"submit",class:"w-full"},{default:l(()=>[...r[16]||(r[16]=[n("Save Form",-1)])]),_:1})])],32)]),_:1})):re("",!0)],64)}const Qe=le(we,[["render",Ee],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/analyses/services/DetectionLimit.vue"]]);export{Qe as default};
