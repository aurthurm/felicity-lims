import{Y as D,u as O,aw as P,a0 as F,an as K,a7 as z,bb as Y,a9 as W,aa as G,ab as J,ad as Q,ae as X,af as Z,a3 as j,_ as $,c as T,o as u,a as t,z as d,A as S,C as ee,K as l,M as o,F as x,H as U,I as f,B as te,a4 as B}from"./index-OdhKCqIc.js";import{c as le,a as V,d as ae,u as re,F as ne}from"./index.esm-BfHj8iGm.js";import{B as oe,D as se}from"./analyses.mutations-DUxQZn1r.js";import{u as ie}from"./analysis-PB9AMevg.js";import{u as de}from"./setup-BcFG_bXr.js";import{I as ue}from"./Input-BEm5S0CJ.js";import{F as me,a as fe,b as ge}from"./FormMessage-CgXFMXx9.js";import{F as ce}from"./FormLabel-DxP9wnWS.js";import{S as be,a as ye,b as ve,c as Fe,d as Ie}from"./SelectValue-Ds0cfAgl.js";import{P as _e}from"./PageHeading-Czi_4opS.js";import"./Label-CS46LzLb.js";import"./useNonce-B4v0IDPb.js";import"./chevron-down-Dqf-ptA3.js";import"./useFocusGuards-Bjb6OG0k.js";import"./PopperContent-BfyCnGUj.js";const H="__none__",Te=D({__name:"InterimFields",props:{analysis:{type:Object,required:!0,default:()=>({})},analysisUid:{type:String,required:!0,default:""}},setup(p,{expose:a}){a();const g=ie(),e=de(),{withClientMutation:c}=O(),b=p,{analysis:n}=P(b);let i=F(!1),I=F("");const y=F(!0),m=F(null),w=le({instrumentUid:V().trim().required("Instrument is required"),key:ae().typeError("Interim key must be a number").integer("Interim key must be an integer").required("Interim key is required"),value:V().trim().required("Result value is required")}),{handleSubmit:C,resetForm:k,setValues:M,setFieldValue:A}=re({validationSchema:w,initialValues:{instrumentUid:"",key:"",value:""}});K(()=>b.analysisUid,(r,s)=>{}),e.fetchInstruments();const _=z(()=>e.getInstruments);function R(r){A("instrumentUid",r===H?"":r)}function h(r){c(oe,{payload:r},"createAnalysisInterim").then(s=>g.addAnalysisInterim(s))}function E(r){m.value&&c(se,{uid:m.value,payload:r},"updateAnalysisInterim").then(s=>g.updateAnalysisInterim(s))}function L(r,s={}){y.value=r,i.value=!0,I.value=(r?"CREATE":"EDIT")+" ANALYSIS INTERIM",r?(m.value=null,k({values:{instrumentUid:"",key:"",value:""}})):(m.value=s.uid??null,M({instrumentUid:s.instrumentUid??"",key:s.key??"",value:s.value??""}))}const q=C(r=>{const s=n?.value?.uid;if(!s)return;const v={instrumentUid:r.instrumentUid,key:Number(r.key),value:r.value,analysisUid:s};y.value===!0&&h(v),y.value===!1&&E(v),i.value=!1}),N={SELECT_NONE:H,analysisStore:g,setupStore:e,withClientMutation:c,props:b,analysis:n,get showModal(){return i},set showModal(r){i=r},get formTitle(){return I},set formTitle(r){I=r},formAction:y,currentUid:m,interimSchema:w,handleSubmit:C,resetForm:k,setValues:M,setFieldValue:A,instruments:_,onInstrumentChange:R,addAnalysisInterim:h,editAnalysisInterim:E,FormManager:L,saveForm:q,instrumentName:r=>{const s=_?.value?.findIndex(v=>v.uid===r);return _?.value[s]?.name||"unknown"},get Button(){return j},get Input(){return ue},get FormControl(){return ge},get FormField(){return ne},get FormItem(){return fe},get FormLabel(){return ce},get FormMessage(){return me},get Select(){return Ie},get SelectContent(){return Fe},get SelectItem(){return ve},get SelectTrigger(){return ye},get SelectValue(){return be},get Table(){return Z},get TableBody(){return X},get TableCell(){return Q},get TableHead(){return J},get TableHeader(){return G},get TableRow(){return W},Modal:Y,PageHeading:_e};return Object.defineProperty(N,"__isScriptSetup",{enumerable:!1,value:!0}),N}}),Se={class:"mt-4 border border-border bg-card rounded-lg shadow-md"},xe={class:"relative w-full overflow-auto"},pe={class:"text-lg font-bold text-foreground"},we={class:"space-y-4"},Ce={class:"grid grid-cols-3 gap-4"},ke={class:"pt-4"};function Me(p,a,g,e,c,b){return u(),T(x,null,[t(e.PageHeading,{title:"Interim Fields"},{default:l(()=>[t(e.Button,{onClick:a[0]||(a[0]=n=>e.FormManager(!0))},{default:l(()=>[...a[3]||(a[3]=[o("Add Interim Field",-1)])]),_:1})]),_:1}),d("div",Se,[d("div",xe,[t(e.Table,{class:"w-full caption-bottom text-sm"},{default:l(()=>[t(e.TableHeader,{class:"[&_tr]:border-b"},{default:l(()=>[t(e.TableRow,{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:l(()=>[t(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...a[4]||(a[4]=[o("Interim Key",-1)])]),_:1}),t(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...a[5]||(a[5]=[o("Result Value",-1)])]),_:1}),t(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...a[6]||(a[6]=[o("Instrument",-1)])]),_:1}),t(e.TableHead,{class:"h-12 px-4 text-right align-middle font-medium text-muted-foreground"},{default:l(()=>[...a[7]||(a[7]=[o("Actions",-1)])]),_:1})]),_:1})]),_:1}),t(e.TableBody,{class:"[&_tr:last-child]:border-0"},{default:l(()=>[(u(!0),T(x,null,U(e.analysis?.interims,n=>(u(),S(e.TableRow,{key:n?.uid,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:l(()=>[t(e.TableCell,{class:"px-4 py-3 align-middle whitespace-nowrap text-sm text-foreground"},{default:l(()=>[o(f(n?.key),1)]),_:2},1024),t(e.TableCell,{class:"px-4 py-3 align-middle whitespace-nowrap text-sm text-foreground"},{default:l(()=>[o(f(n?.value),1)]),_:2},1024),t(e.TableCell,{class:"px-4 py-3 align-middle whitespace-nowrap text-sm text-foreground"},{default:l(()=>[o(f(e.instrumentName(n?.instrumentUid)),1)]),_:2},1024),t(e.TableCell,{class:"px-4 py-3 align-middle text-right"},{default:l(()=>[t(e.Button,{variant:"outline",size:"sm",onClick:i=>e.FormManager(!1,n)},{default:l(()=>[...a[8]||(a[8]=[o(" Edit ",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),e.showModal?(u(),S(e.Modal,{key:0,onClose:a[2]||(a[2]=n=>e.showModal=!1),contentWidth:"w-2/4"},{header:l(()=>[d("h3",pe,f(e.formTitle),1)]),body:l(()=>[d("form",{onSubmit:a[1]||(a[1]=te((...n)=>e.saveForm&&e.saveForm(...n),["prevent"])),class:"p-6 space-y-6"},[d("div",we,[d("div",Ce,[t(e.FormField,{name:"instrumentUid"},{default:l(({componentField:n})=>[t(e.FormItem,null,{default:l(()=>[t(e.FormLabel,null,{default:l(()=>[...a[9]||(a[9]=[o("Instrument",-1)])]),_:1}),t(e.FormControl,null,{default:l(()=>[t(e.Select,{"model-value":n.modelValue||e.SELECT_NONE,"onUpdate:modelValue":e.onInstrumentChange},{default:l(()=>[t(e.SelectTrigger,null,{default:l(()=>[t(e.SelectValue,{placeholder:"Select Instrument"})]),_:1}),t(e.SelectContent,null,{default:l(()=>[t(e.SelectItem,{value:e.SELECT_NONE},{default:l(()=>[...a[10]||(a[10]=[o("Select Instrument",-1)])]),_:1}),(u(!0),T(x,null,U(e.instruments,i=>(u(),S(e.SelectItem,{key:i?.uid,value:i.uid},{default:l(()=>[o(f(i?.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1}),t(e.FormField,{name:"key"},{default:l(({componentField:n})=>[t(e.FormItem,null,{default:l(()=>[t(e.FormLabel,null,{default:l(()=>[...a[11]||(a[11]=[o("Interim",-1)])]),_:1}),t(e.FormControl,null,{default:l(()=>[t(e.Input,B(n,{type:"number",placeholder:"Interim Key ..."}),null,16)]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1}),t(e.FormField,{name:"value"},{default:l(({componentField:n})=>[t(e.FormItem,null,{default:l(()=>[t(e.FormLabel,null,{default:l(()=>[...a[12]||(a[12]=[o("Result",-1)])]),_:1}),t(e.FormControl,null,{default:l(()=>[t(e.Input,B(n,{placeholder:"Result Value ..."}),null,16)]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1})])]),d("div",ke,[t(e.Button,{type:"submit",class:"w-full"},{default:l(()=>[...a[13]||(a[13]=[o("Save Form",-1)])]),_:1})])],32)]),_:1})):ee("",!0)],64)}const Ye=$(Te,[["render",Me],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/analyses/services/InterimFields.vue"]]);export{Ye as default};
