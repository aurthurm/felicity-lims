import{S as Z,f as G,ai as J,a6 as Q,a0 as b,a1 as f,aj as W,h as ee,i as te,r as S,o as u,c,N as t,a as g,L as d,ad as m,M as w,H as C,a3 as se,C as p,Y as oe,a5 as n,y as ae,F as k,E as A,K as I,a2 as ne,X as M,A as le,Z as ie,$ as re,_ as de}from"./index-56caabce.js";import{u as ue,a as fe}from"./shipment-c66a8c93.js";import{c as ce,b as R,a as T,u as me,e as v}from"./array-956ab147.js";const pe={class:"space-y-6"},be={class:"flex items-center space-x-4 mb-4"},ge={class:"bg-card rounded-lg shadow-sm p-6"},ve={class:"flex"},he={key:0,class:"bg-destructive/10 text-destructive p-4 rounded-md mb-4"},ye={class:"list-disc list-inside space-y-1"},xe={action:"post",class:"space-y-6"},_e={class:"grid grid-cols-3 gap-6"},Se={class:"col-span-1"},we={class:"block space-y-1.5"},Ce=["value"],ke={class:"col-span-1"},Me={class:"block space-y-1.5"},Le={class:"col-span-1"},Be={class:"block space-y-1.5"},Ne={class:"block space-y-1.5"},Ue={class:"border-t border-border pt-4"},Ae=Z({__name:"ShipmentListing",setup(Ie){const V=ie(()=>re(()=>import("./FelDataTable-10e10bd5.js"),["assets/FelDataTable-10e10bd5.js","assets/index-56caabce.js","assets/index-f2df9813.css"])),l=ue(),{withClientMutation:D}=G(),{shipments:L,fetchingShipments:F,shipmentPageInfo:B}=J(l);Q();let r=b(!1);const i=b(!1),E=b([{name:"All",value:""},{name:"Due",value:"due"},{name:"Awaiting",value:"awaiting"},{name:"Failed",value:"failed"}]),P=b([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Shipment Id",value:"shipmentId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(a,e){return f(W,{to:{name:"shipment-detail",params:{shipmentUid:a?.uid}},innerHTML:a?.shipmentId})}},{name:"External Laboratory",value:"laboratory.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Courier",value:"courier",sortable:!1,sortBy:"asc",hidden:!1},{name:"Flow Detail",value:"",sortable:!1,sortBy:"asc",hidden:!1},{name:"Assigned Count",value:"assignedCount",sortable:!1,sortBy:"asc",hidden:!1},{name:"Current Status",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(a,e){return f("button",{type:"button",class:"bg-primary text-primary-foreground py-1 px-2 rounded-sm leading-none",innerHTML:a?.state||"unknown"})}},{name:"",value:"",sortable:!1,showInToggler:!1,hidden:!1,customRender:function(a,e){return a.incoming?f("span",{class:"text-success"},f("i",{class:"fa fa-reply-all"})):f("span",{class:"text-destructive"},f("i",{class:"fa fa-share-from-square"}))}}]);l.removeShipment();let o=ee({first:25,before:"",incoming:i.value,status:"",text:"",sort:["-uid"],filterAction:!1});l.fetchShipments(o),l.fetchReferralLaboratories();const $=ce({laboratoryUid:R().required("Laboratory is Required").typeError("Laboratory is Required"),comment:T().nullable(),courier:T().required("Courier is required"),count:R()}),{handleSubmit:q,errors:N}=me({validationSchema:$,initialValues:{laboratoryUid:void 0,comment:"",courier:"",count:1}}),{value:h}=v("laboratoryUid"),{value:y}=v("comment"),{value:x}=v("courier"),{value:_}=v("count"),O=q(a=>{r.value=!1,D(fe,{payload:a},"createShipment").then(e=>{l.addShipment(e),r.value=!1})});function H(a){o.first=a.fetchCount,o.before=B?.value?.endCursor??"",o.text=a.filterText,o.status=a.filterStatus,o.incoming=i.value,o.filterAction=!1,l.fetcShipments(o)}function j(a){o.first=25,o.before="",o.text=a.filterText,o.status=a.filterStatus,o.incoming=i.value,o.filterAction=!0,l.clearShipment(),l.fetcShipments(o)}const z=te(()=>L?.value?.length+" of "+l.getShipmentCount+" Shipments");return(a,e)=>{const U=S("fel-button"),K=S("fel-heading"),X=S("fel-modal");return u(),c(k,null,[t("div",pe,[g(K,{title:"Shipments"},{default:d(()=>[g(U,{onClick:e[0]||(e[0]=s=>m(r)?r.value=!0:r=!0)},{default:d(()=>e[9]||(e[9]=[w("Create New")])),_:1})]),_:1}),t("div",be,[g(U,{onClick:e[1]||(e[1]=s=>i.value=!i.value),class:se([i.value?"bg-primary text-primary-foreground hover:bg-primary/90":"bg-secondary text-secondary-foreground hover:bg-secondary/80"]),"aria-pressed":i.value},{default:d(()=>[w(C(i.value?"Incoming":"Outgoing"),1)]),_:1},8,["class","aria-pressed"])]),t("div",ge,[g(n(V),{columns:P.value,data:n(L),toggleColumns:!0,loading:n(F),paginable:!0,pageMeta:{fetchCount:n(o).first,hasNextPage:n(B)?.hasNextPage,countNone:z.value},searchable:!0,filterable:!0,filterMeta:{defaultFilter:n(o).status,filters:E.value},onOnSearch:j,onOnPaginate:H,selectable:!1},{"pre-filter":d(()=>[t("label",ve,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=s=>i.value=s)},null,512),[[oe,i.value]]),e[10]||(e[10]=w()),e[11]||(e[11]=t("span",{class:"mx-2"},"InBound",-1))])]),footer:d(()=>e[12]||(e[12]=[])),_:1},8,["columns","data","loading","pageMeta","filterMeta"])])]),n(r)?(u(),ae(X,{key:0,onClose:e[8]||(e[8]=s=>m(r)?r.value=!1:r=!1)},{header:d(()=>e[13]||(e[13]=[t("h3",{class:"text-lg font-medium leading-6 text-foreground"},"Create New Shipment",-1)])),validation:d(()=>[n(N).length?(u(),c("div",he,[t("ul",ye,[(u(!0),c(k,null,A(n(N),(s,Y)=>(u(),c("li",{key:Y,class:"text-sm"},C(s),1))),128))])])):I("v-if",!0)]),body:d(()=>[t("form",xe,[t("div",_e,[t("div",Se,[t("label",we,[e[14]||(e[14]=t("span",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},"External Laboratory",-1)),p(t("select",{class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","onUpdate:modelValue":e[3]||(e[3]=s=>m(h)?h.value=s:null)},[(u(!0),c(k,null,A(n(l).laboratories,s=>(u(),c("option",{key:s.uid,value:s.uid},C(s.name),9,Ce))),128))],512),[[ne,n(h)]])])]),t("div",ke,[t("label",Me,[e[15]||(e[15]=t("span",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},"Courier",-1)),p(t("input",{type:"text",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","onUpdate:modelValue":e[4]||(e[4]=s=>m(x)?x.value=s:null)},null,512),[[M,n(x)]])])]),t("div",Le,[t("label",Be,[e[16]||(e[16]=t("span",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},"How Many",-1)),p(t("input",{type:"number",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","onUpdate:modelValue":e[5]||(e[5]=s=>m(_)?_.value=s:null),min:"1",default:"1"},null,512),[[M,n(_)]])])])]),t("div",null,[t("label",Ne,[e[17]||(e[17]=t("span",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},"Comment",-1)),p(t("textarea",{class:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",rows:"2",placeholder:"Notes ...","onUpdate:modelValue":e[6]||(e[6]=s=>m(y)?y.value=s:null)},null,512),[[M,n(y)]])])]),t("div",Ue,[t("button",{type:"button",onClick:e[7]||(e[7]=le(s=>n(O)(),["prevent"])),class:"inline-flex w-full items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4"}," Create Shipment ")])])]),_:1})):I("v-if",!0)],64)}}}),De=de(Ae,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/shipment/ShipmentListing.vue"]]);export{De as default};
