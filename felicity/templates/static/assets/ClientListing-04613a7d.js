import{d as X,I as Y,r as u,at as Z,au as ee,s as B,n as P,p as te,o as i,c,g as E,f as l,e as m,L as se,b as s,z as _,y as oe,t as b,v as T,i as g,F as h,C as y,ad as k,w as le,B as ne,j as A,_ as N,k as ae}from"./index-b31857b9.js";import ie from"./FelModal-aa713485.js";import{A as re,E as ue}from"./clients.mutations-667c65a1.js";import{u as ce}from"./client-9e130650.js";import{u as de}from"./location-b8593386.js";import{h as me,o as fe,a as pe}from"./constants-43d02f99.js";const ve=s("hr",null,null,-1),be={action:"post",class:"p-1"},he={class:"grid grid-cols-2 gap-x-4 mb-4"},Ce={class:"block col-span-1 mb-2"},_e=s("span",{class:"text-gray-700"},"Name",-1),ge={class:"block col-span-1 mb-2"},ye=s("span",{class:"text-gray-700"},"Code",-1),ke={class:"grid grid-cols-3 gap-x-4 mb-4"},xe={class:"block col-span-1 mb-2"},we=s("span",{class:"text-gray-700"},"Country",-1),Ue=s("option",null,null,-1),De=["value"],Be={class:"block col-span-1 mb-2"},Pe=s("span",{class:"text-gray-700"},"Province",-1),Ee=s("option",null,null,-1),Te=["value"],Ae={class:"block col-span-1 mb-2"},Ne=s("span",{class:"text-gray-700"},"District",-1),Ie=s("option",null,null,-1),Le=["value"],Me=s("hr",null,null,-1),Se=X({__name:"ClientListing",setup(Ve){const I=A(()=>N(()=>import("./FelDataTable-0abd4631.js"),["assets/FelDataTable-0abd4631.js","assets/index-b31857b9.js","assets/index-c2286288.css"])),L=A(()=>N(()=>import("./FelPageHeading-78c628fc.js"),["assets/FelPageHeading-78c628fc.js","assets/index-b31857b9.js","assets/index-c2286288.css"])),r=ce(),v=de(),{withClientMutation:x}=Y(),M=u([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Client Name",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(o,t){return Z(ee,{to:{name:"client-detail",query:{clientUid:o?.uid}},class:"px-1 ml-2 border-white border text-gray-500rounded-smtransition duration-300 hover:border-sky-800 hover:text-sky-800 focus:outline-none",innerHTML:o?.name})}},{name:"Client ID",value:"code",sortable:!1,sortBy:"asc",hidden:!1},{name:"District",value:"district.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Province",value:"district.province.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Mobile Number",value:"mobilePhone",sortable:!1,sortBy:"asc",hidden:!1},{name:"Email Asdress",value:"email",sortable:!1,sortBy:"asc",hidden:!1}]),{countries:S,provinces:V,districts:R}=B(v),{clients:w,clientPageInfo:U,fetchingClients:O}=B(r);let d=u(!1),C=u(!1),F=u(""),n=P({});const D=u(""),j=()=>Object.assign(n,{});let a=P({first:50,after:"",text:"",sortBy:["uid"],filterAction:!1}),f=u(),p=u();r.fetchClients(a),v.fetchCountries();function H(){x(re,{payload:{name:n.name,code:n.code,districtUid:n.districtUid}},"createClient").then(o=>r.addClient(o))}function q(){x(ue,{uid:n.uid,payload:{name:n.name,code:n.code,districtUid:n.districtUid}},"updateClient").then(o=>r.updateClient(o))}function z(o){v.filterProvincesByCountry(f.value)}function K(o){v.filterDistrictsByProvince(p.value)}function $(o){a.first=100,a.after="",a.text=o.filterText,a.filterAction=!0,r.fetchClients(a)}function G(o){a.first=o.fetchCount,a.after=U?.value?.endCursor,a.text=o.filterText,a.filterAction=!1,r.fetchClients(a)}function J(o,t,e={}){C.value=o,F.value=t,D.value=(o?"CREATE":"EDIT")+" "+t.toUpperCase(),t=="client"&&(d.value=!0),o?t=="client"&&Object.assign(n,{}):t=="client"&&Object.assign(n,{...e})}function Q(){C.value&&H(),C.value||q(),d.value=!1}const W=te(()=>w?.value?.length+" of "+r.getClientCount+" clients");return(o,t)=>(i(),c(h,null,[E(l(L),{title:"Clients"}),m(s("button",{class:"p-2 my-2 text-sm border-sky-800 border text-dark-700 transition-colors duration-150 rounded-sm focus:outline-none hover:bg-sky-800 hover:text-gray-100",onClick:t[0]||(t[0]=e=>J(!0,"client"))}," Add client ",512),[[se,me(pe.CREATE,fe.CLIENT)]]),ve,E(l(I),{columns:M.value,data:l(w),toggleColumns:!0,loading:l(O),paginable:!0,pageMeta:{fetchCount:l(a).first,hasNextPage:l(U)?.hasNextPage,countNone:W.value},searchable:!0,filterable:!1,onOnSearchKeyUp:$,onOnSearchFocus:j,onOnPaginate:G,selectable:!1},{footer:_(()=>[]),_:1},8,["columns","data","loading","pageMeta"]),l(d)?(i(),oe(ie,{key:0,onClose:t[9]||(t[9]=e=>g(d)?d.value=!1:d=!1)},{header:_(()=>[s("h3",null,b(D.value),1)]),body:_(()=>[s("form",be,[s("div",he,[s("label",Ce,[_e,m(s("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":t[1]||(t[1]=e=>l(n).name=e),placeholder:"Name ..."},null,512),[[T,l(n).name]])]),s("label",ge,[ye,m(s("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":t[2]||(t[2]=e=>l(n).code=e),placeholder:"Code ..."},null,512),[[T,l(n).code]])])]),s("div",ke,[s("label",xe,[we,m(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":t[3]||(t[3]=e=>g(f)?f.value=e:f=e),onChange:t[4]||(t[4]=e=>z(e))},[Ue,(i(!0),c(h,null,y(l(S),e=>(i(),c("option",{key:e.uid,value:e.uid},b(e.name),9,De))),128))],544),[[k,l(f)]])]),s("label",Be,[Pe,m(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":t[5]||(t[5]=e=>g(p)?p.value=e:p=e),onChange:t[6]||(t[6]=e=>K(e))},[Ee,(i(!0),c(h,null,y(l(V),e=>(i(),c("option",{key:e.uid,value:e.uid},b(e.name),9,Te))),128))],544),[[k,l(p)]])]),s("label",Ae,[Ne,m(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":t[7]||(t[7]=e=>l(n).districtUid=e)},[Ie,(i(!0),c(h,null,y(l(R),e=>(i(),c("option",{key:e.uid,value:e.uid},b(e.name),9,Le))),128))],512),[[k,l(n).districtUid]])])]),Me,s("button",{type:"button",onClick:t[8]||(t[8]=le(e=>Q(),["prevent"])),class:"-mb-4 w-full border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):ne("",!0)],64))}}),ze=ae(Se,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/client/ClientListing.vue"]]);export{ze as default};
