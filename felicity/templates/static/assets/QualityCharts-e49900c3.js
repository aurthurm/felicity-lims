import{d as q,I as Q,q as j,p as D,r as i,P as V,m as B,o as u,c,b as v,g as d,f as r,i as x,F as A,A as F,C as I,j as f,aD as b,_ as h,k as M}from"./index-52cc981d.js";import{u as O}from"./analysis-ba15cd19.js";const N={class:"min-h-[500px]"},U={class:"flex justify-between"},z={class:"flex justify-start items-center gap-x-2"},G=v("hr",{class:"my-4"},null,-1),H=q({__name:"QualityCharts",setup(J){const k=f(()=>h(()=>import("./vue-multiselect.esm-3b8e4a11.js"),["assets/vue-multiselect.esm-3b8e4a11.js","assets/index-52cc981d.js","assets/index-8ef91573.css"])),w=f(()=>h(()=>import("./FelPageHeading-05abdbbe.js"),["assets/FelPageHeading-05abdbbe.js","assets/index-52cc981d.js","assets/index-8ef91573.css"])),P=f(()=>h(()=>import("./ChartLJ-e2aaca3c.js"),["assets/ChartLJ-e2aaca3c.js","assets/index-52cc981d.js","assets/index-8ef91573.css","assets/index-2ba0f5c9.js"])),y=O(),{withClientQuery:_}=Q();j(()=>{y.fetchAnalysesServices({})});const L=D(()=>y.getAnalysesServicesSimple),o=i([]),m=new Date;let l=i({month:m.getMonth(),year:m.getFullYear()}),n=i(null);const p=i(!1),S=async e=>{if(!l.value)return;const t={analyses:[e.uid],month:l.value.month+1,year:l.value.year};await _(b,t,"qcChartData").then(s=>{o.value=s??[]}).finally(()=>p.value=!1)},g=async e=>{if(!n.value)return;const t={analyses:[n.value?.uid],month:e.month+1,year:e.year};await _(b,t,"qcChartData").then(s=>{o.value=s??[]}).finally(()=>p.value=!1)},C=D(()=>{if(!o.value)return[];const e=R(E(o.value));return console.log("converted: ",e),e});function E(e){return e.reduce((t,s)=>{const a=s.sample.qcLevel.level;return t[a]||(t[a]={results:[],dates:[]}),t[a].results.push(parseFloat(s.result)),t[a].dates.push(s.dateVerified),t},{})}function R(e){return Object.entries(e).map(([t,s])=>({name:t,data:s.results.map((a,T)=>({date:s.dates[T],value:a}))}))}return V(n,async e=>{e&&await S(e)}),V(l,async e=>{e&&await g(e)}),(e,t)=>{const s=B("VueDatePicker");return u(),c("div",N,[v("div",U,[d(r(w),{title:"Analyses Service Control Charts"}),v("div",z,[d(s,{class:"z-60 disabled:bg-slate-200",modelValue:r(l),"onUpdate:modelValue":t[0]||(t[0]=a=>x(l)?l.value=a:l=a),"max-date":r(m),"month-picker":""},null,8,["modelValue","max-date"]),d(r(k),{class:"max-w-[300px]",modelValue:r(n),"onUpdate:modelValue":t[1]||(t[1]=a=>x(n)?n.value=a:n=a),options:L.value,multiple:!1,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","options"])])]),G,C.value?.length==0?(u(),c(A,{key:0},[F(" The selected analysis has no data for the selected period. ")],64)):(u(!0),c(A,{key:1},I(C.value,a=>(u(),c("div",{class:"mb-4",key:a.name},[d(r(P),{title:a.name,series:a.data},null,8,["title","series"])]))),128))])}}}),W=M(H,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/qcontrol/QualityCharts.vue"]]);export{W as default};
