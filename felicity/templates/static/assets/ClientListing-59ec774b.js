import{P as Q,e as W,Z as u,a3 as ee,aj as te,ai as A,f as B,h as se,r as le,o as i,c as d,a as T,a2 as o,A as m,C as oe,b as s,K as k,x as ne,E as b,V as M,a7 as x,F as C,D as h,a4 as w,z as ae,J as ie,X as N,Y as S,_ as re}from"./index-f86d8273.js";import{A as ue,E as de}from"./clients.mutations-9980fcf1.js";import{u as ce}from"./client-6bf4b6ff.js";import{u as me}from"./location-556e8a7d.js";import{h as fe,o as pe,a as ve}from"./constants-bd793a40.js";const be={action:"post",class:"p-1"},Ce={class:"grid grid-cols-2 gap-x-4 mb-4"},ge={class:"block col-span-1 mb-2"},ye={class:"block col-span-1 mb-2"},ke={class:"grid grid-cols-3 gap-x-4 mb-4"},xe={class:"block col-span-1 mb-2"},he=["value"],we={class:"block col-span-1 mb-2"},Ue=["value"],De={class:"block col-span-1 mb-2"},Pe=["value"],Ee=Q({__name:"ClientListing",setup(Ae){const V=N(()=>S(()=>import("./FelDataTable-81fd0c3c.js"),["assets/FelDataTable-81fd0c3c.js","assets/index-f86d8273.js","assets/index-ba19faea.css"])),I=N(()=>S(()=>import("./index-f86d8273.js").then(l=>l.cM),["assets/index-f86d8273.js","assets/index-ba19faea.css"])),r=ce(),v=me(),{withClientMutation:U}=W(),L=u([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Client Name",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(l,e){return ee(te,{to:{name:"client-detail",query:{clientUid:l?.uid}},class:"px-1 ml-2 border-white border text-gray-500rounded-smtransition duration-300 hover:border-sky-800 hover:text-sky-800 focus:outline-none",innerHTML:l?.name})}},{name:"Client ID",value:"code",sortable:!1,sortBy:"asc",hidden:!1},{name:"District",value:"district.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Province",value:"district.province.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Mobile Number",value:"mobilePhone",sortable:!1,sortBy:"asc",hidden:!1},{name:"Email Asdress",value:"email",sortable:!1,sortBy:"asc",hidden:!1}]),{countries:_,provinces:R,districts:O}=A(v),{clients:D,clientPageInfo:P,fetchingClients:F}=A(r);let c=u(!1),g=u(!1),j=u(""),n=B({});const E=u(""),H=()=>Object.assign(n,{});let a=B({first:50,after:"",text:"",sortBy:["uid"],filterAction:!1}),f=u(),p=u();r.fetchClients(a),v.fetchCountries();function K(){U(ue,{payload:{name:n.name,code:n.code,districtUid:n.districtUid}},"createClient").then(l=>r.addClient(l))}function q(){U(de,{uid:n.uid,payload:{name:n.name,code:n.code,districtUid:n.districtUid}},"updateClient").then(l=>r.updateClient(l))}function z(l){v.filterProvincesByCountry(f.value)}function J(l){v.filterDistrictsByProvince(p.value)}function X(l){a.first=100,a.after="",a.text=l.filterText,a.filterAction=!0,r.fetchClients(a)}function Y(l){a.first=l.fetchCount,a.after=P?.value?.endCursor,a.text=l.filterText,a.filterAction=!1,r.fetchClients(a)}function Z(l,e,y={}){g.value=l,j.value=e,E.value=(l?"CREATE":"EDIT")+" "+e.toUpperCase(),e=="client"&&(c.value=!0),l?e=="client"&&Object.assign(n,{}):e=="client"&&Object.assign(n,{...y})}function $(){g.value&&K(),g.value||q(),c.value=!1}const G=se(()=>D?.value?.length+" of "+r.getClientCount+" clients");return(l,e)=>{const y=le("modal");return i(),d(C,null,[T(o(I),{title:"Clients"}),m(s("button",{class:"p-2 my-2 text-sm border-sky-800 border text-dark-700 transition-colors duration-150 rounded-sm focus:outline-none hover:bg-sky-800 hover:text-gray-100",onClick:e[0]||(e[0]=t=>Z(!0,"client"))}," Add client ",512),[[oe,fe(ve.CREATE,pe.CLIENT)]]),e[20]||(e[20]=s("hr",null,null,-1)),T(o(V),{columns:L.value,data:o(D),toggleColumns:!0,loading:o(F),paginable:!0,pageMeta:{fetchCount:o(a).first,hasNextPage:o(P)?.hasNextPage,countNone:G.value},searchable:!0,filterable:!1,onOnSearchKeyUp:X,onOnSearchFocus:H,onOnPaginate:Y,selectable:!1},{footer:k(()=>e[10]||(e[10]=[])),_:1},8,["columns","data","loading","pageMeta"]),o(c)?(i(),ne(y,{key:0,onClose:e[9]||(e[9]=t=>x(c)?c.value=!1:c=!1)},{header:k(()=>[s("h3",null,b(E.value),1)]),body:k(()=>[s("form",be,[s("div",Ce,[s("label",ge,[e[11]||(e[11]=s("span",{class:"text-gray-700"},"Name",-1)),m(s("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":e[1]||(e[1]=t=>o(n).name=t),placeholder:"Name ..."},null,512),[[M,o(n).name]])]),s("label",ye,[e[12]||(e[12]=s("span",{class:"text-gray-700"},"Code",-1)),m(s("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":e[2]||(e[2]=t=>o(n).code=t),placeholder:"Code ..."},null,512),[[M,o(n).code]])])]),s("div",ke,[s("label",xe,[e[14]||(e[14]=s("span",{class:"text-gray-700"},"Country",-1)),m(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[3]||(e[3]=t=>x(f)?f.value=t:f=t),onChange:e[4]||(e[4]=t=>z(t))},[e[13]||(e[13]=s("option",null,null,-1)),(i(!0),d(C,null,h(o(_),t=>(i(),d("option",{key:t.uid,value:t.uid},b(t.name),9,he))),128))],544),[[w,o(f)]])]),s("label",we,[e[16]||(e[16]=s("span",{class:"text-gray-700"},"Province",-1)),m(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[5]||(e[5]=t=>x(p)?p.value=t:p=t),onChange:e[6]||(e[6]=t=>J(t))},[e[15]||(e[15]=s("option",null,null,-1)),(i(!0),d(C,null,h(o(R),t=>(i(),d("option",{key:t.uid,value:t.uid},b(t.name),9,Ue))),128))],544),[[w,o(p)]])]),s("label",De,[e[18]||(e[18]=s("span",{class:"text-gray-700"},"District",-1)),m(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[7]||(e[7]=t=>o(n).districtUid=t)},[e[17]||(e[17]=s("option",null,null,-1)),(i(!0),d(C,null,h(o(O),t=>(i(),d("option",{key:t.uid,value:t.uid},b(t.name),9,Pe))),128))],512),[[w,o(n).districtUid]])])]),e[19]||(e[19]=s("hr",null,null,-1)),s("button",{type:"button",onClick:e[8]||(e[8]=ae(t=>$(),["prevent"])),class:"-mb-4 w-full border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):ie("",!0)],64)}}}),Ve=re(Ee,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/client/ClientListing.vue"]]);export{Ve as default};
