import{d as F,aa as E,aK as V,aL as j,s as z,x as O,z as R,o as r,c as d,f as p,g as C,e as P,F as m,E as g,b as i,t as a,D as b,aG as l,j as G,_ as I,k as K}from"./index-4d0d48ab.js";const M={class:"relative mt-4"},q=i("div",{class:"border-r-2 border-gray-400 border-dotted absolute h-full top-0 z-0",style:{left:"7px"}},null,-1),H={key:0,class:"py-4 text-center"},J={key:1,initial:{opacity:0,y:100},enter:{opacity:1,y:0,scale:1},variants:{custom:{scale:2}},delay:200,class:"list-none m-0 p-0"},Q={class:"flex items-center mb-1"},W=i("div",{class:"bg-indigo-600 rounded-full h-4 w-4 border-gray-200 border-2 z-10"},null,-1),X={class:"ml-4 font-medium italic"},Y={class:"ml-12 w-100"},Z={class:"col-span-1"},$={class:"text-sm text-gray-600 italic"},v={class:"col-span-3"},k={class:"text-muted text-xs text-orange-600"},B={class:"text-muted text-xs text-sky-800"},A=F({__name:"FelAuditLog",props:{targetUid:String,targetType:String},setup(h){const x=G(()=>I(()=>import("./FelLoadingMessage-e29e7357.js"),["assets/FelLoadingMessage-e29e7357.js","assets/index-4d0d48ab.js","assets/index-c2286288.css"])),y=h,{targetType:L,targetUid:S}=E(y),f=V(),u=j();u.restLogs();const{auditLogs:D,fetchingAudits:U}=z(u);f.fetchUsers({}),u.fetchAuditLogs({targetType:L?.value,targetUid:S?.value});let w=O(()=>f.getUsers);function n(o){const c=w?.value?.find(_=>_.uid?.toString()===o?.toString());return c?c.userName:""}function T(o){return o===1?"created":o===2?"updated":o===3?"deleted":""}function N(o){let c=new Set;return Object.entries(o?.stateBefore)?.map(([_,e])=>{Object.entries(o?.stateAfter)?.map(([t,s])=>{_===t&&e!==s&&(t&&t==="updated_by_uid"&&(t="updated_by",e=n(e),s=n(s)),t&&t==="submitted_by_uid"&&(t="submitted_by",e=n(e),s=n(s)),t&&t==="verified_by_uid"&&(t="verified_by",e=n(e),s=n(s)),t&&t==="updated_at"&&(t="updated_on",e=l(e),s=l(s)),t&&t==="cancelled_by_uid"&&(t="cancelled_by",e=n(e),s=n(s)),t&&t==="received_by_uid"&&(t="received_by",e=n(e),s=n(s)),c.add({key:t,old:e?.length>0?e:"None",new:s?.toString()?.length>0?s:"None"}))})}),c}return(o,c)=>{const _=R("motion");return r(),d("div",M,[q,p(U)?(r(),d("div",H,[C(p(x),{message:"Fetching audit logs ..."})])):P((r(),d("ul",J,[(r(!0),d(m,null,g(p(D),e=>(r(),d("li",{key:e.uid,class:"mb-2"},[i("div",Q,[W,i("div",X,[i("span",null,a(n(e?.userUid))+" "+a(T(e?.action))+" "+a(e?.targetType),1),b(" on "),i("span",null,a(p(l)(e?.stateAfter?.updated_at)),1)])]),i("div",Y,[(r(!0),d(m,null,g(N(e),t=>(r(),d("div",{key:t.key,class:"grid grid-cols-4"},[i("span",Z,[i("span",$,a(t?.key),1)]),i("span",v,[i("span",k,a(t?.old),1),b(" â†’ "),i("span",B,a(t?.new),1)])]))),128))])]))),128))])),[[_]])])}}}),et=K(A,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/audit/FelAuditLog.vue"]]);export{et as default};
