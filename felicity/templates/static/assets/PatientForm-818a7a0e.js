import{S as xe,f as Ue,V as ye,a6 as Ne,h as W,i as q,a7 as De,t as Pe,a0 as E,al as Me,r as he,o as m,c as p,N as t,C as o,X as f,a5 as s,ac as d,H as n,Y as J,D as Se,a as Q,a2 as h,F as x,E as U,A as Z,e as Ve,_ as Ie}from"./index-6c3e61f6.js";import Ce from"./vue-multiselect.esm-78b2b2be.js";import{c as ee,b as S,a as b,f as Be,g as te,u as qe,e as r}from"./array-c7a86e05.js";import{A as Ee,E as ke}from"./patient.mutations-f61038db.js";import{u as Oe}from"./client-15762689.js";import{u as _e}from"./location-3008fd14.js";import{u as Fe}from"./patient-a41317bf.js";import{f as Ye}from"./index-1ec5ed02.js";/* empty css                                                                 */const $e={class:"flex whitespace-nowrap w-full"},Ae={class:"w-full"},Re={class:"text-destructive w-4/12",role:"alert"},je={class:"flex whitespace-nowrap w-full"},He={class:"w-full"},Le={class:"text-destructive w-4/12",role:"alert"},Ge={class:"flex whitespace-nowrap mb-2 w-full"},Te={class:"w-full"},Ke={class:"text-destructive w-4/12",role:"alert"},Xe={class:"flex whitespace-nowrap w-full"},ze={class:"w-full"},We={class:"text-destructive w-4/12",role:"alert"},Je={class:"flex whitespace-nowrap my-2 w-full"},Qe={class:"w-full flex justify-between items-center"},Ze={class:"flex justify-start items-center gap-x-2 ml-4"},et={for:"estimateYears"},tt={for:"estimateMonths"},lt={for:"estimateDays"},it={class:"text-destructive w-4/12",role:"alert"},st={class:"flex whitespace-nowrap mb-2 w-full"},at={class:"w-full"},nt={class:"text-destructive w-4/12",role:"alert"},ot={class:"flex whitespace-nowrap mb-2 w-full"},rt={class:"w-full"},ut={class:"text-destructive w-4/12",role:"alert"},dt={class:"flex whitespace-nowrap mb-2 w-full"},mt={class:"w-full"},pt=["value"],ft={class:"text-destructive w-4/12",role:"alert"},ct={class:"flex whitespace-nowrap mb-2 w-full"},vt={class:"w-full"},bt={class:"text-destructive w-4/12",role:"alert"},wt={class:"flex whitespace-nowrap mb-2 w-full"},gt={class:"w-full"},xt={class:"text-destructive w-4/12",role:"alert"},Ut={class:"flex whitespace-nowrap mb-2 w-full"},yt={class:"w-full"},Nt={class:"text-destructive w-4/12",role:"alert"},Dt={class:"flex whitespace-nowrap mb-2 w-full"},Pt={class:"text-foreground w-4/12 flex justify-between items-center"},Mt={class:"w-full border-border"},ht=["onUpdate:modelValue","aria-label"],St=["value"],Vt=["onUpdate:modelValue","aria-label"],It=["onClick","aria-label"],Ct={class:"grid grid-cols-3 gap-x-4 mb-4"},Bt={class:"col-span-1"},qt={class:"flex gap-x-2 items-center whitespace-nowrap w-full"},Et=["value"],kt={class:"text-destructive w-4/12",role:"alert"},Ot={class:"col-span-1"},_t={class:"flex gap-x-2 items-center whitespace-nowrap col-span-1 w-full"},Ft=["value"],Yt={class:"text-destructive w-4/12",role:"alert"},$t={class:"col-span-1"},At={class:"flex gap-x-2 items-center whitespace-nowrap col-span-1 w-full"},Rt=["value"],jt={class:"text-destructive w-4/12",role:"alert"},Ht=xe({__name:"PatientForm",props:{patient:{type:Object,required:!1},navigate:{type:Boolean,required:!1,default:!1}},emits:["close"],setup(le,{emit:ie}){const y=le,T=ie;let K=Oe(),c=_e(),V=Fe();const{withClientMutation:X}=Ue();let se=ye(),ae=Ne();const N=W({genders:["Male","Female","Missing","Trans Gender"],createAction:!0,countries:q(()=>c.getCountries),provinces:q(()=>c.getProvinces),districts:q(()=>c.getDistricts),clients:q(()=>K.getClients)});let ne=W({first:void 0,after:"",text:"",sortBy:["name"],filterAction:!1});De(async()=>{await c.fetchCountries(),await K.fetchClients(ne),y.patient?.countryUid&&await c.filterProvincesByCountry(y.patient?.countryUid),y.patient?.provinceUid&&await c.filterDistrictsByProvince(y.patient?.provinceUid),await V.fetchIdentifications()});const{patient:a,navigate:oe}=Pe(y),re=E(new Date),I=E(0),k=E(0),O=E(0),w=()=>{const i=Ve().subtract(I.value,"year").subtract(k.value,"month").subtract(O.value,"day");g.value=i.format("YYYY-MM-DD"),D.value=I.value},ue=()=>{var i=new Date().getFullYear();if(g.value){const e=new Date(g.value).getFullYear();D.value=i-e}},de=ee({uid:S().nullable(),clientPatientId:b().required("Client Patient ID is Required"),patientId:b().nullable(),firstName:b().required("First Name is Required"),middleName:b().nullable(),lastName:b().required("Last Name is Required"),client:ee().required("Client is Required"),gender:b().required("Gender is Required"),age:S().nullable(),dateOfBirth:Be().nullable(),ageDobEstimated:te().nullable(),phoneHome:b().nullable(),phoneMobile:b().nullable(),consentSms:te().nullable(),districtUid:S().nullable(),provinceUid:S().nullable(),countryUid:S().nullable()}),{handleSubmit:me,errors:u}=qe({validationSchema:de,initialValues:{uid:a?.value?.uid,clientPatientId:a?.value?.clientPatientId||ae?.query?.cpid,patientId:a?.value?.patientId,firstName:a?.value?.firstName,middleName:a?.value?.middleName,lastName:a?.value?.lastName,client:a?.value?.client,gender:a?.value?.gender,age:a?.value?.age,dateOfBirth:Me(a?.value?.dateOfBirth)?void 0:new Date(a?.value?.dateOfBirth).toISOString().split("T")[0],ageDobEstimated:a?.value?.ageDobEstimated,phoneHome:a?.value?.phoneHome,phoneMobile:a?.value?.phoneMobile,consentSms:a?.value?.consentSms,districtUid:a?.value?.districtUid,provinceUid:a?.value?.provinceUid,countryUid:a?.value?.countryUid,identifications:a?.value?.identifications??[]}}),{value:_}=r("clientPatientId"),{value:F}=r("firstName"),{value:Y}=r("middleName"),{value:$}=r("lastName"),{value:A}=r("client"),{value:R}=r("gender"),{value:D}=r("age"),{value:g}=r("dateOfBirth"),{value:P}=r("ageDobEstimated"),{value:j}=r("phoneMobile"),{value:H}=r("consentSms"),{value:L}=r("districtUid"),{value:C}=r("provinceUid"),{value:B}=r("countryUid"),{value:G}=r("identifications"),z=me(i=>{i.uid||pe(i),i.uid&&fe(i)});function pe(i){X(Ee,{payload:{clientPatientId:i.clientPatientId,firstName:i.firstName,middleName:i.middleName,lastName:i.lastName,age:i.age,gender:i.gender,dateOfBirth:Ye(i.dateOfBirth,"YYYY-MM-DD HH:mm"),ageDobEstimated:i.ageDobEstimated,clientUid:i.client.uid,phoneMobile:i.phoneMobile,consentSms:i.consentSms,countryUid:i.countryUid,provinceUid:i.provinceUid,districtUid:i.districtUid,identifications:i.identifications}},"createPatient").then(e=>{V.addPatient(e),T("close",e),oe.value===!0&&se.push({name:"patient-detail",params:{patientUid:e?.uid}})})}function fe(i){X(ke,{uid:i.uid,payload:{clientPatientId:i.clientPatientId,firstName:i.firstName,middleName:i.middleName,lastName:i.lastName,age:i.age,gender:i.gender,dateOfBirth:i.dateOfBirth?new Date(i.dateOfBirth).toISOString():null,ageDobEstimated:i.ageDobEstimated,clientUid:i.client.uid,phoneMobile:i.phoneMobile,consentSms:i.consentSms,countryUid:i.countryUid,provinceUid:i.provinceUid,districtUid:i.districtUid,identifications:i.identifications?.map(e=>({identificationUid:e.identificationUid,value:e.value}))}},"updatePatient").then(e=>{V.updatePatient(e),T("close",e)})}function ce(i){c.filterProvincesByCountry(B.value)}function ve(i){c.filterDistrictsByProvince(C.value)}function be(){G.value.push({identificationUid:"12122",value:""})}function we(i){G.value.splice(i,1)}return(i,e)=>{const ge=he("VueDatePicker");return m(),p("form",{onSubmit:e[27]||(e[27]=Z((...l)=>s(z)&&s(z)(...l),["prevent"])),autocomplete:"off",role:"form","aria-label":"Patient Information Form"},[t("label",$e,[e[28]||(e[28]=t("span",{class:"text-foreground w-4/12"},"Patient Unique Identifier",-1)),t("div",Ae,[o(t("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":e[0]||(e[0]=l=>d(_)?_.value=l:null),placeholder:"Patient Unique Identifier","aria-label":"Patient Unique Identifier","aria-required":"true"},null,512),[[f,s(_)]]),t("div",Re,n(s(u).clientPatientId),1)])]),t("label",je,[e[29]||(e[29]=t("span",{class:"text-foreground w-4/12"},"First Name",-1)),t("div",He,[o(t("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":e[1]||(e[1]=l=>d(F)?F.value=l:null),placeholder:"First Name","aria-label":"First Name","aria-required":"true"},null,512),[[f,s(F)]]),t("div",Le,n(s(u).firstName),1)])]),t("label",Ge,[e[30]||(e[30]=t("span",{class:"text-foreground w-4/12"},"Middle Name",-1)),t("div",Te,[o(t("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":e[2]||(e[2]=l=>d(Y)?Y.value=l:null),placeholder:"Middle Name","aria-label":"Middle Name"},null,512),[[f,s(Y)]]),t("div",Ke,n(s(u).middleName),1)])]),t("label",Xe,[e[31]||(e[31]=t("span",{class:"text-foreground w-4/12"},"Last Name",-1)),t("div",ze,[o(t("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":e[3]||(e[3]=l=>d($)?$.value=l:null),placeholder:"Last Name","aria-label":"Last Name","aria-required":"true"},null,512),[[f,s($)]]),t("div",We,n(s(u).lastName),1)])]),t("label",Je,[e[35]||(e[35]=t("span",{class:"text-foreground w-4/12"},"Age/DOB Estimated?",-1)),t("div",Qe,[o(t("input",{type:"checkbox",class:"form-checkbox text-primary","onUpdate:modelValue":e[4]||(e[4]=l=>d(P)?P.value=l:null),"aria-label":"Age/DOB Estimated"},null,512),[[J,s(P)]]),o(t("div",Ze,[t("label",et,[e[32]||(e[32]=t("span",{class:"mr-1"},"Years",-1)),o(t("input",{name:"estimateYears",type:"number",min:"0",class:"form-input w-24 py-0 text-primary","onUpdate:modelValue":e[5]||(e[5]=l=>I.value=l),onChange:e[6]||(e[6]=l=>w()),onKeyup:e[7]||(e[7]=l=>w()),"aria-label":"Estimated Years"},null,544),[[f,I.value]])]),t("label",tt,[e[33]||(e[33]=t("span",{class:"mr-1"},"Months",-1)),o(t("input",{name:"estimateMonths",type:"number",min:"0",max:"12",class:"form-input w-24 py-0 text-primary","onUpdate:modelValue":e[8]||(e[8]=l=>k.value=l),onChange:e[9]||(e[9]=l=>w()),onKeyup:e[10]||(e[10]=l=>w()),"aria-label":"Estimated Months"},null,544),[[f,k.value]])]),t("label",lt,[e[34]||(e[34]=t("span",{class:"mr-1"},"Days",-1)),o(t("input",{name:"estimateDays",type:"number",min:"0",max:"365",class:"form-input w-24 py-0 text-primary","onUpdate:modelValue":e[11]||(e[11]=l=>O.value=l),onChange:e[12]||(e[12]=l=>w()),onKeyup:e[13]||(e[13]=l=>w()),"aria-label":"Estimated Days"},null,544),[[f,O.value]])])],512),[[Se,s(P)]]),t("div",it,n(s(u).ageDobEstimated),1)])]),t("label",st,[e[36]||(e[36]=t("span",{class:"text-foreground w-4/12"},"Date of Birth",-1)),t("div",at,[Q(ge,{class:"z-60 disabled:bg-muted",modelValue:s(g),"onUpdate:modelValue":e[14]||(e[14]=l=>d(g)?g.value=l:null),disabled:s(P),onClosed:e[15]||(e[15]=l=>ue()),"max-date":re.value,"aria-label":"Date of Birth"},null,8,["modelValue","disabled","max-date"]),t("div",nt,n(s(u).dateOfBirth),1)])]),t("label",ot,[e[37]||(e[37]=t("span",{class:"text-foreground w-4/12"},"Age",-1)),t("div",rt,[o(t("input",{class:"form-input mt-1 w-full disabled:bg-muted",type:"number","onUpdate:modelValue":e[16]||(e[16]=l=>d(D)?D.value=l:null),placeholder:"Age",disabled:"","aria-label":"Age"},null,512),[[f,s(D)]]),t("div",ut,n(s(u).age),1)])]),t("label",dt,[e[39]||(e[39]=t("span",{class:"text-foreground w-4/12"},"Gender",-1)),t("div",mt,[o(t("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":e[17]||(e[17]=l=>d(R)?R.value=l:null),"aria-label":"Gender","aria-required":"true"},[e[38]||(e[38]=t("option",{value:""},null,-1)),(m(!0),p(x,null,U(N.genders,l=>(m(),p("option",{key:l,value:l},n(l),9,pt))),128))],512),[[h,s(R)]]),t("div",ft,n(s(u).gender),1)])]),t("label",ct,[e[40]||(e[40]=t("span",{class:"text-foreground w-4/12"},"Mobile Number",-1)),t("div",vt,[o(t("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":e[18]||(e[18]=l=>d(j)?j.value=l:null),placeholder:"Mobile Number","aria-label":"Mobile Number"},null,512),[[f,s(j)]]),t("div",bt,n(s(u).phoneMobile),1)])]),t("label",wt,[e[41]||(e[41]=t("span",{class:"text-foreground w-4/12"},"Consent to SMS",-1)),t("div",gt,[o(t("input",{type:"checkbox",class:"form-checkbox text-primary","onUpdate:modelValue":e[19]||(e[19]=l=>d(H)?H.value=l:null),"aria-label":"Consent to SMS"},null,512),[[J,s(H)]]),t("div",xt,n(s(u).consentSms),1)])]),t("label",Ut,[e[42]||(e[42]=t("span",{class:"text-foreground w-4/12"},"Primary Referrer",-1)),t("div",yt,[Q(s(Ce),{placeholder:"Select a Primary Referrer",modelValue:s(A),"onUpdate:modelValue":e[20]||(e[20]=l=>d(A)?A.value=l:null),options:N.clients,searchable:!0,label:"name","track-by":"uid","aria-label":"Primary Referrer","aria-required":"true"},null,8,["modelValue","options"]),t("div",Nt,n(s(u).client),1)])]),t("label",Dt,[t("span",Pt,[e[43]||(e[43]=t("span",{class:"mr-4"},"Extra Ids:",-1)),t("div",null,[t("button",{type:"button",class:"relative px-1 mr-2 mt-4 border-primary border text-primary rounded-sm transition duration-300 hover:bg-primary hover:text-primary-foreground focus:outline-none focus:ring-2 focus:ring-primary",onClick:e[21]||(e[21]=l=>be()),"aria-label":"Add Extra Identifier"}," Add ")])]),t("div",Mt,[(m(!0),p(x,null,U(s(G),(l,M)=>(m(),p("div",{class:"flex justify-around items-center w-full",key:M},[e[45]||(e[45]=t("span",null,"Identification",-1)),o(t("select",{class:"form-select mt-1","onUpdate:modelValue":v=>l.identificationUid=v,"aria-label":"Identification Type "+(M+1)},[e[44]||(e[44]=t("option",{value:""},null,-1)),(m(!0),p(x,null,U(s(V).identifications,v=>(m(),p("option",{key:v.uid,value:v.uid},n(v.name),9,St))),128))],8,ht),[[h,l.identificationUid]]),e[46]||(e[46]=t("span",null,"Value",-1)),o(t("input",{type:"text",class:"form-input text-primary","onUpdate:modelValue":v=>l.value=v,"aria-label":"Identification Value "+(M+1)},null,8,Vt),[[f,l.value]]),t("button",{type:"button",class:"p-2 text-destructive",onClick:Z(v=>we(M),["prevent"]),"aria-label":"Remove Identification "+(M+1)},"X",8,It)]))),128))])]),e[53]||(e[53]=t("hr",{class:"my-2"},null,-1)),t("div",Ct,[t("div",Bt,[t("label",qt,[e[48]||(e[48]=t("span",{class:"text-foreground w-4/12"},"Country",-1)),o(t("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":e[22]||(e[22]=l=>d(B)?B.value=l:null),onChange:e[23]||(e[23]=l=>ce()),"aria-label":"Country"},[e[47]||(e[47]=t("option",{value:null},null,-1)),(m(!0),p(x,null,U(N.countries,l=>(m(),p("option",{key:l.uid,value:l.uid},n(l.name),9,Et))),128))],544),[[h,s(B)]])]),t("div",kt,n(s(u).countryUid),1)]),t("div",Ot,[t("label",_t,[e[50]||(e[50]=t("span",{class:"text-foreground w-4/12"},"Province",-1)),o(t("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":e[24]||(e[24]=l=>d(C)?C.value=l:null),onChange:e[25]||(e[25]=l=>ve()),"aria-label":"Province"},[e[49]||(e[49]=t("option",{value:null},null,-1)),(m(!0),p(x,null,U(N.provinces,l=>(m(),p("option",{key:l.uid,value:l.uid},n(l.name),9,Ft))),128))],544),[[h,s(C)]])]),t("div",Yt,n(s(u).provinceUid),1)]),t("div",$t,[t("label",At,[e[52]||(e[52]=t("span",{class:"text-foreground w-4/12"},"District",-1)),o(t("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":e[26]||(e[26]=l=>d(L)?L.value=l:null),"aria-label":"District"},[e[51]||(e[51]=t("option",{value:null},null,-1)),(m(!0),p(x,null,U(N.districts,l=>(m(),p("option",{key:l.uid,value:l.uid},n(l.name),9,Rt))),128))],512),[[h,s(L)]])]),t("div",jt,n(s(u).districtUid),1)])]),e[54]||(e[54]=t("hr",null,null,-1)),e[55]||(e[55]=t("button",{type:"submit",class:"-mb-4 w-1/5 border border-primary bg-primary text-primary-foreground rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-primary focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Save Patient Information"}," Save Patient ",-1))],32)}}}),Zt=Ie(Ht,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/person/PatientForm.vue"]]);export{Zt as default};
