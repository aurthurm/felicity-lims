import{u as f,P as p,f as h,Q as y,k as d}from"./index-93739211.js";import{e as A,f as w,S as g,g as $,h as k,i as S}from"./analyses.mutations-e3a0ff1f.js";function W(){const r=f(),l=p(),{withClientMutation:u}=h(),{toastSuccess:i,toastError:o,swalConfirm:c}=d();return{submitResult:async s=>{if(s.status!=="pending"){o("Cannot submit non-pending analysis");return}try{if(!(await c("Are you sure you want to submit this result?","Submit Result")).isConfirmed)return;s.result=s.editResult;const t={uid:s.uid||"",result:s.result||"",laboratoryInstrumentUid:s.laboratoryInstrumentUid||"",methodUid:s.methodUid||""},a=await u(g,{analysisResults:[t],sourceObject:"sample",sourceObjectUid:s.sampleUid||""},"submitAnalysisResults");a?.isBackground?(r.backgroundProcessing([{uid:s.uid,result:s.result}],"","submitting"),l.backgroundProcessing([{uid:s.uid,result:s.result}],void 0,"submitting")):(r.updateAnalysesResults(a.results??[]),l.updateAnalysesResults(a.results??[])),a?.message&&i(a.message)}catch(e){o(`Failed to submit result: ${e instanceof Error?e.message:"Unknown error"}`)}},submitResults:async(s,e,t)=>{try{if((await c(`Are you sure you want to submit ${s.length} result${s.length>1?"s":""}?`,"Submit Results")).isConfirmed){const n=await u(g,{analysisResults:s,sourceObject:e,sourceObjectUid:t},"submitAnalysisResults");n?.isBackground?(r.backgroundProcessing(s,e===y.Sample?t:"","submitting"),l.backgroundProcessing(s,e===y.Worksheet?t:void 0,"submitting")):(e==y.Sample&&r.updateAnalysesResults(n.results??[]),e==y.Worksheet&&l.updateAnalysesResults(n.results??[])),n?.message&&i(n.message)}}catch(a){o(`Failed to submit results: ${a instanceof Error?a.message:"Unknown error"}`)}},cancelResults:async s=>{try{if((await c(`Are you sure you want to cancel ${s.length} analyte${s.length>1?"s":""}?`,"Cancel Analysis")).isConfirmed){const t=await u(A,{analyses:s},"cancelAnalysisResults");t?.results&&(r.updateAnalysesResultsStatus(t.results),l.updateWorksheetResultsStatus(t.results),i(`Successfully cancelled ${s.length} analyte${s.length>1?"s":""}`))}}catch(e){o(`Failed to cancel analyses: ${e instanceof Error?e.message:"Unknown error"}`)}},reInstateResults:async s=>{try{if((await c(`Are you sure you want to reinstate ${s.length} analyte${s.length>1?"s":""}?`,"Reinstate Analysis")).isConfirmed){const t=await u(w,{analyses:s},"reInstateAnalysisResults");t?.results&&(r.updateAnalysesResultsStatus(t.results),l.updateWorksheetResultsStatus(t.results),i(`Successfully reinstated ${s.length} analyte${s.length>1?"s":""}`))}}catch(e){o(`Failed to reinstate analyses: ${e instanceof Error?e.message:"Unknown error"}`)}},approveResults:async(s,e,t)=>{try{if((await c(`Are you sure you want to approve ${s.length} result${s.length>1?"s":""}?`,"Approve Results")).isConfirmed){const n=await u($,{analyses:s,sourceObject:e,sourceObjectUid:t},"verifyAnalysisResults");if(n?.isBackground){const m=s.map(R=>({uid:R}));r.backgroundProcessing(m,e==="sample"?t:"","approving"),l.backgroundProcessing(m,e==="worksheet"?t:void 0,"approving")}else e=="sample"&&r.updateAnalysesResults(n.results??[]),e=="worksheet"&&l.updateAnalysesResults(n.results??[]);n?.message&&i(n.message)}}catch(a){o(`Failed to approve results: ${a instanceof Error?a.message:"Unknown error"}`)}},retractResults:async s=>{try{if((await c(`Are you sure you want to retract ${s.length} result${s.length>1?"s":""}?`,"Retract Results")).isConfirmed){const t=await u(k,{analyses:s},"retractAnalysisResults");t?.results&&(r.updateAnalysesResults(t.results),l.updateWorksheetResultsStatus(t.results),i(`Successfully retracted ${s.length} result${s.length>1?"s":""}`))}}catch(e){o(`Failed to retract results: ${e instanceof Error?e.message:"Unknown error"}`)}},retestResults:async s=>{try{if((await c(`Are you sure you want to retest ${s.length} analyte${s.length>1?"s":""}?`,"Retest Analysis")).isConfirmed){const t=await u(S,{analyses:s},"retestAnalysisResults");t?.results&&(r.updateAnalysesResults(t.results),i(`Successfully initiated retest for ${s.length} analyte${s.length>1?"s":""}`))}}catch(e){o(`Failed to retest analyses: ${e instanceof Error?e.message:"Unknown error"}`)}}}}export{W as u};
