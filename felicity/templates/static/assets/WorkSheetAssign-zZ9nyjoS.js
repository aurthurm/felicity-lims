import{a0 as z,S as G,u as X,f as Z,a7 as T,h as _,g as $,aq as j,aU as ee,aV as te,_ as se,r as N,aa as Y,c as n,o as l,A as t,F as i,J as u,K as b,L as d,a9 as w,D as U,H as B,a as W,N as Q,P as R,a3 as H}from"./index-C5OmCQ1r.js";import{u as oe}from"./analysis-CQxuKvI2.js";import{s as re}from"./index-K3ETbf84.js";const ne=z({__name:"WorkSheetAssign",setup(I,{expose:e}){e();const c=G(),o=oe(),S=X(),{withClientMutation:y}=Z(),p=T();c.fetchWorkSheetTemplates();const m=_(()=>c.getWorkSheet),g=_(()=>c.getWorkSheetTemplates),A=async()=>{try{j.fire({title:"Are you sure?",text:"You want to apply this template to add samples?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, apply now!",cancelButtonText:"No, cancel apply!"}).then(r=>{r.isConfirmed&&y(ee,{worksheetUid:m?.value?.uid,templateUid:p.value},"updateWorksheetApplyTemplate").then(a=>{})})}catch{}};o.fetchAnalysesServices({first:void 0,after:"",text:"",sortBy:["name"]}),S.fetchSampleTypes(),o.fetchQCTemplates();const s=_(()=>o.getQCTemplates),f=T(void 0),F=$({sampleTypeUid:void 0,analysisUid:void 0}),x=T(!1),k=_(()=>{const r=v;return c.getAnalysisResults?.forEach(h=>{r?.some(J=>J.uid===h.uid)||r.push(h)}),r}),K=()=>{C(),c.fetchForWorkSheetsAssign({first:50,after:"",text:"",sortBy:void 0,...F})},L=()=>{const r=D();try{j.fire({title:"Are you sure?",text:"You want to assign selected to worksheet?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, assign now!",cancelButtonText:"No, cancel apply!"}).then(a=>{a.isConfirmed&&y(te,{uid:m?.value?.uid,qcTemplateUid:f.value,analysesUids:r},"updateWorksheetManualAssign").then(h=>{})})}catch{}};let v=[];function C(){let r=[];return k?.value?.forEach(a=>{a.checked&&r.push(a)}),v=r,r}function D(){const r=C();let a=[];return r?.forEach(h=>a.push(h.uid)),a}function O(r){q()?x.value=!0:x.value=!1}function V(r){r.checked=!0}function E(r){r.checked=!1}async function P(){await k?.value?.forEach(r=>x.value?V(r):E(r))}function q(){return k?.value?.every(r=>r.checked===!0)}const M={worksheetStore:c,analysisStore:o,sampleStore:S,withClientMutation:y,templateUid:p,worksheet:m,workSheetTemplates:g,applyTemplate:A,qcTemplates:s,qcTemplateUid:f,filterForm:F,allChecked:x,analysisResults:k,filterAnalysis:K,assignToWorkSheet:L,get checkedAnalyses(){return v},set checkedAnalyses(r){v=r},getResultsChecked:C,getResultsUids:D,checkCheck:O,check:V,unCheck:E,toggleCheckAll:P,areAllChecked:q,get shield(){return re}};return Object.defineProperty(M,"__isScriptSetup",{enumerable:!1,value:!0}),M}}),le={class:"space-y-6"},ie={class:"border-t border-border pt-6"},ae={action:"post",class:"space-y-4"},de={class:"flex items-center space-x-4"},ce={class:"flex-1 max-w-xs"},ue=["value"],pe={class:"overflow-x-auto mt-4"},me={action:"post",class:"p-1"},fe={class:"flex justify-start mb-4"},he={class:"flex justify-between items-center"},be=["value"],ye={class:"flex justify-between items-center ml-6"},ge=["value"],xe={class:"ml-6 mt-2"},ke={class:"overflow-x-auto mt-4"},ve={class:"align-middle inline-block min-w-full shadow overflow-hidden bg-background shadow-dashboard px-2 pt-1 rounded-bl-lg rounded-br-lg"},_e={key:0,class:"py-4 text-center"},we={key:1,class:"min-w-full"},Se={class:"px-1 py-1 border-b-2 border-border text-left leading-4 text-foreground tracking-wider"},Ae={class:"bg-background"},Ce=["onUpdate:modelValue","onChange"],Te={class:"px-1 py-1 whitespace-no-wrap border-b border-border"},Ue={class:"text-sm leading-5 text-primary font-semibold"},Be={class:"px-1 py-1 whitespace-no-wrap border-b border-border"},We={class:"text-sm leading-5 text-primary"},Fe={class:"px-1 py-1 whitespace-no-wrap border-b border-border"},De={class:"text-sm leading-5 text-primary"},Ve={class:"px-1 py-1 whitespace-no-wrap border-b border-border"},Ee={class:"text-sm leading-5 text-primary"},qe={class:"px-1 py-1 whitespace-no-wrap border-b border-border"},Me={class:"text-sm leading-5 text-primary"},je={class:"my-4"},Ne={action:"post",class:"mb-4"},Ye={class:"flex justify-start items-center mr-4"},Qe={class:"block mx-4"},Re=["value"];function He(I,e,c,o,S,y){const p=N("FButton"),m=N("fel-loader"),g=Y("motion-slide-right"),A=Y("motion-slide-left");return l(),n(u,null,[t("section",le,[t("div",ie,[i((l(),n("form",ae,[t("div",de,[e[8]||(e[8]=t("span",{class:"text-sm font-medium text-foreground"},"Worksheet Template",-1)),t("label",ce,[i(t("select",{class:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary","onUpdate:modelValue":e[0]||(e[0]=s=>o.templateUid=s)},[e[7]||(e[7]=t("option",{value:""},null,-1)),(l(!0),n(u,null,b(o.workSheetTemplates,s=>(l(),n("option",{key:s.uid,value:s.uid},d(s.name),9,ue))),128))],512),[[w,o.templateUid]])]),i(t("button",{type:"button",onClick:e[1]||(e[1]=U(s=>o.applyTemplate(),["prevent"])),class:"px-4 py-2 bg-primary text-primary-foreground rounded-md text-sm font-medium hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors"}," Apply Template ",512),[[B,o.shield.hasRights(o.shield.actions.CREATE,o.shield.objects.WORKSHEET)]])])])),[[g]])])]),e[22]||(e[22]=t("hr",{class:"mt-4 mb-2"},null,-1)),e[23]||(e[23]=t("h3",{class:"font-bold"},"Manual Analyses Assignment",-1)),e[24]||(e[24]=t("hr",{class:"mb-4 mt-2"},null,-1)),t("div",pe,[i((l(),n("form",me,[t("div",fe,[t("label",he,[e[9]||(e[9]=t("span",{class:"text-foreground mr-2"},"SampleType",-1)),i(t("select",{name:"analyses_uids","onUpdate:modelValue":e[2]||(e[2]=s=>o.filterForm.sampleTypeUid=s),class:"form-input mt-1 block w-full py-1"},[(l(!0),n(u,null,b(o.sampleStore.sampleTypes,s=>(l(),n("option",{key:s.uid,value:s.uid},d(s.name),9,be))),128))],512),[[w,o.filterForm.sampleTypeUid]])]),t("label",ye,[e[10]||(e[10]=t("span",{class:"text-foreground mr-2"},"Analyses",-1)),i(t("select",{name:"analyses_uids","onUpdate:modelValue":e[3]||(e[3]=s=>o.filterForm.analysisUid=s),class:"form-input mt-1 block w-full py-1"},[(l(!0),n(u,null,b(o.analysisStore.analysesServices,s=>(l(),n("option",{key:s.uid,value:s.uid},d(s.name),9,ge))),128))],512),[[w,o.filterForm.analysisUid]])]),t("div",xe,[i(W(p,{onClick:e[4]||(e[4]=U(s=>o.filterAnalysis(),["prevent"])),color:"sky-800",class:"p-1"},{default:Q(()=>[...e[11]||(e[11]=[R("Apply Filters",-1)])]),_:1},512),[[B,!0]])])])])),[[A]])]),t("div",ke,[t("div",ve,[o.worksheetStore.fetchingAnalysisResults?(l(),n("div",_e,[W(m,{message:"Fetching analytes ..."})])):(l(),n("table",we,[t("thead",null,[t("tr",null,[t("th",Se,[i(t("input",{type:"checkbox",onChange:o.toggleCheckAll,"onUpdate:modelValue":e[5]||(e[5]=s=>o.allChecked=s)},null,544),[[H,o.allChecked]])]),e[12]||(e[12]=t("th",{class:"px-1 py-1 border-b-2 border-border text-left leading-4 text-foreground tracking-wider"},null,-1)),e[13]||(e[13]=t("th",{class:"px-1 py-1 border-b-2 border-border text-left leading-4 text-foreground tracking-wider"}," Sample ID ",-1)),e[14]||(e[14]=t("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Analysis ",-1)),e[15]||(e[15]=t("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Date Created ",-1)),e[16]||(e[16]=t("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Date Received ",-1)),e[17]||(e[17]=t("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Status ",-1))])]),i((l(),n("tbody",Ae,[(l(!0),n(u,null,b(o.analysisResults,s=>(l(),n("tr",{key:s?.uid},[t("td",null,[i(t("input",{type:"checkbox","onUpdate:modelValue":f=>s.checked=f,onChange:f=>o.checkCheck(s)},null,40,Ce),[[H,s.checked]])]),e[18]||(e[18]=t("td",{class:"px-1 py-1 whitespace-no-wrap border-b border-border"},null,-1)),t("td",Te,[t("div",Ue,d(s?.sample?.sampleId),1)]),t("td",Be,[t("div",We,d(s?.analysis?.name),1)]),t("td",Fe,[t("div",De,d(s?.sample?.createdAt),1)]),t("td",Ve,[t("div",Ee,d(s?.sample?.dateReceived),1)]),t("td",qe,[t("div",Me,d(s?.sample?.status),1)])]))),128))])),[[g]])]))])]),t("section",je,[t("form",Ne,[t("div",Ye,[e[20]||(e[20]=t("span",{class:"text-foreground"},"Apply QC Template",-1)),t("label",Qe,[i(t("select",{class:"form-select block w-full py-1","onUpdate:modelValue":e[6]||(e[6]=s=>o.qcTemplateUid=s)},[e[19]||(e[19]=t("option",null,null,-1)),(l(!0),n(u,null,b(o.qcTemplates,s=>(l(),n("option",{key:s.uid,value:s.uid},d(s.name),9,Re))),128))],512),[[w,o.qcTemplateUid]])])])]),i(W(p,{onClick:U(o.assignToWorkSheet,["prevent"]),color:"orange-600"},{default:Q(()=>[...e[21]||(e[21]=[R("Assign Analyses",-1)])]),_:1},512),[[B,!0]])])],64)}const Oe=se(ne,[["render",He],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/worksheet/_id/WorkSheetAssign.vue"]]);export{Oe as default};
