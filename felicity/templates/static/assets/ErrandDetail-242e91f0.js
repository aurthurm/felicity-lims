import{P as ye,Z as i,aa as fe,a9 as _e,h as R,e as he,a5 as F,r as j,a2 as t,o as r,c as u,b as e,E as c,A as K,V as xe,H as ke,as as De,L as B,ak as T,J as g,x as Ve,C as Ee,at as Ue,a1 as h,a as d,K as O,X as x,au as we,Y as k,_ as Ce}from"./index-fa13e788.js";import{a as Se,b as Ae,c as Be,d as Te,E as Me}from"./grind.queries-2a7b3de7.js";import{S as z}from"./schema-f3233b53.js";import{C as Pe,A as He,a as Le,b as $e,B as Ye,c as Ie,E as Ne,H as Ge,I as Re,d as Fe,e as je,L as Ke,P as Oe,S as ze,T as Qe,f as Je,U as We,g as Xe}from"./index-7d84edd6.js";import v from"./vue-multiselect.esm-d8a2873c.js";import{U as Ze}from"./_queries-fa6c96fd.js";import"./_baseForOwn-f09f6708.js";import"./merge-9af0dc11.js";import"./_isIterateeCall-63f093c4.js";import"./isArray-513c67aa.js";import"./mapValues-17240bfb.js";import"./isString-5d6832c3.js";import"./clone-304ea981.js";import"./_baseSet-8f475b6b.js";const qe={key:0,class:"bg-white rounded-lg shadow"},et={class:"flex flex-col md:flex-row"},tt={class:"flex-1 p-6 border-r"},st={class:"p-6 border-b"},at={class:"flex justify-between items-center"},ot={class:"relative w-full"},lt={class:"mt-4 text-xs flex items-center gap-2"},it={class:"h-8 w-8 rounded-full bg-orange-200 flex items-center justify-center text-orange-600"},nt={class:"my-1 font-semibold"},rt={class:"text-sm text-gray-600"},dt=["innerHTML"],ut={key:1,class:"mt-6"},ct={class:"main-container min-w-full prose prose-slate"},mt={class:"editor-container editor-container_balloon-editor",ref:"editorContainerElement"},pt={class:"editor-container__editor"},gt={ref:"editorElement"},vt={class:"flex justify-start items-center gap-x-2 mt-1"},bt={class:"my-2 w-full bg-gray-200 rounded-full h-1 dark:bg-gray-700"},yt={class:"text-xs"},ft={class:"border-b border-gray-200"},_t={class:"flex"},ht={class:"py-4"},xt={key:0,class:"space-y-6"},kt={key:1,class:"space-y-4"},Dt={key:2,class:"space-y-4"},Vt={key:3},Et={class:"w-full md:w-80 p-6"},Ut={class:"space-y-6"},wt=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1),Ct=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Assignee",-1),St=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Reporter",-1),At=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Team Members",-1),Bt={class:"multiselect-tag"},Tt=["onClick"],Mt=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Priority",-1),Pt=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tags",-1),Ht={class:"multiselect-tag"},Lt=["onClick"],$t=ye({__name:"ErrandDetail",setup(Yt){const Q=x(()=>k(()=>import("./ErrandActivity-7caaa640.js"),["assets/ErrandActivity-7caaa640.js","assets/index-fa13e788.js","assets/index-ccc6a521.css"])),J=x(()=>k(()=>import("./CommentSystem-1fb5c7d0.js"),["assets/CommentSystem-1fb5c7d0.js","assets/index-fa13e788.js","assets/index-ccc6a521.css","assets/grind.queries-2a7b3de7.js","assets/CommentSystem-d474aa42.css"])),W=x(()=>k(()=>import("./ErrandFile-5e925bda.js"),["assets/ErrandFile-5e925bda.js","assets/index-fa13e788.js","assets/index-ccc6a521.css","assets/grind.queries-2a7b3de7.js","assets/schema-f3233b53.js","assets/ErrandFile-a405999b.css"])),X=x(()=>k(()=>import("./ErrandMilestone-90369c87.js"),["assets/ErrandMilestone-90369c87.js","assets/index-fa13e788.js","assets/index-ccc6a521.css","assets/_queries-fa6c96fd.js","assets/grind.queries-2a7b3de7.js","assets/vue-multiselect.esm-d8a2873c.js"])),D=i(!1),M=i(null),Z=i(Pe);function q(){M.value={toolbar:{items:["undo","redo","|","heading","|","bold","italic","underline","|","link","insertTable","blockQuote","|","bulletedList","numberedList","todoList","outdent","indent"],shouldNotGroupWhenFull:!1},plugins:[He,Le,$e,Ye,Ie,Ne,Ge,Re,Fe,je,Ke,Oe,ze,Qe,Je,We,Xe],heading:{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h1",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h2",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h3",title:"Heading 3",class:"ck-heading_heading3"},{model:"heading4",view:"h4",title:"Heading 4",class:"ck-heading_heading4"},{model:"heading5",view:"h5",title:"Heading 5",class:"ck-heading_heading5"},{model:"heading6",view:"h6",title:"Heading 6",class:"ck-heading_heading6"}]},placeholder:"Begin typing..."},D.value=!0}fe(()=>{q(),$(),ne(),de(),ve()});const n=i("discussions"),P=_e(),H=R(()=>P.params.errandUid),ee=R(()=>P.params.boardUid);let a=i();const{withClientQuery:y,withClientMutation:L}=he();function $(){y(Se,{uid:H.value},"grindErrandByUid").then(o=>{a.value=o;const s=F(a.value.startDate,!0)??new Date,p=F(a.value.endDate,!0)??new Date(new Date().setDate(s.getDate()+7));U.value=[s,p]})}function m(o){L(Me,{uid:H.value,payload:o},"updateGrindErrand").then(()=>$())}const V=i(!1),E=i(null),te=()=>{V.value=!0,we(()=>{E.value?.focus(),E.value?.select()})},Y=()=>{V.value=!1,m({title:a.value?.title})},f=i(!1),I=i(""),se=()=>{f.value=!0,I.value=a.value?.description??""},ae=()=>{f.value=!1,m({description:a.value?.description})},oe=()=>{a.value.description=I.value,f.value=!1},U=i(),le=o=>{const s=o[0]?.getDate(),p=o[0]?.getMonth()+1,S=o[0]?.getFullYear(),l=o[1]?.getDate(),b=o[1]?.getMonth()+1,A=o[1]?.getFullYear();return`${s}/${p}/${S} - ${l}/${b}/${A}`},ie=o=>{if(o.length!==2){alert("Invalid date range");return}m({startDate:T(o[0],"YYYY-MM-DD HH:mm"),endDate:T(o[1],"YYYY-MM-DD HH:mm")})},N=i([]);function ne(){y(Ae,{boardUid:ee.value},"grindPostersByBoard").then(o=>{N.value=o.filter(s=>s.uid!==a.value?.posterUid)})}function re(o){m({posterUid:o.uid})}const _=i();function de(){y(Ze,{first:100},"userAll").then(o=>{_.value=o.items})}function w({firstName:o,lastName:s}){return`${o} ${s}`}function ue(o){m({assigneeUid:o.uid})}function ce(o){m({reporterUid:o.uid})}function me(o){m({members:o.map(s=>s.uid)})}const pe=["Low","Normal","High","Critical"];function ge(o){m({priority:o})}const C=i([]);function ve(){y(Be,{category:z.Project},"grindStampByCategory").then(o=>{C.value=o})}function G(o){m({stamps:o?.map(s=>s.uid)})}const be=o=>{L(Te,{payload:{title:o,category:z.Project}},"createGrindStamp").then(s=>{if(s.uid){C.value.push(s);const p=a.value?.stamps??[];p.push(s),G(p)}})};return(o,s)=>{const p=j("ckeditor"),S=j("VueDatePicker");return t(a)?(r(),u("div",qe,[e("div",et,[e("div",tt,[e("div",st,[e("div",at,[e("div",ot,[V.value?K((r(),u("input",{key:1,type:"text","onUpdate:modelValue":s[0]||(s[0]=l=>t(a).title=l),onBlur:Y,onKeyup:ke(Y,["enter"]),ref_key:"titleInput",ref:E,class:"text-2xl font-semibold text-gray-800 w-full px-2 py-1 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544)),[[xe,t(a).title]]):(r(),u("h1",{key:0,onClick:te,class:"text-3xl font-bold text-gray-800 cursor-pointer hover:bg-gray-50 rounded"},c(t(a).title),1))])]),e("div",lt,[e("div",it,c(t(De)(t(a).createdBy?.firstName,t(a).createdBy?.lastName)),1),B(" by "),e("span",nt,c(t(a).createdBy?.firstName)+" "+c(t(a).createdBy?.lastName),1),e("span",rt,"on "+c(t(T)(t(a).createdAt,"D MMMM YYYY")),1)]),f.value?(r(),u("div",ut,[e("div",ct,[e("p",null,"isLayoutReady : "+c(D.value),1),e("div",mt,[e("div",pt,[e("div",gt,[D.value?(r(),Ve(p,{key:0,modelValue:t(a).description,"onUpdate:modelValue":s[1]||(s[1]=l=>t(a).description=l),editor:Z.value,config:M.value,"tag-name":"textarea"},null,8,["modelValue","editor","config"])):g("",!0)],512)])],512)]),e("div",{class:"mt-2 flex gap-2"},[e("button",{onClick:ae,class:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm"}," Save "),e("button",{onClick:oe,class:"px-3 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 text-sm"}," Cancel ")])])):(r(),u("div",{key:0,class:"mt-6 prose",onClick:se},[t(a).description?(r(),u("article",{key:0,class:"text-lg text-gray-800",innerHTML:t(a).description},null,8,dt)):g("",!0)]))]),K(e("div",vt,[e("div",bt,[e("div",{class:"bg-green-600 h-1 rounded-full",style:Ue(`width: ${t(a)?.milestonesAt}%`)},null,4)]),e("span",yt,c(t(a)?.milestonesAt)+"%",1)],512),[[Ee,t(a)?.milestonesAt]]),e("div",ft,[e("div",_t,[e("button",{onClick:s[2]||(s[2]=l=>n.value="discussions"),class:h(["py-3 px-4 text-sm font-medium border-b-2 focus:outline-none",n.value==="discussions"?"border-blue-500 text-blue-500":"border-transparent text-gray-500 hover:text-gray-700"])}," Discussions ",2),e("button",{onClick:s[3]||(s[3]=l=>n.value="milestones"),class:h(["py-3 px-4 text-sm font-medium border-b-2 focus:outline-none",n.value==="milestones"?"border-blue-500 text-blue-500":"border-transparent text-gray-500 hover:text-gray-700"])}," Milestones ",2),e("button",{onClick:s[4]||(s[4]=l=>n.value="activity"),class:h(["py-3 px-4 text-sm font-medium border-b-2 focus:outline-none",n.value==="activity"?"border-blue-500 text-blue-500":"border-transparent text-gray-500 hover:text-gray-700"])}," Activity Stream ",2),e("button",{onClick:s[5]||(s[5]=l=>n.value="files"),class:h(["py-3 px-4 text-sm font-medium border-b-2 focus:outline-none",n.value==="files"?"border-blue-500 text-blue-500":"border-transparent text-gray-500 hover:text-gray-700"])}," Files ",2)])]),e("div",ht,[n.value==="discussions"?(r(),u("div",xt,[d(t(J),{errandUid:t(a).uid},null,8,["errandUid"])])):g("",!0),n.value==="milestones"?(r(),u("div",kt,[d(t(X),{errandUid:t(a).uid},null,8,["errandUid"])])):g("",!0),n.value==="activity"?(r(),u("div",Dt,[d(t(Q),{errandUid:t(a).uid},null,8,["errandUid"])])):g("",!0),n.value==="files"?(r(),u("div",Vt,[d(t(W),{errandUid:t(a).uid},null,8,["errandUid"])])):g("",!0)])]),e("div",Et,[e("div",Ut,[d(S,{class:"z-60",modelValue:U.value,"onUpdate:modelValue":[s[6]||(s[6]=l=>U.value=l),ie],range:"",format:le},null,8,["modelValue"]),e("div",null,[wt,d(t(v),{modelValue:t(a).poster,"onUpdate:modelValue":[s[7]||(s[7]=l=>t(a).poster=l),re],options:N.value,label:"title","track-by":"uid",placeholder:"Select status"},null,8,["modelValue","options"])]),e("div",null,[Ct,d(t(v),{modelValue:t(a).assignee,"onUpdate:modelValue":[s[8]||(s[8]=l=>t(a).assignee=l),ue],options:_.value,"track-by":"uid",searchable:!0,"custom-label":w,placeholder:"Select assignee"},null,8,["modelValue","options"])]),e("div",null,[St,d(t(v),{modelValue:t(a).reporter,"onUpdate:modelValue":[s[9]||(s[9]=l=>t(a).reporter=l),ce],options:_.value,"track-by":"uid",searchable:!0,"custom-label":w,placeholder:"Select reporter"},null,8,["modelValue","options"])]),e("div",null,[At,d(t(v),{modelValue:t(a).members,"onUpdate:modelValue":[s[10]||(s[10]=l=>t(a).members=l),me],options:_.value,multiple:!0,searchable:!0,"custom-label":w,"track-by":"uid",placeholder:"Select members"},{tag:O(({option:l,remove:b})=>[e("div",Bt,[B(c(l.firstName)+" "+c(l.lastName)+" ",1),e("i",{class:"multiselect-tag-remove",onClick:A=>b(l)},"×",8,Tt)])]),_:1},8,["modelValue","options"])]),e("div",null,[Mt,d(t(v),{modelValue:t(a).priority,"onUpdate:modelValue":[s[11]||(s[11]=l=>t(a).priority=l),ge],options:pe,searchable:!1,"show-labels":!1,placeholder:"Select priority"},null,8,["modelValue"])]),e("div",null,[Pt,d(t(v),{modelValue:t(a).stamps,"onUpdate:modelValue":[s[12]||(s[12]=l=>t(a).stamps=l),G],options:C.value,multiple:!0,taggable:!0,searchable:!0,"track-by":"uid","show-labels":!1,placeholder:"Select or add tags",onTag:be,"custom-label":({title:l})=>`${l}`},{tag:O(({option:l,remove:b})=>[e("div",Ht,[B(c(l.title)+" ",1),e("i",{class:"multiselect-tag-remove",onClick:A=>b(l)},"×",8,Lt)])]),_:1},8,["modelValue","options","custom-label"])])])])])])):g("",!0)}}}),qt=Ce($t,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/grind/_id/ErrandDetail.vue"]]);export{qt as default};
