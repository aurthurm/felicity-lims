import{d as ge,N as xe,W as ke,s as ve,q as we,y as Re,V as Ce,r as z,m as Ue,z as Ee,o,c as n,b as e,f as i,g as _,e as u,at as W,F as p,E as y,I as Ae,B as L,A as N,D as b,t as c,as as $,v as Ve,aG as q,P as v,C as h,w,j as S,_ as I,aR as G,x as De,k as Se}from"./index-4d0d48ab.js";import{u as Ie}from"./analysis-da6664b3.js";import{h as R,o as C,a as U}from"./constants-f934664e.js";const Te=e("hr",{class:"mt-4 mb-2"},null,-1),Pe=e("h3",{class:"font-bold"},"Analyses/Results",-1),Le=e("hr",{class:"mb-4 mt-2"},null,-1),Ne={class:"overflow-x-auto"},$e={class:"align-middle inline-block min-w-full shadow overflow-hidden bg-white shadow-dashboard px-2 pt-1 rounded-bl-lg rounded-br-lg"},Be={key:0,class:"py-4 text-center"},Oe={key:1,class:"min-w-full"},Fe={class:"px-1 py-1 border-b-2 border-gray-300 text-left leading-4 text-gray-800 tracking-wider"},Me=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left leading-4 text-gray-800 tracking-wider"},null,-1),qe=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left leading-4 text-gray-800 tracking-wider"}," Analysis ",-1),Ke=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Instrument ",-1),je=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Method ",-1),ze=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Analyst ",-1),We=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Reviewer(s) ",-1),Ge=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Interim ",-1),He=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Result ",-1),Je=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Retest ",-1),Qe=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Due Date ",-1),Xe=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Submitted ",-1),Ye=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Approved ",-1),Ze=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Status ",-1),et=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Reportable ",-1),tt=e("th",{class:"px-1 py-1 border-b-2 border-gray-300"},null,-1),st={class:"bg-white"},at=["onUpdate:modelValue","onChange","disabled"],ot=e("td",{class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},null,-1),nt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},lt={class:"text-sm leading-5 text-sky-800 font-semibold"},rt=["onClick"],it={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},ct={key:0,class:"text-sm leading-5 text-sky-800"},dt={key:1,class:"block col-span-2 mb-2"},ut=["onUpdate:modelValue","onChange"],_t=e("option",{value:""},null,-1),pt=["value"],ht={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},yt={key:0,class:"text-sm leading-5 text-sky-800"},bt={key:1,class:"block col-span-2 mb-2"},mt=["onUpdate:modelValue","onChange"],ft=e("option",{value:""},null,-1),gt=["value"],xt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},kt={class:"text-sm leading-5 text-sky-800"},vt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},wt={class:"text-sm leading-5 text-sky-800"},Rt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Ct={key:0,class:"text-sm leading-5 text-sky-800"},Ut={key:1,class:"block col-span-2 mb-2"},Et=["onUpdate:modelValue","onChange"],At=e("option",{value:""},null,-1),Vt=["value"],Dt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},St={key:0,class:"text-sm leading-5 text-sky-800"},It={key:1,class:"block"},Tt=["onUpdate:modelValue","onKeyup"],Pt={key:2,class:"block col-span-2 mb-2"},Lt=["onUpdate:modelValue","onChange"],Nt=e("option",{value:""},null,-1),$t=["value"],Bt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Ot={class:"text-sm leading-5 text-sky-800"},Ft={key:0,class:"text-sky-800"},Mt={key:1,class:"text-orange-600"},qt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Kt={class:"text-sm leading-5 text-sky-800"},jt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},zt={class:"text-sm leading-5 text-sky-800"},Wt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Gt={class:"text-sm leading-5 text-sky-800"},Ht={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Jt={type:"button",class:"bg-sky-800 text-white px-2 py-1 rounded-sm leading-none"},Qt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Xt={class:"text-sm leading-5 text-sky-800"},Yt={key:0,class:"text-emerald-600"},Zt={key:1,class:"text-orange-600"},es=e("td",{class:"px-1 py-1 whitespace-no-wrap text-right border-b border-gray-500 text-sm leading-5"},null,-1),ts={class:"my-4"},ss=e("h3",null,"Result Information",-1),as=ge({__name:"Results",setup(os){const m=S(()=>I(()=>import("./FelButton-f535b4fc.js"),["assets/FelButton-f535b4fc.js","assets/index-4d0d48ab.js","assets/index-c2286288.css"])),H=S(()=>I(()=>import("./FelLoadingMessage-e29e7357.js"),["assets/FelLoadingMessage-e29e7357.js","assets/index-4d0d48ab.js","assets/index-c2286288.css"])),J=S(()=>I(()=>import("./FelDrawer-f636fc7a.js"),["assets/FelDrawer-f636fc7a.js","assets/index-4d0d48ab.js","assets/index-c2286288.css"])),Q=S(()=>I(()=>import("./AnalysisSneak-c58ce344.js"),["assets/AnalysisSneak-c58ce344.js","assets/index-4d0d48ab.js","assets/index-c2286288.css"])),X=S(()=>I(()=>import("./ResultDetail-27fa5512.js"),["assets/ResultDetail-27fa5512.js","assets/index-4d0d48ab.js","assets/index-c2286288.css"])),B=xe(),f=ke(),{sample:T,analysisResults:E,fetchingResults:Y}=ve(f),l=we({can_submit:!1,can_cancel:!1,can_retract:!1,can_approve:!1,can_retest:!1,can_reinstate:!1,allChecked:!1});Re(()=>{f.fetchAnalysisResultsForSample(B.params.sampleUid)}),Ce(()=>B.params.sampleUid,(s,r)=>{f.resetSample(),f.fetchAnalysisResultsForSample(B.params.sampleUid)});function O(){let s=[];return E?.value?.forEach(r=>{r.checked&&s.push(r)}),s}function Z(){let s=O(),r=[];return s?.forEach(d=>r.push({uid:d.uid,result:d.result,methodUid:d.methodUid,laboratoryInstrumentUid:d.laboratoryInstrumentUid})),r}function A(){const s=O();let r=[];return s?.forEach(d=>r.push(d.uid)),r}function ee(s){se()?l.allChecked=!0:l.allChecked=!1,V()}function g(s){j(s)||(s.checked=!0,V())}function K(s){s.checked=!1,V()}async function te(){await E?.value?.forEach(s=>l.allChecked?g(s):K(s)),V()}async function x(){await E?.value?.forEach(s=>K(s)),V()}function se(){return E?.value?.every(s=>s.checked===!0)}function j(s){switch(s?.status){case"retracted":return!0;case"approved":return!0;case"cancelled":return T?.value?.status!=="received";default:return!1}}function ae(s){s.editable=!0}function P(s){return!["received","paired"].includes(T?.value?.status??"")||s.status!=="pending"?!1:s?.editable||G(s?.result)?(ae(s),!0):!1}function oe(s){switch(s?.status){case"retracted":return"bg-gray-300";case"aproved":return s?.reportable===!1?"bg-orange-600":"";default:return""}}function V(){l.can_cancel=!1,l.can_submit=!1,l.can_retract=!1,l.can_approve=!1,l.can_retest=!1,l.can_reinstate=!1;const s=O();s.length!==0&&(s.every(r=>r.status==="cancelled")&&(l.can_reinstate=!0),s.every(r=>r.status==="pending")&&(l.can_cancel=!0),s.every(r=>["pending"].includes(r.status??"")&&!G(r.result))&&(l.can_submit=!0),s.every(r=>r.status==="resulted")&&(l.can_retract=!0,l.can_approve=!0,l.can_retest=!0))}const k=async()=>{const s=De(()=>f.getSample);s.value&&f.fetchSampleStatus(s?.value?.uid)},F=z(!1),D=z(void 0),ne=s=>{F.value=!0,D.value=s};let{submitResults:le,cancelResults:re,reInstateResults:ie,approveResults:ce,retractResults:de,retestResults:ue}=Ie();const _e=()=>le(Z(),"sample",T?.value?.uid).then(()=>k()).finally(()=>x()),pe=()=>re(A()).then(()=>k()).finally(()=>x()),he=()=>ie(A()).then(()=>k()).finally(()=>x()),ye=()=>ce(A(),"sample",T?.value?.uid).then(()=>k()).finally(()=>x()),be=()=>de(A()).then(()=>k()).finally(()=>x()),me=()=>ue(A()).then(()=>k()).finally(()=>x());return(s,r)=>{const d=Ue("font-awesome-icon"),fe=Ee("motion-slide-right");return o(),n(p,null,[Te,Pe,Le,e("div",Ne,[e("div",$e,[i(Y)?(o(),n("div",Be,[_(i(H),{message:"Fetching analytes ..."})])):(o(),n("table",Oe,[e("thead",null,[e("tr",null,[e("th",Fe,[u(e("input",{type:"checkbox",class:"",onChange:te,"onUpdate:modelValue":r[0]||(r[0]=t=>l.allChecked=t)},null,544),[[W,l.allChecked]])]),Me,qe,Ke,je,ze,We,Ge,He,Je,Qe,Xe,Ye,Ze,et,tt])]),e("tbody",st,[(o(!0),n(p,null,y(i(E),t=>u((o(),n("tr",{key:t.uid,class:Ae([oe(t)])},[e("td",null,[u(e("input",{type:"checkbox",class:"border-red-500","onUpdate:modelValue":a=>t.checked=a,onChange:a=>ee(),disabled:j(t)},null,40,at),[[W,t.checked]]),t.status==="pending"?(o(),L(d,{key:0,icon:"fa-question",class:"ml-1 text-xs"})):N("v-if",!0),t.status==="resulted"?(o(),L(d,{key:1,icon:"fa-question",class:"ml-1 text-xs text-orange"})):N("v-if",!0)]),ot,e("td",nt,[e("div",lt,[e("span",{class:"mr-1 hover:cursor-pointer",onClick:a=>ne(t)},[_(d,{icon:"fa-info-circle"})],8,rt),b(" "+c(t.analysis?.name),1)])]),e("td",it,[P(t)?(o(),n("label",dt,[u(e("select",{class:"form-input mt-1 block w-full","onUpdate:modelValue":a=>t.laboratoryInstrumentUid=a,onChange:a=>g(t)},[_t,(o(!0),n(p,null,y(t.analysis?.instruments,a=>(o(),n(p,{key:a.uid},[(o(!0),n(p,null,y(a.laboratoryInstruments,M=>(o(),n("option",{key:M.uid,value:M.uid},c(M.labName)+" â†’ ("+c(a?.name)+") ",9,pt))),128))],64))),128))],40,ut),[[$,t.laboratoryInstrumentUid]])])):(o(),n("div",ct,c(t.laboratoryInstrument?.labName||"---"),1))]),e("td",ht,[P(t)?(o(),n("label",bt,[u(e("select",{class:"form-input mt-1 block w-full","onUpdate:modelValue":a=>t.methodUid=a,onChange:a=>g(t)},[ft,(o(!0),n(p,null,y(t.analysis?.methods,a=>(o(),n("option",{key:a.uid,value:a.uid},c(a.name),9,gt))),128))],40,mt),[[$,t.methodUid]])])):(o(),n("div",yt,c(t.method?.name||"---"),1))]),e("td",xt,[e("div",kt,c(`${t.submittedBy?.firstName??"--"} ${t.submittedBy?.lastName??"--"}`),1)]),e("td",vt,[e("div",wt,[(o(!0),n(p,null,y(t.verifiedBy,a=>(o(),n("span",{key:a.firstName,class:"ml-1"},c(`${a?.firstName??"--"} ${a?.lastName??"--"},`),1))),128))])]),e("td",Rt,[!P(t)||t?.analysis?.interims?.length===0?(o(),n("div",Ct," --- ")):(o(),n("label",Ut,[u(e("select",{class:"form-input mt-1 block w-full","onUpdate:modelValue":a=>t.result=a,onChange:a=>g(t)},[At,(o(!0),n(p,null,y(t?.analysis?.interims,a=>(o(),n("option",{key:a.key,value:a.value},c(a.value),9,Vt))),128))],40,Et),[[$,t.result]])]))]),e("td",Dt,[P(t)?t?.analysis?.resultOptions?.length===0?(o(),n("label",It,[u(e("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":a=>t.result=a,onKeyup:a=>g(t)},null,40,Tt),[[Ve,t.result]])])):(o(),n("label",Pt,[u(e("select",{class:"form-input mt-1 block w-full","onUpdate:modelValue":a=>t.result=a,onChange:a=>g(t)},[Nt,(o(!0),n(p,null,y(t?.analysis?.resultOptions,a=>(o(),n("option",{key:a.optionKey,value:a.value},c(a.value),9,$t))),128))],40,Lt),[[$,t.result]])])):(o(),n("div",St,c(t?.result),1))]),e("td",Bt,[e("div",Ot,[t?.retest?(o(),n("span",Ft,[_(d,{icon:"fa-check-circle"})])):(o(),n("span",Mt,[_(d,{icon:"fa-times-circle"})]))])]),e("td",qt,[e("div",Kt,c(i(q)(t?.dueDate)),1)]),e("td",jt,[e("div",zt,c(i(q)(t?.dateSubmitted)),1)]),e("td",Wt,[e("div",Gt,c(i(q)(t?.dateVerified)),1)]),e("td",Ht,[e("button",Jt,c(t.status),1)]),e("td",Qt,[e("div",Xt,[t?.reportable?(o(),n("span",Yt,[_(d,{icon:"fa-thumbs-up","aria-hidden":"true"})])):(o(),n("span",Zt,[_(d,{icon:"fa-thumbs-down","aria-hidden":"true"})]))])]),es],2)),[[fe]])),128))])]))])]),e("section",ts,[u(_(i(m),{key:"cancel",onClick:w(pe,["prevent"]),color:"sky-800"},{default:h(()=>[b("Cancel")]),_:1},512),[[v,R(U.UPDATE,C.RESULT)&&l.can_cancel]]),u(_(i(m),{key:"reinstate",onClick:w(he,["prevent"]),color:"orange-600"},{default:h(()=>[b("Re-Instate")]),_:1},512),[[v,R(U.UPDATE,C.RESULT)&&l.can_reinstate]]),u(_(i(m),{key:"submit",onClick:w(_e,["prevent"]),color:"orange-600"},{default:h(()=>[b("Submit")]),_:1},512),[[v,R(U.UPDATE,C.RESULT)&&l.can_submit]]),u(_(i(m),{key:"retract",onClick:w(be,["prevent"]),color:"orange-600"},{default:h(()=>[b("Retract")]),_:1},512),[[v,R(U.UPDATE,C.RESULT)&&l.can_retract]]),u(_(i(m),{key:"verify",onClick:w(ye,["prevent"]),color:"orange-600"},{default:h(()=>[b("Verify")]),_:1},512),[[v,R(U.UPDATE,C.RESULT)&&l.can_approve]]),u(_(i(m),{key:"retest",onClick:w(me,["prevent"]),color:"orange-600"},{default:h(()=>[b("Retest")]),_:1},512),[[v,R(U.UPDATE,C.RESULT)&&l.can_retest]])]),_(i(J),{show:F.value,onClose:r[1]||(r[1]=t=>F.value=!1),"content-width":"w-2/4"},{header:h(()=>[ss]),body:h(()=>[D.value?.analysisUid?(o(),L(i(Q),{key:0,analysisUid:D.value?.analysisUid},null,8,["analysisUid"])):N("v-if",!0),D.value?.uid?(o(),L(i(X),{key:1,analysisResultesultUid:D.value?.uid},null,8,["analysisResultesultUid"])):N("v-if",!0)]),_:1},8,["show"])],64)}}}),is=Se(as,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/sample/_id/Results.vue"]]);export{is as default};
