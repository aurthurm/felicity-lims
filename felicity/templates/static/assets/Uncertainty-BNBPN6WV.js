import{a0 as $,f as ee,t as te,a7 as h,a5 as re,h as B,_ as oe,r as E,c as a,o as d,a as L,A as e,C as ne,E as c,N as _,P as se,J as U,K as k,L as i,D as de,F as b,a9 as R,a2 as S}from"./index-DApeomWQ.js";import{c as ie,d as A,a as J,u as ae,b as p}from"./index.esm-Cx9agkcQ.js";import{H as le,J as ue}from"./analyses.mutations-Bu696l9I.js";import{u as me}from"./setup-HNpvekU2.js";import{u as ce}from"./analysis-BTUsl5OO.js";const fe=$({__name:"Uncertainty",props:{analysis:{type:Object,required:!0,default:()=>({})},analysisUid:{type:String,required:!0,default:0}},setup(V,{expose:t}){t();const x=ce(),r=me(),{withClientMutation:g}=ee(),y=V,{analysis:v}=te(y);let l=h(!1),f=h("");const o=h(!0),u=h(null),N=ie({instrumentUid:J().trim().required("Instrument is required"),methodUid:J().trim().required("Method is required"),min:A().typeError("Min must be a number").required("Min is required"),max:A().typeError("Max must be a number").required("Max is required"),value:A().typeError("Variance must be a number").required("Variance is required")}),{handleSubmit:q,resetForm:C,setValues:F}=ae({validationSchema:N,initialValues:{instrumentUid:"",methodUid:"",min:"",max:"",value:""}}),{value:O,errorMessage:P}=p("instrumentUid"),{value:Y,errorMessage:H}=p("methodUid"),{value:K,errorMessage:W}=p("min"),{value:z,errorMessage:G}=p("max"),{value:Q,errorMessage:X}=p("value");re(()=>y.analysisUid,(n,s)=>{}),r.fetchInstruments();const w=B(()=>r.getInstruments);r.fetchMethods();const M=B(()=>r.getMethods);function I(n){g(le,{payload:n},"createAnalysisUncertainty").then(s=>x.addAnalysisUncertainty(s))}function T(n){u.value&&g(ue,{uid:u.value,payload:n},"updateAnalysisUncertainty").then(s=>x.updateAnalysisUncertainty(s))}function Z(n,s={}){o.value=n,l.value=!0,f.value=(n?"CREATE":"EDIT")+" ANALYSIS UNCERTAINTY",n?(u.value=null,C({values:{instrumentUid:"",methodUid:"",min:"",max:"",value:""}})):(u.value=s.uid??null,F({instrumentUid:s.instrumentUid??"",methodUid:s.methodUid??"",min:s.min??"",max:s.max??"",value:s.value??""}))}const j=q(n=>{const s=v?.value?.uid;if(!s)return;const m={instrumentUid:n.instrumentUid,methodUid:n.methodUid,min:Number(n.min),max:Number(n.max),value:Number(n.value),analysisUid:s};o.value===!0&&I(m),o.value===!1&&T(m),l.value=!1}),D={analysisStore:x,setupStore:r,withClientMutation:g,props:y,analysis:v,get showModal(){return l},set showModal(n){l=n},get formTitle(){return f},set formTitle(n){f=n},formAction:o,currentUid:u,uncertaintySchema:N,handleSubmit:q,resetForm:C,setValues:F,instrumentUid:O,instrumentError:P,methodUid:Y,methodError:H,min:K,minError:W,max:z,maxError:G,variance:Q,varianceError:X,instruments:w,methods:M,addAnalysisUncertainty:I,editAnalysisUncertainty:T,FormManager:Z,saveForm:j,instrumentName:n=>{const s=w?.value?.findIndex(m=>m.uid===n);return w?.value[s]?.name||"unknown"},methodName:n=>{const s=M?.value?.findIndex(m=>m.uid===n);return M?.value[s]?.name||"unknown"}};return Object.defineProperty(D,"__isScriptSetup",{enumerable:!1,value:!0}),D}}),be={class:"overflow-x-auto mt-4"},pe={class:"align-middle inline-block min-w-full shadow overflow-hidden bg-card text-card-foreground rounded-lg border border-border"},xe={class:"min-w-full fel-table"},ge={class:"bg-card"},ye={class:"px-4 py-2 whitespace-nowrap border-b border-border"},ve={class:"text-sm text-foreground"},he={class:"px-4 py-2 whitespace-nowrap border-b border-border"},_e={class:"text-sm text-foreground"},Ue={class:"px-4 py-2 whitespace-nowrap border-b border-border"},we={class:"text-sm text-foreground"},Me={class:"px-4 py-2 whitespace-nowrap border-b border-border"},Ee={class:"text-sm text-foreground"},ke={class:"px-4 py-2 whitespace-nowrap border-b border-border"},Se={class:"text-sm text-foreground"},Ae={class:"px-4 py-2 whitespace-nowrap text-right border-b border-border"},Ve=["onClick"],Ne={class:"text-lg font-bold text-foreground"},qe={class:"space-y-4"},Ce={class:"grid grid-cols-5 gap-4"},Fe={class:"space-y-2"},Ie=["value"],Te={key:0,class:"text-sm text-destructive"},De={class:"space-y-2"},Be=["value"],Le={key:0,class:"text-sm text-destructive"},Re={class:"space-y-2"},Je={key:0,class:"text-sm text-destructive"},Oe={class:"space-y-2"},Pe={key:0,class:"text-sm text-destructive"},Ye={class:"space-y-2"},He={key:0,class:"text-sm text-destructive"};function Ke(V,t,x,r,g,y){const v=E("fel-button"),l=E("fel-heading"),f=E("fel-modal");return d(),a(U,null,[L(l,{title:"Uncertainty"},{default:_(()=>[L(v,{onClick:t[0]||(t[0]=o=>r.FormManager(!0))},{default:_(()=>[...t[8]||(t[8]=[se("Add Uncertainty",-1)])]),_:1})]),_:1}),e("div",be,[e("div",pe,[e("table",xe,[t[9]||(t[9]=e("thead",null,[e("tr",null,[e("th",{class:"px-4 py-2 border-b border-border text-left text-sm font-medium text-muted-foreground"},"Instrument"),e("th",{class:"px-4 py-2 border-b border-border text-left text-sm font-medium text-muted-foreground"},"Method"),e("th",{class:"px-4 py-2 border-b border-border text-left text-sm font-medium text-muted-foreground"},"Min"),e("th",{class:"px-4 py-2 border-b border-border text-left text-sm font-medium text-muted-foreground"},"Max"),e("th",{class:"px-4 py-2 border-b border-border text-left text-sm font-medium text-muted-foreground"},"Variance (+/-)"),e("th",{class:"px-4 py-2 border-b border-border"})])],-1)),e("tbody",ge,[(d(!0),a(U,null,k(r.analysis?.uncertainties,o=>(d(),a("tr",{key:o?.uid,class:"hover:bg-accent/50"},[e("td",ye,[e("div",ve,i(r.instrumentName(o?.instrumentUid)),1)]),e("td",he,[e("div",_e,i(r.methodName(o?.methodUid)),1)]),e("td",Ue,[e("div",we,i(o.min),1)]),e("td",Me,[e("div",Ee,i(o.max),1)]),e("td",ke,[e("div",Se,i(o.value),1)]),e("td",Ae,[e("button",{onClick:u=>r.FormManager(!1,o),class:"px-2 py-1 mr-2 border border-border bg-background text-foreground transition-colors duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-ring hover:bg-accent hover:text-accent-foreground"},"Edit",8,Ve)])]))),128))])])])]),r.showModal?(d(),ne(f,{key:0,onClose:t[7]||(t[7]=o=>r.showModal=!1),contentWidth:"w-2/4"},{header:_(()=>[e("h3",Ne,i(r.formTitle),1)]),body:_(()=>[e("form",{onSubmit:t[6]||(t[6]=de((...o)=>r.saveForm&&r.saveForm(...o),["prevent"])),class:"p-6 space-y-6"},[e("div",qe,[e("div",Ce,[e("label",Fe,[t[11]||(t[11]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Instrument",-1)),b(e("select",{class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":t[1]||(t[1]=o=>r.instrumentUid=o)},[t[10]||(t[10]=e("option",{value:""},"Select Instrument",-1)),(d(!0),a(U,null,k(r.instruments,o=>(d(),a("option",{key:o?.uid,value:o.uid},i(o?.name),9,Ie))),128))],512),[[R,r.instrumentUid]]),r.instrumentError?(d(),a("p",Te,i(r.instrumentError),1)):c("",!0)]),e("label",De,[t[13]||(t[13]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Method",-1)),b(e("select",{class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":t[2]||(t[2]=o=>r.methodUid=o)},[t[12]||(t[12]=e("option",{value:""},"Select Method",-1)),(d(!0),a(U,null,k(r.methods,o=>(d(),a("option",{key:o?.uid,value:o.uid},i(o?.name),9,Be))),128))],512),[[R,r.methodUid]]),r.methodError?(d(),a("p",Le,i(r.methodError),1)):c("",!0)]),e("label",Re,[t[14]||(t[14]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Min",-1)),b(e("input",{type:"number",class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":t[3]||(t[3]=o=>r.min=o),placeholder:"Value ..."},null,512),[[S,r.min]]),r.minError?(d(),a("p",Je,i(r.minError),1)):c("",!0)]),e("label",Oe,[t[15]||(t[15]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Max",-1)),b(e("input",{type:"number",class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":t[4]||(t[4]=o=>r.max=o),placeholder:"Value ..."},null,512),[[S,r.max]]),r.maxError?(d(),a("p",Pe,i(r.maxError),1)):c("",!0)]),e("label",Ye,[t[16]||(t[16]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Variance +/-",-1)),b(e("input",{type:"number",class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":t[5]||(t[5]=o=>r.variance=o),placeholder:"Value ..."},null,512),[[S,r.variance]]),r.varianceError?(d(),a("p",He,i(r.varianceError),1)):c("",!0)])])]),t[17]||(t[17]=e("div",{class:"pt-4"},[e("button",{type:"submit",class:"w-full bg-primary text-primary-foreground hover:bg-primary/90 rounded-lg px-4 py-2 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-ring"}," Save Form ")],-1))],32)]),_:1})):c("",!0)],64)}const $e=oe(fe,[["render",Ke],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/analyses/services/Uncertainty.vue"]]);export{$e as default};
