import{W as ue,f as ce,a8 as fe,a2 as h,h as q,a9 as me,r as H,o as n,c as r,O as o,J as m,a7 as l,F as p,H as g,a as O,M as U,N as pe,z as P,C as b,D as y,Z as B,a4 as k,af as X,L as Y,a0 as ge,ah as ye,a1 as ve,ai as xe,_ as be}from"./index-93739211.js";import{u as _e,D as he,a as ke,b as we,c as Re,d as Ce}from"./reflex.mutations-d934ee0f.js";import{u as Ae}from"./analysis-689a99f8.js";const Ue={class:"space-y-6"},Be={class:"flex items-center justify-between"},De={class:"text-2xl font-semibold text-foreground"},Ve={class:"mt-2 text-muted-foreground"},Oe={class:"space-y-4"},Ee={class:"flex items-center space-x-2 p-4"},Ne=["onClick"],Se={class:"text-foreground"},je={class:"p-4 space-y-4"},$e={class:"flex items-center justify-between"},Fe=["onClick"],Te={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Me={class:"flex items-center justify-between"},Le={class:"text-lg font-medium text-foreground"},qe={class:"flex items-center space-x-2"},He=["onClick"],Pe=["onClick"],Xe={class:"text-sm text-muted-foreground"},Ye={class:"text-xl font-semibold text-foreground"},ze={class:"grid grid-cols-1 gap-4"},Je={class:"block"},We={class:"block"},Ze=["value"],Ge={class:"block"},Ke={class:"text-xl font-semibold text-foreground"},Qe={class:"block"},Ie={class:"space-y-4"},eo={class:"flex items-center justify-between"},oo={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},to={class:"flex items-center justify-between"},so={class:"flex items-center space-x-2"},no=["onClick"],ro=["onClick"],io={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},lo={class:"block"},ao=["onUpdate:modelValue","onChange"],uo=["value"],co={class:"block"},fo=["onUpdate:modelValue"],mo={class:"block"},po=["onUpdate:modelValue"],go=["onUpdate:modelValue"],yo=["value"],vo={class:"flex justify-end"},xo=["onClick"],bo={class:"space-y-4"},_o={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ho={class:"flex items-center justify-between"},ko=["onClick"],wo={class:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4"},Ro={class:"block"},Co=["onUpdate:modelValue"],Ao=["value"],Uo={class:"block"},Bo=["onUpdate:modelValue"],Do={class:"flex justify-end mt-2"},Vo=["onClick"],Oo={class:"flex items-center justify-between"},Eo=["onClick"],No={class:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4"},So={class:"block"},jo=["onUpdate:modelValue","onChange"],$o=["value"],Fo={class:"block"},To=["onUpdate:modelValue"],Mo=["onUpdate:modelValue"],Lo=["value"],qo={class:"flex justify-end mt-2"},Ho=["onClick"],Po=ue({__name:"Reflex",setup(Xo){const z=ge(()=>ve(()=>import("./index-93739211.js").then(s=>s.cT),["assets/index-93739211.js","assets/index-0f090789.css"])),x=_e(),J=Ae(),{withClientMutation:D}=ce(),W=fe();let w=h(!1),V=h(""),f=q({});const R=h(!0);let C=h(!1),u=q({description:"",priority:0,conditions:[],actions:[]});me(async()=>{x.fetchReflexRuleByUid(W.params?.uid)});const Z=s=>{const e=xe(s);return e.charAt(0).toUpperCase()+e.slice(1)},A=J.getAnalysesServicesSimple;function G(){const s={reflexRuleUid:x.reflexRule?.uid,level:f.level,description:f.description,analyses:f.analyses};D(ke,{payload:s},"createReflexAction").then(e=>x.addReflexAction(e))}function K(){const s={reflexRuleUid:x.reflexRule?.uid,level:f.level,description:f.description,analyses:f.analyses};D(we,{uid:f.uid,payload:s},"updateReflexAction").then(e=>x.updateReflexAction(e))}function j(s,e={}){if(R.value=s,w.value=!0,V.value=(s?"CREATE":"EDIT")+" REFLEX ACTION",s)Object.assign(f,{});else{let a=[];e.analyses?.forEach(_=>a.push(_?.uid)),Object.assign(f,{...e,analyses:a})}}function Q(){R.value===!0&&G(),R.value===!1&&K(),w.value=!1}const E=h();function I(){const s={...u,reflexActionUid:E.value};D(Re,{payload:s},"createReflexBrain").then(e=>x.updateReflexBrain(e))}function ee(){const s={reflexActionUid:E.value,priority:u.priority,description:u.description,conditions:u.conditions?.map(e=>({description:e.description,priority:e.priority,criteria:e.criteria?.map(a=>({analysisUid:a.analysisUid,operator:a.operator,value:a.value}))})),actions:u.actions?.map(e=>({addNew:e.addNew?.map(a=>({analysisUid:a.analysisUid,count:a.count})),finalise:e.finalise?.map(a=>({analysisUid:a.analysisUid,value:a.value}))}))};D(Ce,{uid:u.uid,payload:s},"updateReflexBrain").then(e=>x.updateReflexBrain(e))}function $(){u.conditions?.push({description:"",priority:0,criteria:[]})}function oe(s){u.conditions?.splice(s,1)}function te(){u.actions?.push({addNew:[],finalise:[]})}function F(s){u.conditions[s].criteria?.push({operator:"eq"})}function se(s,e){u.conditions[s].criteria?.splice(e,1)}let N=h([]);function ne(s,e){const a=A?.find(_=>_.uid===e.analysisUid);e.value=void 0,N.value=a?.resultOptions||[]}function T(s){u.actions[s]?.addNew?.push({})}function re(s){u.actions[0]?.addNew?.splice(s,1)}function M(s){u.actions[0]?.finalise?.push({})}function ie(s){u.actions[s]?.finalise?.splice(s,1)}let S=h([]);function le(s,e){const a=A?.find(_=>_.uid===e.analysisUid);e.value=void 0,S.value=a?.resultOptions||[]}function L(s,e,a={}){R.value=s,C.value=!0,V.value=(s?"CREATE":"EDIT")+" REFLEX BRAIN",E.value=e,s?(Object.assign(u,{priority:0,description:"",conditions:[],actions:[]}),$(),F(0),te(),T(0),M()):Object.assign(u,{...a})}function de(){R.value===!0&&I(),R.value===!1&&ee(),C.value=!1}function ae(s,e){ye.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(a=>{a.isConfirmed&&D(he,{uid:e},"deleteReflexBrain").then(_=>x.deleteReflexBrain(s,e))})}return(s,e)=>{const a=H("font-awesome-icon"),_=H("fel-modal");return n(),r("div",Ue,[o("div",Be,[o("div",null,[o("h2",De,m(l(x).reflexRule?.name),1),o("p",Ve,m(l(x).reflexRule?.description),1)]),o("button",{onClick:e[0]||(e[0]=i=>j(!0)),class:"bg-primary text-primary-foreground px-4 py-2 rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Add Reflex Action ")]),o("div",Oe,[(n(!0),r(p,null,g(l(x).reflexRule?.reflexActions,i=>(n(),r("section",{key:i?.uid,class:"rounded-md border border-border"},[O(l(z),null,{title:U(()=>[o("div",Ee,[o("button",{onClick:c=>j(!1,i),class:"text-muted-foreground hover:text-foreground transition-colors duration-200"},[O(a,{icon:"edit",class:"text-md"})],8,Ne),o("span",Se,[pe(" Reflex Action Level "+m(i?.level)+" targeting ",1),(n(!0),r(p,null,g(i?.analyses,c=>(n(),r("span",{key:c.uid,class:"text-primary"},m(c?.name)+m(i?.analyses?.indexOf(c)!==i?.analyses?.length-1?", ":""),1))),128))])])]),body:U(()=>[o("div",je,[o("div",$e,[e[8]||(e[8]=o("h3",{class:"text-lg font-medium text-foreground"},"Reflex Action Brains",-1)),o("button",{onClick:c=>L(!0,i?.uid,{}),class:"bg-primary text-primary-foreground px-4 py-2 rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Add Brain ",8,Fe)]),o("div",Te,[(n(!0),r(p,null,g(i?.brains,(c,d)=>(n(),r("div",{key:c?.uid,class:"rounded-md border border-border p-4 space-y-2"},[o("div",Me,[o("h4",Le,m(Z(d+1))+" Brain ",1),o("div",qe,[o("button",{onClick:v=>L(!1,i.uid,c),class:"text-muted-foreground hover:text-foreground transition-colors duration-200"},[O(a,{icon:"edit",class:"text-md"})],8,He),o("button",{onClick:v=>ae(i.uid,c.uid),class:"text-destructive hover:text-destructive/80 transition-colors duration-200"},[O(a,{icon:"trash",class:"text-md"})],8,Pe)])]),o("p",Xe,m(c?.description),1)]))),128))])])]),_:2},1024)]))),128))]),l(w)?(n(),P(_,{key:0,onClose:e[4]||(e[4]=i=>X(w)?w.value=!1:w=!1)},{header:U(()=>[o("h3",Ye,m(l(V)),1)]),body:U(()=>[o("form",{onSubmit:b(Q,["prevent"]),class:"space-y-6 p-4"},[o("div",ze,[o("label",Je,[e[9]||(e[9]=o("span",{class:"text-sm font-medium text-foreground"},"Level",-1)),y(o("input",{class:"mt-1 block w-full rounded-md border-border shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50","onUpdate:modelValue":e[1]||(e[1]=i=>l(f).level=i),type:"number",min:"1",placeholder:"Level ..."},null,512),[[B,l(f).level]])]),o("label",We,[e[10]||(e[10]=o("span",{class:"text-sm font-medium text-foreground"},"Target Analyses",-1)),y(o("select",{"onUpdate:modelValue":e[2]||(e[2]=i=>l(f).analyses=i),class:"mt-1 block w-full rounded-md border-border shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50",multiple:""},[(n(!0),r(p,null,g(l(A),i=>(n(),r("option",{key:i.uid,value:i.uid},m(i.name),9,Ze))),128))],512),[[k,l(f).analyses]])]),o("label",Ge,[e[11]||(e[11]=o("span",{class:"text-sm font-medium text-foreground"},"Description",-1)),y(o("textarea",{class:"mt-1 block w-full rounded-md border-border shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50","onUpdate:modelValue":e[3]||(e[3]=i=>l(f).description=i),placeholder:"Description ...",rows:"3"},null,512),[[B,l(f).description]])])]),e[12]||(e[12]=o("div",{class:"flex justify-end"},[o("button",{type:"submit",class:"bg-primary text-primary-foreground px-4 py-2 rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Save Reflex Action ")],-1))],32)]),_:1})):Y("",!0),l(C)?(n(),P(_,{key:1,onClose:e[7]||(e[7]=i=>X(C)?C.value=!1:C=!1),"content-width":"w-4/5"},{header:U(()=>[o("h3",Ke,m(l(V)),1)]),body:U(()=>[o("form",{onSubmit:b(de,["prevent"]),class:"space-y-6 p-4"},[o("label",Qe,[e[13]||(e[13]=o("span",{class:"text-sm font-medium text-foreground"},"Description",-1)),y(o("textarea",{class:"mt-1 block w-full rounded-md border-border shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50","onUpdate:modelValue":e[5]||(e[5]=i=>l(u).description=i),placeholder:"Description ...",rows:"3"},null,512),[[B,l(u).description]])]),o("div",Ie,[o("div",eo,[e[14]||(e[14]=o("h3",{class:"text-lg font-medium text-foreground"},"Conditions (OR)",-1)),o("button",{onClick:e[6]||(e[6]=b(i=>$(),["prevent"])),class:"bg-primary text-primary-foreground px-4 py-2 rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Add Condition ")]),e[22]||(e[22]=o("p",{class:"text-sm text-muted-foreground"},"Criteria under a condition are evaluated as AND whilst conditions are evaluated as OR",-1)),o("div",oo,[(n(!0),r(p,null,g(l(u).conditions,(i,c)=>(n(),r("section",{key:c,class:"rounded-md border border-border p-4 space-y-4"},[o("div",to,[o("div",so,[e[15]||(e[15]=o("h4",{class:"text-md font-medium text-foreground"},"Criteria (AND)",-1)),o("button",{onClick:b(d=>F(c),["prevent"]),class:"bg-primary text-primary-foreground px-3 py-1 rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Add Criteria ",8,no)]),o("button",{onClick:b(d=>oe(c),["prevent"]),class:"bg-destructive text-destructive-foreground px-3 py-1 rounded-md hover:bg-destructive/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-destructive focus:ring-offset-2"}," Remove Condition ",8,ro)]),(n(!0),r(p,null,g(i.criteria,(d,v)=>(n(),r("div",{key:v,class:"space-y-4"},[o("div",io,[o("label",lo,[e[17]||(e[17]=o("span",{class:"text-sm font-medium text-foreground"},"Analysis",-1)),y(o("select",{"onUpdate:modelValue":t=>d.analysisUid=t,class:"mt-1 block w-full rounded-md border-border shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50",onChange:t=>ne(t,d)},[e[16]||(e[16]=o("option",{value:""},null,-1)),(n(!0),r(p,null,g(l(A),t=>(n(),r("option",{key:t.uid,value:t.uid},m(t.name),9,uo))),128))],40,ao),[[k,d.analysisUid]])]),o("label",co,[e[19]||(e[19]=o("span",{class:"text-sm font-medium text-foreground"},"Operator",-1)),y(o("select",{"onUpdate:modelValue":t=>d.operator=t,class:"mt-1 block w-full rounded-md border-border shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50"},[...e[18]||(e[18]=[o("option",{value:"eq"},"=",-1),o("option",{value:"gt"},">",-1),o("option",{value:"lt"},"<",-1),o("option",{value:"neq"},"≠",-1)])],8,fo),[[k,d.operator]])]),o("label",mo,[e[21]||(e[21]=o("span",{class:"text-sm font-medium text-foreground"},"Result",-1)),l(N).length==0?y((n(),r("input",{key:0,class:"mt-1 block w-full rounded-md border-border shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50","onUpdate:modelValue":t=>d.value=t,type:"text",placeholder:"Result ..."},null,8,po)),[[B,d.value]]):y((n(),r("select",{key:1,"onUpdate:modelValue":t=>d.value=t,class:"mt-1 block w-full rounded-md border-border shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50"},[e[20]||(e[20]=o("option",{value:""},null,-1)),(n(!0),r(p,null,g(l(N),t=>(n(),r("option",{key:t.uid,value:t.value},m(t.value),9,yo))),128))],8,go)),[[k,d.value]])])]),o("div",vo,[o("button",{onClick:b(t=>se(c,v),["prevent"]),class:"bg-destructive text-destructive-foreground px-3 py-1 rounded-md hover:bg-destructive/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-destructive focus:ring-offset-2"}," Remove Criteria ",8,xo)])]))),128))]))),128))])]),o("div",bo,[e[32]||(e[32]=o("h3",{class:"text-lg font-medium text-foreground"},"Actions",-1)),e[33]||(e[33]=o("p",{class:"text-sm text-muted-foreground"},"If conditions are met, auto create new analyses and or set final results",-1)),o("div",_o,[(n(!0),r(p,null,g(l(u).actions,(i,c)=>(n(),r("div",{key:c,class:"rounded-md border border-border p-4 space-y-4"},[(n(!0),r(p,null,g(i.addNew,(d,v)=>(n(),r("div",{key:v},[o("div",ho,[e[23]||(e[23]=o("h4",{class:"text-md font-medium text-foreground"},"Create Analyses",-1)),o("button",{onClick:b(t=>T(v),["prevent"]),class:"bg-primary text-primary-foreground px-3 py-1 rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Add Analysis ",8,ko)]),o("div",wo,[o("label",Ro,[e[25]||(e[25]=o("span",{class:"text-sm font-medium text-foreground"},"Analysis",-1)),y(o("select",{"onUpdate:modelValue":t=>d.analysisUid=t,class:"mt-1 block w-full rounded-md border-border shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50"},[e[24]||(e[24]=o("option",{value:""},null,-1)),(n(!0),r(p,null,g(l(A),t=>(n(),r("option",{key:t.uid,value:t.uid},m(t.name),9,Ao))),128))],8,Co),[[k,d.analysisUid]])]),o("label",Uo,[e[26]||(e[26]=o("span",{class:"text-sm font-medium text-foreground"},"Count",-1)),y(o("input",{class:"mt-1 block w-full rounded-md border-border shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50","onUpdate:modelValue":t=>d.count=t,type:"number",placeholder:"How Many ...",default:"1"},null,8,Bo),[[B,d.count]])])]),o("div",Do,[o("button",{onClick:b(t=>re(v),["prevent"]),class:"bg-destructive text-destructive-foreground px-3 py-1 rounded-md hover:bg-destructive/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-destructive focus:ring-offset-2"}," Remove ",8,Vo)])]))),128))]))),128)),(n(!0),r(p,null,g(l(u).actions,(i,c)=>(n(),r("div",{key:c,class:"rounded-md border border-border p-4 space-y-4"},[(n(!0),r(p,null,g(i.finalise,(d,v)=>(n(),r("div",{key:v},[o("div",Oo,[e[27]||(e[27]=o("h4",{class:"text-md font-medium text-foreground"},"Set Final Analyses",-1)),o("button",{onClick:b(t=>M(v),["prevent"]),class:"bg-primary text-primary-foreground px-3 py-1 rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Add Analysis ",8,Eo)]),o("div",No,[o("label",So,[e[29]||(e[29]=o("span",{class:"text-sm font-medium text-foreground"},"Analysis",-1)),y(o("select",{"onUpdate:modelValue":t=>d.analysisUid=t,class:"mt-1 block w-full rounded-md border-border shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50",onChange:t=>le(t,d)},[e[28]||(e[28]=o("option",{value:""},null,-1)),(n(!0),r(p,null,g(l(A),t=>(n(),r("option",{key:t.uid,value:t.uid},m(t.name),9,$o))),128))],40,jo),[[k,d.analysisUid]])]),o("label",Fo,[e[31]||(e[31]=o("span",{class:"text-sm font-medium text-foreground"},"Result",-1)),l(S).length==0?y((n(),r("input",{key:0,class:"mt-1 block w-full rounded-md border-border shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50","onUpdate:modelValue":t=>d.value=t,type:"text",placeholder:"Result ..."},null,8,To)),[[B,d.value]]):y((n(),r("select",{key:1,"onUpdate:modelValue":t=>d.value=t,class:"mt-1 block w-full rounded-md border-border shadow-sm focus:border-primary focus:ring focus:ring-primary focus:ring-opacity-50"},[e[30]||(e[30]=o("option",{value:""},null,-1)),(n(!0),r(p,null,g(l(S),t=>(n(),r("option",{key:t.uid,value:t.value},m(t.value),9,Lo))),128))],8,Mo)),[[k,d.value]])])]),o("div",qo,[o("button",{onClick:b(t=>ie(v),["prevent"]),class:"bg-destructive text-destructive-foreground px-3 py-1 rounded-md hover:bg-destructive/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-destructive focus:ring-offset-2"}," Remove ",8,Ho)])]))),128))]))),128))])]),e[34]||(e[34]=o("div",{class:"flex justify-end"},[o("button",{type:"submit",class:"bg-primary text-primary-foreground px-4 py-2 rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Save Reflex Brain ")],-1))],32)]),_:1})):Y("",!0)])}}}),Wo=be(Po,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/admin/reflex/_id/Reflex.vue"]]);export{Wo as default};
