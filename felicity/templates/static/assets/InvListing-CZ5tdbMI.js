const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FelDataTable-BgRrYa9n.js","assets/index-Daoe3XS9.js","assets/index-C7Rn7ES8.css","assets/StockReceiveForm-CKHCojNN.js","assets/vue-multiselect.esm-C31Sh9AO.js","assets/index.esm-BT7_X8h2.js","assets/inventory.queries-QHmwiWhL.js","assets/inventory-BkEPpJMt.js","assets/storage-DVAgmrnV.js","assets/setup-B4brziEy.js","assets/user-B30GGGOK.js","assets/StockReceiveForm-CvK01SLk.css","assets/ProductDetail-DSJabJMD.js","assets/index-Cgdayxkn.js"])))=>i.map(i=>d[i]);
import{a0 as A,a as t,P as o,a1 as f,r as u,F as i,a9 as p,a2 as m,J as D,f as T,g as P,a7 as d,a5 as _,h as U,a6 as h,a8 as c}from"./index-Daoe3XS9.js";import{u as j,a as I}from"./inventory-BkEPpJMt.js";import{G as M}from"./inventory.queries-QHmwiWhL.js";import{p as S}from"./index-Cgdayxkn.js";const q=f(()=>h(()=>import("./FelDataTable-BgRrYa9n.js"),__vite__mapDeps([0,1,2]))),B=f(()=>h(()=>import("./StockReceiveForm-CKHCojNN.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11]))),V=f(()=>h(()=>import("./ProductDetail-DSJabJMD.js"),__vite__mapDeps([12,1,2,6,13]))),H=A({name:"stock-listing",setup(e,N){const{withClientMutation:v,withClientQuery:w}=T(),n=j();n.fetchProducts({first:50,after:"",text:"",sortBy:["-uid"]});const s=P({product:{},quantity:0,stockLotUid:"",type:"",remarks:""}),b=d(!1),y=d([]),L=r=>{w(M,{productUid:r},"stockLots").then(l=>{y.value=l})};_(()=>s.product?.uid,(r,l)=>r&&L(r));const g=d(!1),x=d(!1),k=d({}),C=d([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Name",value:"stockItem.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Type",value:"name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Category",value:"stockItem.category.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Hazard",value:"stockItem.hazard.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Quantity",value:"quantity",sortable:!1,sortBy:"asc",hidden:!1},{name:"Description",value:"description",sortable:!1,sortBy:"asc",hidden:!1},{name:"Actions",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(r,l){return c("div",{class:"flex justify-start align-items-center gap-x-4"},[c("button",{type:"button",class:"bg-primary text-primary-foreground py-1 px-2 rounded-sm leading-none disabled:bg-muted",innerHTML:"+ Basket",disabled:r.quantity<1,onClick:()=>{s.product=r,s.quantity=0,b.value=!0}},[]),c("button",{type:"button",class:"bg-primary text-primary-foreground py-1 px-2 rounded-sm leading-none disabled:bg-muted",innerHTML:"+/- Adjust",disabled:r.quantity<1,onClick:()=>{s.product=r,s.quantity=0,g.value=!0}},[]),c("button",{type:"button",class:"bg-primary text-primary-foreground py-1 px-2 rounded-sm leading-none",innerHTML:"View Detail",onClick:()=>{x.value=!0,k.value=r}},[])])}}]),a=P({first:50,before:"",text:"",sortBy:["-uid"],filterAction:!1});return{tableColumns:C,inventoryStore:n,openDrawer:d(!1),openAddProduct:b,choiceProduct:s,openAdjustProduct:g,stockLots:y,openProductDetail:x,productDetailItem:k,filterProducts:r=>{a.first=50,a.before="",a.text=r.filterText,a.filterAction=!0,n.fetchProducts(a)},showMoreProducts:r=>{a.first=r.fetchCount,a.before=n.productsPaging?.pageInfo?.endCursor??"",a.text=r.filterText,a.filterAction=!1,n.fetchProducts(a)},countNone:U(()=>n.products?.length+" of "+n.productsPaging.totalCount+" products"),validateMinMax:r=>{},adjustStock:()=>{v(I,{payload:{productUid:s.product.uid,stockLotUid:s.stockLotUid,adjustmentType:s.type,adjust:s.quantity,remarks:s.remarks}},"createStockAdjustment").then(r=>{})}}},render(){return t(D,null,[t("div",{class:"space-y-4"},[t("button",{onClick:()=>this.openDrawer=!0,class:"px-4 py-2 text-sm font-medium text-primary-foreground bg-primary border border-transparent rounded-md shadow-sm hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors duration-200"},[o("Receive Stock")])]),t(q,{columns:this.tableColumns,data:this.inventoryStore.products,toggleColumns:!1,loading:!1,paginable:!0,pageMeta:{fetchCount:10,hasNextPage:!1,countNone:this.countNone},searchable:!0,filterable:!1,selectable:!1,onOnSearch:e=>this.filterProducts(e),onOnPaginate:e=>this.showMoreProducts(e)},null),t(u("fel-drawer"),{show:this.openDrawer,onClose:()=>this.openDrawer=!1},{header:()=>"Receive Stock",body:()=>[t(B,{onClose:()=>this.openDrawer=!1},null)]}),t(u("fel-drawer"),{show:this.openProductDetail,onClose:()=>this.openProductDetail=!1},{header:()=>"Product Details",body:()=>[t(V,{product:this.productDetailItem,onClose:()=>this.openProductDetail=!1},null)]}),this.openAddProduct&&t(u("fel-modal"),{onClose:()=>this.openAddProduct=!1,contentWidth:"w-1/4"},{header:()=>t("h3",{class:"text-lg font-medium text-foreground"},[this.choiceProduct.product?.stockItem?.name,o(" ("),this.choiceProduct.product.name,o(")")]),body:()=>t("form",{action:"post",class:"space-y-4 p-4"},[t("div",{class:"space-y-2"},[t("label",{class:"block text-sm font-medium text-foreground"},[o("Product Lot")]),i(t("select",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200","onUpdate:modelValue":e=>this.choiceProduct.stockLotUid=e,"aria-label":"Product Lot"},[t("option",{value:""},null),this.stockLots?.map(e=>t("option",{key:e.uid,value:e.uid},[e.lotNumber,o(" ("),e.quantity,o(") ["),S(e.expiryDate,!1),o("]")]))]),[[p,this.choiceProduct.stockLotUid]])]),t("div",{class:"space-y-2"},[t("label",{class:"block text-sm font-medium text-foreground"},[o("Quantity")]),i(t("input",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200",type:"number",onChange:this.validateMinMax,"onUpdate:modelValue":e=>this.choiceProduct.quantity=e,placeholder:"Quantity..."},null),[[m,this.choiceProduct.quantity]])]),t("div",{class:"border-t border-border my-4"},null),t("button",{type:"button",onClick:()=>{this.inventoryStore.addToBasket(this.choiceProduct.product.uid,this.choiceProduct.stockLotUid,this.choiceProduct.quantity),this.openAddProduct=!1},class:"w-full px-4 py-2 text-sm font-medium text-primary-foreground bg-primary border border-transparent rounded-md shadow-sm hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",disabled:!this.choiceProduct.stockLotUid},[o("Add to basket")])])}),this.openAdjustProduct&&t(u("fel-modal"),{onClose:()=>this.openAdjustProduct=!1,contentWidth:"w-1/4"},{header:()=>t("h3",{class:"text-lg font-medium text-foreground"},[this.choiceProduct.product?.stockItem?.name,o(" ("),this.choiceProduct.product.name,o(")")]),body:()=>t("form",{action:"post",class:"space-y-4 p-4"},[t("div",{class:"space-y-2"},[t("label",{class:"block text-sm font-medium text-foreground"},[o("Product Lot")]),i(t("select",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200","onUpdate:modelValue":e=>this.choiceProduct.stockLotUid=e,"aria-label":"Product Lot"},[t("option",{value:""},null),this.stockLots?.map(e=>t("option",{key:e.uid,value:e.uid},[e.lotNumber]))]),[[p,this.choiceProduct.stockLotUid]])]),t("div",{class:"space-y-2"},[t("label",{class:"block text-sm font-medium text-foreground"},[o("Adjustment Type")]),i(t("select",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200","onUpdate:modelValue":e=>this.choiceProduct.type=e,"aria-label":"Adjustment Type"},[t("option",{value:"lost"},[o("Lost")]),t("option",{value:"theft"},[o("Theft")]),t("option",{value:"transfer-out"},[o("Transfer Out")])]),[[p,this.choiceProduct.type]])]),t("div",{class:"space-y-2"},[t("label",{class:"block text-sm font-medium text-foreground"},[o("Quantity")]),i(t("input",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200",type:"number",onChange:this.validateMinMax,"onUpdate:modelValue":e=>this.choiceProduct.quantity=e,placeholder:"Quantity..."},null),[[m,this.choiceProduct.quantity]])]),t("div",{class:"space-y-2"},[t("label",{class:"block text-sm font-medium text-foreground"},[o("Remarks")]),i(t("textarea",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200",rows:"3","onUpdate:modelValue":e=>this.choiceProduct.remarks=e,placeholder:"Remarks..."},null),[[m,this.choiceProduct.remarks]])]),t("div",{class:"border-t border-border my-4"},null),t("button",{type:"button",onClick:()=>{this.adjustStock(),this.openAdjustProduct=!1},class:"w-full px-4 py-2 text-sm font-medium text-primary-foreground bg-primary border border-transparent rounded-md shadow-sm hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed",disabled:!this.choiceProduct.stockLotUid},[o("Adjust")])])})])}});export{H as InventoryListing,H as default};
