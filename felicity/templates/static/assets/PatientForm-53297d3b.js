import{d as be,I as ge,u as xe,J as Ue,n as J,p as C,q as ye,a8 as Ne,r as B,aE as De,av as Pe,m as Me,o as c,c as m,b as e,e as o,v as p,f as l,i as r,t as a,ae as W,L as Ve,g as X,ad as D,F as b,C as g,y as ke,w as Q,aM as Se,k as Ce}from"./index-06e172a4.js";import Be from"./vue-multiselect.esm-7066afb0.js";import{A as Ie}from"./patient.mutations-02ce4553.js";import{u as Oe}from"./client-cc579a4e.js";import{u as $e}from"./location-11442f09.js";import{u as qe}from"./patient-17d0183e.js";import{c as Z,d as P,a as _,f as Ee,g as ee,u as Fe,b as d}from"./array-e4b47dec.js";/* empty css                                                                 */const Ye={class:"flex whitespace-nowrap w-full"},Re=e("span",{class:"text-gray-700 w-4/12"},"Patient Unique Identifier",-1),Ae={class:"w-full"},je={class:"text-orange-600 w-4/12"},Le={class:"flex whitespace-nowrap w-full"},He=e("span",{class:"text-gray-700 w-4/12"},"First Name",-1),Ge={class:"w-full"},Ke={class:"text-orange-600 w-4/12"},Te={class:"flex whitespace-nowrap mb-2 w-full"},ze=e("span",{class:"text-gray-700 w-4/12"},"Middle Name",-1),Je={class:"w-full"},We={class:"text-orange-600 w-4/12"},Xe={class:"flex whitespace-nowrap w-full"},Qe=e("span",{class:"text-gray-700 w-4/12"},"Last Name",-1),Ze={class:"w-full"},et={class:"text-orange-600 w-4/12"},tt={class:"flex whitespace-nowrap my-2 w-full"},st=e("span",{class:"text-gray-700 w-4/12"},"Age/DOB Estimated?",-1),nt={class:"w-full flex justify-between items-center"},lt={class:"flex justify-start items-center gap-x-2 ml-4"},it={for:"estimateYears"},at=e("span",{class:"mr-1"},"Years",-1),ot={for:"estimateMonths"},dt=e("span",{class:"mr-1"},"Months",-1),ut={for:"estimateDays"},rt=e("span",{class:"mr-1"},"Days",-1),ct={class:"text-orange-600 w-4/12"},mt={class:"flex whitespace-nowrap mb-2 w-full"},pt=e("span",{class:"text-gray-700 w-4/12"},"Date of Birth",-1),ft={class:"w-full"},vt={class:"text-orange-600 w-4/12"},_t={class:"flex whitespace-nowrap mb-2 w-full"},wt=e("span",{class:"text-gray-700 w-4/12"},"Age",-1),ht={class:"w-full"},bt={class:"text-orange-600 w-4/12"},gt={class:"flex whitespace-nowrap mb-2 w-full"},xt=e("span",{class:"text-gray-700 w-4/12"},"Gender",-1),Ut={class:"w-full"},yt=e("option",null,null,-1),Nt=["value"],Dt={class:"text-orange-600 w-4/12"},Pt={class:"flex whitespace-nowrap mb-2 w-full"},Mt=e("span",{class:"text-gray-700 w-4/12"},"Mobile Number",-1),Vt={class:"w-full"},kt={class:"text-orange-600 w-4/12"},St={class:"flex whitespace-nowrap mb-2 w-full"},Ct=e("span",{class:"text-gray-700 w-4/12"},"Consent to SMS",-1),Bt={class:"w-full"},It={class:"text-orange-600 w-4/12"},Ot={class:"flex whitespace-nowrap mb-2 w-full"},$t=e("span",{class:"text-gray-700 w-4/12"},"Primary Referrer",-1),qt={class:"w-full"},Et={class:"text-orange-600 w-4/12"},Ft={class:"flex whitespace-nowrap mb-2 w-full"},Yt={class:"text-gray-700 w-4/12 flex justify-between items-center"},Rt=e("span",{class:"mr-4"},"Extra Ids:",-1),At={class:"w-full border-gray-200"},jt={class:"flex justify-around items-center w-full"},Lt=e("span",null,"Identification",-1),Ht=["onUpdate:modelValue"],Gt=e("option",null,null,-1),Kt=["value"],Tt=e("span",null,"Value",-1),zt=["onUpdate:modelValue"],Jt=["onClick"],Wt=e("hr",{class:"my-2"},null,-1),Xt={class:"grid grid-cols-3 gap-x-4 mb-4"},Qt={class:"col-span-1"},Zt={class:"flex gap-x-2 items-center whitespace-nowrap w-full"},es=e("span",{class:"text-gray-700 w-4/12"},"Country",-1),ts=e("option",{value:null},null,-1),ss=["value"],ns={class:"text-orange-600 w-4/12"},ls={class:"col-span-1"},is={class:"flex gap-x-2 items-center whitespace-nowrap col-span-1 w-full"},as=e("span",{class:"text-gray-700 w-4/12"},"Province",-1),os=e("option",{value:null},null,-1),ds=["value"],us={class:"text-orange-600 w-4/12"},rs={class:"col-span-1"},cs={class:"flex gap-x-2 items-center whitespace-nowrap col-span-1 w-full"},ms=e("span",{class:"text-gray-700 w-4/12"},"District",-1),ps=e("option",{value:null},null,-1),fs=["value"],vs={class:"text-orange-600 w-4/12"},_s=e("hr",null,null,-1),ws=e("button",{type:"submit",class:"-mb-4 w-1/5 border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Save Patient ",-1),hs=be({__name:"PatientForm",props:{patient:Object,navigate:{type:Boolean,default:!1}},emits:["close"],setup(te,{emit:se}){const x=te,G=se;let K=Oe(),f=$e(),M=qe();const{withClientMutation:T}=ge();let ne=xe(),le=Ue();const U=J({genders:["Male","Female","Missing","Trans Gender"],createAction:!0,countries:C(()=>f.getCountries),provinces:C(()=>f.getProvinces),districts:C(()=>f.getDistricts),clients:C(()=>K.getClients)});let ie=J({first:void 0,after:"",text:"",sortBy:["name"],filterAction:!1});ye(async()=>{await f.fetchCountries(),await K.fetchClients(ie),x.patient?.countryUid&&await f.filterProvincesByCountry(x.patient?.countryUid),x.patient?.provinceUid&&await f.filterDistrictsByProvince(x.patient?.provinceUid),await M.fetchIdentifications()});const{patient:i,navigate:ae}=Ne(x),oe=B(new Date),V=B(0),I=B(0),O=B(0),w=()=>{const n=Se().subtract(V.value,"year").subtract(I.value,"month").subtract(O.value,"day");h.value=n.format("YYYY-MM-DD"),y.value=V.value},de=()=>{var n=new Date().getFullYear();if(h.value){const t=new Date(h.value).getFullYear();y.value=n-t}},ue=Z({uid:P(),clientPatientId:_().required("Client Patient ID is Required"),patientId:_().nullable(),firstName:_().required("First Name is Required"),middleName:_().nullable(),lastName:_().required("Last Name is Required"),client:Z().required("Client is Required"),gender:_().required("Gender is Required"),age:P().nullable(),dateOfBirth:Ee().nullable(),ageDobEstimated:ee().nullable(),phoneHome:_().nullable(),phoneMobile:_().nullable(),consentSms:ee().nullable(),districtUid:P().nullable(),provinceUid:P().nullable(),countryUid:P().nullable()}),{handleSubmit:re,errors:u}=Fe({validationSchema:ue,initialValues:{uid:i?.value?.uid,clientPatientId:i?.value?.clientPatientId||le?.query?.cpid,patientId:i?.value?.patientId,firstName:i?.value?.firstName,middleName:i?.value?.middleName,lastName:i?.value?.lastName,client:i?.value?.client,gender:i?.value?.gender,age:i?.value?.age,dateOfBirth:De(i?.value?.dateOfBirth)?void 0:new Date(i?.value?.dateOfBirth).toISOString().split("T")[0],ageDobEstimated:i?.value?.ageDobEstimated,phoneHome:i?.value?.phoneHome,phoneMobile:i?.value?.phoneMobile,consentSms:i?.value?.consentSms,districtUid:i?.value?.districtUid,provinceUid:i?.value?.provinceUid,countryUid:i?.value?.countryUid,identifications:i?.value?.identifications??[]}}),{value:$}=d("clientPatientId"),{value:q}=d("firstName"),{value:E}=d("middleName"),{value:F}=d("lastName"),{value:Y}=d("client"),{value:R}=d("gender"),{value:y}=d("age"),{value:h}=d("dateOfBirth"),{value:N}=d("ageDobEstimated"),{value:A}=d("phoneMobile"),{value:j}=d("consentSms"),{value:L}=d("districtUid"),{value:k}=d("provinceUid"),{value:S}=d("countryUid"),{value:H}=d("identifications"),z=re(n=>{n.uid||ce(n),n.uid&&me(n)});function ce(n){T(Ie,{payload:{clientPatientId:n.clientPatientId,firstName:n.firstName,middleName:n.middleName,lastName:n.lastName,age:n.age,gender:n.gender,dateOfBirth:Pe(n.dateOfBirth,"YYYY-MM-DD HH:mm"),ageDobEstimated:n.ageDobEstimated,clientUid:n.client.uid,phoneMobile:n.phoneMobile,consentSms:n.consentSms,countryUid:n.countryUid,provinceUid:n.provinceUid,districtUid:n.districtUid,identifications:n.identifications}},"createPatient").then(t=>{M.addPatient(t),G("close",t),ae.value===!0&&ne.push({name:"patient-detail",params:{patientUid:t.uid}})})}function me(n){T(UpdatePatientDocument,{uid:n.uid,payload:{clientPatientId:n.clientPatientId,firstName:n.firstName,middleName:n.middleName,lastName:n.lastName,age:n.age,gender:n.gender,dateOfBirth:n.dateOfBirth,ageDobEstimated:n.ageDobEstimated,clientUid:n.client.uid,phoneMobile:n.phoneMobile,consentSms:n.consentSms,countryUid:n.countryUid,provinceUid:n.provinceUid,districtUid:n.districtUid,identifications:n.identifications?.map(t=>({identificationUid:t.identificationUid,value:t.value}))}},"updatePatient").then(t=>{M.updatePatient(t),G("close",t)})}function pe(n){f.filterProvincesByCountry(S.value)}function fe(n){f.filterDistrictsByProvince(k.value)}const ve=()=>{H.value.push({identificationUid:"12122",value:""})},_e=n=>{H.value.splice(n,1)};return(n,t)=>{const we=Me("VueDatePicker");return c(),m("form",{onSubmit:t[27]||(t[27]=Q((...s)=>l(z)&&l(z)(...s),["prevent"])),class:"border-2 border-gray-900 border-dotted rounded-sm px-4 py-8",autocomplete:"off"},[e("label",Ye,[Re,e("div",Ae,[o(e("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":t[0]||(t[0]=s=>r($)?$.value=s:null),placeholder:"Patient Unique Identifier"},null,512),[[p,l($)]]),e("div",je,a(l(u).clientPatientId),1)])]),e("label",Le,[He,e("div",Ge,[o(e("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":t[1]||(t[1]=s=>r(q)?q.value=s:null),placeholder:"First Name"},null,512),[[p,l(q)]]),e("div",Ke,a(l(u).firstName),1)])]),e("label",Te,[ze,e("div",Je,[o(e("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":t[2]||(t[2]=s=>r(E)?E.value=s:null),placeholder:"Middle Name"},null,512),[[p,l(E)]]),e("div",We,a(l(u).middleName),1)])]),e("label",Xe,[Qe,e("div",Ze,[o(e("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":t[3]||(t[3]=s=>r(F)?F.value=s:null),placeholder:"Last Name"},null,512),[[p,l(F)]]),e("div",et,a(l(u).lastName),1)])]),e("label",tt,[st,e("div",nt,[o(e("input",{type:"checkbox",class:"form-checkbox text-sky-800","onUpdate:modelValue":t[4]||(t[4]=s=>r(N)?N.value=s:null)},null,512),[[W,l(N)]]),o(e("div",lt,[e("label",it,[at,o(e("input",{name:"estimateYears",type:"number",min:"0",class:"form-input w-24 py-0 text-sky-800","onUpdate:modelValue":t[5]||(t[5]=s=>V.value=s),onChange:t[6]||(t[6]=s=>w()),onKeyup:t[7]||(t[7]=s=>w())},null,544),[[p,V.value]])]),e("label",ot,[dt,o(e("input",{name:"estimateMonths",type:"number",min:"0",max:"12",class:"form-input w-24 py-0 text-sky-800","onUpdate:modelValue":t[8]||(t[8]=s=>I.value=s),onChange:t[9]||(t[9]=s=>w()),onKeyup:t[10]||(t[10]=s=>w())},null,544),[[p,I.value]])]),e("label",ut,[rt,o(e("input",{name:"estimateDays",type:"number",min:"0",max:"365",class:"form-input w-24 py-0 text-sky-800","onUpdate:modelValue":t[11]||(t[11]=s=>O.value=s),onChange:t[12]||(t[12]=s=>w()),onKeyup:t[13]||(t[13]=s=>w())},null,544),[[p,O.value]])])],512),[[Ve,l(N)]]),e("div",ct,a(l(u).ageDobEstimated),1)])]),e("label",mt,[pt,e("div",ft,[X(we,{class:"z-60 disabled:bg-slate-200",modelValue:l(h),"onUpdate:modelValue":t[14]||(t[14]=s=>r(h)?h.value=s:null),disabled:l(N),onClosed:t[15]||(t[15]=s=>de()),"max-date":oe.value},null,8,["modelValue","disabled","max-date"]),e("div",vt,a(l(u).dateOfBirth),1)])]),e("label",_t,[wt,e("div",ht,[o(e("input",{class:"form-input mt-1 w-full disabled:bg-slate-200",type:"number","onUpdate:modelValue":t[16]||(t[16]=s=>r(y)?y.value=s:null),placeholder:"Age",disabled:""},null,512),[[p,l(y)]]),e("div",bt,a(l(u).age),1)])]),e("label",gt,[xt,e("div",Ut,[o(e("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":t[17]||(t[17]=s=>r(R)?R.value=s:null)},[yt,(c(!0),m(b,null,g(U.genders,s=>(c(),m("option",{key:s,value:s},a(s),9,Nt))),128))],512),[[D,l(R)]]),e("div",Dt,a(l(u).gender),1)])]),e("label",Pt,[Mt,e("div",Vt,[o(e("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":t[18]||(t[18]=s=>r(A)?A.value=s:null),placeholder:"Mobile Number"},null,512),[[p,l(A)]]),e("div",kt,a(l(u).phoneMobile),1)])]),e("label",St,[Ct,e("div",Bt,[o(e("input",{type:"checkbox",class:"form-checkbox text-sky-800","onUpdate:modelValue":t[19]||(t[19]=s=>r(j)?j.value=s:null)},null,512),[[W,l(j)]]),e("div",It,a(l(u).consentSms),1)])]),ke(" other identifiers: passport, client pid, national id "),e("label",Ot,[$t,e("div",qt,[X(l(Be),{placeholder:"Select a Primary Referrer",modelValue:l(Y),"onUpdate:modelValue":t[20]||(t[20]=s=>r(Y)?Y.value=s:null),options:U.clients,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","options"]),e("div",Et,a(l(u).client),1)])]),e("label",Ft,[e("span",Yt,[Rt,e("div",null,[e("span",{class:"relative px-1 mr-2 mt-4 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none",onClick:t[21]||(t[21]=s=>ve())}," Add ")])]),e("div",At,[(c(!0),m(b,null,g(l(H),(s,he)=>(c(),m("div",jt,[Lt,o(e("select",{class:"form-select mt-1","onUpdate:modelValue":v=>s.identificationUid=v},[Gt,(c(!0),m(b,null,g(l(M).identifications,v=>(c(),m("option",{key:v.uid,value:v.uid},a(v.name),9,Kt))),128))],8,Ht),[[D,s.identificationUid]]),Tt,o(e("input",{type:"text",class:"form-input text-sky-800","onUpdate:modelValue":v=>s.value=v},null,8,zt),[[p,s.value]]),e("span",{class:"p-2 text-red-800",onClick:Q(v=>_e(he),["prevent"])},"X",8,Jt)]))),256))])]),Wt,e("div",Xt,[e("div",Qt,[e("label",Zt,[es,o(e("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":t[22]||(t[22]=s=>r(S)?S.value=s:null),onChange:t[23]||(t[23]=s=>pe())},[ts,(c(!0),m(b,null,g(U.countries,s=>(c(),m("option",{key:s.uid,value:s.uid},a(s.name),9,ss))),128))],544),[[D,l(S)]])]),e("div",ns,a(l(u).countryUid),1)]),e("div",ls,[e("label",is,[as,o(e("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":t[24]||(t[24]=s=>r(k)?k.value=s:null),onChange:t[25]||(t[25]=s=>fe())},[os,(c(!0),m(b,null,g(U.provinces,s=>(c(),m("option",{key:s.uid,value:s.uid},a(s.name),9,ds))),128))],544),[[D,l(k)]])]),e("div",us,a(l(u).provinceUid),1)]),e("div",rs,[e("label",cs,[ms,o(e("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":t[26]||(t[26]=s=>r(L)?L.value=s:null)},[ps,(c(!0),m(b,null,g(U.districts,s=>(c(),m("option",{key:s.uid,value:s.uid},a(s.name),9,fs))),128))],512),[[D,l(L)]])])]),e("div",vs,a(l(u).districtUid),1)]),_s,ws],32)}}}),Ms=Ce(hs,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/person/PatientForm.vue"]]);export{Ms as default};
