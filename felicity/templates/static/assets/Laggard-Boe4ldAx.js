import{Y as A,aB as w,a0 as x,a7 as S,ah as k,an as C,bo as N,_ as B,c as u,o as m,C as j,z as t,a as d,K as r,M as b,I as _}from"./index-OdhKCqIc.js";import{C as D}from"./index-Bq8gZhK2.js";import{u as z}from"./dashboard-Ahkf2TxK.js";import{E as F,a as H,b as M,c as V,d as O}from"./EmptyTitle-aCQRDpx3.js";import{S as R}from"./Spinner-Bl8RfjFA.js";import"./value-Cwgbb3dI.js";import"./string-CE8GzbCR.js";const W=A({__name:"Laggard",setup(T,{expose:e}){e();const c=z(),{dashboard:n}=w(c),p=x(0),y=x(0),E=S(()=>(n.value.laggards??[]).length>0);k(()=>{c.getSampleLaggards()}),C(()=>n.value.laggards,async s=>{if(!s?.length)return;await N();const o=s?.filter(g=>g?.category==="delayed_and_incomplete")[0],a=s?.filter(g=>g?.category==="authorised_already_delayed")[0];p.value=o?.counts?.totalIncomplete??0;const i=[{item:"On-Time",count:o?.counts?.totalDelayed,percent:o?.counts?.totalIncomplete>0?o?.counts?.totalDelayed/o?.counts?.totalIncomplete*100:0},{item:"Delayed",count:o?.counts?.totalNotDelayed,percent:o?.counts?.totalIncomplete>0?o?.counts?.totalNotDelayed/o?.counts?.totalIncomplete*100:0}];f(i,"late-active-donut");const l=[{type:"<10",value:o?.counts?.lessThanTen},{type:"10 - 20",value:o?.counts?.tenToTwenty},{type:"20 - 30",value:o?.counts?.twentyToThirty},{type:"> 30",value:o?.counts?.graterThanThirty}];v(l,"late-active-since","days since created","number of samples"),y.value=a?.counts?.totalIncomplete??0;const I=[{item:"On-Time",count:a?.counts?.totalDelayed,percent:a?.counts?.totalIncomplete>0?a?.counts?.totalDelayed/a?.counts?.totalIncomplete*100:0},{item:"Delayed",count:a?.counts?.totalNotDelayed,percent:a?.counts?.totalIncomplete>0?a?.counts?.totalNotDelayed/a?.counts?.totalIncomplete*100:0}];f(I,"late-auth-donut");const L=[{type:"<10",value:a?.counts?.lessThanTen},{type:"10 - 20",value:a?.counts?.tenToTwenty},{type:"20 - 30",value:a?.counts?.twentyToThirty},{type:"> 30",value:a?.counts?.graterThanThirty}];v(L,"late-auth-since","days: created to authorised","number of samples")});const v=(s,o,a,i)=>{const l=new D({container:o,autoFit:!0,height:200,width:600});l.data(s),l.scale({value:{max:150,min:0,alias:i},type:{alias:a}}),l.axis("type",{title:{offset:60,style:{fontSize:12,fontWeight:300}},tickLine:null,line:null}),l.axis("value",{label:null,title:{offset:30,style:{fontSize:12,fontWeight:300}}}),l.legend(!1),l.coordinate().transpose(),l.interval().position("type*value").size(26).label("value",{style:{fill:"hsl(var(--muted-foreground))"},offset:10}),l.interaction("element-active"),l.render()},f=(s,o)=>{const a=new D({container:o,autoFit:!0,height:150,width:300});a.data(s),a.scale("percent",{formatter:i=>`${(i*100).toFixed(2)}%`}),a.coordinate("theta",{radius:.75,innerRadius:.6}),a.interval().adjust("stack").position("percent").color("item").label("percent",{content:i=>`${i.item}: ${(i.percent*100).toFixed(2)}%`}),a.interaction("element-active"),a.render()},h={dashBoardStore:c,dashboard:n,totalIncompleteDAI:p,totalIncompleteAAD:y,hasLaggards:E,plotLateSince:v,plotLateDonut:f,resetLateActive:()=>{const s=document.getElementById("late-active");s&&(s.innerHTML=`
      <div class="mx-8">
        <div id="late-active-donut"></div>
      </div>
      <div>
        <div id="late-active-since"></div>
      </div>
    `)},resetLateAuth:()=>{const s=document.getElementById("late-auth");s&&(s.innerHTML=`
      <div class="mx-8">
        <div id="late-auth-donut"></div>
      </div>
      <div>
        <div id="late-auth-since"></div>
      </div>
    `)},get Empty(){return O},get EmptyContent(){return V},get EmptyDescription(){return M},get EmptyHeader(){return H},get EmptyTitle(){return F},get Spinner(){return R}};return Object.defineProperty(h,"__isScriptSetup",{enumerable:!1,value:!0}),h}}),K={class:"mt-4"},P={key:0,class:"text-start my-4"},Y={class:"inline-flex items-center gap-2"},q={key:1,class:"mt-4"},G={key:2},J={class:"flex justify-start items-center"},Q={class:"bg-background shadow rounded-sm px-6 pt-3 pb-5 border border-foreground text-center"},U={class:"font-bold text-foreground text-2xl"},X={class:"mt-8"},Z={class:"flex justify-start items-center"},$={class:"bg-background shadow rounded-sm px-6 pt-3 pb-5 border border-foreground text-center"},tt={class:"font-bold text-foreground text-2xl"};function et(T,e,c,n,p,y){return m(),u("div",K,[n.dashboard.fetchingLaggards?(m(),u("div",P,[t("span",Y,[d(n.Spinner,{class:"size-4"}),e[0]||(e[0]=t("span",{class:"text-sm"},"Fetching laggard stats...",-1))])])):j("",!0),!n.dashboard.fetchingLaggards&&!n.hasLaggards?(m(),u("div",q,[d(n.Empty,{class:"border-0 bg-muted/40"},{default:r(()=>[d(n.EmptyContent,null,{default:r(()=>[d(n.EmptyHeader,null,{default:r(()=>[d(n.EmptyTitle,null,{default:r(()=>[...e[1]||(e[1]=[b("No laggard data yet",-1)])]),_:1}),d(n.EmptyDescription,null,{default:r(()=>[...e[2]||(e[2]=[b("There are no delayed samples in this period.",-1)])]),_:1})]),_:1})]),_:1})]),_:1})])):(m(),u("div",G,[t("section",null,[e[5]||(e[5]=t("h1",{class:"text-xl text-foreground font-semibold"},"Delayed and incomplete",-1)),e[6]||(e[6]=t("hr",{class:"my-2"},null,-1)),t("div",J,[t("div",Q,[t("div",U,_(n.totalIncompleteDAI),1),e[3]||(e[3]=t("div",{class:"font-semibold text-muted-foreground"},"Already Delayed",-1))]),e[4]||(e[4]=t("div",{id:"late-active",class:"flex justify-start items-center ms-8"},[t("div",{class:"me-8"},[t("div",{id:"late-active-donut"})]),t("div",null,[t("div",{id:"late-active-since"})])],-1))])]),t("section",X,[e[9]||(e[9]=t("h1",{class:"text-xl text-foreground font-semibold"},"Authorised already delayed",-1)),e[10]||(e[10]=t("hr",{class:"my-2"},null,-1)),t("div",Z,[t("div",$,[t("div",tt,_(n.totalIncompleteAAD),1),e[7]||(e[7]=t("div",{class:"font-semibold text-muted-foreground"},"Authorised Already Delayed",-1))]),e[8]||(e[8]=t("div",{id:"late-auth",class:"flex justify-start items-center ms-8"},[t("div",{class:"me-8"},[t("div",{id:"late-auth-donut"})]),t("div",null,[t("div",{id:"late-auth-since"})])],-1))])])]))])}const ut=B(W,[["render",et],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/dashboard/Laggard.vue"]]);export{ut as default};
