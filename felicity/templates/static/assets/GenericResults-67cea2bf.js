import{P as ge,u as fe,f as xe,Z as q,r as ke,$ as ve,o,c as n,b as e,a as u,a2 as _,A as d,W as z,F as p,D as y,a1 as we,x as L,J as P,L as b,E as i,a4 as $,V as Re,a5 as F,C as k,K as h,z as v,X as A,Y as D,ap as W,h as Ce,_ as Ue}from"./index-fa13e788.js";import{u as Ee}from"./analysis-265e51d4.js";import{h as w,o as R,a as C}from"./constants-68671847.js";import"./analyses.mutations-bfee3c87.js";const Ve=e("hr",{class:"mt-4 mb-2"},null,-1),Ae=e("h3",{class:"font-bold"},"Analyses/Results",-1),De=e("hr",{class:"mb-4 mt-2"},null,-1),Ie={class:"overflow-x-auto"},Se={class:"align-middle inline-block min-w-full shadow overflow-hidden bg-white shadow-dashboard px-2 pt-1 rounded-bl-lg rounded-br-lg"},Te={key:0,class:"py-4 text-center"},Le={key:1,class:"min-w-full"},Pe={class:"px-1 py-1 border-b-2 border-gray-300 text-left leading-4 text-gray-800 tracking-wider"},$e=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left leading-4 text-gray-800 tracking-wider"},null,-1),Ne=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left leading-4 text-gray-800 tracking-wider"}," Analysis ",-1),Be=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Instrument ",-1),Oe=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Method ",-1),Me=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Analyst ",-1),Fe=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Reviewer(s) ",-1),Ke=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Interim ",-1),je=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Result ",-1),Ge=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Retest ",-1),qe=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Due Date ",-1),ze=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Submitted ",-1),We=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Approved ",-1),Je=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Status ",-1),Xe=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Reportable ",-1),Ye=e("th",{class:"px-1 py-1 border-b-2 border-gray-300"},null,-1),Ze={class:"bg-white"},He=["onUpdate:modelValue","onChange","disabled"],Qe=e("td",{class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},null,-1),et={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},tt={class:"text-sm leading-5 text-sky-800 font-semibold"},st=["onClick"],at={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},ot={key:0,class:"text-sm leading-5 text-sky-800"},nt={key:1,class:"block col-span-2 mb-2"},rt=["onUpdate:modelValue","onChange"],lt=e("option",{value:""},null,-1),it=["value"],ct={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},dt={key:0,class:"text-sm leading-5 text-sky-800"},ut={key:1,class:"block col-span-2 mb-2"},_t=["onUpdate:modelValue","onChange"],pt=e("option",{value:""},null,-1),ht=["value"],yt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},bt={class:"text-sm leading-5 text-sky-800"},mt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},gt={class:"text-sm leading-5 text-sky-800"},ft={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},xt={key:0,class:"text-sm leading-5 text-sky-800"},kt={key:1,class:"block col-span-2 mb-2"},vt=["onUpdate:modelValue","onChange"],wt=e("option",{value:""},null,-1),Rt=["value"],Ct={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Ut={key:0,class:"text-sm leading-5 text-sky-800"},Et={key:1,class:"block"},Vt=["onUpdate:modelValue","onKeyup"],At={key:2,class:"block col-span-2 mb-2"},Dt=["onUpdate:modelValue","onChange"],It=e("option",{value:""},null,-1),St=["value"],Tt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Lt={class:"text-sm leading-5 text-sky-800"},Pt={key:0,class:"text-sky-800"},$t={key:1,class:"text-orange-600"},Nt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Bt={class:"text-sm leading-5 text-sky-800"},Ot={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Mt={class:"text-sm leading-5 text-sky-800"},Ft={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Kt={class:"text-sm leading-5 text-sky-800"},jt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Gt={type:"button",class:"bg-sky-800 text-white px-2 py-1 rounded-sm leading-none"},qt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},zt={class:"text-sm leading-5 text-sky-800"},Wt={key:0,class:"text-emerald-600"},Jt={key:1,class:"text-orange-600"},Xt=e("td",{class:"px-1 py-1 whitespace-no-wrap text-right border-b border-gray-500 text-sm leading-5"},null,-1),Yt={class:"my-4"},Zt=e("h3",null,"Result Information",-1),Ht=ge({__name:"GenericResults",props:{sample:Object,analysisResults:Object,fetchingResults:Boolean},setup(N){const m=A(()=>D(()=>import("./FelButton-1d1ff19a.js"),["assets/FelButton-1d1ff19a.js","assets/index-fa13e788.js","assets/index-ccc6a521.css"])),J=A(()=>D(()=>import("./FelLoadingMessage-c4848162.js"),["assets/FelLoadingMessage-c4848162.js","assets/index-fa13e788.js","assets/index-ccc6a521.css"])),X=A(()=>D(()=>import("./FelDrawer-a3c94246.js"),["assets/FelDrawer-a3c94246.js","assets/index-fa13e788.js","assets/index-ccc6a521.css"])),Y=A(()=>D(()=>import("./AnalysisSneak-17375d0c.js"),["assets/AnalysisSneak-17375d0c.js","assets/index-fa13e788.js","assets/index-ccc6a521.css"])),Z=A(()=>D(()=>import("./ResultDetail-15477ca1.js"),["assets/ResultDetail-15477ca1.js","assets/index-fa13e788.js","assets/index-ccc6a521.css"])),{sample:I,analysisResults:S,fetchingResults:Qt}=N,K=fe(),r=xe({can_submit:!1,can_cancel:!1,can_retract:!1,can_approve:!1,can_retest:!1,can_reinstate:!1,allChecked:!1});function B(){let s=[];return S?.forEach(l=>{l.checked&&s.push(l)}),s}function H(){let s=B(),l=[];return s?.forEach(c=>l.push({uid:c.uid,result:c.result,methodUid:c.methodUid,laboratoryInstrumentUid:c.laboratoryInstrumentUid})),l}function U(){const s=B();let l=[];return s?.forEach(c=>l.push(c.uid)),l}function Q(s){te()?r.allChecked=!0:r.allChecked=!1,E()}function g(s){G(s)||(s.checked=!0,E())}function j(s){s.checked=!1,E()}async function ee(){await S?.forEach(s=>r.allChecked?g(s):j(s)),E()}async function f(){await S?.forEach(s=>j(s)),E()}function te(){return S?.every(s=>s.checked===!0)||!1}function G(s){switch(s?.status){case"retracted":return!0;case"approved":return!0;case"cancelled":return I?.status!=="received";default:return!1}}function se(s){s.editable=!0}function T(s){return!["received","paired"].includes(I?.status??"")||s.status!=="pending"?!1:s?.editable||W(s?.result)?(se(s),!0):!1}function ae(s){switch(s?.status){case"retracted":return"bg-gray-300";case"aproved":return s?.reportable===!1?"bg-orange-600":"";default:return""}}function E(){r.can_cancel=!1,r.can_submit=!1,r.can_retract=!1,r.can_approve=!1,r.can_retest=!1,r.can_reinstate=!1;const s=B();s.length!==0&&(s.every(l=>l.status==="cancelled")&&(r.can_reinstate=!0),s.every(l=>l.status==="pending")&&(r.can_cancel=!0),s.every(l=>["pending"].includes(l.status??"")&&!W(l.result))&&(r.can_submit=!0),s.every(l=>l.status==="resulted")&&(r.can_retract=!0,r.can_approve=!0,r.can_retest=!0))}const x=async()=>{const s=Ce(()=>K.getSample);s.value&&K.fetchSampleStatus(s?.uid)},O=q(!1),V=q(void 0),oe=s=>{O.value=!0,V.value=s};let{submitResults:ne,cancelResults:re,reInstateResults:le,approveResults:ie,retractResults:ce,retestResults:de}=Ee();const ue=()=>ne(H(),"sample",I?.uid).then(()=>x()).finally(()=>f()),_e=()=>re(U()).then(()=>x()).finally(()=>f()),pe=()=>le(U()).then(()=>x()).finally(()=>f()),he=()=>ie(U(),"sample",I?.uid).then(()=>x()).finally(()=>f()),ye=()=>ce(U()).then(()=>x()).finally(()=>f()),be=()=>de(U()).then(()=>x()).finally(()=>f());return(s,l)=>{const c=ke("font-awesome-icon"),me=ve("motion-slide-right");return o(),n(p,null,[Ve,Ae,De,e("div",Ie,[e("div",Se,[N.fetchingResults?(o(),n("div",Te,[u(_(J),{message:"Fetching analytes ..."})])):(o(),n("table",Le,[e("thead",null,[e("tr",null,[e("th",Pe,[d(e("input",{type:"checkbox",class:"",onChange:ee,"onUpdate:modelValue":l[0]||(l[0]=t=>r.allChecked=t)},null,544),[[z,r.allChecked]])]),$e,Ne,Be,Oe,Me,Fe,Ke,je,Ge,qe,ze,We,Je,Xe,Ye])]),e("tbody",Ze,[(o(!0),n(p,null,y(N.analysisResults,t=>d((o(),n("tr",{key:t.uid,class:we([ae(t)])},[e("td",null,[d(e("input",{type:"checkbox",class:"border-red-500","onUpdate:modelValue":a=>t.checked=a,onChange:a=>Q(),disabled:G(t)},null,40,He),[[z,t.checked]]),t.status==="pending"?(o(),L(c,{key:0,icon:"fa-question",class:"ml-1 text-xs"})):P("",!0),t.status==="resulted"?(o(),L(c,{key:1,icon:"fa-question",class:"ml-1 text-xs text-orange"})):P("",!0)]),Qe,e("td",et,[e("div",tt,[e("span",{class:"mr-1 hover:cursor-pointer",onClick:a=>oe(t)},[u(c,{icon:"fa-info-circle"})],8,st),b(" "+i(t.analysis?.name),1)])]),e("td",at,[T(t)?(o(),n("label",nt,[d(e("select",{class:"form-input mt-1 block w-full","onUpdate:modelValue":a=>t.laboratoryInstrumentUid=a,onChange:a=>g(t)},[lt,(o(!0),n(p,null,y(t.analysis?.instruments,a=>(o(),n(p,{key:a.uid},[(o(!0),n(p,null,y(a.laboratoryInstruments,M=>(o(),n("option",{key:M.uid,value:M.uid},i(M.labName)+" → ("+i(a?.name)+") ",9,it))),128))],64))),128))],40,rt),[[$,t.laboratoryInstrumentUid]])])):(o(),n("div",ot,i(t.laboratoryInstrument?.labName||"---"),1))]),e("td",ct,[T(t)?(o(),n("label",ut,[d(e("select",{class:"form-input mt-1 block w-full","onUpdate:modelValue":a=>t.methodUid=a,onChange:a=>g(t)},[pt,(o(!0),n(p,null,y(t.analysis?.methods,a=>(o(),n("option",{key:a.uid,value:a.uid},i(a.name),9,ht))),128))],40,_t),[[$,t.methodUid]])])):(o(),n("div",dt,i(t.method?.name||"---"),1))]),e("td",yt,[e("div",bt,i(`${t.submittedBy?.firstName??"--"} ${t.submittedBy?.lastName??"--"}`),1)]),e("td",mt,[e("div",gt,[(o(!0),n(p,null,y(t.verifiedBy,a=>(o(),n("span",{key:a.firstName,class:"ml-1"},i(`${a?.firstName??"--"} ${a?.lastName??"--"},`),1))),128))])]),e("td",ft,[!T(t)||t?.analysis?.interims?.length===0?(o(),n("div",xt," --- ")):(o(),n("label",kt,[d(e("select",{class:"form-input mt-1 block w-full","onUpdate:modelValue":a=>t.result=a,onChange:a=>g(t)},[wt,(o(!0),n(p,null,y(t?.analysis?.interims,a=>(o(),n("option",{key:a.key,value:a.value},i(a.value),9,Rt))),128))],40,vt),[[$,t.result]])]))]),e("td",Ct,[T(t)?t?.analysis?.resultOptions?.length===0?(o(),n("label",Et,[d(e("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":a=>t.result=a,onKeyup:a=>g(t)},null,40,Vt),[[Re,t.result]])])):(o(),n("label",At,[d(e("select",{class:"form-input mt-1 block w-full","onUpdate:modelValue":a=>t.result=a,onChange:a=>g(t)},[It,(o(!0),n(p,null,y(t?.analysis?.resultOptions,a=>(o(),n("option",{key:a.optionKey,value:a.value},i(a.value),9,St))),128))],40,Dt),[[$,t.result]])])):(o(),n("div",Ut,i(t?.result),1))]),e("td",Tt,[e("div",Lt,[t?.retest?(o(),n("span",Pt,[u(c,{icon:"fa-check-circle"})])):(o(),n("span",$t,[u(c,{icon:"fa-times-circle"})]))])]),e("td",Nt,[e("div",Bt,i(_(F)(t?.dueDate)),1)]),e("td",Ot,[e("div",Mt,i(_(F)(t?.dateSubmitted)),1)]),e("td",Ft,[e("div",Kt,i(_(F)(t?.dateVerified)),1)]),e("td",jt,[e("button",Gt,i(t.status),1)]),e("td",qt,[e("div",zt,[t?.reportable?(o(),n("span",Wt,[u(c,{icon:"fa-thumbs-up","aria-hidden":"true"})])):(o(),n("span",Jt,[u(c,{icon:"fa-thumbs-down","aria-hidden":"true"})]))])]),Xt],2)),[[me]])),128))])]))])]),e("section",Yt,[d(u(_(m),{key:"cancel",onClick:v(_e,["prevent"]),color:"sky-800"},{default:h(()=>[b("Cancel")]),_:1},512),[[k,w(C.UPDATE,R.RESULT)&&r.can_cancel]]),d(u(_(m),{key:"reinstate",onClick:v(pe,["prevent"]),color:"orange-600"},{default:h(()=>[b("Re-Instate")]),_:1},512),[[k,w(C.UPDATE,R.RESULT)&&r.can_reinstate]]),d(u(_(m),{key:"submit",onClick:v(ue,["prevent"]),color:"orange-600"},{default:h(()=>[b("Submit")]),_:1},512),[[k,w(C.UPDATE,R.RESULT)&&r.can_submit]]),d(u(_(m),{key:"retract",onClick:v(ye,["prevent"]),color:"orange-600"},{default:h(()=>[b("Retract")]),_:1},512),[[k,w(C.UPDATE,R.RESULT)&&r.can_retract]]),d(u(_(m),{key:"verify",onClick:v(he,["prevent"]),color:"orange-600"},{default:h(()=>[b("Verify")]),_:1},512),[[k,w(C.UPDATE,R.RESULT)&&r.can_approve]]),d(u(_(m),{key:"retest",onClick:v(be,["prevent"]),color:"orange-600"},{default:h(()=>[b("Retest")]),_:1},512),[[k,w(C.UPDATE,R.RESULT)&&r.can_retest]])]),u(_(X),{show:O.value,onClose:l[1]||(l[1]=t=>O.value=!1),"content-width":"w-2/4"},{header:h(()=>[Zt]),body:h(()=>[V.value?.analysisUid?(o(),L(_(Y),{key:0,analysisUid:V.value?.analysisUid},null,8,["analysisUid"])):P("",!0),V.value?.uid?(o(),L(_(Z),{key:1,analysisResultesultUid:V.value?.uid},null,8,["analysisResultesultUid"])):P("",!0)]),_:1},8,["show"])],64)}}}),os=Ue(Ht,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/sample/_id/results/GenericResults.vue"]]);export{os as default};
