import{P as _e,e as me,a9 as he,Z as g,f as X,aa as fe,r as ve,o as n,c as i,b as e,E as f,a2 as a,F as _,D as h,a as S,K as U,L as ye,x as Y,A as v,V as B,a4 as k,z as b,a7 as z,J as H,X as J,S as xe,Y as K,ah as be,_ as ge}from"./index-fa13e788.js";import{u as ke,D as we,a as Re,b as Ce,c as Ae,d as Ue}from"./reflex.mutations-563a7a35.js";import{u as Be}from"./analysis-235f825e.js";const Ve={class:"mt-4 mb-2 text-xl text-gray-600 font-semibold tracking-wide"},De={class:"leading-2 text-md italic tracking-wide"},Se=e("hr",null,null,-1),Ee=e("hr",null,null,-1),Ne=["onClick"],$e={class:"flex justify-start items-center mb-2"},Fe=e("h4",{class:"text-l leading-4 italic"},"Reflex Action Brains",-1),Oe=["onClick"],je={class:"grid grid-cols-3 gap-4"},Te={class:"flex justify-between items-center"},Me={class:"my-2 text-l text-gray-600 font-bold"},Le=["onClick"],Pe=["onClick"],qe={class:"text-gray-500 text-sm"},Xe={action:"post",class:"p-1"},Ye={class:"grid grid-cols-2 gap-x-4 mb-4"},ze={class:"block col-span-1 mb-2"},He=e("span",{class:"text-gray-700"},"Level",-1),Je={class:"block col-span-2 mb-2"},Ke=e("span",{class:"text-gray-700"},"Target Analyses",-1),We=e("option",{value:""},null,-1),Ze=["value"],Ge={class:"block col-span-2 mb-2"},Ie=e("span",{class:"text-gray-700"},"Description",-1),Qe=e("hr",null,null,-1),et={action:"post",class:"p-1"},tt={class:"mb-2"},st=e("span",{class:"text-gray-700"},"Description",-1),ot={class:"flex items-center justify-start my-4 font-bold text-l text-gray-600"},nt=e("span",null,"Conditions (OR)",-1),lt=e("p",{class:"italic text-sm text-gray-400"},"Criteria under a condition are evaluated as AND whilst conditions are evaluated as OR",-1),it={class:"grid grid-cols-2 gap-4 my-4"},at=e("hr",null,null,-1),rt={class:"flex justify-between items-center"},ct={class:"flex justify-start items-center py-2"},dt=e("h5",null,"Criteria (AND)",-1),ut=["onClick"],pt=["onClick"],_t=e("hr",{class:"mb-4"},null,-1),mt={class:"flex items-center justify-between"},ht={class:"flex items-bottom gap-x-2"},ft={class:"flex flex-col whitespace-nowrap mb-2"},vt=e("span",{class:"text-gray-700"},"Analysis",-1),yt=["onUpdate:modelValue","onChange"],xt=e("option",{value:""},null,-1),bt=["value"],gt={class:"flex flex-col whitespace-nowrap mb-2"},kt=e("span",{class:"text-white"},".",-1),wt=["onUpdate:modelValue"],Rt=e("option",{value:"eq"},"=",-1),Ct=e("option",{value:"gt"},">",-1),At=e("option",{value:"lt"},"<",-1),Ut=e("option",{value:"neq"},"â‰ ",-1),Bt=[Rt,Ct,At,Ut],Vt={class:"block col-span-1 mt-1"},Dt=e("span",{class:"text-gray-700"},"Result",-1),St=["onUpdate:modelValue"],Et=["onUpdate:modelValue"],Nt=e("option",{value:""},null,-1),$t=["value"],Ft={class:""},Ot=["onClick"],jt=e("hr",null,null,-1),Tt=e("h3",{class:"mt-4 font-bold text-l text-gray-600"},"Actions",-1),Mt=e("p",{class:"italic text-sm text-gray-400"},"If conditions are met, auto create new analyses and or set final results",-1),Lt={class:"flex justify-start items-center py-2"},Pt=e("h5",null,"Create Analyses",-1),qt=e("span",{class:"text-orange-600"},null,-1),Xt=["onClick"],Yt=e("hr",null,null,-1),zt={class:"flex items-center justify-between"},Ht={class:"flex items-top gap-x-4"},Jt={class:"flex flex-col whitespace-nowrap mb-2"},Kt=e("span",{class:"text-gray-700"},"Analysis",-1),Wt=["onUpdate:modelValue"],Zt=e("option",{value:""},null,-1),Gt=["value"],It={class:"block col-span-1 mb-2"},Qt=e("span",{class:"text-gray-700"},"Count",-1),es=["onUpdate:modelValue"],ts={class:""},ss=["onClick"],os={class:"flex justify-start items-center py-2"},ns=e("h5",null,"Set Final Analyses",-1),ls=e("span",{class:"text-orange-600"},null,-1),is=["onClick"],as=e("hr",null,null,-1),rs={class:"flex items-center justify-between"},cs={class:"flex items-top gap-x-4"},ds={class:"flex flex-col whitespace-nowrap mb-2"},us=e("span",{class:"text-gray-700"},"Analysis",-1),ps=["onUpdate:modelValue","onChange"],_s=e("option",{value:""},null,-1),ms=["value"],hs={class:"block col-span-1 mb-2"},fs=e("span",{class:"text-gray-700"},"Result",-1),vs=["onUpdate:modelValue"],ys=["onUpdate:modelValue"],xs=e("option",{value:""},null,-1),bs=["value"],gs={class:""},ks=["onClick"],ws=e("hr",null,null,-1),Rs=_e({__name:"Reflex",setup(Cs){const O=J(()=>K(()=>import("./index-fa13e788.js").then(s=>s.cN),["assets/index-fa13e788.js","assets/index-ccc6a521.css"])),W=J(()=>K(()=>import("./FelAccordion-03f58c1a.js"),["assets/FelAccordion-03f58c1a.js","assets/index-fa13e788.js","assets/index-ccc6a521.css"])),y=ke(),Z=Be(),{withClientMutation:V}=me(),G=he();let w=g(!1),D=g(""),m=X({});const R=g(!0);let C=g(!1),c=X({description:"",priority:0,conditions:[],actions:[]});fe(async()=>{y.fetchReflexRuleByUid(G.params?.uid)});const I=s=>{const t=be(s);return t.charAt(0).toUpperCase()+t.slice(1)},A=Z.getAnalysesServicesSimple;function Q(){const s={reflexRuleUid:y.reflexRule?.uid,level:m.level,description:m.description,analyses:m.analyses};V(Re,{payload:s},"createReflexAction").then(t=>y.addReflexAction(t))}function ee(){const s={reflexRuleUid:y.reflexRule?.uid,level:m.level,description:m.description,analyses:m.analyses};V(Ce,{uid:m.uid,payload:s},"updateReflexAction").then(t=>y.updateReflexAction(t))}function j(s,t={}){if(R.value=s,w.value=!0,D.value=(s?"CREATE":"EDIT")+" REFLEX ACTION",s)Object.assign(m,{});else{let r=[];t.analyses?.forEach(o=>r.push(o?.uid)),Object.assign(m,{...t,analyses:r})}}function te(){R.value===!0&&Q(),R.value===!1&&ee(),w.value=!1}const E=g();function se(){const s={...c,reflexActionUid:E.value};V(Ae,{payload:s},"createReflexBrain").then(t=>y.updateReflexBrain(t))}function oe(){const s={reflexActionUid:E.value,priority:c.priority,description:c.description,conditions:c.conditions?.map(t=>({description:t.description,priority:t.priority,criteria:t.criteria?.map(r=>({analysisUid:r.analysisUid,operator:r.operator,value:r.value}))})),actions:c.actions?.map(t=>({addNew:t.addNew?.map(r=>({analysisUid:r.analysisUid,count:r.count})),finalise:t.finalise?.map(r=>({analysisUid:r.analysisUid,value:r.value}))}))};V(Ue,{uid:c.uid,payload:s},"updateReflexBrain").then(t=>y.updateReflexBrain(t))}function T(){c.conditions?.push({description:"",priority:0,criteria:[]})}function ne(s){c.conditions?.splice(s,1)}function le(){c.actions?.push({addNew:[],finalise:[]})}function M(s){c.conditions[s].criteria?.push({operator:"eq"})}function ie(s,t){c.conditions[s].criteria?.splice(t,1)}let N=g([]);function ae(s,t){const r=A?.find(o=>o.uid===t.analysisUid);t.value=void 0,N.value=r?.resultOptions||[]}function L(s){c.actions[s]?.addNew?.push({})}function re(s){c.actions[0]?.addNew?.splice(s,1)}function P(s){c.actions[0]?.finalise?.push({})}function ce(s){c.actions[s]?.finalise?.splice(s,1)}let $=g([]);function de(s,t){const r=A?.find(o=>o.uid===t.analysisUid);t.value=void 0,$.value=r?.resultOptions||[]}function q(s,t,r={}){R.value=s,C.value=!0,D.value=(s?"CREATE":"EDIT")+" REFLEX BRAIN",E.value=t,s?(Object.assign(c,{priority:0,description:"",conditions:[],actions:[]}),T(),M(0),le(),L(0),P()):Object.assign(c,{...r})}function ue(){R.value===!0&&se(),R.value===!1&&oe(),C.value=!1}function pe(s,t){xe.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!"}).then(r=>{r.isConfirmed&&V(we,{uid:t},"deleteReflexBrain").then(o=>y.deleteReflexBrain(s,t))})}return(s,t)=>{const r=ve("font-awesome-icon");return n(),i(_,null,[e("h3",Ve,f(a(y).reflexRule?.name),1),e("p",De,f(a(y).reflexRule?.description),1),Se,e("button",{onClick:t[0]||(t[0]=o=>j(!0)),class:"my-4 px-2 py-1 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Add Reflex Action "),Ee,(n(!0),i(_,null,h(a(y).reflexRule?.reflexActions,o=>(n(),i("section",{class:"col-span-1",key:o?.uid},[S(a(W),null,{title:U(()=>[e("span",{class:"p-2",onClick:p=>j(!1,o)},[S(r,{icon:"edit",class:"text-md text-gray-400 mr-1"})],8,Ne),ye(" Reflex Action Level "+f(o?.level)+" targeting ",1),(n(!0),i(_,null,h(o?.analyses,p=>(n(),i("span",{key:p.uid,class:"ml-1"},f(p?.name)+",",1))),128))]),body:U(()=>[e("div",$e,[Fe,e("button",{onClick:p=>q(!0,o?.uid,{}),class:"ml-4 px-2 py-1 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Add Brain ",8,Oe)]),e("div",je,[(n(!0),i(_,null,h(o?.brains,(p,d)=>(n(),i("div",{key:p?.uid,class:"block col-span-1 bg-white py-2 px-4 m"},[e("div",Te,[e("h2",Me,f(I(d+1))+" Brain ",1),e("div",null,[e("span",{class:"p-2",onClick:x=>q(!1,o.uid,p)},[S(r,{icon:"edit",class:"text-md text-gray-400 mr-1"})],8,Le),e("span",{class:"p-2",onClick:x=>pe(o.uid,p.uid)},[S(r,{icon:"trash",class:"text-md text-red-400 mr-1"})],8,Pe)])]),e("p",qe,f(p?.description),1)]))),128))])]),_:2},1024)]))),128)),a(w)?(n(),Y(a(O),{key:0,onClose:t[5]||(t[5]=o=>z(w)?w.value=!1:w=!1)},{header:U(()=>[e("h3",null,f(a(D)),1)]),body:U(()=>[e("form",Xe,[e("div",Ye,[e("label",ze,[He,v(e("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":t[1]||(t[1]=o=>a(m).level=o),type:"number",min:"1",placeholder:"Name ..."},null,512),[[B,a(m).level]])]),e("label",Je,[Ke,v(e("select",{name:"analyses",id:"analyses","onUpdate:modelValue":t[2]||(t[2]=o=>a(m).analyses=o),class:"form-input mt-1 block w-full",multiple:""},[We,(n(!0),i(_,null,h(a(A),o=>(n(),i("option",{key:o.uid,value:o.uid},f(o.name),9,Ze))),128))],512),[[k,a(m).analyses]])]),e("label",Ge,[Ie,v(e("textarea",{cols:"2",class:"form-input mt-1 block w-full","onUpdate:modelValue":t[3]||(t[3]=o=>a(m).description=o),placeholder:"Description ..."},null,512),[[B,a(m).description]])])]),Qe,e("button",{type:"button",onClick:t[4]||(t[4]=b(o=>te(),["prevent"])),class:"-mb-4 w-full border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):H("",!0),a(C)?(n(),Y(a(O),{key:1,onClose:t[9]||(t[9]=o=>z(C)?C.value=!1:C=!1),contentWidth:"w-4/5"},{header:U(()=>[e("h3",null,f(a(D)),1)]),body:U(()=>[e("form",et,[e("label",tt,[st,v(e("textarea",{cols:"2",class:"form-input mt-1 block w-full","onUpdate:modelValue":t[6]||(t[6]=o=>a(c).description=o),placeholder:"Description ..."},null,512),[[B,a(c).description]])]),e("h3",ot,[nt,e("button",{onClick:t[7]||(t[7]=b(o=>T(),["prevent"])),class:"px-2 py-1 ml-4 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Add ")]),lt,e("div",it,[(n(!0),i(_,null,h(a(c).conditions,(o,p)=>(n(),i("section",{class:"bg-slate-100 px-1",id:"criteria",key:p},[at,e("div",rt,[e("div",ct,[dt,e("button",{onClick:b(d=>M(p),["prevent"]),class:"px-2 py-1 ml-4 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," + criteria ",8,ut)]),e("button",{onClick:b(d=>ne(p),["prevent"]),class:"px-2 py-1 mr-2 border-orange-600 border text-orange-600rounded-smtransition duration-300 hover:bg-orange-600 hover:text-white focus:outline-none"}," - condition ",8,pt)]),_t,(n(!0),i(_,null,h(o.criteria,(d,x)=>(n(),i("div",{key:x},[e("div",mt,[e("div",ht,[e("label",ft,[vt,v(e("select",{name:"analysisService",id:"analysisService","onUpdate:modelValue":l=>d.analysisUid=l,class:"form-input mt-1",onChange:l=>ae(l,d)},[xt,(n(!0),i(_,null,h(a(A),l=>(n(),i("option",{key:l.uid,value:l.uid},f(l.name),9,bt))),128))],40,yt),[[k,d.analysisUid]])]),e("label",gt,[kt,v(e("select",{name:"operator",id:"operator","onUpdate:modelValue":l=>d.operator=l,class:"form-input mt-1"},[...Bt],8,wt),[[k,d.operator]])]),e("label",Vt,[Dt,a(N).length==0?v((n(),i("input",{key:0,class:"form-input mt-1 block w-full","onUpdate:modelValue":l=>d.value=l,type:"text",placeholder:"Result ..."},null,8,St)),[[B,d.value]]):v((n(),i("select",{key:1,name:"criteriaValue",id:"criteriaValue","onUpdate:modelValue":l=>d.value=l,class:"form-input"},[Nt,(n(!0),i(_,null,h(a(N),l=>(n(),i("option",{key:l.uid,value:l.value},f(l.value),9,$t))),128))],8,Et)),[[k,d.value]])])]),e("div",Ft,[e("button",{onClick:b(l=>ie(p,x),["prevent"]),class:"px-2 py-1 mt-5 ml-2 border-orange-600 border text-orange-600rounded-smtransition duration-300 hover:bg-orange-600 hover:text-white focus:outline-none"}," - criteria ",8,Ot)])]),jt]))),128))]))),128))]),Tt,Mt,(n(!0),i(_,null,h(a(c).actions,(o,p)=>(n(),i("section",{class:"grid grid-cols-2 gap-x-4 my-4",key:p},[(n(!0),i(_,null,h(o.addNew,(d,x)=>(n(),i("div",{class:"bg-green-50 px-1",key:x},[e("div",Lt,[Pt,qt,e("button",{onClick:b(l=>L(x),["prevent"]),class:"px-2 py-1 ml-4 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Add ",8,Xt)]),Yt,e("div",zt,[e("div",Ht,[e("label",Jt,[Kt,v(e("select",{name:"analysisService",id:"analysisService","onUpdate:modelValue":l=>d.analysisUid=l,class:"form-input mt-1"},[Zt,(n(!0),i(_,null,h(a(A),l=>(n(),i("option",{key:l.uid,value:l.uid},f(l.name),9,Gt))),128))],8,Wt),[[k,d.analysisUid]])]),e("label",It,[Qt,v(e("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":l=>d.count=l,type:"number",placeholder:"How Many ...",default:"1"},null,8,es),[[B,d.count]])])]),e("div",ts,[e("button",{onClick:b(l=>re(x),["prevent"]),class:"px-2 py-1 mr-2 border-orange-600 border text-orange-600rounded-smtransition duration-300 hover:bg-orange-600 hover:text-white focus:outline-none"}," Remove ",8,ss)])])]))),128)),(n(!0),i(_,null,h(a(c).actions,(d,x)=>(n(),i("div",{key:x},[(n(!0),i(_,null,h(d.finalise,(l,F)=>(n(),i("div",{class:"bg-orange-50 px-1",key:F},[e("div",os,[ns,ls,e("button",{onClick:b(u=>P(F),["prevent"]),class:"px-2 py-1 ml-4 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Add ",8,is)]),as,e("div",rs,[e("div",cs,[e("label",ds,[us,v(e("select",{name:"analysisService",id:"analysisService","onUpdate:modelValue":u=>l.analysisUid=u,class:"form-input mt-1",onChange:u=>de(u,l)},[_s,(n(!0),i(_,null,h(a(A),u=>(n(),i("option",{key:u.uid,value:u.uid},f(u.name),9,ms))),128))],40,ps),[[k,l.analysisUid]])]),e("label",hs,[fs,a($).length==0?v((n(),i("input",{key:0,class:"form-input mt-1 block w-full","onUpdate:modelValue":u=>l.value=u,type:"text",placeholder:"Result ..."},null,8,vs)),[[B,l.value]]):v((n(),i("select",{key:1,name:"finalValue",id:"finalValue","onUpdate:modelValue":u=>l.value=u,class:"form-input mt-1"},[xs,(n(!0),i(_,null,h(a($),u=>(n(),i("option",{key:u.uid,value:u.value},f(u.value),9,bs))),128))],8,ys)),[[k,l.value]])])]),e("div",gs,[e("button",{onClick:b(u=>ce(F),["prevent"]),class:"px-2 py-1 mr-2 border-orange-600 border text-orange-600rounded-smtransition duration-300 hover:bg-orange-600 hover:text-white focus:outline-none"}," Remove ",8,ks)])])]))),128))]))),128))]))),128)),ws,e("button",{type:"button",onClick:t[8]||(t[8]=b(o=>ue(),["prevent"])),class:"-mb-4 border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Save ")])]),_:1})):H("",!0)],64)}}}),Vs=ge(Rs,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/admin/reflex/_id/Reflex.vue"]]);export{Vs as default};
