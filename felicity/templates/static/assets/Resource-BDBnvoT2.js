import{a0 as V,ap as N,g as j,a7 as L,ad as E,a5 as S,e as w,_ as U,r as _,c as l,o as n,A as o,E as k,C,F as b,H as R,J as F,K as M,N as g,Q as P,L as u,P as A,a as H,b as z,a2 as D,D as I}from"./index-Daoe3XS9.js";import{C as W}from"./index-CtZXlKlF.js";import{u as J}from"./dashboard--zvjQWHL.js";import"./index-BkD7Hj8s.js";import"./ticks-yQcwDFE8.js";import"./arc-B8IjlRao.js";import"./rgb-Co1IAoj1.js";import"./math-CyDA0WRY.js";import"./index-DaJBD5B5.js";import"./defaultLocale-D2nGpDRe.js";import"./Tableau10-1LCcg9PS.js";import"./range-OtVwhkKS.js";const K=V({__name:"Resource",setup(B,{expose:t}){t();const d=J(),{dashboard:e}=N(d),f=j({range:{from:"",to:""}}),h=L(!1),x=()=>{d.setFilterRange(w(f.range.from),w(f.range.to)),h.value=!1};E(async()=>{r(),d.setShowFilters(!0),d.getResourceStats()}),S(()=>e.value.filterRange.from,()=>{r(),d.getResourceStats()}),S(()=>e.value.resourceStats?.samples,a=>{a?.forEach(i=>{const m=[],c=i.counts?.reduce((s,T)=>s+T.count,0)||0;i.counts?.forEach(s=>{m.push({item:s.group,count:s.count,percent:s.count/c})}),p(m,i.group,i.group)})});const y=a=>{const i=e.value.resourceStats?.instruments?.reduce((c,s)=>c+s.count,0)||0;return`${(a/i*100).toFixed(2)}%`},p=(a,i,m)=>{const c=new W({container:i,autoFit:!0,height:250,width:500});c.options({type:"view",data:a,coordinate:{type:"theta",innerRadius:.5,outerRadius:.75},scale:{color:{type:"ordinal"}},legend:!1,tooltip:{title:!1,items:[s=>({name:s.item,value:`${(s.percent*100).toFixed(2)}%`})]},interaction:{elementHighlight:!0},children:[{type:"interval",encode:{y:"percent",color:"item"},transform:[{type:"stackY"}],labels:[{text:s=>`${s.item} (${s.count})`,position:"spider",connectorDistance:8,connectorLineWidth:.5}]},{type:"text",style:{text:m,x:"50%",y:"50%",textAlign:"center",fontSize:14,fill:"hsl(var(--foreground))"}}]}),c.render()},r=()=>{const a=document.getElementById("user-matrix");a&&(a.innerHTML=`
      <div>
        <div id="registration"></div>
      </div>
      <div>
        <div id="submission"></div>
      </div>
      <div>
        <div id="verification"></div>
      </div>
      <div>
        <div id="publication"></div>
      </div>
    `)},v={dashBoardStore:d,dashboard:e,localState:f,showModal:h,setCustomRange:x,instrumentPerf:y,plotUserMatrix:p,resetUserMatrix:r};return Object.defineProperty(v,"__isScriptSetup",{enumerable:!1,value:!0}),v}}),O={class:"mt-4"},Q={class:"flex justify-between mb-8"},Y={class:"flex justify-end items-center"},q=["onClick"],G={key:0,class:"text-start my-4"},X={class:"mb-8"},Z={key:0,class:"text-muted-foreground"},$={key:1,class:"flex justify-start"},tt={class:"mr-4 font-bold text-foreground text-xl"},et={class:"font-semibold text-muted-foreground text-l"},ot={action:"post",class:"p-1"},rt={class:"grid grid-cols-2 gap-x-4 mb-4"},st={class:"block col-span-2 mb-2"},at={class:"block col-span-2 mb-2"};function nt(B,t,d,e,f,h){const x=_("VTooltip"),y=_("fel-loader"),p=_("fel-modal");return n(),l("div",O,[o("section",Q,[b(o("div",Y,[(n(!0),l(F,null,M(e.dashboard.filters,(r,v)=>b((n(),C(x,{key:v,placements:["right-start"]},{popper:g(()=>[A(u(e.dashBoardStore.filterToolTip(r)),1)]),default:g(()=>[o("button",{onClick:a=>e.dashBoardStore.setCurrentFilter(r),type:"button",class:P(["px-2 py-1 mr-2 border border-foreground text-foreground rounded-sm transition duration-300 hover:bg-primary hover:text-primary-foreground focus:outline-none",{"bg-primary text-primary-foreground":e.dashboard.currentFilter===r}])},u(r),11,q)]),_:2},1024)),[[R,r!==e.dashboard.filters[e.dashboard.filters.length]]])),128)),o("button",{onClick:t[0]||(t[0]=r=>e.showModal=!0),class:"ml-4 mr-1 px-2 py-1 border border-border text-muted-foreground rounded-sm transition duration-300 hover:bg-muted hover:text-primary-foreground focus:outline-none"},u(e.dashboard.filterRange.from)+" - "+u(e.dashboard.filterRange.to),1)],512),[[R,e.dashboard.showFilters]])]),e.dashboard.fetchingResourceStats?(n(),l("div",G,[H(y,{message:"Fetching resource stats..."})])):k("",!0),o("section",null,[o("div",X,[t[5]||(t[5]=o("h1",{class:"text-xl text-foreground font-semibold"},"Instrument Matrix / Load",-1)),t[6]||(t[6]=o("hr",{class:"my-2"},null,-1)),e.dashboard.resourceStats?.instruments?.length?(n(),l("div",$,[(n(!0),l(F,null,M(e.dashboard.resourceStats?.instruments,r=>(n(),l("div",{key:r.group,class:"flex items-center bg-background shadow rounded-sm px-6 pt-3 pb-5 border border-foreground mr-8"},[o("span",tt,u(e.instrumentPerf(r?.count)),1),o("span",et,u(r.group),1)]))),128))])):(n(),l("div",Z," No instrument data available "))]),t[7]||(t[7]=z('<div class="mb-8"><h1 class="text-xl text-foreground font-semibold">User Matrix / Load</h1><hr class="my-2"><div class="flex flex-wrap justify-start" id="user-matrix"><div><div id="registration"></div></div><div><div id="submission"></div></div><div><div id="verification"></div></div><div><div id="publication"></div></div></div></div>',1))]),e.showModal?(n(),C(p,{key:1,onClose:t[4]||(t[4]=r=>e.showModal=!1),contentWidth:"w-1/4"},{header:g(()=>[...t[8]||(t[8]=[o("h3",null,"Custom Filter Date Range",-1)])]),body:g(()=>[o("form",ot,[o("div",rt,[o("label",st,[t[9]||(t[9]=o("span",{class:"text-foreground"},"Date From",-1)),b(o("input",{type:"datetime-local",class:"form-input mt-1 block w-full",autocomplete:"off","onUpdate:modelValue":t[1]||(t[1]=r=>e.localState.range.from=r),placeholder:"Select start date..."},null,512),[[D,e.localState.range.from]])]),o("label",at,[t[10]||(t[10]=o("span",{class:"text-foreground"},"Date To",-1)),b(o("input",{type:"datetime-local",class:"form-input mt-1 block w-full",autocomplete:"off","onUpdate:modelValue":t[2]||(t[2]=r=>e.localState.range.to=r),placeholder:"Select end date..."},null,512),[[D,e.localState.range.to]])])]),t[11]||(t[11]=o("hr",null,null,-1)),o("button",{type:"button",onClick:t[3]||(t[3]=I(r=>e.setCustomRange(),["prevent"])),class:"m-2 -mb-4 w-full rounded-sm border border-primary bg-primary px-4 py-2 text-primary-foreground transition-colors duration-500 ease select-none hover:bg-primary focus:outline-none focus:shadow-outline"}," Apply Filter ")])]),_:1})):k("",!0)])}const xt=U(K,[["render",nt],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/dashboard/Resource.vue"]]);export{xt as default};
