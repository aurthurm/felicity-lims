const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vue-multiselect.esm-Cvm3ZCjW.js","assets/index-OdhKCqIc.js","assets/index-DD18L2yL.css","assets/DataTable-DLBrhw2Z.js","assets/TooltipTrigger-BWIYwmnQ.js","assets/PopperContent-BfyCnGUj.js","assets/Input-BEm5S0CJ.js","assets/SelectValue-Ds0cfAgl.js","assets/useNonce-B4v0IDPb.js","assets/chevron-down-Dqf-ptA3.js","assets/useFocusGuards-Bjb6OG0k.js","assets/Spinner-Bl8RfjFA.js"])))=>i.map(i=>d[i]);
import{Y as se,a0 as S,P as oe,u as ae,aB as le,av as _,a7 as f,ah as ne,a5 as B,a6 as E,aC as I,a3 as re,aD as x,_ as ie,r as ue,c as v,o as p,a as c,z as o,A as de,C as j,K as b,D as O,M as F,E as ce,F as w,H as N,I as me,aG as fe}from"./index-OdhKCqIc.js";import{u as pe}from"./setup-BcFG_bXr.js";import{u as ge}from"./analysis-PB9AMevg.js";import{s as ve}from"./index-DJJ2wcNX.js";import{A as be}from"./analyses.mutations-DUxQZn1r.js";import{p as Se}from"./index-CXV6PIcj.js";import{P as ye}from"./PageHeading-Czi_4opS.js";const he=se({__name:"QualityControlListing",setup(H,{expose:e}){e();const A=B(()=>E(()=>import("./vue-multiselect.esm-Cvm3ZCjW.js"),__vite__mapDeps([0,1,2]))),t=B(()=>E(()=>import("./DataTable-DLBrhw2Z.js"),__vite__mapDeps([3,1,2,4,5,6,7,8,9,10,11]))),P=S([{name:"All",value:""},{name:"Pending",value:"pending"},{name:"Awaiting",value:"awaiting"},{name:"Approved",value:"approved"}]),Q=S([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Date Created",value:"createdAt",sortable:!1,defaultSort:!0,showInToggler:!1,hidden:!1,customRender:function(s,l){return x("div",Se(s.createdAt))}},{name:"Run Sets (samples)",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(s,l){return x("div",L(s.samples??[]))}},{name:"Test(s)",value:"code",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(s,l){return x("div",U(s.samples??[]))}},{name:"Status",value:"status",sortable:!1,defaultSort:!1,showInToggler:!0},{name:"",value:"",sortable:!1,hidden:!1,showInToggler:!1,customRender:function(s,l){return x(I,{to:{name:"qc-set-detail",params:{qcSetUid:s.uid}},class:"px-2 mr-2 border-primary border text-gray-500rounded-smtransition duration-300 hover:bg-primary hover:text-primary-foreground focus:outline-none",innerHTML:"View Run Set"})}}]),i=oe(),a=ge(),g=pe(),{withClientMutation:u}=ae(),{qcSets:V,fetchingQCSets:z}=le(i);let q=_({first:void 0,after:"",text:"",sortBy:["name"]});a.fetchAnalysesServices(q),a.fetchQCLevels(),a.fetchQCTemplates(),a.fetchAnalysesProfiles(),g.fetchDepartments({}),i.resetQCSets();let y=S(25),k=f(()=>`Showing ${V?.value?.length} of ${i.getQCSetCount} QC Sets`),r=_({first:y.value,after:"",status:"",sortBy:["-uid"],filterAction:!1});i.fetchQCSets(r);function G(s){r.first=25,r.after="",r.status=s.filterStatus,r.filterAction=!0,i.fetchQCSets(r)}const K=f(()=>a.getAnalysesProfiles),W=f(()=>{const s=a.getAnalysesServicesSimple;let l=new Set;return s.forEach(n=>{n.profiles?.length===0&&l.add(n)}),[...l]});let h=S(!1),C=S(!0),m=_({departmentUid:void 0,samples:[]});ne(()=>M());function M(){m.samples?.push({qcTemplate:void 0,qcLevels:[],analysisProfiles:[],analysisServices:[]})}function R(){const s=m.samples?.map(l=>({qcTemplateUid:l.qcTemplate?.uid,qcLevels:l.qcLevels?.map(n=>n.uid),analysisProfiles:l.analysisProfiles?.map(n=>n.uid),analysisServices:l.analysisServices?.map(n=>n.uid)}));u(be,{samples:s},"createQcSet").then(l=>i.addQCSets(l?.qcSets))}function Y(s){m.samples?.splice(s,1)}function Z(s,l){C.value=s,h.value=!0,s?Object.assign(m,{}):Object.assign(m,{...l})}function J(){C.value===!0&&R(),h.value=!1}const T=f(()=>i.getQCSetPageInfo);function X(){r.first=+y.value,r.after=T?.value?.pageInfo?.endCursor??"",r.text="",r.filterAction=!1,i.fetchQCSets(r)}function L(s){let l=[];return s?.forEach(n=>{n?.sampleId+""+n.status;let d=n?.qcLevel?.level?.match(/\b([A-Z])/g).join("")+" ("+n.status+")";l.includes(d)||l.push(d)}),l.join(", ")}function U(s){let l=[];return s?.forEach(n=>{n?.profiles?.forEach(d=>{l.includes(d.name)||l.push(d.name)})}),s?.forEach(n=>{n?.analyses?.forEach(d=>{l.includes(d.name)||l.push(d.name)})}),l.join(", ")}const $=f(()=>g.getDepartments),ee=f(()=>a.getQCTemplates),te=f(()=>a.getQCLevels),D={VueMultiselect:A,DataTable:t,filterOptions:P,tableColumns:Q,sampleStore:i,analysisStore:a,setupStore:g,withClientMutation:u,qcSets:V,fetchingQCSets:z,get analysesParams(){return q},set analysesParams(s){q=s},get qcSetBatch(){return y},set qcSetBatch(s){y=s},get qcSetCount(){return k},set qcSetCount(s){k=s},get qcSetParams(){return r},set qcSetParams(s){r=s},searchQCSets:G,analysesProfiles:K,analysesServices:W,get showModal(){return h},set showModal(s){h=s},get formAction(){return C},set formAction(s){C=s},get form(){return m},set form(s){m=s},addQCSet:M,addQCRequest:R,removeQCSet:Y,FormManager:Z,saveForm:J,pageInfo:T,showMoreQCSets:X,qcSetSamples:L,qcSetProfileAnalyses:U,departments:$,qcTemplates:ee,qcLevels:te,get Button(){return re},get RouterLink(){return I},get shield(){return ve},PageHeading:ye};return Object.defineProperty(D,"__isScriptSetup",{enumerable:!1,value:!0}),D}}),Ce={class:"flex justify-start items-start gap-x-4"},xe={class:"rounded-lg border border-border bg-card shadow-sm p-6"},qe={action:"post",class:"mb-8 bg-background"},_e={class:"grid grid-cols-3 gap-x-4 mb-4"},we={class:"block col-span-1"},Ae=["value"],Pe={id:"samples"},Qe={class:"flex justify-between items-center py-2"},Ve={class:"flex items-center justify-between"},ke={class:""},Me={class:"grid grid-cols-4 gap-x-4"},Re={class:"block col-span-1 mb-2"},Te={class:"block col-span-1 mb-2"},Le={class:"block col-span-1 mb-2"},Ue={class:"block col-span-1 mb-2"},De={class:"ml-4"},Be=["onClick"];function Ee(H,e,A,t,P,Q){const i=ue("Modal");return p(),v(w,null,[c(t.PageHeading,{title:"Reference Runs (QC)"},{default:b(()=>[o("div",Ce,[O(c(t.Button,{onClick:e[0]||(e[0]=a=>t.showModal=!t.showModal)},{default:b(()=>[...e[5]||(e[5]=[F(" Add Reference Runs ",-1)])]),_:1},512),[[ce,t.shield.hasRights(t.shield.actions.CREATE,t.shield.objects.SAMPLE)]]),c(t.RouterLink,{to:"/quality-control/charts",id:"control-charts",class:"px-4 py-2 bg-accent text-accent-foreground rounded-md hover:bg-accent/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-accent/50"},{default:b(()=>[...e[6]||(e[6]=[F(" View Run Charts ",-1)])]),_:1})])]),_:1}),o("div",xe,[c(t.DataTable,{columns:t.tableColumns,data:t.qcSets,toggleColumns:!0,loading:t.fetchingQCSets,paginable:!0,pageMeta:{fetchCount:t.qcSetParams.first,hasNextPage:t.pageInfo?.pageInfo?.hasNextPage,qcSetCount:t.qcSetCount},searchable:!1,onOnSearch:t.searchQCSets,filterable:!0,filterMeta:{defaultFilter:t.qcSetParams.status,filters:t.filterOptions},onOnPaginate:t.showMoreQCSets,selectable:!1},{footer:b(()=>[...e[7]||(e[7]=[])]),_:1},8,["columns","data","loading","pageMeta","filterMeta"])]),t.showModal?(p(),de(i,{key:0,onClose:e[4]||(e[4]=a=>t.showModal=!1),contentWidth:"w-4/5"},{header:b(()=>[...e[8]||(e[8]=[o("h3",null,"Create QC Analyses Requests",-1)])]),body:b(()=>[o("form",qe,[o("div",_e,[o("label",we,[e[10]||(e[10]=o("span",{class:"text-foreground"},"Department",-1)),O(o("select",{name:"clientContacts",id:"clientContacts","onUpdate:modelValue":e[1]||(e[1]=a=>t.form.departmentUid=a),class:"form-input mt-1 block w-full"},[e[9]||(e[9]=o("option",{value:""},null,-1)),(p(!0),v(w,null,N(t.departments,a=>(p(),v("option",{key:a.uid,value:a.uid},me(a.name),9,Ae))),128))],512),[[fe,t.form.departmentUid]])])]),o("section",Pe,[e[17]||(e[17]=o("hr",null,null,-1)),o("div",Qe,[e[11]||(e[11]=o("h5",null,"Add Control Samples",-1)),t.form.samples?.length<20?(p(),v("button",{key:0,onClick:e[2]||(e[2]=a=>t.addQCSet()),class:"px-2 py-1 mr-2 border-primary border text-primary rounded-sm transition duration-300 hover:bg-primary hover:text-primary-foreground focus:outline-none"},"Add QCSet")):j("",!0)]),e[18]||(e[18]=o("hr",{class:"mb-4"},null,-1)),(p(!0),v(w,null,N(t.form.samples,(a,g)=>(p(),v("div",{key:g},[o("div",Ve,[o("div",ke,[o("div",Me,[o("label",Re,[e[12]||(e[12]=o("span",{class:"text-foreground"},"QC Template",-1)),c(t.VueMultiselect,{class:"max-w-[300px]",modelValue:a.qcTemplateUid,"onUpdate:modelValue":u=>a.qcTemplateUid=u,options:t.qcTemplates,multiple:!1,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","onUpdate:modelValue","options"])]),o("label",Te,[e[13]||(e[13]=o("span",{class:"text-foreground"},"QC Levels",-1)),c(t.VueMultiselect,{class:"max-w-[300px]",modelValue:a.qcLevels,"onUpdate:modelValue":u=>a.qcLevels=u,options:t.qcLevels,multiple:!0,searchable:!0,label:"level","track-by":"uid"},null,8,["modelValue","onUpdate:modelValue","options"])]),o("label",Le,[e[14]||(e[14]=o("span",{class:"text-foreground"},"Analysis Profiles",-1)),c(t.VueMultiselect,{class:"max-w-[300px]",modelValue:a.analysisProfiles,"onUpdate:modelValue":u=>a.analysisProfiles=u,options:t.analysesProfiles,multiple:!0,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","onUpdate:modelValue","options"])]),o("label",Ue,[e[15]||(e[15]=o("span",{class:"text-foreground"},"Analysis Services",-1)),c(t.VueMultiselect,{class:"max-w-[300px]",modelValue:a.analysisServices,"onUpdate:modelValue":u=>a.analysisServices=u,options:t.analysisStore.getAnalysesServicesSimple,multiple:!0,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","onUpdate:modelValue","options"])])])]),o("div",De,[o("button",{onClick:u=>t.removeQCSet(g),class:"px-2 py-1 mr-2 border-destructive border text-orange-600rounded-smtransition duration-300 hover:bg-destructive hover:text-primary-foreground focus:outline-none"},"Remove",8,Be)])]),e[16]||(e[16]=o("hr",null,null,-1))]))),128))]),e[19]||(e[19]=o("hr",null,null,-1)),o("button",{type:"button",onClick:e[3]||(e[3]=a=>t.saveForm()),class:"-mb-4 w-full border border-primary bg-primary text-primary-foreground rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-primary focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):j("",!0)],64)}const Ge=ie(he,[["render",Ee],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/qcontrol/QualityControlListing.vue"]]);export{Ge as default};
