import{W as b,a2 as r,i as d,a9 as k,o,c as a,O as e,J as c,L as l,a as w,M as V,T as C,al as m,k as N,_ as D}from"./index-5d85e9da.js";const M={class:"flex flex-col gap-y-2 bg-background/50 px-4 py-2 rounded-lg border border-border/50"},L={class:"flex items-center gap-x-4"},B={class:"flex items-center gap-x-2"},T={class:"text-sm font-medium text-foreground"},$={key:0,class:"flex items-center gap-x-2 text-primary"},H={class:"text-sm font-medium"},I={key:1,class:"ml-auto text-xs text-muted-foreground"},R={key:0},S={key:0,class:"flex flex-col gap-2 mt-2"},j={class:"flex items-center gap-2"},F=["href"],U={key:0,class:"bg-muted/30 border border-border/30 rounded p-3 mt-1 max-h-96 overflow-auto whitespace-pre-wrap text-xs font-mono"},A=["innerHTML"],E={key:1,class:"text-xs text-muted-foreground mt-2"},G=b({__name:"VersionDisplay",setup(J){const i=r(!1),v=r("0.0.0"),t=r(null),p=r(null),u=r(!1),x=async()=>{i.value=!0,m.get("/version").then(({data:{version:s}})=>{v.value=s}).catch(s=>{p.value="Failed to get current version",console.error(s)}).finally(()=>i.value=!1)},{toastInfo:_}=N(),f=async()=>{i.value=!0,m.get("/version/updates").then(({data:s})=>{t.value=s,s.update_available?_(`Update available: ${s.latest_version}`):_("No updates available")}).catch(s=>{p.value="Failed to get current version",console.error(s)}).finally(()=>i.value=!1)},g=d(()=>t.value?.latest_version||"-"),h=d(()=>t.value?.last_checked?new Date(t.value.last_checked).toLocaleString():"-"),y=d(()=>t.value?.release_notes?t.value.release_notes.replace(/^(\s*[-*] .*)$/gm,'<span style="color:#2563eb;">$1</span>').replace(/^(\s*[A-Z][^:]+:)/gm,"<b>$1</b>").replace(/\r?\n/g,"<br>"):"");return k(()=>{x(),f()}),(s,n)=>(o(),a("div",M,[e("div",L,[e("div",B,[e("span",T,"v"+c(v.value),1),t.value?.update_available?l("",!0):(o(),a("button",{key:0,onClick:f,class:"p-1.5 text-muted-foreground hover:text-foreground hover:bg-muted rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2","aria-label":"Check for updates"},n[1]||(n[1]=[e("svg",{class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[e("path",{d:"M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.3"})],-1)])))]),t.value?.update_available?(o(),a("div",$,[e("span",H,"v"+c(g.value)+" available",1),n[2]||(n[2]=e("svg",{class:"w-4 h-4 animate-pulse",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round","aria-hidden":"true"},[e("circle",{cx:"12",cy:"12",r:"10"}),e("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),e("line",{x1:"12",y1:"8",x2:"12",y2:"8"})],-1))])):l("",!0),t.value?.last_checked?(o(),a("span",I,"Last checked: "+c(h.value),1)):l("",!0)]),t.value?(o(),a("div",R,[t.value.update_available?(o(),a("div",S,[e("div",j,[t.value.release_url?(o(),a("a",{key:0,href:t.value.release_url,target:"_blank",rel:"noopener",class:"text-blue-600 hover:underline text-xs font-medium"}," View Release on GitHub ",8,F)):l("",!0),e("button",{onClick:n[0]||(n[0]=O=>u.value=!u.value),class:"text-xs text-primary underline focus:outline-none"},c(u.value?"Hide":"Show")+" Release Notes ",1)]),w(C,{name:"fade"},{default:V(()=>[u.value?(o(),a("div",U,[e("span",{innerHTML:y.value},null,8,A)])):l("",!0)]),_:1})])):(o(),a("div",E,n[3]||(n[3]=[e("span",null,"No updates available.",-1)])))])):l("",!0)]))}});const Z=D(G,[["__scopeId","data-v-f64094ba"],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/admin/VersionDisplay.vue"]]);export{Z as default};
