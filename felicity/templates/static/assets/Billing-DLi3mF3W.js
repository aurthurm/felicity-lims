import{a0 as Y,f as Z,t as $,a5 as f,a7 as F,_ as ee,c as p,o as m,A as t,D as B,F as a,a2 as g,L as d,a9 as D,J as P,K as h,H as te,a3 as oe}from"./index-v7Q387fb.js";import{c as M,d as A,u as j,b as c,f as se,a as v}from"./index.esm-D-THTBXR.js";import{E as ne,a as ie,b as re,c as ue}from"./billing.mutations-BnVxQIQJ.js";import{u as le}from"./billing-BJXnGQ6y.js";import"./billing.queries-DcwlyfmJ.js";const ae=Y({__name:"Billing",props:{target:{type:String,required:!0},targetUid:{type:String,required:!0}},setup(V,{expose:e}){e();const n=le(),{withClientMutation:s}=Z(),y=V,{target:u,targetUid:o}=$(y),b=()=>{n.clear(),u?.value==="profile"&&(n.fetchProfilePrice(o.value),n.fetchProfileDiscount(o.value)),u?.value==="analysis"&&(n.fetchAnalysisPrice(o.value),n.fetchAnalysisDiscount(o.value)),n.fetchVouchers()};b(),f(()=>u.value,(i,l)=>b()),f(()=>o.value,(i,l)=>b());const T=M({amount:A().min(0,"Amount must be 0 or greater").required("Amount is required")}),{handleSubmit:S,errors:C,setFieldValue:x}=j({validationSchema:T,initialValues:{amount:0}}),{value:z}=c("amount");f(()=>n.fetchingPrice,(i,l)=>{i||(u?.value==="profile"&&x("amount",n.profilePrice?.amount??0),u?.value==="analysis"&&x("amount",n.analysisPrice?.amount??0))});const I=S(i=>{const l={amount:i.amount};let r=u.value=="profile"?n.profilePrice:n.analysisPrice;u?.value==="profile"?s(ne,{uid:r.uid,payload:l},"updateProfilePrice").then():s(ie,{uid:r.uid,payload:l},"updateAnalysisPrice").then()}),U=M({discountType:v().required("Discount type is required"),valueType:v().required("Value type is required"),startDate:v().nullable(),endDate:v().nullable(),voucherUid:v().nullable().when("discountType",{is:"voucher",then:i=>i.required("Voucher is required")}),valuePercent:A().min(0,"Value percent must be 0 or greater").max(100,"Value percent must be 100 or less").nullable().when("valueType",{is:"percentage",then:i=>i.required("Value percent is required")}),valueAmount:A().min(0,"Value amount must be 0 or greater").nullable().when("valueType",{is:"amount",then:i=>i.required("Value amount is required")}),isActive:se().nullable()}),{handleSubmit:_,errors:L,setValues:w,setFieldValue:k}=j({validationSchema:U,initialValues:{discountType:"",valueType:"",startDate:"",endDate:"",voucherUid:null,valuePercent:0,valueAmount:0,isActive:!0}}),{value:E}=c("discountType"),{value:H}=c("valueType"),{value:J}=c("startDate"),{value:K}=c("endDate"),{value:N}=c("voucherUid"),{value:O}=c("valuePercent"),{value:R}=c("valueAmount"),{value:G}=c("isActive");f(()=>n.fetchingDiscount,(i,l)=>{if(!i){let r={};u?.value==="profile"&&(r={...n.profileDiscount}),u?.value==="analysis"&&(r={...n.analyisDiscount}),w({discountType:r.discountType??"",valueType:r.valueType??"",startDate:r.startDate??"",endDate:r.endDate??"",voucherUid:r.voucherUid??null,valuePercent:r.valuePercent??0,valueAmount:r.valueAmount??0,isActive:r.isActive??!0})}});const Q=F(["sale","voucher"]),W=F(["percentage","amount"]),X=_(i=>{const l={...i};let r=u.value=="profile"?n.profileDiscount:n.analyisDiscount;u.value=="profile"?s(re,{uid:r.uid,payload:l},"updateProfileDiscount").then():s(ue,{uid:r.uid,payload:l},"updateAnalysisDiscount").then()});f(()=>E.value,(i,l)=>{i!=="voucher"&&k("voucherUid",null)});const q={billingStore:n,withClientMutation:s,props:y,target:u,targetUid:o,getProfileAndPrices:b,pricingSchema:T,handlePricingSubmit:S,pricingErrors:C,setPricingFieldValue:x,amount:z,updatePricing:I,discountSchema:U,handleDiscountSubmit:_,discountErrors:L,setDiscountValues:w,setDiscountFieldValue:k,discountType:E,valueType:H,startDate:J,endDate:K,voucherUid:N,valuePercent:O,valueAmount:R,isActive:G,discountTypes:Q,valueTypes:W,updateDiscounting:X};return Object.defineProperty(q,"__isScriptSetup",{enumerable:!1,value:!0}),q}}),de={class:"grid grid-cols-12 gap-8 p-6"},ce={class:"col-span-6"},pe={class:"space-y-6"},me={class:"rounded-lg border border-border bg-card p-6"},fe={class:"space-y-4"},ge={class:"space-y-2"},ve={class:"relative"},be={class:"text-sm text-destructive"},ye={class:"col-span-6"},xe={class:"space-y-6"},De={class:"rounded-lg border border-border bg-card p-6"},Pe={class:"grid grid-cols-2 gap-4"},he={class:"space-y-2"},Ae=["value"],Ve={class:"text-sm text-destructive"},Te={class:"space-y-2"},Se=["value"],Ue={class:"text-sm text-destructive"},_e={class:"grid grid-cols-2 gap-4"},we={class:"space-y-2"},ke={class:"space-y-2"},Ee={class:"space-y-2"},qe=["value"],Fe={class:"text-sm text-destructive"},Be={class:"grid grid-cols-2 gap-4"},Me={class:"space-y-2"},je={class:"text-sm text-destructive"},Ce={class:"space-y-2"},ze={class:"relative"},Ie={class:"text-sm text-destructive"},Le={class:"flex items-center space-x-2"};function He(V,e,n,s,y,u){return m(),p("div",de,[t("section",ce,[t("div",pe,[e[14]||(e[14]=t("div",{class:"flex items-center justify-between"},[t("h3",{class:"text-lg font-semibold text-foreground"},"Pricing Information")],-1)),t("div",me,[t("form",{class:"space-y-6",onSubmit:e[1]||(e[1]=B((...o)=>s.updatePricing&&s.updatePricing(...o),["prevent"]))},[t("div",fe,[t("label",ge,[e[12]||(e[12]=t("span",{class:"text-sm font-medium text-muted-foreground"},"Amount ($)",-1)),t("div",ve,[e[11]||(e[11]=t("span",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground"},"$",-1)),a(t("input",{class:"w-full pl-8 px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring placeholder:text-muted-foreground","onUpdate:modelValue":e[0]||(e[0]=o=>s.amount=o),type:"number",min:"0.0",step:"0.1",placeholder:"0.00"},null,512),[[g,s.amount]])]),t("div",be,d(s.pricingErrors.amount),1)])]),e[13]||(e[13]=t("button",{type:"submit",class:"w-full bg-primary text-primary-foreground hover:bg-primary/90 rounded-lg px-4 py-2 text-sm font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-ring"}," Update Pricing ",-1))],32)])])]),t("section",ye,[t("div",xe,[e[28]||(e[28]=t("div",{class:"flex items-center justify-between"},[t("h3",{class:"text-lg font-semibold text-foreground"},"Discounts Information")],-1)),t("div",De,[t("form",{class:"space-y-6",onSubmit:e[10]||(e[10]=B((...o)=>s.updateDiscounting&&s.updateDiscounting(...o),["prevent"]))},[t("div",Pe,[t("label",he,[e[16]||(e[16]=t("span",{class:"text-sm font-medium text-muted-foreground"},"Discount Type",-1)),a(t("select",{class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":e[2]||(e[2]=o=>s.discountType=o)},[e[15]||(e[15]=t("option",{value:""},"Select type",-1)),(m(!0),p(P,null,h(s.discountTypes,o=>(m(),p("option",{key:o,value:o,class:"capitalize"},d(o),9,Ae))),128))],512),[[D,s.discountType]]),t("div",Ve,d(s.discountErrors.discountType),1)]),t("label",Te,[e[18]||(e[18]=t("span",{class:"text-sm font-medium text-muted-foreground"},"Value Type",-1)),a(t("select",{class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":e[3]||(e[3]=o=>s.valueType=o)},[e[17]||(e[17]=t("option",{value:""},"Select type",-1)),(m(!0),p(P,null,h(s.valueTypes,o=>(m(),p("option",{key:o,value:o,class:"capitalize"},d(o),9,Se))),128))],512),[[D,s.valueType]]),t("div",Ue,d(s.discountErrors.valueType),1)])]),t("div",_e,[t("label",we,[e[19]||(e[19]=t("span",{class:"text-sm font-medium text-muted-foreground"},"Start Date",-1)),a(t("input",{class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":e[4]||(e[4]=o=>s.startDate=o),type:"date"},null,512),[[g,s.startDate]])]),t("label",ke,[e[20]||(e[20]=t("span",{class:"text-sm font-medium text-muted-foreground"},"End Date",-1)),a(t("input",{class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":e[5]||(e[5]=o=>s.endDate=o),type:"date"},null,512),[[g,s.endDate]])])]),a(t("div",Ee,[t("label",null,[e[22]||(e[22]=t("span",{class:"text-sm font-medium text-muted-foreground"},"Voucher",-1)),a(t("select",{class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring mt-2","onUpdate:modelValue":e[6]||(e[6]=o=>s.voucherUid=o)},[e[21]||(e[21]=t("option",{value:""},"Select voucher",-1)),(m(!0),p(P,null,h(s.billingStore.vouchers,o=>(m(),p("option",{key:o.uid,value:o.uid},d(o.code),9,qe))),128))],512),[[D,s.voucherUid]]),t("div",Fe,d(s.discountErrors.voucherUid),1)])],512),[[te,s.discountType==="voucher"]]),t("div",Be,[t("label",Me,[e[23]||(e[23]=t("span",{class:"text-sm font-medium text-muted-foreground"},"Value Percentage (%)",-1)),a(t("input",{class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":e[7]||(e[7]=o=>s.valuePercent=o),type:"number",min:"0",max:"100",step:"0.1",placeholder:"0.00"},null,512),[[g,s.valuePercent]]),t("div",je,d(s.discountErrors.valuePercent),1)]),t("label",Ce,[e[25]||(e[25]=t("span",{class:"text-sm font-medium text-muted-foreground"},"Value Amount ($)",-1)),t("div",ze,[e[24]||(e[24]=t("span",{class:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground"},"$",-1)),a(t("input",{class:"w-full pl-8 px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":e[8]||(e[8]=o=>s.valueAmount=o),type:"number",min:"0",step:"0.1",placeholder:"0.00"},null,512),[[g,s.valueAmount]])]),t("div",Ie,d(s.discountErrors.valueAmount),1)])]),t("div",Le,[a(t("input",{type:"checkbox",id:"isActive","onUpdate:modelValue":e[9]||(e[9]=o=>s.isActive=o),class:"h-4 w-4 rounded border-input bg-background text-primary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"},null,512),[[oe,s.isActive]]),e[26]||(e[26]=t("label",{for:"isActive",class:"text-sm font-medium text-muted-foreground"},"Active",-1))]),e[27]||(e[27]=t("button",{type:"submit",class:"w-full bg-primary text-primary-foreground hover:bg-primary/90 rounded-lg px-4 py-2 text-sm font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-ring"}," Update Discount ",-1))],32)])])])])}const Ge=ee(ae,[["render",He],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/analyses/Billing.vue"]]);export{Ge as default};
