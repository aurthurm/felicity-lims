import{Y as G,Q as L,P as J,u as X,a0 as V,a7 as C,av as Z,aN as $,b9 as ee,ba as te,a3 as se,_ as oe,r as y,aF as Q,c as r,o as i,z as s,D as c,F as k,H as b,I as u,aG as U,E as j,a as n,K as a,M as g,A as q}from"./index-OdhKCqIc.js";import{u as le}from"./analysis-PB9AMevg.js";import{S as ne}from"./Spinner-Bl8RfjFA.js";import{s as ae}from"./index-DJJ2wcNX.js";const ie=G({__name:"WorkSheetAssign",setup(I,{expose:e}){e();const f=L(),o=le(),W=J(),{withClientMutation:T}=X(),{confirm:h}=$(),d=V(null);f.fetchWorkSheetTemplates();const x=C(()=>f.getWorkSheet),B=C(()=>f.getWorkSheetTemplates),m=async()=>{try{if(!await h({title:"Are you sure?",description:"You want to apply this template to add samples?",confirmText:"Yes, apply now!",cancelText:"No, cancel apply!",variant:"destructive"}))return;await T(ee,{worksheetUid:x?.value?.uid,templateUid:d.value},"updateWorksheetApplyTemplate")}catch{}};o.fetchAnalysesServices({first:void 0,after:"",text:"",sortBy:["name"]}),W.fetchSampleTypes(),o.fetchQCTemplates();const D=C(()=>o.getQCTemplates),S=V(null),v=Z({sampleTypeUid:void 0,analysisUid:void 0}),_=V(!1),t=C(()=>{const l=w;return f.getAnalysisResults?.forEach(A=>{l?.some(P=>P.uid===A.uid)||l.push(A)}),l}),E=()=>{F(),f.fetchForWorkSheetsAssign({first:50,after:"",text:"",sortBy:void 0,...v})},z=()=>{const l=H();try{h({title:"Are you sure?",description:"You want to assign selected to worksheet?",confirmText:"Yes, assign now!",cancelText:"No, cancel apply!",variant:"destructive"}).then(p=>{p&&T(te,{uid:x?.value?.uid,qcTemplateUid:S.value,analysesUids:l},"updateWorksheetManualAssign").then(()=>{})})}catch{}};let w=[];function F(){let l=[];return t?.value?.forEach(p=>{p.checked&&l.push(p)}),w=l,l}function H(){const l=F();let p=[];return l?.forEach(A=>p.push(A.uid)),p}function K(l){R()?_.value=!0:_.value=!1}function M(l){l.checked=!0}function N(l){l.checked=!1}async function O(){await t?.value?.forEach(l=>_.value?M(l):N(l))}function R(){return t?.value?.every(l=>l.checked===!0)}const Y={worksheetStore:f,analysisStore:o,sampleStore:W,withClientMutation:T,confirm:h,templateUid:d,worksheet:x,workSheetTemplates:B,applyTemplate:m,qcTemplates:D,qcTemplateUid:S,filterForm:v,allChecked:_,analysisResults:t,filterAnalysis:E,assignToWorkSheet:z,get checkedAnalyses(){return w},set checkedAnalyses(l){w=l},getResultsChecked:F,getResultsUids:H,checkCheck:K,check:M,unCheck:N,toggleCheckAll:O,areAllChecked:R,get Spinner(){return ne},get Button(){return se},get shield(){return ae}};return Object.defineProperty(Y,"__isScriptSetup",{enumerable:!1,value:!0}),Y}}),re={class:"space-y-6"},de={class:"border-t border-border pt-6"},ce={action:"post",class:"space-y-4"},me={class:"flex items-center space-x-4"},ue={class:"flex-1 max-w-xs"},pe=["value"],fe={class:"overflow-x-auto mt-4"},ye={action:"post",class:"p-1"},ge={class:"flex justify-start mb-4"},he={class:"flex justify-between items-center"},xe=["value"],_e={class:"flex justify-between items-center ml-6"},ke=["value"],ve={class:"ml-6 mt-2"},be={class:"mt-4 border border-border bg-card rounded-lg shadow-md"},Te={class:"relative w-full overflow-auto"},Se={key:0,class:"py-4 text-center"},we={class:"inline-flex items-center gap-2"},Ae={class:"text-sm leading-5 text-primary font-semibold"},Ce={class:"text-sm leading-5 text-primary"},Ue={class:"text-sm leading-5 text-primary"},We={class:"text-sm leading-5 text-primary"},Be={class:"text-sm leading-5 text-primary"},De={class:"my-4"},Ee={action:"post",class:"mb-4"},Fe={class:"flex justify-start items-center mr-4"},Ve={class:"block mx-4"},je=["value"];function qe(I,e,f,o,W,T){const h=y("Checkbox"),d=y("TableHead"),x=y("TableRow"),B=y("TableHeader"),m=y("TableCell"),D=y("TableBody"),S=y("Table"),v=Q("motion-slide-right"),_=Q("motion-slide-left");return i(),r(k,null,[s("section",re,[s("div",de,[c((i(),r("form",ce,[s("div",me,[e[8]||(e[8]=s("span",{class:"text-sm font-medium text-foreground"},"Worksheet Template",-1)),s("label",ue,[c(s("select",{class:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary","onUpdate:modelValue":e[0]||(e[0]=t=>o.templateUid=t)},[e[7]||(e[7]=s("option",{value:""},null,-1)),(i(!0),r(k,null,b(o.workSheetTemplates,t=>(i(),r("option",{key:t.uid,value:t.uid},u(t.name),9,pe))),128))],512),[[U,o.templateUid]])]),c(s("button",{type:"button",onClick:e[1]||(e[1]=t=>o.applyTemplate()),class:"px-4 py-2 bg-primary text-primary-foreground rounded-md text-sm font-medium hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors"}," Apply Template ",512),[[j,o.shield.hasRights(o.shield.actions.CREATE,o.shield.objects.WORKSHEET)]])])])),[[v]])])]),e[21]||(e[21]=s("hr",{class:"mt-4 mb-2"},null,-1)),e[22]||(e[22]=s("h3",{class:"font-bold"},"Manual Analyses Assignment",-1)),e[23]||(e[23]=s("hr",{class:"mb-4 mt-2"},null,-1)),s("div",fe,[c((i(),r("form",ye,[s("div",ge,[s("label",he,[e[9]||(e[9]=s("span",{class:"text-foreground mr-2"},"SampleType",-1)),c(s("select",{name:"analyses_uids","onUpdate:modelValue":e[2]||(e[2]=t=>o.filterForm.sampleTypeUid=t),class:"form-input mt-1 block w-full py-1"},[(i(!0),r(k,null,b(o.sampleStore.sampleTypes,t=>(i(),r("option",{key:t.uid,value:t.uid},u(t.name),9,xe))),128))],512),[[U,o.filterForm.sampleTypeUid]])]),s("label",_e,[e[10]||(e[10]=s("span",{class:"text-foreground mr-2"},"Analyses",-1)),c(s("select",{name:"analyses_uids","onUpdate:modelValue":e[3]||(e[3]=t=>o.filterForm.analysisUid=t),class:"form-input mt-1 block w-full py-1"},[(i(!0),r(k,null,b(o.analysisStore.analysesServices,t=>(i(),r("option",{key:t.uid,value:t.uid},u(t.name),9,ke))),128))],512),[[U,o.filterForm.analysisUid]])]),s("div",ve,[c(n(o.Button,{onClick:e[4]||(e[4]=t=>o.filterAnalysis()),class:"p-1"},{default:a(()=>[...e[11]||(e[11]=[g("Apply Filters",-1)])]),_:1},512),[[j,!0]])])])])),[[_]])]),s("div",be,[s("div",Te,[o.worksheetStore.fetchingAnalysisResults?(i(),r("div",Se,[s("span",we,[n(o.Spinner,{class:"size-4"}),e[12]||(e[12]=s("span",{class:"text-sm"},"Fetching analytes ...",-1))])])):(i(),q(S,{key:1,class:"w-full caption-bottom text-sm"},{default:a(()=>[n(B,{class:"[&_tr]:border-b"},{default:a(()=>[n(x,{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:a(()=>[n(d,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:a(()=>[n(h,{checked:o.allChecked,"onUpdate:checked":e[5]||(e[5]=t=>{o.allChecked=t,o.toggleCheckAll()})},null,8,["checked"])]),_:1}),n(d,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"}),n(d,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:a(()=>[...e[13]||(e[13]=[g(" Sample ID ",-1)])]),_:1}),n(d,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:a(()=>[...e[14]||(e[14]=[g(" Analysis ",-1)])]),_:1}),n(d,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:a(()=>[...e[15]||(e[15]=[g(" Date Created ",-1)])]),_:1}),n(d,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:a(()=>[...e[16]||(e[16]=[g(" Date Received ",-1)])]),_:1}),n(d,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:a(()=>[...e[17]||(e[17]=[g(" Status ",-1)])]),_:1})]),_:1})]),_:1}),c((i(),q(D,{class:"[&_tr:last-child]:border-0"},{default:a(()=>[(i(!0),r(k,null,b(o.analysisResults,t=>(i(),q(x,{key:t?.uid,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:a(()=>[n(m,{class:"px-4 py-3 align-middle"},{default:a(()=>[n(h,{checked:t.checked,"onUpdate:checked":E=>{t.checked=E,o.checkCheck(t)}},null,8,["checked","onUpdate:checked"])]),_:2},1024),n(m,{class:"px-4 py-3 align-middle"}),n(m,{class:"px-4 py-3 align-middle text-sm"},{default:a(()=>[s("div",Ae,u(t?.sample?.sampleId),1)]),_:2},1024),n(m,{class:"px-4 py-3 align-middle text-sm"},{default:a(()=>[s("div",Ce,u(t?.analysis?.name),1)]),_:2},1024),n(m,{class:"px-4 py-3 align-middle text-sm"},{default:a(()=>[s("div",Ue,u(t?.sample?.createdAt),1)]),_:2},1024),n(m,{class:"px-4 py-3 align-middle text-sm"},{default:a(()=>[s("div",We,u(t?.sample?.dateReceived),1)]),_:2},1024),n(m,{class:"px-4 py-3 align-middle text-sm"},{default:a(()=>[s("div",Be,u(t?.sample?.status),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})),[[v]])]),_:1}))])]),s("section",De,[s("form",Ee,[s("div",Fe,[e[19]||(e[19]=s("span",{class:"text-foreground"},"Apply QC Template",-1)),s("label",Ve,[c(s("select",{class:"form-select block w-full py-1","onUpdate:modelValue":e[6]||(e[6]=t=>o.qcTemplateUid=t)},[e[18]||(e[18]=s("option",null,null,-1)),(i(!0),r(k,null,b(o.qcTemplates,t=>(i(),r("option",{key:t.uid,value:t.uid},u(t.name),9,je))),128))],512),[[U,o.qcTemplateUid]])])])]),c(n(o.Button,{onClick:o.assignToWorkSheet},{default:a(()=>[...e[20]||(e[20]=[g("Assign Analyses",-1)])]),_:1},512),[[j,!0]])])],64)}const Ye=oe(ie,[["render",qe],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/worksheet/_id/WorkSheetAssign.vue"]]);export{Ye as default};
