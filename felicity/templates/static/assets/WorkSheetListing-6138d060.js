import{P as Y,M as Z,e as G,ai as Q,a9 as ee,Z as b,a3 as y,aj as te,f as se,aq as oe,h as C,o as i,c as u,a as E,a2 as n,b as s,A as m,C as ae,z as M,a7 as d,K as g,x as ne,F as f,D as S,E as w,a4 as R,V as re,J as le,X as x,Y as W,_ as ie}from"./index-e1b11e1a.js";import{u as ue}from"./user-3cd24915.js";import{c as de,d as c,u as me,b as h}from"./array-81ccc855.js";import{h as fe,o as ce,a as he}from"./constants-ba5dc390.js";import"./_queries-2b677941.js";const pe={class:"flex justify-between items-center"},ve={action:"post",class:"p-1"},ke={class:"grid grid-cols-3 gap-x-4 mb-4"},be={class:"block col-span-1 mb-2"},ye=["value"],ge={class:"block col-span-1 mb-2"},Se=["value"],we={class:"block col-span-1 mb-2"},xe=Y({__name:"WorkSheetListing",setup(We){const N=x(()=>W(()=>import("./index-e1b11e1a.js").then(t=>t.cN),["assets/index-e1b11e1a.js","assets/index-78b87750.css"])),P=x(()=>W(()=>import("./FelDataTable-3747b614.js"),["assets/FelDataTable-3747b614.js","assets/index-e1b11e1a.js","assets/index-78b87750.css"])),B=x(()=>W(()=>import("./index-e1b11e1a.js").then(t=>t.cM),["assets/index-e1b11e1a.js","assets/index-78b87750.css"])),l=Z(),_=ue(),{withClientMutation:D}=G(),{workSheets:A,fetchingWorkSheets:I,workSheetPageInfo:U,workSheetTemplates:L}=Q(l);ee();let r=b(!1);const V=b([{name:"All",value:""},{name:"Pending",value:"pending"},{name:"Awaiting",value:"awaiting"},{name:"Approved",value:"approved"},{name:"Empty",value:"empty"}]),O=b([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"WorkSheet Id",value:"workSheetId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(t,e){return y(te,{to:{name:"worksheet-detail",params:{workSheetUid:t?.uid}},innerHTML:t?.worksheetId})}},{name:"Analysis/Test",value:"analysis.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Samples",value:"assignedCount",sortable:!1,sortBy:"asc",hidden:!1},{name:"Instrument",value:"instrument.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Analyst",value:"clientPatientId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(t,e){return y("div",{innerHTML:T(t?.analyst)})}},{name:"Status",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(t,e){return y("button",{type:"button",class:"bg-sky-800 text-white py-1 px-2 rounded-sm leading-none",innerHTML:t?.state||"unknown"})}}]);l.removeWorksheet();let a=se({first:25,before:"",status:"",text:"",sort:["-uid"],filterAction:!1});l.fetchWorkSheets(a),l.fetchWorkSheetTemplates(),_.fetchUsers({});const F=de({analystUid:c().required("Analyst is Required").typeError("Analyst is Required"),templateUid:c().typeError("Worksheet Template is required"),instrumentUid:c(),count:c().typeError("Required number of worksheets must be defined")}),{handleSubmit:q,errors:H}=me({validationSchema:F,initialValues:{count:1,analystUid:void 0,templateUid:void 0,instrumentUid:void 0}}),{value:p}=h("count"),{value:v}=h("analystUid"),{value:k}=h("templateUid");h("instrumentUid");const j=q(t=>{r.value=!1,D(oe,t,"createWorksheet").then(e=>{l.addWorksheet(e),r.value=!1})});function $(t){a.first=t.fetchCount,a.before=U?.value?.endCursor??"",a.text=t.filterText,a.status=t.filterStatus,a.filterAction=!1,l.fetchWorkSheets(a)}function K(t){a.first=25,a.before="",a.text=t.filterText,a.status=t.filterStatus,a.filterAction=!0,l.fetchWorkSheets(a)}const z=C(()=>_.getUsers),T=t=>t?.auth?.userName?t?.auth?.userName:t?.firstName?t.firstName+" "+t.lastName:"----",J=C(()=>A?.value?.length+" of "+l.getWorkSheetCount+" WorkSheets");return(t,e)=>(i(),u(f,null,[E(n(B),{title:"Worksheets"}),s("div",pe,[s("div",null,[m(s("button",{onClick:e[0]||(e[0]=M(o=>d(r)?r.value=!0:r=!0,["prevent"])),class:"p-2 h-10 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Add WorkSheet ",512),[[ae,fe(he.CREATE,ce.WORKSHEET)]])])]),E(n(P),{columns:O.value,data:n(A),toggleColumns:!0,loading:n(I),paginable:!0,pageMeta:{fetchCount:n(a).first,hasNextPage:n(U)?.hasNextPage,countNone:J.value},searchable:!0,filterable:!0,filterMeta:{defaultFilter:n(a).status,filters:V.value},onOnSearch:K,onOnPaginate:$,selectable:!1},{footer:g(()=>e[6]||(e[6]=[])),_:1},8,["columns","data","loading","pageMeta","filterMeta"]),n(r)?(i(),ne(n(N),{key:0,onClose:e[5]||(e[5]=o=>d(r)?r.value=!1:r=!1)},{header:g(()=>[s("div",null,[e[7]||(e[7]=s("h3",null,"Create Worksheet",-1)),e[8]||(e[8]=s("hr",null,null,-1)),s("ul",null,[(i(!0),u(f,null,S(Object.values(n(H)),(o,X)=>(i(),u("li",{key:X,class:"text-orange-600"},w(o),1))),128))])])]),body:g(()=>[s("form",ve,[s("div",ke,[s("label",be,[e[9]||(e[9]=s("span",{class:"text-gray-700"},"Analyst",-1)),m(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[1]||(e[1]=o=>d(v)?v.value=o:null)},[(i(!0),u(f,null,S(z.value,o=>(i(),u("option",{key:o.uid,value:o.uid},w(T(o)),9,ye))),128))],512),[[R,n(v)]])]),s("label",ge,[e[11]||(e[11]=s("span",{class:"text-gray-700"},"Worksheet Template",-1)),m(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[2]||(e[2]=o=>d(k)?k.value=o:null)},[e[10]||(e[10]=s("option",{value:"undefined"},null,-1)),(i(!0),u(f,null,S(n(L),o=>(i(),u("option",{key:o.uid,value:o.uid},w(o.name),9,Se))),128))],512),[[R,n(k)]])]),s("label",we,[e[12]||(e[12]=s("span",{class:"text-gray-700"},"How Many",-1)),m(s("input",{type:"number",class:"form-input mt-1 block w-full","onUpdate:modelValue":e[3]||(e[3]=o=>d(p)?p.value=o:null),min:"1"},null,512),[[re,n(p)]])])]),e[13]||(e[13]=s("hr",null,null,-1)),s("button",{type:"button",onClick:e[4]||(e[4]=M(o=>n(j)(),["prevent"])),class:"-mb-4 w-full border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):le("",!0)],64))}}),Ee=ie(xe,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/worksheet/WorkSheetListing.vue"]]);export{Ee as default};
