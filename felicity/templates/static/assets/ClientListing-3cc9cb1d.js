import{S as W,f as Y,a0 as u,a1 as ee,ai as te,ah as A,h as E,i as oe,r as h,o as i,c as d,a as k,L as b,C as c,M as le,D as se,N as o,a5 as s,y as ne,H as C,X as P,ac as U,F as g,E as w,a2 as D,A as ae,K as ie,Z as re,$ as ue,_ as de}from"./index-8d0a01b3.js";import{A as fe,E as ce}from"./clients.mutations-a6ef66fb.js";import{u as me}from"./client-758e188f.js";import{u as pe}from"./location-dec429f8.js";import{h as be,a as ve,o as Ce}from"./constants-cc44aa7b.js";const ge={class:"rounded-lg border border-border bg-card shadow-sm p-6"},ye={action:"post",class:"p-1"},xe={class:"grid grid-cols-2 gap-x-4 mb-4"},he={class:"block col-span-1 mb-2"},ke={class:"block col-span-1 mb-2"},Ue={class:"grid grid-cols-3 gap-x-4 mb-4"},we={class:"block col-span-1 mb-2"},De=["value"],_e={class:"block col-span-1 mb-2"},Be=["value"],Ne={class:"block col-span-1 mb-2"},Te=["value"],Ae=W({__name:"ClientListing",setup(Ee){const M=re(()=>ue(()=>import("./FelDataTable-a1323da9.js"),["assets/FelDataTable-a1323da9.js","assets/index-8d0a01b3.js","assets/index-a402b5a2.css"])),r=me(),v=pe(),{withClientMutation:_}=Y(),S=u([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Client Name",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(l,e){return ee(te,{to:{name:"client-detail",query:{clientUid:l?.uid}},class:"px-2 py-1 font-semibold rounded-md hover:underline transition-colors duration-200",innerHTML:l?.name})}},{name:"Client ID",value:"code",sortable:!1,sortBy:"asc",hidden:!1},{name:"District",value:"district.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Province",value:"district.province.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Mobile Number",value:"mobilePhone",sortable:!1,sortBy:"asc",hidden:!1},{name:"Email Address",value:"email",sortable:!1,sortBy:"asc",hidden:!1}]),{countries:L,provinces:V,districts:I}=A(v),{clients:B,clientPageInfo:N,fetchingClients:R}=A(r);let f=u(!1),y=u(!1),O=u(""),n=E({});const T=u(""),F=()=>Object.assign(n,{});let a=E({first:50,after:"",text:"",sortBy:["uid"],filterAction:!1}),m=u(),p=u();r.fetchClients(a),v.fetchCountries();function j(){_(fe,{payload:{name:n.name,code:n.code,districtUid:n.districtUid}},"createClient").then(l=>r.addClient(l))}function H(){_(ce,{uid:n.uid,payload:{name:n.name,code:n.code,districtUid:n.districtUid}},"updateClient").then(l=>r.updateClient(l))}function K(l){v.filterProvincesByCountry(m.value)}function $(l){v.filterDistrictsByProvince(p.value)}function q(l){a.first=100,a.after="",a.text=l.filterText,a.filterAction=!0,r.fetchClients(a)}function X(l){a.first=l.fetchCount,a.after=N?.value?.endCursor,a.text=l.filterText,a.filterAction=!1,r.fetchClients(a)}function Z(l,e,x={}){y.value=l,O.value=e,T.value=(l?"CREATE":"EDIT")+" "+e.toUpperCase(),e=="client"&&(f.value=!0),l?e=="client"&&Object.assign(n,{}):e=="client"&&Object.assign(n,{...x})}function z(){y.value&&j(),y.value||H(),f.value=!1}const G=oe(()=>B?.value?.length+" of "+r.getClientCount+" clients");return(l,e)=>{const x=h("fel-button"),J=h("fel-heading"),Q=h("fel-modal");return i(),d(g,null,[k(J,{title:"Clients"},{default:b(()=>[c(k(x,{onClick:e[0]||(e[0]=t=>Z(!0,"client"))},{default:b(()=>e[10]||(e[10]=[le(" Add client ")])),_:1},512),[[se,be(ve.CREATE,Ce.CLIENT)]])]),_:1}),o("div",ge,[k(s(M),{columns:S.value,data:s(B),toggleColumns:!0,loading:s(R),paginable:!0,pageMeta:{fetchCount:s(a).first,hasNextPage:s(N)?.hasNextPage,countNone:G.value},searchable:!0,filterable:!1,onOnSearchKeyUp:q,onOnSearchFocus:F,onOnPaginate:X,selectable:!1},{footer:b(()=>e[11]||(e[11]=[])),_:1},8,["columns","data","loading","pageMeta"])]),s(f)?(i(),ne(Q,{key:0,onClose:e[9]||(e[9]=t=>U(f)?f.value=!1:f=!1)},{header:b(()=>[o("h3",null,C(T.value),1)]),body:b(()=>[o("form",ye,[o("div",xe,[o("label",he,[e[12]||(e[12]=o("span",{class:"text-foreground"},"Name",-1)),c(o("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":e[1]||(e[1]=t=>s(n).name=t),placeholder:"Name ..."},null,512),[[P,s(n).name]])]),o("label",ke,[e[13]||(e[13]=o("span",{class:"text-foreground"},"Code",-1)),c(o("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":e[2]||(e[2]=t=>s(n).code=t),placeholder:"Code ..."},null,512),[[P,s(n).code]])])]),o("div",Ue,[o("label",we,[e[15]||(e[15]=o("span",{class:"text-foreground"},"Country",-1)),c(o("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[3]||(e[3]=t=>U(m)?m.value=t:m=t),onChange:e[4]||(e[4]=t=>K(t))},[e[14]||(e[14]=o("option",null,null,-1)),(i(!0),d(g,null,w(s(L),t=>(i(),d("option",{key:t.uid,value:t.uid},C(t.name),9,De))),128))],544),[[D,s(m)]])]),o("label",_e,[e[17]||(e[17]=o("span",{class:"text-foreground"},"Province",-1)),c(o("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[5]||(e[5]=t=>U(p)?p.value=t:p=t),onChange:e[6]||(e[6]=t=>$(t))},[e[16]||(e[16]=o("option",null,null,-1)),(i(!0),d(g,null,w(s(V),t=>(i(),d("option",{key:t.uid,value:t.uid},C(t.name),9,Be))),128))],544),[[D,s(p)]])]),o("label",Ne,[e[19]||(e[19]=o("span",{class:"text-foreground"},"District",-1)),c(o("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[7]||(e[7]=t=>s(n).districtUid=t)},[e[18]||(e[18]=o("option",null,null,-1)),(i(!0),d(g,null,w(s(I),t=>(i(),d("option",{key:t.uid,value:t.uid},C(t.name),9,Te))),128))],512),[[D,s(n).districtUid]])])]),e[20]||(e[20]=o("hr",null,null,-1)),o("button",{type:"button",onClick:e[8]||(e[8]=ae(t=>z(),["prevent"])),class:"m-2 -mb-4 w-full rounded-sm border border-primary bg-primary px-4 py-2 text-primary-foreground transition-colors duration-500 ease select-none hover:bg-primary focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):ie("",!0)],64)}}}),Ie=de(Ae,[["__file","/Users/admin/Documents/Development/felicity/felicity-lims/webapp/views/client/ClientListing.vue"]]);export{Ie as default};
