import{a0 as G,f as W,a7 as g,h as E,_ as X,r as y,c as i,o as l,A as e,C as Y,E as p,a as M,N as x,P as Z,J as C,K as F,L as a,D as $,F as T,a2 as S,a9 as ee}from"./index-DApeomWQ.js";import{c as te,e as D,a as N,u as se,b}from"./index.esm-Cx9agkcQ.js";import{q as oe,r as re}from"./analyses.mutations-Bu696l9I.js";import{u as ne}from"./analysis-BTUsl5OO.js";const le=G({__name:"QCTemplates",setup(V,{expose:t}){t();const d=ne(),{withClientMutation:s}=W();let m=g(!1),f=g("");const u=g(!0),c=g(null),v=te({name:N().trim().required("Template name is required"),description:N().trim().nullable(),qcLevels:D().nullable(),departments:D().nullable()}),{handleSubmit:o,resetForm:_,setValues:w}=se({validationSchema:v,initialValues:{name:"",description:"",qcLevels:[],departments:[]}}),{value:A,errorMessage:U}=b("name"),{value:B,errorMessage:P}=b("description"),{value:z,errorMessage:H}=b("qcLevels"),{value:I}=b("departments");d.fetchQCLevels(),d.fetchQCTemplates();const J=E(()=>d.getQCTemplates),K=E(()=>d.getQCLevels);function L(r){s(oe,{payload:r},"createQcTemplate").then(n=>d.addQcTemplate(n))}function q(r){c.value&&s(re,{uid:c.value,payload:r},"updateQcTemplate").then(n=>d.updateQcTemplate(n))}function Q(r){if(r?.length<=0)return[];let n=[];return r?.forEach(h=>n.push(h.uid)),n}function O(r,n={}){u.value=r,m.value=!0,f.value=(r?"CREATE":"EDIT")+" QC Template",r?(c.value=null,_({values:{name:"",description:"",qcLevels:[],departments:[]}})):(c.value=n.uid??null,w({name:n.name??"",description:n.description??"",qcLevels:n.qcLevels??[],departments:n.departments??[]}))}function R(r){if(r?.length<=0)return"";let n=[];return r?.forEach(h=>n.push(h.level)),n.join(",")}const j=o(r=>{const n={name:r.name,description:r.description??null,levels:Q(r.qcLevels??[]),departments:r.departments??[]};u.value===!0&&L(n),u.value===!1&&q(n),m.value=!1}),k={analysisStore:d,withClientMutation:s,get showModal(){return m},set showModal(r){m=r},get formTitle(){return f},set formTitle(r){f=r},formAction:u,currentUid:c,qcTemplateSchema:v,handleSubmit:o,resetForm:_,setValues:w,name:A,nameError:U,description:B,descriptionError:P,qcLevelsField:z,qcLevelsError:H,departments:I,qcTemplates:J,qcLevels:K,addQCTemplate:L,editQCTemplate:q,levelsUids:Q,FormManager:O,levelsNames:R,saveForm:j};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),ie={class:"shadow-sm rounded-lg bg-card p-6"},ae={class:"overflow-x-auto"},de={class:"min-w-full divide-y divide-border fel-table"},ce={class:"divide-y divide-border bg-background"},ue={class:"whitespace-nowrap text-sm text-foreground"},me={class:"font-medium text-foreground"},pe={key:0,class:"text-sm text-muted-foreground"},fe={class:"whitespace-nowrap text-sm text-foreground"},ve={class:"whitespace-nowrap text-sm text-foreground"},ge={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6"},xe=["onClick"],be={class:"text-xl font-semibold text-foreground"},_e={class:"space-y-4"},he={class:"space-y-2"},ye={key:0,class:"text-sm text-destructive"},Ce={class:"space-y-2"},Te={key:0,class:"text-sm text-destructive"},we={class:"space-y-2"},Le=["value"],qe={key:0,class:"text-sm text-destructive"};function Qe(V,t,d,s,m,f){const u=y("fel-button"),c=y("fel-heading"),v=y("fel-modal");return l(),i(C,null,[e("div",null,[M(c,{title:"QC Templates"},{default:x(()=>[M(u,{onClick:t[0]||(t[0]=o=>s.FormManager(!0))},{default:x(()=>[...t[6]||(t[6]=[Z("Add QC Template",-1)])]),_:1})]),_:1}),e("div",ie,[e("div",ae,[e("table",de,[t[7]||(t[7]=e("thead",null,[e("tr",null,[e("th",{class:"text-left text-sm font-semibold text-foreground"},"QC Template Name"),e("th",{class:"text-left text-sm font-semibold text-foreground"},"Quality Control level(s)"),e("th",{class:"text-left text-sm font-semibold text-foreground"},"Department(s)"),e("th",{class:"relative py-3.5 pl-3 pr-4 sm:pr-6"},[e("span",{class:"sr-only"},"Actions")])])],-1)),e("tbody",ce,[(l(!0),i(C,null,F(s.qcTemplates,o=>(l(),i("tr",{key:o?.uid,class:"hover:bg-muted/50"},[e("td",ue,[e("div",me,a(o?.name),1),o?.description?(l(),i("div",pe,a(o?.description),1)):p("",!0)]),e("td",fe,a(s.levelsNames(o?.qcLevels??[])),1),e("td",ve,a(o?.category),1),e("td",ge,[e("button",{onClick:_=>s.FormManager(!1,o),class:"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 px-4 py-2"}," Edit ",8,xe)])]))),128))])])])])]),s.showModal?(l(),Y(v,{key:0,onClose:t[5]||(t[5]=o=>s.showModal=!1)},{header:x(()=>[e("h3",be,a(s.formTitle),1)]),body:x(()=>[e("form",{onSubmit:t[4]||(t[4]=$((...o)=>s.saveForm&&s.saveForm(...o),["prevent"])),class:"p-6 space-y-6"},[e("div",_e,[e("div",he,[t[8]||(t[8]=e("label",{for:"name",class:"text-sm font-medium text-muted-foreground"},"QC Template Name",-1)),T(e("input",{id:"name",class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring placeholder:text-muted-foreground","onUpdate:modelValue":t[1]||(t[1]=o=>s.name=o),placeholder:"Enter template name"},null,512),[[S,s.name]]),s.nameError?(l(),i("p",ye,a(s.nameError),1)):p("",!0)]),e("div",Ce,[t[9]||(t[9]=e("label",{for:"description",class:"text-sm font-medium text-muted-foreground"},"Description",-1)),T(e("textarea",{id:"description",class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring placeholder:text-muted-foreground resize-none","onUpdate:modelValue":t[2]||(t[2]=o=>s.description=o),placeholder:"Enter template description",rows:"3"},null,512),[[S,s.description]]),s.descriptionError?(l(),i("p",Te,a(s.descriptionError),1)):p("",!0)]),e("div",we,[t[11]||(t[11]=e("label",{for:"controlLevels",class:"text-sm font-medium text-muted-foreground"},"Quality Control Sample Levels",-1)),T(e("select",{name:"controlLevels",id:"controlLevels","onUpdate:modelValue":t[3]||(t[3]=o=>s.qcLevelsField=o),class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring",multiple:""},[t[10]||(t[10]=e("option",{disabled:"",value:""},"Select QC Levels",-1)),(l(!0),i(C,null,F(s.qcLevels,o=>(l(),i("option",{key:o.uid,value:o,class:"py-1"},a(o.level),9,Le))),128))],512),[[ee,s.qcLevelsField]]),t[12]||(t[12]=e("p",{class:"text-xs text-muted-foreground mt-1"},"Hold Ctrl/Cmd to select multiple levels",-1)),s.qcLevelsError?(l(),i("p",qe,a(s.qcLevelsError),1)):p("",!0)])]),t[13]||(t[13]=e("div",{class:"pt-4"},[e("button",{type:"submit",class:"w-full inline-flex items-center justify-center bg-primary text-primary-foreground hover:bg-primary/90 rounded-lg px-4 py-2.5 text-sm font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"}," Save Changes ")],-1))],32)]),_:1})):p("",!0)],64)}const Se=X(le,[["render",Qe],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/analyses/QCTemplates.vue"]]);export{Se as default};
