import{P as ge,u as fe,f as xe,Z as j,r as he,$ as ke,o,c as l,b as t,a as u,a2 as p,A as c,W as G,F as b,D as g,a1 as _e,x as T,J as L,L as f,E as i,a4 as P,V as ve,a5 as O,C as v,K as m,z as w,X as D,Y as I,ap as q,h as we,_ as Re}from"./index-d30fd8e2.js";import{u as Ce}from"./analysis-21d492cc.js";import{h as R,o as C,a as U}from"./constants-cb49b235.js";import"./analyses.mutations-ddd21bab.js";const Ue={class:"overflow-x-auto"},Ee={class:"align-middle inline-block min-w-full shadow overflow-hidden bg-white shadow-dashboard px-2 pt-1 rounded-bl-lg rounded-br-lg"},Ve={key:0,class:"py-4 text-center"},Ae={key:1,class:"min-w-full"},De={class:"px-1 py-1 border-b-2 border-gray-300 text-left leading-4 text-gray-800 tracking-wider"},Ie={class:"bg-white"},Se=["onUpdate:modelValue","onChange","disabled"],Te={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Le={class:"text-sm leading-5 text-sky-800 font-semibold"},Pe=["onClick"],$e={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Ne={key:0,class:"text-sm leading-5 text-sky-800"},Be={key:1,class:"block col-span-2 mb-2"},Oe=["onUpdate:modelValue","onChange"],Me=["value"],Fe={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Ke={key:0,class:"text-sm leading-5 text-sky-800"},je={key:1,class:"block col-span-2 mb-2"},Ge=["onUpdate:modelValue","onChange"],qe=["value"],ze={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},We={class:"text-sm leading-5 text-sky-800"},Je={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Xe={class:"text-sm leading-5 text-sky-800"},Ye={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Ze={key:0,class:"text-sm leading-5 text-sky-800"},He={key:1,class:"block col-span-2 mb-2"},Qe=["onUpdate:modelValue","onChange"],et=["value"],tt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},st={key:0,class:"text-sm leading-5 text-sky-800"},at={key:1,class:"block"},nt=["onUpdate:modelValue","onKeyup"],ot={key:2,class:"block col-span-2 mb-2"},lt=["onUpdate:modelValue","onChange"],rt=["value"],it={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},dt={class:"text-sm leading-5 text-sky-800"},ct={key:0,class:"text-sky-800"},ut={key:1,class:"text-orange-600"},pt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},yt={class:"text-sm leading-5 text-sky-800"},bt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},mt={class:"text-sm leading-5 text-sky-800"},gt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},ft={class:"text-sm leading-5 text-sky-800"},xt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},ht={type:"button",class:"bg-sky-800 text-white px-2 py-1 rounded-sm leading-none"},kt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},_t={class:"text-sm leading-5 text-sky-800"},vt={key:0,class:"text-emerald-600"},wt={key:1,class:"text-orange-600"},Rt={class:"my-4"},Ct=ge({__name:"GenericResults",props:{sample:Object,analysisResults:Object,fetchingResults:Boolean},setup(y){const x=D(()=>I(()=>import("./FelButton-a50b979f.js"),["assets/FelButton-a50b979f.js","assets/index-d30fd8e2.js","assets/index-81d3252e.css"])),z=D(()=>I(()=>import("./FelLoadingMessage-e38294dc.js"),["assets/FelLoadingMessage-e38294dc.js","assets/index-d30fd8e2.js","assets/index-81d3252e.css"])),W=D(()=>I(()=>import("./FelDrawer-bd80a13c.js"),["assets/FelDrawer-bd80a13c.js","assets/index-d30fd8e2.js","assets/index-81d3252e.css"])),J=D(()=>I(()=>import("./AnalysisSneak-cb2300ad.js"),["assets/AnalysisSneak-cb2300ad.js","assets/index-d30fd8e2.js","assets/index-81d3252e.css"])),X=D(()=>I(()=>import("./ResultDetail-400e8377.js"),["assets/ResultDetail-400e8377.js","assets/index-d30fd8e2.js","assets/index-81d3252e.css"])),M=fe(),r=xe({can_submit:!1,can_cancel:!1,can_retract:!1,can_approve:!1,can_retest:!1,can_reinstate:!1,allChecked:!1});function $(){let a=[];return y.analysisResults?.forEach(e=>{e.checked&&a.push(e)}),a}function Y(){let a=$(),e=[];return a?.forEach(d=>e.push({uid:d.uid,result:d.result,methodUid:d.methodUid,laboratoryInstrumentUid:d.laboratoryInstrumentUid})),e}function E(){const a=$();let e=[];return a?.forEach(d=>e.push(d.uid)),e}function Z(a){Q()?r.allChecked=!0:r.allChecked=!1,V()}function h(a){K(a)||(a.checked=!0,V())}function F(a){a.checked=!1,V()}async function H(){await y.analysisResults?.forEach(a=>r.allChecked?h(a):F(a)),V()}async function k(){await y.analysisResults?.forEach(a=>F(a)),V()}function Q(){return y.analysisResults?.every(a=>a.checked===!0)||!1}function K(a){switch(a?.status){case"retracted":return!0;case"approved":return!0;case"cancelled":return y.sample?.status!=="received";default:return!1}}function ee(a){a.editable=!0}function S(a){return!["received","paired"].includes(y.sample?.status??"")||a.status!=="pending"?!1:a?.editable||q(a?.result)?(ee(a),!0):!1}function te(a){switch(a?.status){case"retracted":return"bg-gray-300";case"aproved":return a?.reportable===!1?"bg-orange-600":"";default:return""}}function V(){r.can_cancel=!1,r.can_submit=!1,r.can_retract=!1,r.can_approve=!1,r.can_retest=!1,r.can_reinstate=!1;const a=$();a.length!==0&&(a.every(e=>e.status==="cancelled")&&(r.can_reinstate=!0),a.every(e=>e.status==="pending")&&(r.can_cancel=!0),a.every(e=>["pending"].includes(e.status??"")&&!q(e.result))&&(r.can_submit=!0),a.every(e=>e.status==="resulted")&&(r.can_retract=!0,r.can_approve=!0,r.can_retest=!0))}const _=async()=>{const a=we(()=>M.getSample);a.value&&M.fetchSampleStatus(a?.uid)},N=j(!1),A=j(void 0),se=a=>{N.value=!0,A.value=a};let{submitResults:ae,cancelResults:ne,reInstateResults:oe,approveResults:le,retractResults:re,retestResults:ie}=Ce();const de=()=>ae(Y(),"sample",y.sample?.uid).then(()=>_()).finally(()=>k()),ce=()=>ne(E()).then(()=>_()).finally(()=>k()),ue=()=>oe(E()).then(()=>_()).finally(()=>k()),pe=()=>le(E(),"sample",y.sample?.uid).then(()=>_()).finally(()=>k()),ye=()=>re(E()).then(()=>_()).finally(()=>k()),be=()=>ie(E()).then(()=>_()).finally(()=>k());return(a,e)=>{const d=he("font-awesome-icon"),me=ke("motion-slide-right");return o(),l(b,null,[e[30]||(e[30]=t("hr",{class:"mt-4 mb-2"},null,-1)),e[31]||(e[31]=t("h3",{class:"font-bold"},"Analyses/Results",-1)),e[32]||(e[32]=t("hr",{class:"mb-4 mt-2"},null,-1)),t("div",Ue,[t("div",Ee,[y.fetchingResults?(o(),l("div",Ve,[u(p(z),{message:"Fetching analytes ..."})])):(o(),l("table",Ae,[t("thead",null,[t("tr",null,[t("th",De,[c(t("input",{type:"checkbox",class:"",onChange:H,"onUpdate:modelValue":e[0]||(e[0]=s=>r.allChecked=s)},null,544),[[G,r.allChecked]])]),e[2]||(e[2]=t("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left leading-4 text-gray-800 tracking-wider"},null,-1)),e[3]||(e[3]=t("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left leading-4 text-gray-800 tracking-wider"}," Analysis ",-1)),e[4]||(e[4]=t("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Instrument ",-1)),e[5]||(e[5]=t("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Method ",-1)),e[6]||(e[6]=t("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Analyst ",-1)),e[7]||(e[7]=t("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Reviewer(s) ",-1)),e[8]||(e[8]=t("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Interim ",-1)),e[9]||(e[9]=t("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Result ",-1)),e[10]||(e[10]=t("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Retest ",-1)),e[11]||(e[11]=t("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Due Date ",-1)),e[12]||(e[12]=t("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Submitted ",-1)),e[13]||(e[13]=t("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Approved ",-1)),e[14]||(e[14]=t("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Status ",-1)),e[15]||(e[15]=t("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Reportable ",-1)),e[16]||(e[16]=t("th",{class:"px-1 py-1 border-b-2 border-gray-300"},null,-1))])]),t("tbody",Ie,[(o(!0),l(b,null,g(y.analysisResults,s=>c((o(),l("tr",{key:s.uid,class:_e([te(s)])},[t("td",null,[c(t("input",{type:"checkbox",class:"border-red-500","onUpdate:modelValue":n=>s.checked=n,onChange:n=>Z(),disabled:K(s)},null,40,Se),[[G,s.checked]]),s.status==="pending"?(o(),T(d,{key:0,icon:"fa-question",class:"ml-1 text-xs"})):L("",!0),s.status==="resulted"?(o(),T(d,{key:1,icon:"fa-question",class:"ml-1 text-xs text-orange"})):L("",!0)]),e[21]||(e[21]=t("td",{class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},null,-1)),t("td",Te,[t("div",Le,[t("span",{class:"mr-1 hover:cursor-pointer",onClick:n=>se(s)},[u(d,{icon:"fa-info-circle"})],8,Pe),f(" "+i(s.analysis?.name),1)])]),t("td",$e,[S(s)?(o(),l("label",Be,[c(t("select",{class:"form-input mt-1 block w-full","onUpdate:modelValue":n=>s.laboratoryInstrumentUid=n,onChange:n=>h(s)},[e[17]||(e[17]=t("option",{value:""},null,-1)),(o(!0),l(b,null,g(s.analysis?.instruments,n=>(o(),l(b,{key:n.uid},[(o(!0),l(b,null,g(n.laboratoryInstruments,B=>(o(),l("option",{key:B.uid,value:B.uid},i(B.labName)+" â†’ ("+i(n?.name)+") ",9,Me))),128))],64))),128))],40,Oe),[[P,s.laboratoryInstrumentUid]])])):(o(),l("div",Ne,i(s.laboratoryInstrument?.labName||"---"),1))]),t("td",Fe,[S(s)?(o(),l("label",je,[c(t("select",{class:"form-input mt-1 block w-full","onUpdate:modelValue":n=>s.methodUid=n,onChange:n=>h(s)},[e[18]||(e[18]=t("option",{value:""},null,-1)),(o(!0),l(b,null,g(s.analysis?.methods,n=>(o(),l("option",{key:n.uid,value:n.uid},i(n.name),9,qe))),128))],40,Ge),[[P,s.methodUid]])])):(o(),l("div",Ke,i(s.method?.name||"---"),1))]),t("td",ze,[t("div",We,i(`${s.submittedBy?.firstName??"--"} ${s.submittedBy?.lastName??"--"}`),1)]),t("td",Je,[t("div",Xe,[(o(!0),l(b,null,g(s.verifiedBy,n=>(o(),l("span",{key:n.firstName,class:"ml-1"},i(`${n?.firstName??"--"} ${n?.lastName??"--"},`),1))),128))])]),t("td",Ye,[!S(s)||s?.analysis?.interims?.length===0?(o(),l("div",Ze," --- ")):(o(),l("label",He,[c(t("select",{class:"form-input mt-1 block w-full","onUpdate:modelValue":n=>s.result=n,onChange:n=>h(s)},[e[19]||(e[19]=t("option",{value:""},null,-1)),(o(!0),l(b,null,g(s?.analysis?.interims,n=>(o(),l("option",{key:n.key,value:n.value},i(n.value),9,et))),128))],40,Qe),[[P,s.result]])]))]),t("td",tt,[S(s)?s?.analysis?.resultOptions?.length===0?(o(),l("label",at,[c(t("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":n=>s.result=n,onKeyup:n=>h(s)},null,40,nt),[[ve,s.result]])])):(o(),l("label",ot,[c(t("select",{class:"form-input mt-1 block w-full","onUpdate:modelValue":n=>s.result=n,onChange:n=>h(s)},[e[20]||(e[20]=t("option",{value:""},null,-1)),(o(!0),l(b,null,g(s?.analysis?.resultOptions,n=>(o(),l("option",{key:n.optionKey,value:n.value},i(n.value),9,rt))),128))],40,lt),[[P,s.result]])])):(o(),l("div",st,i(s?.result),1))]),t("td",it,[t("div",dt,[s?.retest?(o(),l("span",ct,[u(d,{icon:"fa-check-circle"})])):(o(),l("span",ut,[u(d,{icon:"fa-times-circle"})]))])]),t("td",pt,[t("div",yt,i(p(O)(s?.dueDate)),1)]),t("td",bt,[t("div",mt,i(p(O)(s?.dateSubmitted)),1)]),t("td",gt,[t("div",ft,i(p(O)(s?.dateVerified)),1)]),t("td",xt,[t("button",ht,i(s.status),1)]),t("td",kt,[t("div",_t,[s?.reportable?(o(),l("span",vt,[u(d,{icon:"fa-thumbs-up","aria-hidden":"true"})])):(o(),l("span",wt,[u(d,{icon:"fa-thumbs-down","aria-hidden":"true"})]))])]),e[22]||(e[22]=t("td",{class:"px-1 py-1 whitespace-no-wrap text-right border-b border-gray-500 text-sm leading-5"},null,-1))],2)),[[me]])),128))])]))])]),t("section",Rt,[c(u(p(x),{key:"cancel",onClick:w(ce,["prevent"]),color:"sky-800"},{default:m(()=>e[23]||(e[23]=[f("Cancel")])),_:1},512),[[v,R(U.UPDATE,C.RESULT)&&r.can_cancel]]),c(u(p(x),{key:"reinstate",onClick:w(ue,["prevent"]),color:"orange-600"},{default:m(()=>e[24]||(e[24]=[f("Re-Instate")])),_:1},512),[[v,R(U.UPDATE,C.RESULT)&&r.can_reinstate]]),c(u(p(x),{key:"submit",onClick:w(de,["prevent"]),color:"orange-600"},{default:m(()=>e[25]||(e[25]=[f("Submit")])),_:1},512),[[v,R(U.UPDATE,C.RESULT)&&r.can_submit]]),c(u(p(x),{key:"retract",onClick:w(ye,["prevent"]),color:"orange-600"},{default:m(()=>e[26]||(e[26]=[f("Retract")])),_:1},512),[[v,R(U.UPDATE,C.RESULT)&&r.can_retract]]),c(u(p(x),{key:"verify",onClick:w(pe,["prevent"]),color:"orange-600"},{default:m(()=>e[27]||(e[27]=[f("Verify")])),_:1},512),[[v,R(U.UPDATE,C.RESULT)&&r.can_approve]]),c(u(p(x),{key:"retest",onClick:w(be,["prevent"]),color:"orange-600"},{default:m(()=>e[28]||(e[28]=[f("Retest")])),_:1},512),[[v,R(U.UPDATE,C.RESULT)&&r.can_retest]])]),u(p(W),{show:N.value,onClose:e[1]||(e[1]=s=>N.value=!1),"content-width":"w-2/4"},{header:m(()=>e[29]||(e[29]=[t("h3",null,"Result Information",-1)])),body:m(()=>[A.value?.analysisUid?(o(),T(p(J),{key:0,analysisUid:A.value?.analysisUid},null,8,["analysisUid"])):L("",!0),A.value?.uid?(o(),T(p(X),{key:1,analysisResultesultUid:A.value?.uid},null,8,["analysisResultesultUid"])):L("",!0)]),_:1},8,["show"])],64)}}}),Dt=Re(Ct,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/sample/_id/results/GenericResults.vue"]]);export{Dt as default};
