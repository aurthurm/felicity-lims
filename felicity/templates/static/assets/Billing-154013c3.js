import{P as S,e as B,t as C,R as c,f as w,Z as P,o as u,c as r,b as e,A as i,V as m,z as A,a4 as y,F as g,D as b,E as D,C as x,a2 as M,W as _,_ as I}from"./index-d30fd8e2.js";import{u as $,E as j,a as q,b as F,c as R}from"./billing-c9a6c7fc.js";const z={class:"grid grid-cols-12"},L={class:"col-span-6 gap-x-4 pr-4 mb-2"},N={class:"mt-4"},W={class:""},Z={class:"flex justify-start items-center gap-x-4 mb-4"},G={class:"col-span-6 gap-x-4 mb-2 border-l-2 border-l-gray-500 pl-4"},H={class:"mt-4"},J={class:"grid grid-cols-2 gap-4"},K={class:"col-span-1 whitespace-nowrap mb-2 w-full"},O={class:"w-full"},Q=["value"],X={class:"col-span-1 whitespace-nowrap mb-2 w-full"},Y={class:"w-full"},tt=["value"],et={class:"grid grid-cols-4 gap-4 mt-1"},st={class:"col-span-2"},lt={class:"col-span-2"},ot={class:"col-span-2 whitespace-nowrap w-full mb-2"},nt={class:"w-full"},it=["value"],at={class:"grid grid-cols-2 gap-x-4 mt-1"},ut={class:"col-span-1"},rt={class:"col-span-1"},dt={class:"grid grid-cols-2 gap-4 mt-4 mb-2"},pt={class:"col-span-4 flex justify-start items-center gap-x-4"},ct=S({__name:"Billing",props:{target:{type:String,required:!0},targetUid:{type:String,required:!0}},setup(U){const o=$(),{withClientMutation:f}=B(),T=U,{target:a,targetUid:d}=C(T),v=()=>{o.clear(),a?.value==="profile"&&(o.fetchProfilePrice(d.value),o.fetchProfileDiscount(d.value)),a?.value==="analysis"&&(o.fetchAnalysisPrice(d.value),o.fetchAnalysisDiscount(d.value)),o.fetchVouchers()};v(),c(()=>a.value,(n,t)=>v()),c(()=>d.value,(n,t)=>v());const p=w({amount:0});c(()=>o.fetchingPrice,(n,t)=>{n||(a?.value==="profile"&&(p.amount=o.profilePrice?.amount??0),a?.value==="analysis"&&(p.amount=o.analysisPrice?.amount??0))});const k=()=>{const n={...p};let t=a.value=="profile"?o.profilePrice:o.analysisPrice;a?.value==="profile"?f(j,{uid:t.uid,payload:n},"updateProfilePrice").then():f(q,{uid:t.uid,payload:n},"updateAnalysisPrice").then()},l=w({discountType:"",valueType:"",startDate:"",endDate:"",voucherUid:"",valuePercent:0,valueAmount:0,isActive:!0});c(()=>o.fetchingDiscount,(n,t)=>{if(!n){let s={};a?.value==="profile"&&(s={...o.profileDiscount}),a?.value==="analysis"&&(s={...o.analyisDiscount}),l.discountType=s.discountType,l.valueType=s.valueType,l.startDate=s.startDate,l.endDate=s.endDate,l.voucherUid=s.voucherUid,l.valuePercent=s.valuePercent,l.valueAmount=s.valueAmount,l.isActive=s.isActive}});const V=P(["sale","voucher"]),h=P(["percentage","amount"]),E=()=>{const n={...l};let t=a.value=="profile"?o.profileDiscount:o.analyisDiscount;a.value=="profile"?f(F,{uid:t.uid,payload:n},"updateProfileDiscount").then():f(R,{uid:t.uid,payload:n},"updateAnalysisDiscount").then()};return c(()=>l.discountType,(n,t)=>{n!=="voucher"&&(l.voucherUid=void 0)}),(n,t)=>(u(),r("div",z,[e("section",L,[t[12]||(t[12]=e("h3",{class:"font-semibold text-l text-gray-600"},"Pricing Information",-1)),t[13]||(t[13]=e("hr",null,null,-1)),e("form",N,[e("div",W,[e("label",Z,[t[11]||(t[11]=e("span",{class:"col-span-1 text-gray-700"},"Amount: $",-1)),i(e("input",{class:"form-input mt-1","onUpdate:modelValue":t[0]||(t[0]=s=>p.amount=s),type:"number",min:"0.0",step:"0.1"},null,512),[[m,p.amount]])])]),e("button",{type:"button",onClick:t[1]||(t[1]=A(s=>k(),["prevent"])),class:"border border-sky-800 bg-sky-800 text-white rounded-sm mt-4 px-2 py-1 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Update Pricing ")])]),e("section",G,[t[27]||(t[27]=e("h3",{class:"font-semibold text-l text-gray-600"},"Discounts Information",-1)),t[28]||(t[28]=e("hr",null,null,-1)),e("form",H,[e("div",J,[e("label",K,[t[15]||(t[15]=e("span",{class:"text-gray-700 w-4/12"},"Discount Type",-1)),e("div",O,[i(e("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":t[2]||(t[2]=s=>l.discountType=s)},[t[14]||(t[14]=e("option",null,null,-1)),(u(!0),r(g,null,b(V.value,s=>(u(),r("option",{key:s,value:s},D(s),9,Q))),128))],512),[[y,l.discountType]])])]),e("label",X,[t[17]||(t[17]=e("span",{class:"text-gray-700 w-4/12"},"Value Type",-1)),e("div",Y,[i(e("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":t[3]||(t[3]=s=>l.valueType=s)},[t[16]||(t[16]=e("option",null,null,-1)),(u(!0),r(g,null,b(h.value,s=>(u(),r("option",{key:s,value:s},D(s),9,tt))),128))],512),[[y,l.valueType]])])])]),e("div",et,[e("label",st,[t[18]||(t[18]=e("span",{class:"col-span-1 text-gray-700"},"Start Date",-1)),i(e("input",{class:"form-input w-full","onUpdate:modelValue":t[4]||(t[4]=s=>l.startDate=s),type:"date"},null,512),[[m,l.startDate]])]),e("label",lt,[t[19]||(t[19]=e("span",{class:"col-span-1 text-gray-700"},"End Date",-1)),i(e("input",{class:"form-input w-full","onUpdate:modelValue":t[5]||(t[5]=s=>l.endDate=s),type:"date"},null,512),[[m,l.endDate]])]),i(e("label",ot,[t[21]||(t[21]=e("span",{class:"text-gray-700 w-4/12"},"Voucher",-1)),e("div",nt,[i(e("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":t[6]||(t[6]=s=>l.voucherUid=s)},[t[20]||(t[20]=e("option",null,null,-1)),(u(!0),r(g,null,b(M(o).vouchers,s=>(u(),r("option",{key:s.uid,value:s.uid},D(s.name),9,it))),128))],512),[[y,l.voucherUid]])])],512),[[x,l.discountType==="voucher"]])]),e("div",at,[i(e("label",ut,[t[22]||(t[22]=e("span",{class:"text-gray-700"},"Value Percent",-1)),i(e("input",{class:"form-input w-full","onUpdate:modelValue":t[7]||(t[7]=s=>l.valuePercent=s),type:"number",step:"0.01",min:"0.00",max:"1"},null,512),[[m,l.valuePercent]]),t[23]||(t[23]=e("span",{class:"italic leading text-xs"},"Example: 0.05 for 5%",-1))],512),[[x,l.valueType==="percentage"]]),i(e("label",rt,[t[24]||(t[24]=e("span",{class:"text-gray-700"},"Value Amount",-1)),i(e("input",{class:"form-input w-full","onUpdate:modelValue":t[8]||(t[8]=s=>l.valueAmount=s),type:"number",step:"0.1",min:"0.0"},null,512),[[m,l.valueAmount]])],512),[[x,l.valueType==="amount"]])]),e("div",dt,[e("label",pt,[t[25]||(t[25]=e("span",{class:"col-span-1 text-gray-700"},"Is Active",-1)),i(e("input",{class:"form-checkbox","onUpdate:modelValue":t[9]||(t[9]=s=>l.isActive=s),type:"checkbox"},null,512),[[_,l.isActive]])])]),t[26]||(t[26]=e("hr",null,null,-1)),e("button",{type:"button",onClick:t[10]||(t[10]=A(s=>E(),["prevent"])),class:"border border-sky-800 bg-sky-800 text-white rounded-sm mt-4 px-2 py-1 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Update Discount ")])])]))}}),vt=I(ct,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/admin/analyses/Billing.vue"]]);export{vt as default};
