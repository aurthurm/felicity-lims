import{a0 as V,f as B,ad as j,a7 as l,g as G,W as N,_ as S,r as T,c as x,o as p,A as e,C as L,E as q,J as P,K as Q,Q as _,L as b,N as U,D as z,F as v,P as H,a2 as C,a as I,a3 as J}from"./index-CNAOKjig.js";import{j as K,k as O,l as W}from"./grind.queries-CgCUL2Rs.js";import{r as R,m as X}from"./index-6YiJnsMt.js";import{Multiselect as Y}from"./vue-multiselect.esm-BoOjdWpS.js";const Z=V({__name:"ErrandMilestone",props:{errandUid:{type:String,required:!0}},emits:["milestoneUpdated"],setup(y,{expose:o,emit:w}){o();const t=y,{withClientMutation:d,withClientQuery:a}=B();j(()=>{i(),k()});const u=w,r=l([]);function i(s="cache-first"){a(K,{errandUid:t.errandUid},"grindMilestonesByErrand",s).then(f=>{f&&(r.value=f)})}const c=l(!1),m=l(!1),g=l(""),n=G({});function D(){c.value=!0,g.value="Add Milestone",m.value=!0,R(n)}function E(s){c.value=!0,g.value="Edit Milestone",m.value=!1,X(n,s)}function A(){c.value=!1;const s={title:n.title,description:n.description,complete:n.complete,assigneeUid:n.assignee?.uid,errandUid:t.errandUid};m.value?d(O,{payload:{...s,errandUid:t.errandUid}},"createGrindMilestone").then(()=>i("network-only")):d(W,{uid:n.uid,payload:s},"updateGrindMilestone").then(()=>{i("network-only"),u("milestoneUpdated")})}function F({firstName:s,lastName:f}){return`${s} ${f}`}const h=l();function k(){a(N,{first:100},"userAll").then(s=>{h.value=s.items})}const M={props:t,withClientMutation:d,withClientQuery:a,emit:u,milestones:r,fetchMilestones:i,showForm:c,formAction:m,formTitle:g,form:n,addMilestone:D,editMilestone:E,saveForm:A,customLabel:F,users:h,getUsers:k,get Multiselect(){return Y}};return Object.defineProperty(M,"__isScriptSetup",{enumerable:!1,value:!0}),M}}),$={class:"space-y-6"},ee={class:"space-y-6"},oe=["onDblclick"],te={class:"absolute left-0 top-0 transform -translate-x-1/2 bg-background p-1 border border-border rounded-full w-4 h-4 flex items-center justify-center transition-colors duration-200 group-hover:border-primary"},re={class:"mb-6"},se={class:"font-medium text-foreground group-hover:text-primary transition-colors duration-200"},ne={class:"text-sm text-muted-foreground mt-1"},ie={class:"text-lg font-semibold text-foreground"},le={class:"flex items-center space-x-2"},de={class:"flex justify-end space-x-3"},ae={type:"submit",class:"px-4 py-2 text-sm font-medium text-primary-foreground bg-primary border border-transparent rounded-md shadow-sm hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors duration-200"};function ue(y,o,w,t,d,a){const u=T("fel-modal");return p(),x("div",$,[e("div",{class:"flex justify-between items-center"},[o[7]||(o[7]=e("h3",{class:"text-lg font-medium text-foreground"},"Milestones",-1)),e("button",{onClick:t.addMilestone,class:"px-3 py-1.5 text-sm font-medium text-foreground bg-background border border-border rounded-md hover:border-primary hover:text-primary hover:bg-secondary transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"},[...o[6]||(o[6]=[e("span",{class:"flex items-center space-x-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",null,"Add New")],-1)])])]),e("div",ee,[(p(!0),x(P,null,Q(t.milestones,r=>(p(),x("div",{key:r.uid,class:_(["pl-6 border-l-2 relative group cursor-pointer",{"border-success/20":r.complete,"border-destructive/20":!r.complete}]),onDblclick:i=>t.editMilestone(r)},[e("div",te,[e("div",{class:_(["w-2 h-2 rounded-full transition-colors duration-200",{"bg-success":r.complete,"bg-destructive":!r.complete}])},null,2)]),e("div",re,[e("h4",se,b(r.title),1),e("p",ne,b(r.description),1)])],42,oe))),128))]),t.showForm?(p(),L(u,{key:0,onClose:o[5]||(o[5]=r=>t.showForm=!1),"content-width":"w-full max-w-2xl"},{header:U(()=>[e("h3",ie,b(t.formTitle),1)]),body:U(()=>[e("form",{onSubmit:z(t.saveForm,["prevent"]),class:"space-y-6 p-6"},[e("div",null,[o[8]||(o[8]=e("label",{class:"block text-sm font-medium text-foreground mb-1",for:"title"},[H(" Title "),e("span",{class:"text-destructive"},"*")],-1)),v(e("input",{id:"title","onUpdate:modelValue":o[0]||(o[0]=r=>t.form.title=r),type:"text",required:"",class:"w-full px-3 py-2 border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-background text-foreground",placeholder:"Enter milestone title"},null,512),[[C,t.form.title]])]),e("div",null,[o[9]||(o[9]=e("label",{class:"block text-sm font-medium text-foreground mb-1",for:"description"}," Description ",-1)),v(e("textarea",{id:"description","onUpdate:modelValue":o[1]||(o[1]=r=>t.form.description=r),rows:"3",class:"w-full px-3 py-2 border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-background text-foreground",placeholder:"Enter milestone description"},null,512),[[C,t.form.description]])]),e("div",null,[o[10]||(o[10]=e("label",{class:"block text-sm font-medium text-foreground mb-1"}," Assignee ",-1)),I(t.Multiselect,{modelValue:t.form.assignee,"onUpdate:modelValue":o[2]||(o[2]=r=>t.form.assignee=r),options:t.users,"track-by":"uid",searchable:!0,"custom-label":t.customLabel,placeholder:"Select assignee",class:"multiselect-primary"},null,8,["modelValue","options"])]),e("div",le,[v(e("input",{id:"complete","onUpdate:modelValue":o[3]||(o[3]=r=>t.form.complete=r),type:"checkbox",class:"w-4 h-4 text-primary border-border rounded focus:ring-primary focus:ring-offset-2"},null,512),[[J,t.form.complete]]),o[11]||(o[11]=e("label",{class:"text-sm font-medium text-foreground",for:"complete"}," Complete ",-1))]),e("div",de,[e("button",{type:"button",onClick:o[4]||(o[4]=r=>t.showForm=!1),class:"px-4 py-2 text-sm font-medium text-foreground bg-background border border-border rounded-md shadow-sm hover:bg-muted focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors duration-200"}," Cancel "),e("button",ae,b(t.formAction?"Create":"Update"),1)])],32)]),_:1})):q("",!0)])}const be=S(Z,[["render",ue],["__scopeId","data-v-7f459d59"],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/grind/_id/ErrandMilestone.vue"]]);export{be as default};
