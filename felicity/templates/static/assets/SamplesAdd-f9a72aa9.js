import{P as ae,u as oe,Q as ne,e as ie,h as f,f as I,Z as M,ak as re,r as ue,o as n,c as i,b as t,A as d,V as E,a2 as a,a7 as v,E as r,a as V,a4 as y,F as w,D as b,z as U,J as de,X as pe,i as me,Y as ce,_ as fe}from"./index-f86d8273.js";import ve from"./vue-multiselect.esm-1db37a44.js";import{u as ye}from"./patient-e30e0cdb.js";import{u as we}from"./analysis-f80e6c89.js";import{u as be}from"./client-6bf4b6ff.js";import{A as xe}from"./analyses.mutations-0a79566e.js";import{c as N,a as B,d as F,e as ge,u as Ce,b as p}from"./array-6bfc3b39.js";/* empty css                                                                 */import"./location-556e8a7d.js";const Se={class:"w-3/6 mt-4 py-4"},_e={class:""},he={class:"flex whitespace-nowrap mb-2 w-full"},ke={class:"w-full"},Ae={class:"text-orange-600 w-4/12"},De={class:"flex whitespace-nowrap mb-2 w-full"},Ve={class:"w-full"},Ue={class:"text-orange-600 w-4/12"},Re={class:"flex whitespace-nowrap mb-2 w-full"},qe={class:"w-full"},Pe={class:"flex whitespace-nowrap mb-2 w-full"},Te={class:"w-full"},Ie=["value"],Me={class:"text-orange-600 w-4/12"},Ee={class:"flex whitespace-nowrap mb-2 w-full"},Ne={class:"w-full"},Be={class:"text-orange-600 w-4/12"},Fe={id:"samples"},Ye={class:"flex justify-between items-center py-2"},$e={class:"text-orange-600"},Le={class:"flex items-center justify-between"},He={class:"flex items-top gap-x-4"},je={class:"flex flex-col whitespace-nowrap mb-2"},ze=["onUpdate:modelValue"],Je=["value"],Oe={class:"flex flex-col whitespace-nowrap mb-2"},Qe={class:"flex flex-col whitespace-nowrap mb-2"},Xe=["onUpdate:modelValue"],Ze=["value"],Ge={class:"flex flex-col whitespace-nowrap mb-2"},Ke=["onUpdate:modelValue"],We=["value"],et={class:""},tt=["onClick"],st={key:0,type:"submit",class:"-mb-4 w-full border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"},lt={key:1,class:"py-4 text-center"},at=ae({__name:"SamplesAdd",setup(ot){const Y=pe(()=>ce(()=>import("./FelLoadingMessage-e1e357b9.js"),["assets/FelLoadingMessage-e1e357b9.js","assets/index-f86d8273.js","assets/index-ba19faea.css"])),C=oe(),$=ye(),x=we(),R=be(),L=ne(),{withClientMutation:H}=ie(),{swalError:q}=me();let S=f(()=>$.getPatient),j=I({first:void 0,after:"",text:"",sortBy:["name"],contacts:!0});R.fetchClients(j);const z=f(()=>R.getClients),J=M(null),O=o=>{J.value=o};C.fetchSampleTypes();const Q=f(()=>C.getSampleTypes);let X=I({first:void 0,after:"",text:"",sortBy:["name"]});x.fetchAnalysesServices(X);const Z=f(()=>{const o=x.getAnalysesServicesSimple;let e=new Set;return o.forEach((u,s)=>{u.profiles?.length===0&&e.add(u)}),[...e]});x.fetchAnalysesProfiles();const G=f(()=>x.getAnalysesProfiles),_=M(!1),K=new Date,W=N({clientRequestId:B().required("Client Request ID is Required"),clinicalData:B().nullable(),client:N().required("Client is Required"),clientContactUid:F().required("Client Contact is Required"),samples:ge().required().min(1,"Add at least 1 sample"),priority:F()}),{handleSubmit:ee,errors:m}=Ce({validationSchema:W,initialValues:{priority:0,client:S?.value?.client,samples:[]}}),{value:h}=p("clientRequestId"),{value:k}=p("clinicalData"),{value:c}=p("client"),{value:A}=p("clientContactUid"),{value:D}=p("priority"),{value:g}=p("samples"),P=ee(o=>{_.value=!0;for(let e of o.samples||[]){if(typeof e?.sampleType!="string"){q("Samples must have sample types");return}if(e?.analyses?.length<=0&&e?.profiles?.length<=0){q("Samples must have either profiles/analyses or both");return}}te(o)});function te(o){const e={patientUid:S.value?.uid,clientRequestId:o.clientRequestId,clinicalData:o.clinicalData,clientUid:c?.value?.uid,clientContactUid:o.clientContactUid,samples:o.samples?.map(u=>({...u,dateCollected:re(u.dateCollected,"YYYY-MM-DD HH:mm")}))};H(xe,{payload:e},"createAnalysisRequest").then(u=>{C.addAnalysisRequest(u),L.push({name:"patient-detail",params:{patientUid:S.value?.uid}})}).finally(()=>{_.value=!1})}function se(){const o={sampleType:{},dateCollected:"",profiles:[],analyses:[]};g.value.push(o)}function le(o){g.value.splice(o,1)}return(o,e)=>{const u=ue("VueDatePicker");return n(),i("div",Se,[e[26]||(e[26]=t("h5",{class:"mb-4"},"Add Analysis Request",-1)),t("form",{action:"post",class:"p-4 mb-8 bg-white",onSubmit:e[6]||(e[6]=U((...s)=>a(P)&&a(P)(...s),["prevent"]))},[t("div",_e,[t("label",he,[e[7]||(e[7]=t("span",{class:"text-gray-700 w-4/12"},"Client Request ID",-1)),t("div",ke,[d(t("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":e[0]||(e[0]=s=>v(h)?h.value=s:null),placeholder:"CRID ..."},null,512),[[E,a(h)]]),t("div",Ae,r(a(m).clientRequestId),1)])]),t("label",De,[e[8]||(e[8]=t("span",{class:"text-gray-700 w-4/12"},"Clinical Data",-1)),t("div",Ve,[d(t("textarea",{cols:"2",class:"form-input mt-1 w-full","onUpdate:modelValue":e[1]||(e[1]=s=>v(k)?k.value=s:null),placeholder:"Clinical Data ..."},null,512),[[E,a(k)]]),t("div",Ue,r(a(m).clinicalData),1)])]),t("label",Re,[e[9]||(e[9]=t("span",{class:"text-gray-700 w-4/12"},"Client",-1)),t("div",qe,[V(a(ve),{placeholder:"Select a Client",modelValue:a(c),"onUpdate:modelValue":e[2]||(e[2]=s=>v(c)?c.value=s:null),options:z.value,searchable:!0,label:"name","track-by":"uid",onSelect:O},null,8,["modelValue","options"])])]),t("label",Pe,[e[11]||(e[11]=t("span",{class:"text-gray-700 w-4/12"},"Client Contacts",-1)),t("div",Te,[d(t("select",{name:"clientContacts",id:"clientContacts","onUpdate:modelValue":e[3]||(e[3]=s=>v(A)?A.value=s:null),class:"form-input mt-1 block w-full"},[e[10]||(e[10]=t("option",{value:""},null,-1)),(n(!0),i(w,null,b(a(c)?.contacts,s=>(n(),i("option",{key:s.uid,value:s.uid},r(s.firstName)+" "+r(s.lastName),9,Ie))),128))],512),[[y,a(A)]]),t("div",Me,r(a(m).clientContactUid),1)])]),t("label",Ee,[e[13]||(e[13]=t("span",{class:"text-gray-700 w-4/12"},"Priority",-1)),t("div",Ne,[d(t("select",{name:"clientContacts",id:"clientContacts","onUpdate:modelValue":e[4]||(e[4]=s=>v(D)?D.value=s:null),class:"form-input mt-1 block w-full"},e[12]||(e[12]=[t("option",{value:"0"},"Low",-1),t("option",{value:"1"},"Medium",-1),t("option",{value:"2"},"High",-1)]),512),[[y,a(D)]]),t("div",Be,r(a(m).priority),1)])])]),t("section",Fe,[e[23]||(e[23]=t("hr",null,null,-1)),t("div",Ye,[e[14]||(e[14]=t("h5",null,"Samples",-1)),t("span",$e,r(a(m).samples),1),a(g)?.length!==20?(n(),i("button",{key:0,onClick:e[5]||(e[5]=U(s=>se(),["prevent"])),class:"px-2 py-1 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Add Sample ")):de("",!0)]),e[24]||(e[24]=t("hr",{class:"mb-4"},null,-1)),(n(!0),i(w,null,b(a(g),(s,T)=>(n(),i("div",{key:T},[t("div",Le,[t("div",He,[t("label",je,[e[16]||(e[16]=t("span",{class:"text-gray-700"},"Sample Type",-1)),d(t("select",{name:"sampleTypes",id:"sampleTypes","onUpdate:modelValue":l=>s.sampleType=l,class:"form-input mt-1"},[e[15]||(e[15]=t("option",{value:""},null,-1)),(n(!0),i(w,null,b(Q.value,l=>(n(),i("option",{key:l.uid,value:l.uid},r(l.name),9,Je))),128))],8,ze),[[y,s.sampleType]])]),t("label",Oe,[e[17]||(e[17]=t("span",{class:"text-gray-700"},"Date Collected",-1)),V(u,{class:"z-60 disabled:bg-slate-200",modelValue:s.dateCollected,"onUpdate:modelValue":l=>s.dateCollected=l,"max-date":a(K),"time-picker-inline":""},null,8,["modelValue","onUpdate:modelValue","max-date"])]),t("label",Qe,[e[19]||(e[19]=t("span",{class:"text-gray-700"},"Analysis Profiles",-1)),d(t("select",{name:"analysisProfiles",id:"analysisProfiles","onUpdate:modelValue":l=>s.profiles=l,class:"form-input mt-1",multiple:""},[e[18]||(e[18]=t("option",{value:""},null,-1)),(n(!0),i(w,null,b(G.value,l=>(n(),i("option",{key:l.uid,value:l.uid},r(l.name),9,Ze))),128))],8,Xe),[[y,s.profiles]])]),t("label",Ge,[e[21]||(e[21]=t("span",{class:"text-gray-700"},"Analysis Services",-1)),d(t("select",{name:"analysesServices",id:"analysesServices","onUpdate:modelValue":l=>s.analyses=l,class:"form-input mt-1",multiple:""},[e[20]||(e[20]=t("option",{value:""},null,-1)),(n(!0),i(w,null,b(Z.value,l=>(n(),i("option",{key:l.uid,value:l.uid},r(l.name),9,We))),128))],8,Ke),[[y,s.analyses]])])]),t("div",et,[t("button",{onClick:U(l=>le(T),["prevent"]),class:"px-2 py-1 mr-2 border-orange-600 border text-orange-600rounded-smtransition duration-300 hover:bg-orange-600 hover:text-white focus:outline-none"}," Remove ",8,tt)])]),e[22]||(e[22]=t("hr",null,null,-1))]))),128))]),e[25]||(e[25]=t("hr",null,null,-1)),_.value?(n(),i("div",lt,[V(a(Y),{message:"Adding Samples ..."})])):(n(),i("button",st," Add Sample(s) "))],32)])}}}),vt=fe(at,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/sample/SamplesAdd.vue"]]);export{vt as default};
