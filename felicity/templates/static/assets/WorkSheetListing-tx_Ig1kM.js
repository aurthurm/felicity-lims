const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DataTable-DLBrhw2Z.js","assets/index-OdhKCqIc.js","assets/index-DD18L2yL.css","assets/TooltipTrigger-BWIYwmnQ.js","assets/PopperContent-BfyCnGUj.js","assets/Input-BEm5S0CJ.js","assets/SelectValue-Ds0cfAgl.js","assets/useNonce-B4v0IDPb.js","assets/chevron-down-Dqf-ptA3.js","assets/useFocusGuards-Bjb6OG0k.js","assets/Spinner-Bl8RfjFA.js"])))=>i.map(i=>d[i]);
import{Y as K,Q as z,u as J,aB as Q,ag as Y,a0 as S,av as G,aJ as X,a7 as I,a5 as Z,a6 as $,a3 as ee,aD as k,aC as te,_ as ae,r as re,c as v,o as m,a as t,z as d,K as a,D as oe,B as M,M as i,E as le,A as b,C as se,aK as T,aL as P,F as _,H as x,I as A,a4 as ne}from"./index-OdhKCqIc.js";import{u as ie}from"./user-DYsgscqA.js";import{c as de,d as ue,a as w,u as me,F as fe}from"./index.esm-BfHj8iGm.js";import{s as ce}from"./index-DJJ2wcNX.js";import{I as he}from"./Input-BEm5S0CJ.js";import{F as ge,a as Se,b as ke}from"./FormMessage-CgXFMXx9.js";import{F as ve}from"./FormLabel-DxP9wnWS.js";import{S as be,a as _e,b as we,c as Fe,d as ye}from"./SelectValue-Ds0cfAgl.js";import{P as Ce}from"./PageHeading-Czi_4opS.js";import"./Label-CS46LzLb.js";import"./useNonce-B4v0IDPb.js";import"./chevron-down-Dqf-ptA3.js";import"./useFocusGuards-Bjb6OG0k.js";import"./PopperContent-BfyCnGUj.js";const pe=K({__name:"WorkSheetListing",setup(B,{expose:o}){o();const F=Z(()=>$(()=>import("./DataTable-DLBrhw2Z.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),e=z(),f=ie(),{withClientMutation:g}=J(),{workSheets:c,fetchingWorkSheets:s,workSheetPageInfo:n,workSheetTemplates:N}=Q(e),L=Y();let h=S(!1);const U=S([{name:"All",value:""},{name:"Pending",value:"pending"},{name:"Awaiting",value:"awaiting"},{name:"Approved",value:"approved"},{name:"Empty",value:"empty"}]),R=S([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"WorkSheet Id",value:"workSheetId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(r,u){return k(te,{to:{name:"worksheet-detail",params:{workSheetUid:r?.uid}},innerHTML:r?.worksheetId})}},{name:"Analysis/Test",value:"analysis.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Samples",value:"assignedCount",sortable:!1,sortBy:"asc",hidden:!1},{name:"Instrument",value:"instrument.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Analyst",value:"clientPatientId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(r,u){return k("div",{innerHTML:p(r?.analyst)})}},{name:"Status",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(r,u){return k("button",{type:"button",class:"bg-primary text-primary-foreground py-1 px-2 rounded-sm leading-none",innerHTML:r?.state||"unknown"})}}]);e.removeWorksheet();let l=G({first:25,before:"",status:"",text:"",sort:["-uid"],filterAction:!1});e.fetchWorkSheets(l),e.fetchWorkSheetTemplates(),f.fetchUsers({});const y=de({analystUid:w().required("Analyst is Required"),templateUid:w().required("Worksheet Template is required"),instrumentUid:w().nullable(),count:ue().min(1,"Count must be at least 1").required("Count is required")}),{handleSubmit:C}=me({validationSchema:y,initialValues:{count:1,analystUid:"",templateUid:"",instrumentUid:null}}),D=C(r=>{h.value=!1,g(X,r,"createWorksheet").then(u=>{e.addWorksheet(u),h.value=!1})});function E(r){let u=[];return r?.forEach(j=>u.push(j.name)),u?.join(", ")}function V(r){l.first=r.fetchCount,l.before=n?.value?.endCursor??"",l.text=r.filterText,l.status=r.filterStatus,l.filterAction=!1,e.fetchWorkSheets(l)}function H(r){l.first=25,l.before="",l.text=r.filterText,l.status=r.filterStatus,l.filterAction=!0,e.fetchWorkSheets(l)}const O=I(()=>f.getUsers),p=r=>r?.auth?.userName?r?.auth?.userName:r?.firstName?r.firstName+" "+r.lastName:"----",q=I(()=>c?.value?.length+" of "+e.getWorkSheetCount+" WorkSheets"),W={DataTable:F,worksheetStore:e,userStore:f,withClientMutation:g,workSheets:c,fetchingWorkSheets:s,workSheetPageInfo:n,workSheetTemplates:N,route:L,get showModal(){return h},set showModal(r){h=r},filterOptions:U,tableColumns:R,get workSheetParams(){return l},set workSheetParams(r){l=r},worksheetSchema:y,handleSubmit:C,saveForm:D,analysesText:E,showMoreWorkSheets:V,searchWorkSheets:H,analysts:O,analystName:p,countNone:q,get shield(){return ce},get Button(){return ee},get Input(){return he},get FormControl(){return ke},get FormField(){return fe},get FormItem(){return Se},get FormLabel(){return ve},get FormMessage(){return ge},get Select(){return ye},get SelectContent(){return Fe},get SelectItem(){return we},get SelectTrigger(){return _e},get SelectValue(){return be},PageHeading:Ce};return Object.defineProperty(W,"__isScriptSetup",{enumerable:!1,value:!0}),W}}),We={class:"space-y-6"},Ie={class:"rounded-lg border border-border bg-card shadow-sm p-6"},Me={class:"grid grid-cols-3 gap-4"},Te={class:"border-t border-border pt-4"};function Pe(B,o,F,e,f,g){const c=re("Modal");return m(),v(_,null,[t(e.PageHeading,{title:"Worksheets"},{default:a(()=>[oe(t(e.Button,{onClick:o[0]||(o[0]=M(s=>e.showModal=!0,["prevent"]))},{default:a(()=>[...o[3]||(o[3]=[i(" Add WorkSheet ",-1)])]),_:1},512),[[le,e.shield.hasRights(e.shield.actions.CREATE,e.shield.objects.WORKSHEET)]])]),_:1}),d("div",We,[d("div",Ie,[t(e.DataTable,{columns:e.tableColumns,data:e.workSheets,toggleColumns:!0,loading:e.fetchingWorkSheets,paginable:!0,pageMeta:{fetchCount:e.workSheetParams.first,hasNextPage:e.workSheetPageInfo?.hasNextPage,countNone:e.countNone},searchable:!0,filterable:!0,filterMeta:{defaultFilter:e.workSheetParams.status,filters:e.filterOptions},onOnSearch:e.searchWorkSheets,onOnPaginate:e.showMoreWorkSheets,selectable:!1,class:"bg-background rounded-lg shadow-sm"},{footer:a(()=>[...o[4]||(o[4]=[])]),_:1},8,["columns","data","loading","pageMeta","filterMeta"])]),e.showModal?(m(),b(c,{key:0,onClose:o[2]||(o[2]=s=>e.showModal=!1),contentWidth:"w-1/2"},{header:a(()=>[...o[5]||(o[5]=[d("div",{class:"space-y-4"},[d("h3",{class:"text-lg font-medium"},"Create Worksheet"),d("div",{class:"border-t border-border"})],-1)])]),body:a(()=>[d("form",{class:"space-y-6 p-4",onSubmit:o[1]||(o[1]=M((...s)=>e.saveForm&&e.saveForm(...s),["prevent"]))},[d("div",Me,[t(e.FormField,{name:"analystUid"},{default:a(({componentField:s})=>[t(e.FormItem,null,{default:a(()=>[t(e.FormLabel,null,{default:a(()=>[...o[6]||(o[6]=[i("Analyst",-1)])]),_:1}),t(e.FormControl,null,{default:a(()=>[t(e.Select,T(P(s)),{default:a(()=>[t(e.SelectTrigger,null,{default:a(()=>[t(e.SelectValue,{placeholder:"Select analyst"})]),_:1}),t(e.SelectContent,null,{default:a(()=>[t(e.SelectItem,{value:""},{default:a(()=>[...o[7]||(o[7]=[i("Select analyst",-1)])]),_:1}),(m(!0),v(_,null,x(e.analysts,n=>(m(),b(e.SelectItem,{key:n.uid,value:n.uid},{default:a(()=>[i(A(e.analystName(n)),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},16)]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1}),t(e.FormField,{name:"templateUid"},{default:a(({componentField:s})=>[t(e.FormItem,null,{default:a(()=>[t(e.FormLabel,null,{default:a(()=>[...o[8]||(o[8]=[i("Worksheet Template",-1)])]),_:1}),t(e.FormControl,null,{default:a(()=>[t(e.Select,T(P(s)),{default:a(()=>[t(e.SelectTrigger,null,{default:a(()=>[t(e.SelectValue,{placeholder:"Select template"})]),_:1}),t(e.SelectContent,null,{default:a(()=>[t(e.SelectItem,{value:""},{default:a(()=>[...o[9]||(o[9]=[i("Select template",-1)])]),_:1}),(m(!0),v(_,null,x(e.workSheetTemplates,n=>(m(),b(e.SelectItem,{key:n.uid,value:n.uid},{default:a(()=>[i(A(n.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},16)]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1}),t(e.FormField,{name:"count"},{default:a(({componentField:s})=>[t(e.FormItem,null,{default:a(()=>[t(e.FormLabel,null,{default:a(()=>[...o[10]||(o[10]=[i("How Many",-1)])]),_:1}),t(e.FormControl,null,{default:a(()=>[t(e.Input,ne(s,{type:"number",min:"1"}),null,16)]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1})]),d("div",Te,[t(e.Button,{type:"submit",class:"w-full"},{default:a(()=>[...o[11]||(o[11]=[i("Save Form",-1)])]),_:1})])],32)]),_:1})):se("",!0)])],64)}const Ke=ae(pe,[["render",Pe],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/worksheet/WorkSheetListing.vue"]]);export{Ke as default};
