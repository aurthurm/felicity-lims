import{V as G,P as Q,f as X,aj as Z,a7 as ee,a1 as y,a2 as k,ak as te,h as se,ao as oe,i as T,r as M,o as l,c as u,a as R,M as f,D as m,O as s,C as E,ae as d,E as re,a6 as a,L as S,z as ae,F as c,H as w,J as x,a3 as N,Y as ne,$ as le,a0 as ie,_ as ue}from"./index-74595aff.js";import{u as de}from"./user-376fe398.js";import{c as fe,b as p,u as me,e as h}from"./array-b292c9a7.js";import{h as ce,a as pe,o as he}from"./constants-b03e9ddf.js";import"./_queries-3a88eae7.js";const ve={class:"space-y-6"},ge={class:"rounded-lg border border-border bg-card shadow-sm p-6"},be={class:"space-y-4"},ye={key:0,class:"space-y-1"},ke={action:"post",class:"space-y-6 p-4"},Se={class:"grid grid-cols-3 gap-4"},we={class:"block space-y-2"},xe=["value"],_e={class:"block space-y-2"},We=["value"],Ue={class:"block space-y-2"},Ce={class:"border-t border-border pt-4"},Ae=G({__name:"WorkSheetListing",setup(Te){const B=le(()=>ie(()=>import("./FelDataTable-b273d3d1.js"),["assets/FelDataTable-b273d3d1.js","assets/index-74595aff.js","assets/index-8412b2a5.css"])),i=Q(),_=de(),{withClientMutation:L}=X(),{workSheets:W,fetchingWorkSheets:P,workSheetPageInfo:U,workSheetTemplates:D}=Z(i);ee();let n=y(!1);const I=y([{name:"All",value:""},{name:"Pending",value:"pending"},{name:"Awaiting",value:"awaiting"},{name:"Approved",value:"approved"},{name:"Empty",value:"empty"}]),V=y([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"WorkSheet Id",value:"workSheetId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(t,e){return k(te,{to:{name:"worksheet-detail",params:{workSheetUid:t?.uid}},innerHTML:t?.worksheetId})}},{name:"Analysis/Test",value:"analysis.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Samples",value:"assignedCount",sortable:!1,sortBy:"asc",hidden:!1},{name:"Instrument",value:"instrument.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Analyst",value:"clientPatientId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(t,e){return k("div",{innerHTML:A(t?.analyst)})}},{name:"Status",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(t,e){return k("button",{type:"button",class:"bg-primary text-primary-foreground py-1 px-2 rounded-sm leading-none",innerHTML:t?.state||"unknown"})}}]);i.removeWorksheet();let r=se({first:25,before:"",status:"",text:"",sort:["-uid"],filterAction:!1});i.fetchWorkSheets(r),i.fetchWorkSheetTemplates(),_.fetchUsers({});const F=fe({analystUid:p().required("Analyst is Required").typeError("Analyst is Required"),templateUid:p().typeError("Worksheet Template is required"),instrumentUid:p(),count:p().typeError("Required number of worksheets must be defined")}),{handleSubmit:O,errors:C}=me({validationSchema:F,initialValues:{count:1,analystUid:void 0,templateUid:void 0,instrumentUid:void 0}}),{value:v}=h("count"),{value:g}=h("analystUid"),{value:b}=h("templateUid");h("instrumentUid");const H=O(t=>{n.value=!1,L(oe,t,"createWorksheet").then(e=>{i.addWorksheet(e),n.value=!1})});function q(t){r.first=t.fetchCount,r.before=U?.value?.endCursor??"",r.text=t.filterText,r.status=t.filterStatus,r.filterAction=!1,i.fetchWorkSheets(r)}function $(t){r.first=25,r.before="",r.text=t.filterText,r.status=t.filterStatus,r.filterAction=!0,i.fetchWorkSheets(r)}const j=T(()=>_.getUsers),A=t=>t?.auth?.userName?t?.auth?.userName:t?.firstName?t.firstName+" "+t.lastName:"----",z=T(()=>W?.value?.length+" of "+i.getWorkSheetCount+" WorkSheets");return(t,e)=>{const J=M("fel-heading"),K=M("fel-modal");return l(),u(c,null,[R(J,{title:"Worksheets"},{default:f(()=>[m(s("button",{onClick:e[0]||(e[0]=E(o=>d(n)?n.value=!0:n=!0,["prevent"])),class:"px-4 py-2 bg-primary text-primary-foreground rounded-md transition-colors duration-200 hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Add WorkSheet ",512),[[re,ce(pe.CREATE,he.WORKSHEET)]])]),_:1}),s("div",ve,[s("div",ge,[R(a(B),{columns:V.value,data:a(W),toggleColumns:!0,loading:a(P),paginable:!0,pageMeta:{fetchCount:a(r).first,hasNextPage:a(U)?.hasNextPage,countNone:z.value},searchable:!0,filterable:!0,filterMeta:{defaultFilter:a(r).status,filters:I.value},onOnSearch:$,onOnPaginate:q,selectable:!1,class:"bg-background rounded-lg shadow-sm"},{footer:f(()=>e[6]||(e[6]=[])),_:1},8,["columns","data","loading","pageMeta","filterMeta"])]),S(" Location Edit Form Modal "),a(n)?(l(),ae(K,{key:0,onClose:e[5]||(e[5]=o=>d(n)?n.value=!1:n=!1),contentWidth:"w-1/2"},{header:f(()=>[s("div",be,[e[7]||(e[7]=s("h3",{class:"text-lg font-medium"},"Create Worksheet",-1)),e[8]||(e[8]=s("div",{class:"border-t border-border"},null,-1)),Object.keys(a(C)).length>0?(l(),u("ul",ye,[(l(!0),u(c,null,w(Object.values(a(C)),(o,Y)=>(l(),u("li",{key:Y,class:"text-destructive text-sm"},x(o),1))),128))])):S("v-if",!0)])]),body:f(()=>[s("form",ke,[s("div",Se,[s("label",we,[e[9]||(e[9]=s("span",{class:"text-sm font-medium"},"Analyst",-1)),m(s("select",{class:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary","onUpdate:modelValue":e[1]||(e[1]=o=>d(g)?g.value=o:null)},[(l(!0),u(c,null,w(j.value,o=>(l(),u("option",{key:o.uid,value:o.uid},x(A(o)),9,xe))),128))],512),[[N,a(g)]])]),s("label",_e,[e[11]||(e[11]=s("span",{class:"text-sm font-medium"},"Worksheet Template",-1)),m(s("select",{class:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary","onUpdate:modelValue":e[2]||(e[2]=o=>d(b)?b.value=o:null)},[e[10]||(e[10]=s("option",{value:"undefined"},null,-1)),(l(!0),u(c,null,w(a(D),o=>(l(),u("option",{key:o.uid,value:o.uid},x(o.name),9,We))),128))],512),[[N,a(b)]])]),s("label",Ue,[e[12]||(e[12]=s("span",{class:"text-sm font-medium"},"How Many",-1)),m(s("input",{type:"number",class:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary","onUpdate:modelValue":e[3]||(e[3]=o=>d(v)?v.value=o:null),min:"1"},null,512),[[ne,a(v)]])])]),s("div",Ce,[s("button",{type:"button",onClick:e[4]||(e[4]=E(o=>a(H)(),["prevent"])),class:"w-full px-4 py-2 bg-primary text-primary-foreground rounded-md transition-colors duration-200 hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Save Form ")])])]),_:1})):S("v-if",!0)])],64)}}}),Le=ue(Ae,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/worksheet/WorkSheetListing.vue"]]);export{Le as default};
