import{d as Z,I as ee,r as c,at as te,au as se,s as P,n as A,p as oe,m as ne,o as i,c as u,g as B,f as n,e as m,L as le,b as s,A as g,y as T,z as ae,t as b,v as L,i as y,F as h,C as k,ad as x,w as ie,j as M,_ as N,k as re}from"./index-fc86f1fc.js";import{A as ce,E as ue}from"./clients.mutations-0455b564.js";import{u as de}from"./client-b8c54b8b.js";import{u as me}from"./location-e3bae4c4.js";import{h as fe,o as pe,a as ve}from"./constants-3670b8e1.js";const be=s("hr",null,null,-1),he={action:"post",class:"p-1"},_e={class:"grid grid-cols-2 gap-x-4 mb-4"},Ce={class:"block col-span-1 mb-2"},ge=s("span",{class:"text-gray-700"},"Name",-1),ye={class:"block col-span-1 mb-2"},ke=s("span",{class:"text-gray-700"},"Code",-1),xe={class:"grid grid-cols-3 gap-x-4 mb-4"},we={class:"block col-span-1 mb-2"},Ue=s("span",{class:"text-gray-700"},"Country",-1),De=s("option",null,null,-1),Ee=["value"],Pe={class:"block col-span-1 mb-2"},Ae=s("span",{class:"text-gray-700"},"Province",-1),Be=s("option",null,null,-1),Te=["value"],Le={class:"block col-span-1 mb-2"},Me=s("span",{class:"text-gray-700"},"District",-1),Ne=s("option",null,null,-1),Ie=["value"],Se=s("hr",null,null,-1),Ve=Z({__name:"ClientListing",setup(Re){const I=M(()=>N(()=>import("./FelDataTable-07d3baf7.js"),["assets/FelDataTable-07d3baf7.js","assets/index-fc86f1fc.js","assets/index-246842b1.css"])),S=M(()=>N(()=>import("./index-fc86f1fc.js").then(o=>o.br),["assets/index-fc86f1fc.js","assets/index-246842b1.css"])),r=de(),v=me(),{withClientMutation:w}=ee(),V=c([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Client Name",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(o,t){return te(se,{to:{name:"client-detail",query:{clientUid:o?.uid}},class:"px-1 ml-2 border-white border text-gray-500rounded-smtransition duration-300 hover:border-sky-800 hover:text-sky-800 focus:outline-none",innerHTML:o?.name})}},{name:"Client ID",value:"code",sortable:!1,sortBy:"asc",hidden:!1},{name:"District",value:"district.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Province",value:"district.province.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Mobile Number",value:"mobilePhone",sortable:!1,sortBy:"asc",hidden:!1},{name:"Email Asdress",value:"email",sortable:!1,sortBy:"asc",hidden:!1}]),{countries:R,provinces:O,districts:F}=P(v),{clients:U,clientPageInfo:D,fetchingClients:j}=P(r);let d=c(!1),_=c(!1),H=c(""),l=A({});const E=c(""),q=()=>Object.assign(l,{});let a=A({first:50,after:"",text:"",sortBy:["uid"],filterAction:!1}),f=c(),p=c();r.fetchClients(a),v.fetchCountries();function z(){w(ce,{payload:{name:l.name,code:l.code,districtUid:l.districtUid}},"createClient").then(o=>r.addClient(o))}function K(){w(ue,{uid:l.uid,payload:{name:l.name,code:l.code,districtUid:l.districtUid}},"updateClient").then(o=>r.updateClient(o))}function $(o){v.filterProvincesByCountry(f.value)}function G(o){v.filterDistrictsByProvince(p.value)}function J(o){a.first=100,a.after="",a.text=o.filterText,a.filterAction=!0,r.fetchClients(a)}function Q(o){a.first=o.fetchCount,a.after=D?.value?.endCursor,a.text=o.filterText,a.filterAction=!1,r.fetchClients(a)}function W(o,t,C={}){_.value=o,H.value=t,E.value=(o?"CREATE":"EDIT")+" "+t.toUpperCase(),t=="client"&&(d.value=!0),o?t=="client"&&Object.assign(l,{}):t=="client"&&Object.assign(l,{...C})}function X(){_.value&&z(),_.value||K(),d.value=!1}const Y=oe(()=>U?.value?.length+" of "+r.getClientCount+" clients");return(o,t)=>{const C=ne("modal");return i(),u(h,null,[B(n(S),{title:"Clients"}),m(s("button",{class:"p-2 my-2 text-sm border-sky-800 border text-dark-700 transition-colors duration-150 rounded-sm focus:outline-none hover:bg-sky-800 hover:text-gray-100",onClick:t[0]||(t[0]=e=>W(!0,"client"))}," Add client ",512),[[le,fe(ve.CREATE,pe.CLIENT)]]),be,B(n(I),{columns:V.value,data:n(U),toggleColumns:!0,loading:n(j),paginable:!0,pageMeta:{fetchCount:n(a).first,hasNextPage:n(D)?.hasNextPage,countNone:Y.value},searchable:!0,filterable:!1,onOnSearchKeyUp:J,onOnSearchFocus:q,onOnPaginate:Q,selectable:!1},{footer:g(()=>[]),_:1},8,["columns","data","loading","pageMeta"]),T(" Location Edit Form Modal "),n(d)?(i(),ae(C,{key:0,onClose:t[9]||(t[9]=e=>y(d)?d.value=!1:d=!1)},{header:g(()=>[s("h3",null,b(E.value),1)]),body:g(()=>[s("form",he,[s("div",_e,[s("label",Ce,[ge,m(s("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":t[1]||(t[1]=e=>n(l).name=e),placeholder:"Name ..."},null,512),[[L,n(l).name]])]),s("label",ye,[ke,m(s("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":t[2]||(t[2]=e=>n(l).code=e),placeholder:"Code ..."},null,512),[[L,n(l).code]])])]),s("div",xe,[s("label",we,[Ue,m(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":t[3]||(t[3]=e=>y(f)?f.value=e:f=e),onChange:t[4]||(t[4]=e=>$(e))},[De,(i(!0),u(h,null,k(n(R),e=>(i(),u("option",{key:e.uid,value:e.uid},b(e.name),9,Ee))),128))],544),[[x,n(f)]])]),s("label",Pe,[Ae,m(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":t[5]||(t[5]=e=>y(p)?p.value=e:p=e),onChange:t[6]||(t[6]=e=>G(e))},[Be,(i(!0),u(h,null,k(n(O),e=>(i(),u("option",{key:e.uid,value:e.uid},b(e.name),9,Te))),128))],544),[[x,n(p)]])]),s("label",Le,[Me,m(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":t[7]||(t[7]=e=>n(l).districtUid=e)},[Ne,(i(!0),u(h,null,k(n(F),e=>(i(),u("option",{key:e.uid,value:e.uid},b(e.name),9,Ie))),128))],512),[[x,n(l).districtUid]])])]),Se,s("button",{type:"button",onClick:t[8]||(t[8]=ie(e=>X(),["prevent"])),class:"-mb-4 w-full border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):T("v-if",!0)],64)}}}),ze=re(Ve,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/client/ClientListing.vue"]]);export{ze as default};
