import{S as te,O as re,u as ne,f as le,a0 as C,i as x,h as Q,r as O,o as n,c as l,N as o,a as R,L as W,M as ie,F as a,E as p,a3 as y,a5 as r,A as _,H as d,K as b,y as de,C as m,X as S,a2 as T,Y as ue,ac as ae,Z as pe,$ as me,aL as ce,aM as fe,_ as ge}from"./index-54016222.js";import{u as be}from"./analysis-67f4ba72.js";import{u as ve}from"./setup-20f4d78e.js";import"./_queries-7a4a5593.js";const xe={class:"grid grid-cols-12 gap-4 mt-2"},ye={class:"col-span-12 md:col-span-4 lg:col-span-3"},ke={class:"overflow-y-scroll overscroll-contain scroll-section pr-2 space-y-1"},we=["onClick"],he=["onClick"],_e={key:0,class:"p-4 text-center text-muted-foreground text-sm"},Te={key:0,class:"col-span-12 md:col-span-8 lg:col-span-9 overflow-y-scroll overscroll-contain scroll-section pl-2"},Se={class:"bg-card text-card-foreground rounded-lg shadow-md p-4 sm:p-6"},Ue={class:"space-y-4"},Ce={class:"flex justify-between items-center"},We={class:"text-lg font-semibold text-card-foreground"},Ae={class:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2 text-sm"},Ve={class:"flex"},$e={class:"text-foreground"},Ee={class:"flex"},Oe={class:"text-foreground"},Re={class:"flex"},Le={class:"text-foreground"},Me={class:"flex"},qe={class:"text-foreground"},Ne={class:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2 text-sm"},je={class:"flex"},De={class:"text-foreground"},Qe={key:0,class:"flex"},Pe={class:"text-foreground"},Be={key:0},Fe={class:"flex"},Ke={class:"text-foreground"},ze={class:"flex"},He={class:"text-foreground"},Ge={class:"mt-6"},Xe={key:0,class:"space-y-1"},Ye={class:"col-span-1 my-1 text-xs text-muted-foreground text-right pr-1"},Ze={key:1},Je={key:0},Ie={key:1,class:"col-span-12 md:col-span-8 lg:col-span-9 p-10 text-center"},eo={class:"text-lg font-semibold text-card-foreground"},oo={action:"post",class:"p-4 space-y-6"},so={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},to={class:"block md:col-span-2"},ro={class:"block"},no={class:"grid grid-cols-1 md:grid-cols-4 gap-4 items-start"},lo={class:"block"},io={key:0,class:"md:col-span-3"},uo={class:"grid grid-cols-3 gap-4 items-end"},ao={class:"block"},po={class:"block"},mo={for:"toggle",class:"flex items-center cursor-pointer"},co={class:"relative"},fo={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},go={class:"block"},bo=["value"],vo={class:"block"},xo=["value"],yo={class:"block"},ko=["value"],wo={id:"samples",class:"space-y-4"},ho={class:"flex flex-wrap justify-between items-end gap-4"},_o={class:"block flex-grow"},To={class:"flex items-center gap-2 mt-1"},So=["value"],Uo={key:0,class:"border-t border-border"},Co={class:"flex flex-wrap items-end justify-between gap-4"},Wo={class:"flex-grow"},Ao={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Vo={class:"block"},$o=["onUpdate:modelValue"],Eo={class:"block"},Oo=["onUpdate:modelValue"],Ro=["value"],Lo={class:"flex-shrink-0"},Mo=["onClick"],qo=te({__name:"WorkSheetsAdmin",setup(No){const P=pe(()=>me(()=>import("./index-54016222.js").then(i=>i.cH),["assets/index-54016222.js","assets/index-a1ed10d8.css"])),U=re(),k=be(),L=ne(),M=ve(),{withClientMutation:q}=le();let B=C("preview");x(()=>"tab-"+B.value);let w=C(!1),A=C(null),s=Q({}),N=C(""),F=Q({first:void 0,after:"",text:"",sortBy:["name"]});k.fetchAnalysesServices(F),L.fetchSampleTypes(),M.fetchInstruments(),k.fetchQCTemplates(),k.fetchQCLevels(),U.fetchWorkSheetTemplates();const j=x(()=>k.getQCTemplates),V=x(()=>U.getWorkSheetTemplates);function K(){const i={name:s.name,sampleTypeUid:s.sampleTypeUid,instrumentUid:s.instrumentUid,description:s.description,qcTemplateUid:s.qcTemplateUid,reserved:s.reserved,numberOfSamples:+s.numberOfSamples,worksheetType:s.worksheetType,cols:s.cols,rows:s.rows,rowWise:s.rowWise,analysisUid:s.analysisUid};q(ce,{payload:i},"createWorksheetTemplate").then(e=>U.addWorksheetTemplate(e))}function z(){const i={name:s.name,sampleTypeUid:s.sampleTypeUid,instrumentUid:s.instrumentUid,description:s.description,qcTemplateUid:s.qcTemplateUid,reserved:s.reserved,numberOfSamples:s.numberOfSamples,worksheetType:s.worksheetType,cols:s.cols,rows:s.rows,rowWise:s.rowWise,analysisUid:s.analysisUid};q(fe,{uid:s.uid,payload:i},"updateWorksheetTemplate").then(e=>U.updateWorksheetTemplate(e))}function H(i){let e=[];return Array.from({length:i?.numberOfSamples+i?.reserved?.length},(h,v)=>v+1).forEach(h=>{let v={position:h,row:1,col:1,name:"sample",sampleUid:void 0};i?.reserved?.some(t=>t.position===h)&&(v.name="control"),i?.reserved?.forEach(t=>{t[1]?.position===h&&(v.name=t[1]?.name)}),e.push(v)}),e}function $(){s.worksheetType=="grid"&&(s.rows=Math.ceil((s?.numberOfSamples+(s.reserved?.length|0))/s?.cols))}function D(i){Object.assign(s,i);const e=H(i);s.preview=e}function G(){s.reserved?.push({}),$()}function X(i){s.reserved?.splice(i,1)}function Y(){if(s.reserved=[],!s.qcTemplateUid)return;j.value?.find(e=>e.uid===s.qcTemplateUid)?.qcLevels.forEach((e,c)=>{s.reserved?.push({position:c+1,levelUid:e.uid})}),$()}function Z(i){i.target.value=="flat"&&(s.cols=void 0,s.rows=void 0)}function E(i,e={}){if(A.value=i,N.value=(i?"CREATE":"EDIT")+" WOKKSHEET TEMPLATE",w.value=!0,i){let c={};c.instrument={},c.sampleType={},c.analysis={},Object.assign(s,{...c})}else D(e)}function J(){A.value&&K(),A.value||z(),w.value=!1}const I=x(()=>M.getInstruments),ee=x(()=>k.getAnalysesServicesSimple?.filter(c=>c?.category?.name!=="Quality Control")),oe=x(()=>k.getQCLevels),se=x(()=>L.getSampleTypes);return(i,e)=>{const c=O("fel-button"),h=O("fel-heading"),v=O("font-awesome-icon");return n(),l(a,null,[o("div",null,[R(h,{title:"WorkSheet Templates"},{default:W(()=>[R(c,{onClick:e[0]||(e[0]=t=>E(!0))},{default:W(()=>e[18]||(e[18]=[ie("Add Template")])),_:1})]),_:1}),e[33]||(e[33]=o("hr",{class:"my-4 border-t border-border"},null,-1)),o("div",xe,[o("section",ye,[o("div",ke,[(n(!0),l(a,null,p(V.value,t=>(n(),l("div",{key:t.uid,class:y(["w-full flex justify-between items-center p-2 rounded-lg border shadow-sm transition-colors",r(s)?.uid===t.uid?"border-primary bg-primary/10":"border-border bg-card hover:bg-muted/50"])},[o("a",{href:"#",onClick:_(u=>D(t),["prevent","stop"]),class:y(["font-medium cursor-pointer",r(s)?.uid===t.uid?"text-primary":"text-card-foreground"])},[o("span",null,d(t.name),1)],10,we),o("a",{href:"#",onClick:_(u=>E(!1,t),["prevent","stop"]),class:"px-2 cursor-pointer text-muted-foreground hover:text-accent-foreground"},[R(v,{icon:"pen"})],8,he)],2))),128)),!V.value||V.value.length===0?(n(),l("div",_e," No templates found. ")):b("",!0)])]),r(s)?.uid?(n(),l("div",Te,[o("div",Se,[o("div",Ue,[o("div",Ce,[o("span",We,d(r(s).name),1),o("div",null,[o("button",{onClick:e[1]||(e[1]=t=>E(!1,r(s))),class:"ml-4 inline-flex h-8 w-8 items-center justify-center rounded-full text-muted-foreground transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","aria-label":"Edit Template"},e[19]||(e[19]=[o("svg",{class:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20"},[o("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})],-1)]))])]),e[28]||(e[28]=o("hr",{class:"border-t border-border"},null,-1)),o("div",Ae,[o("div",null,[o("div",Ve,[e[20]||(e[20]=o("span",{class:"w-1/2 flex-shrink-0 font-medium text-muted-foreground"},"Instrument:",-1)),o("span",$e,d(r(s).instrument?.name||"N/A"),1)]),o("div",Ee,[e[21]||(e[21]=o("span",{class:"w-1/2 flex-shrink-0 font-medium text-muted-foreground"},"Analysis Service:",-1)),o("span",Oe,d(r(s).analysis?.name||"N/A"),1)])]),o("div",null,[o("div",Re,[e[22]||(e[22]=o("span",{class:"w-1/2 flex-shrink-0 font-medium text-muted-foreground"},"Samples:",-1)),o("span",Le,d(r(s).numberOfSamples),1)]),o("div",Me,[e[23]||(e[23]=o("span",{class:"w-1/2 flex-shrink-0 font-medium text-muted-foreground"},"Reserved:",-1)),o("span",qe,d(r(s).reserved?.length??0),1)])])]),e[29]||(e[29]=o("hr",{class:"border-t border-border"},null,-1)),o("div",Ne,[o("div",null,[o("div",je,[e[24]||(e[24]=o("span",{class:"w-1/2 flex-shrink-0 font-medium text-muted-foreground"},"WorkSheet type:",-1)),o("span",De,d(r(s).worksheetType),1)]),r(s).worksheetType=="grid"?(n(),l("div",Qe,[e[25]||(e[25]=o("span",{class:"w-1/2 flex-shrink-0 font-medium text-muted-foreground"},"Direction:",-1)),o("span",Pe,d(r(s).rowWise?"row-wise":"column-wise"),1)])):b("",!0)]),r(s).worksheetType=="grid"?(n(),l("div",Be,[o("div",Fe,[e[26]||(e[26]=o("span",{class:"w-1/2 flex-shrink-0 font-medium text-muted-foreground"},"Rows:",-1)),o("span",Ke,d(r(s).rows),1)]),o("div",ze,[e[27]||(e[27]=o("span",{class:"w-1/2 flex-shrink-0 font-medium text-muted-foreground"},"Columns:",-1)),o("span",He,d(r(s).cols),1)])])):b("",!0)])])]),o("div",Ge,[e[30]||(e[30]=o("h3",{class:"text-lg font-semibold text-foreground"},"WorkSheet Layout Preview",-1)),e[31]||(e[31]=o("hr",{class:"my-2 border-t border-border"},null,-1)),r(s).worksheetType=="flat"?(n(),l("div",Xe,[(n(!0),l(a,null,p(r(s)?.preview||[],(t,u)=>(n(),l("div",{class:"grid grid-cols-6 gap-x-2 items-center",key:`flat-${u}`},[o("span",Ye,d(t.position)+":",1),o("span",{class:y(["col-span-5 my-1 p-1 rounded-md flex justify-center text-xs font-medium",t.name!=="sample"?"bg-success text-success-foreground":"bg-primary text-primary-foreground"])},d(t.name),3)]))),128))])):b("",!0),r(s).worksheetType=="grid"?(n(),l("div",Ze,[r(s).rowWise?(n(),l("div",Je,[(n(!0),l(a,null,p(r(s).rows,(t,u)=>(n(),l("div",{key:`row-${u}`,class:y(["grid gap-2 mb-1",`grid-cols-${r(s).cols}`])},[(n(!0),l(a,null,p(r(s).cols,(f,g)=>(n(),l("div",{key:`row-${u}-col-${g}`,class:"col-span-1 w-full"},[o("span",{class:y(["my-1 p-1 rounded-md flex justify-center text-xs font-medium",r(s)?.preview?.[u*r(s).cols+g]?.name!=="sample"?"bg-success text-success-foreground":"bg-primary text-primary-foreground"])}," ("+d(u*r(s).cols+g+1)+") "+d(r(s)?.preview?.[u*r(s).cols+g]?.name??"Error"),3)]))),128))],2))),128))])):(n(),l("div",{key:1,class:y(["grid gap-2",`grid-cols-${r(s).cols}`])},[(n(!0),l(a,null,p(r(s).cols,(t,u)=>(n(),l("div",{class:"col-span-1 space-y-1",key:`col-${u}`},[(n(!0),l(a,null,p(r(s).rows,(f,g)=>(n(),l("div",{key:`col-${u}-row-${g}`},[o("span",{class:y(["p-1 rounded-md flex justify-center text-xs font-medium",r(s)?.preview?.[u*r(s).rows+g]?.name!=="sample"?"bg-success text-success-foreground":"bg-primary text-primary-foreground"])}," ("+d(u*r(s).rows+g+1)+") "+d(r(s)?.preview?.[u*r(s).rows+g]?.name??"Error"),3)]))),128))]))),128))],2))])):b("",!0)])])):(n(),l("div",Ie,e[32]||(e[32]=[o("p",{class:"text-muted-foreground"},"Select a template from the left to view details.",-1)])))])]),r(w)?(n(),de(r(P),{key:0,onClose:e[17]||(e[17]=t=>ae(w)?w.value=!1:w=!1),"content-width":"'w-1/2'"},{header:W(()=>[o("h3",eo,d(r(N)),1)]),body:W(()=>[o("form",oo,[o("div",so,[o("label",to,[e[34]||(e[34]=o("span",{class:"text-sm font-medium text-foreground"},"Template Name",-1)),m(o("input",{class:"mt-1 block w-full rounded-lg border border-input bg-background px-3 py-2 text-foreground placeholder:text-muted-foreground focus:border-primary focus:outline-none focus:ring-1 focus:ring-ring","onUpdate:modelValue":e[2]||(e[2]=t=>r(s).name=t),placeholder:"Name ..."},null,512),[[S,r(s).name]])]),o("label",ro,[e[35]||(e[35]=o("span",{class:"text-sm font-medium text-foreground"},"Number of Samples",-1)),e[36]||(e[36]=o("span",{class:"ml-2 text-xs italic text-muted-foreground"},"(less reserved)",-1)),m(o("input",{class:"mt-1 block w-full rounded-lg border border-input bg-background px-3 py-2 text-foreground placeholder:text-muted-foreground focus:border-primary focus:outline-none focus:ring-1 focus:ring-ring","onUpdate:modelValue":e[3]||(e[3]=t=>r(s).numberOfSamples=t),placeholder:"Count ...",type:"number"},null,512),[[S,r(s).numberOfSamples,void 0,{number:!0}]])])]),o("div",no,[o("label",lo,[e[38]||(e[38]=o("span",{class:"text-sm font-medium text-foreground"},"Template Type",-1)),m(o("select",{class:"mt-1 block w-full rounded-lg border border-input bg-background px-3 py-2 text-foreground focus:border-primary focus:outline-none focus:ring-1 focus:ring-ring",onChange:e[4]||(e[4]=t=>Z(t)),"onUpdate:modelValue":e[5]||(e[5]=t=>r(s).worksheetType=t)},e[37]||(e[37]=[o("option",{value:"flat"},"Single Column / Flat",-1),o("option",{value:"grid"},"GRID",-1)]),544),[[T,r(s).worksheetType]])]),r(s).worksheetType==="grid"?(n(),l("div",io,[o("div",uo,[o("label",ao,[e[39]||(e[39]=o("span",{class:"text-sm font-medium text-foreground"},"Cols",-1)),m(o("input",{class:"mt-1 block w-full rounded-lg border border-input bg-background px-3 py-2 text-foreground focus:border-primary focus:outline-none focus:ring-1 focus:ring-ring","onUpdate:modelValue":e[6]||(e[6]=t=>r(s).cols=t),onKeyup:e[7]||(e[7]=t=>$()),type:"number"},null,544),[[S,r(s).cols,void 0,{number:!0}]])]),o("label",po,[e[40]||(e[40]=o("span",{class:"text-sm font-medium text-foreground"},"Rows",-1)),m(o("input",{class:"mt-1 block w-full rounded-lg border border-input bg-muted px-3 py-2 text-foreground focus:border-primary focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed","onUpdate:modelValue":e[8]||(e[8]=t=>r(s).rows=t),type:"number",disabled:""},null,512),[[S,r(s).rows,void 0,{number:!0}]])]),o("label",mo,[o("div",co,[m(o("input",{type:"checkbox",name:"toggle",id:"toggle","onUpdate:modelValue":e[9]||(e[9]=t=>r(s).rowWise=t),class:"sr-only peer"},null,512),[[ue,r(s).rowWise]]),e[41]||(e[41]=o("div",{class:"block h-6 w-10 rounded-full bg-muted peer-checked:bg-primary"},null,-1)),e[42]||(e[42]=o("div",{class:"absolute left-1 top-1 h-4 w-4 rounded-full bg-background transition-transform peer-checked:translate-x-full border border-border"},null,-1))]),e[43]||(e[43]=o("span",{class:"ml-2 text-sm font-medium text-foreground"},"Row Wise",-1))])])])):b("",!0)]),o("div",fo,[o("label",go,[e[45]||(e[45]=o("span",{class:"text-sm font-medium text-foreground"},"Instrument",-1)),m(o("select",{class:"mt-1 block w-full rounded-lg border border-input bg-background px-3 py-2 text-foreground focus:border-primary focus:outline-none focus:ring-1 focus:ring-ring","onUpdate:modelValue":e[10]||(e[10]=t=>r(s).instrumentUid=t)},[e[44]||(e[44]=o("option",{value:""},"Select Instrument",-1)),(n(!0),l(a,null,p(I.value,t=>(n(),l("option",{key:t.uid,value:t.uid},d(t.name),9,bo))),128))],512),[[T,r(s).instrumentUid]])]),o("label",vo,[e[47]||(e[47]=o("span",{class:"text-sm font-medium text-foreground"},"Sample Type",-1)),m(o("select",{class:"mt-1 block w-full rounded-lg border border-input bg-background px-3 py-2 text-foreground focus:border-primary focus:outline-none focus:ring-1 focus:ring-ring","onUpdate:modelValue":e[11]||(e[11]=t=>r(s).sampleTypeUid=t)},[e[46]||(e[46]=o("option",{value:""},"Select Sample Type",-1)),(n(!0),l(a,null,p(se.value,t=>(n(),l("option",{key:t.uid,value:t.uid},d(t.name),9,xo))),128))],512),[[T,r(s).sampleTypeUid]])]),o("label",yo,[e[49]||(e[49]=o("span",{class:"text-sm font-medium text-foreground"},"Analysis Service",-1)),m(o("select",{class:"mt-1 block w-full rounded-lg border border-input bg-background px-3 py-2 text-foreground focus:border-primary focus:outline-none focus:ring-1 focus:ring-ring","onUpdate:modelValue":e[12]||(e[12]=t=>r(s).analysisUid=t)},[e[48]||(e[48]=o("option",{value:""},"Select Service",-1)),(n(!0),l(a,null,p(ee.value,t=>(n(),l("option",{key:t.uid,value:t.uid},d(t.name),9,ko))),128))],512),[[T,r(s).analysisUid]])])]),o("section",wo,[e[57]||(e[57]=o("hr",{class:"border-t border-border"},null,-1)),o("div",ho,[e[52]||(e[52]=o("h5",{class:"text-base font-semibold text-foreground w-full md:w-auto"},"Reserved Positions",-1)),o("label",_o,[e[51]||(e[51]=o("span",{class:"text-sm font-medium text-foreground"},"QC Template",-1)),o("div",To,[m(o("select",{class:"block w-full rounded-lg border border-input bg-background px-3 py-2 text-foreground focus:border-primary focus:outline-none focus:ring-1 focus:ring-ring","onUpdate:modelValue":e[13]||(e[13]=t=>r(s).qcTemplateUid=t)},[e[50]||(e[50]=o("option",{value:""},"Select QC Template",-1)),(n(!0),l(a,null,p(j.value,t=>(n(),l("option",{key:t.uid,value:t.uid},d(t.name),9,So))),128))],512),[[T,r(s).qcTemplateUid]]),o("button",{onClick:e[14]||(e[14]=_(t=>Y(),["prevent"])),class:"flex-shrink-0 rounded-lg border border-accent px-3 py-2 text-sm font-medium text-accent transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"}," Apply ")])]),o("button",{onClick:e[15]||(e[15]=_(t=>G(),["prevent"])),class:"flex-shrink-0 rounded-lg border border-accent px-3 py-2 text-sm font-medium text-accent transition-colors hover:bg-accent hover:text-accent-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"}," Add Reserve Slot ")]),r(s).reserved?.length>0?(n(),l("hr",Uo)):b("",!0),(n(!0),l(a,null,p(r(s).reserved,(t,u)=>(n(),l("div",{key:u,class:"space-y-4 py-2"},[o("div",Co,[o("div",Wo,[o("div",Ao,[o("label",Vo,[e[53]||(e[53]=o("span",{class:"text-sm font-medium text-foreground"},"Position",-1)),m(o("input",{class:"mt-1 block w-full rounded-lg border border-input bg-background px-3 py-2 text-foreground focus:border-primary focus:outline-none focus:ring-1 focus:ring-ring","onUpdate:modelValue":f=>t.position=f,type:"number"},null,8,$o),[[S,t.position,void 0,{number:!0}]])]),o("label",Eo,[e[55]||(e[55]=o("span",{class:"text-sm font-medium text-foreground"},"Blank/Control Level",-1)),m(o("select",{"onUpdate:modelValue":f=>t.levelUid=f,class:"mt-1 block w-full rounded-lg border border-input bg-background px-3 py-2 text-foreground focus:border-primary focus:outline-none focus:ring-1 focus:ring-ring"},[e[54]||(e[54]=o("option",{value:""},"Select Level",-1)),(n(!0),l(a,null,p(oe.value,f=>(n(),l("option",{key:f.uid,value:f.uid},d(f.level),9,Ro))),128))],8,Oo),[[T,t.levelUid]])])])]),o("div",Lo,[o("button",{onClick:_(f=>X(u),["prevent"]),class:"rounded-lg border border-destructive px-3 py-2 text-sm font-medium text-destructive transition-colors hover:bg-destructive hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"}," Remove ",8,Mo)])]),e[56]||(e[56]=o("hr",{class:"border-t border-border"},null,-1))]))),128))]),e[58]||(e[58]=o("hr",{class:"border-t border-border"},null,-1)),o("button",{type:"button",onClick:e[16]||(e[16]=_(t=>J(),["prevent"])),class:"w-full rounded-lg bg-primary px-4 py-2 text-sm font-medium text-primary-foreground transition-colors hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2"}," Save Form ")])]),_:1})):b("",!0)],64)}}});const Bo=ge(qo,[["__scopeId","data-v-548ca798"],["__file","/Users/admin/Documents/Development/felicity/felicity-lims/webapp/views/admin/worksheets/WorkSheetsAdmin.vue"]]);export{Bo as default};
