import{S as I,a0 as w,i as C,r as T,o as d,c as f,N as o,A as b,y as p,aC as A,a5 as u,a3 as $,H as N,a as g,K as h,C as j,F as E,E as M,_ as O,f as B,X as L,J as q,M as z,aZ as P}from"./index-6c3e61f6.js";import{c as x,u as V,F as U}from"./DocumentEntry-12a57220.js";import{C as K,P as H}from"./plus-00b50575.js";import{A as R}from"./document.mutations-8388ad6f.js";import"./document.queries-a520e2f1.js";import"./_isIterateeCall-168bf9da.js";import"./toFinite-646a260a.js";/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=x("ChevronRightIcon",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=x("EllipsisIcon",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=x("FolderOpenIcon",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=x("FolderPlusIcon",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=x("TrashIcon",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),W=["aria-expanded","aria-label"],Y=["aria-label"],ee={key:1,class:"w-4"},oe={class:"mr-2 text-muted-foreground"},te={class:"flex items-center opacity-0 group-hover:opacity-100 transition-opacity duration-200"},re=["aria-label"],le={class:"relative"},ne=["aria-label","aria-expanded","aria-controls"],de={key:0,id:"folder-menu",class:"absolute right-0 mt-1 w-48 rounded-md border border-border bg-card p-1 text-card-foreground shadow-md z-10",role:"menu","aria-orientation":"vertical","aria-labelledby":"folder-menu-button"},ie=["aria-label"],ae=I({__name:"FolderItem",props:{folder:{type:Object,required:!0},level:{type:Number,default:0}},emits:["add-subfolder"],setup(a,{emit:D}){const l=a,s=V(),n=w(!1),r=C(()=>s.getChildFolders(l.folder.uid)),v=C(()=>s.currentFolder===l.folder.uid),c=C(()=>!!l.folder.expanded);function y(){s.setCurrentFolder(l.folder.uid)}function k(){s.toggleFolderExpanded(l.folder.uid)}function _(){const e=r.value.length>0,t=s.documents.some(m=>m.folderUid===l.folder.uid);e||t?window.confirm("Delete this folder and all its contents?")&&s.deleteFolder(l.folder.uid):s.deleteFolder(l.folder.uid),n.value=!1}const i={mounted(e,t){e._clickOutside=m=>{e===m.target||e.contains(m.target)||t.value(m)},document.addEventListener("click",e._clickOutside)},unmounted(e){e._clickOutside&&document.removeEventListener("click",e._clickOutside)}};return(e,t)=>{const m=T("FolderItem",!0);return d(),f("div",null,[o("div",{class:$(["flex justify-start items-center p-2 rounded-md cursor-pointer group transition-colors duration-200",a.level>0&&"ml-2",v.value&&"bg-accent text-accent-foreground",!v.value&&"hover:bg-accent/50"]),onClick:y,role:"button","aria-expanded":c.value,"aria-label":`${a.folder.name} folder${r.value.length>0?` with ${r.value.length} subfolders`:""}`},[o("div",{class:"flex items-center mr-2",onClick:b(k,["stop"]),role:"button","aria-label":`${c.value?"Collapse":"Expand"} ${a.folder.name} folder`},[r.value.length>0?(d(),p(A(r.value.length>0?c.value?u(K):u(Z):"div"),{key:0,class:"w-4 h-4 text-muted-foreground","aria-hidden":"true"})):(d(),f("div",ee))],8,Y),o("div",oe,[(d(),p(A(c.value?u(X):u(U)),{class:$(["w-[18px] h-[18px]",v.value&&"text-accent-foreground"]),"aria-hidden":"true"},null,8,["class"]))]),o("div",{class:$(["flex-1 truncate",v.value&&"text-accent-foreground"])},N(a.folder.name),3),o("div",te,[o("button",{onClick:t[0]||(t[0]=b(F=>e.$emit("add-subfolder",a.folder.uid),["stop"])),class:"h-7 w-7 flex items-center justify-center rounded-full hover:bg-accent/80 transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","aria-label":`Add subfolder to ${a.folder.name}`},[g(u(H),{class:"text-muted-foreground w-4 h-4","aria-hidden":"true"})],8,re),o("div",le,[o("button",{onClick:t[1]||(t[1]=b(F=>n.value=!n.value,["stop"])),class:"h-7 w-7 flex items-center justify-center rounded-full hover:bg-accent/80 transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","aria-label":`Open menu for ${a.folder.name}`,"aria-expanded":n.value,"aria-controls":n.value?"folder-menu":void 0},[g(u(J),{class:"text-muted-foreground w-4 h-4","aria-hidden":"true"})],8,ne),h(" Dropdown menu "),n.value?j((d(),f("div",de,[o("button",{onClick:b(_,["stop"]),class:"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground text-destructive w-full text-left hover:bg-accent/80",role:"menuitem"},[g(u(Q),{class:"mr-2 w-4 h-4","aria-hidden":"true"}),t[3]||(t[3]=o("span",null,"Delete Folder",-1))])])),[[i,()=>n.value=!1]]):h("v-if",!0)])])],10,W),c.value&&r.value.length>0?(d(),f("div",{key:0,class:"mt-1 ml-1 pl-1 border-l border-border",role:"group","aria-label":`Subfolders of ${a.folder.name}`},[(d(!0),f(E,null,M(r.value,F=>(d(),p(m,{key:F.uid,folder:F,level:a.level+1,onAddSubfolder:t[2]||(t[2]=S=>e.$emit("add-subfolder",S))},null,8,["folder","level"]))),128))],8,ie)):h("v-if",!0)])}}}),se=O(ae,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/document/FolderItem.vue"]]),ue={class:"h-full overflow-hidden flex flex-col bg-card border border-border rounded-lg",role:"navigation","aria-label":"Folder navigation"},ce={class:"p-4 flex items-center justify-between border-b border-border"},fe={class:"flex-1 overflow-auto p-2"},me={class:"space-y-1"},ve={key:0,class:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center",role:"dialog","aria-labelledby":"add-folder-title","aria-modal":"true"},be={id:"add-folder-title",class:"text-lg font-medium text-card-foreground mb-4"},pe={class:"mb-4"},ge={class:"flex justify-end gap-2"},he=["disabled"],xe=I({__name:"FolderNavigation",setup(a){const{withClientMutation:D}=B(),l=V(),s=w(!1),n=w(""),r=w(null),v=C(()=>l.getChildFolders(null));function c(i){r.value=i,s.value=!0}function y(){s.value=!1,n.value="",r.value=null}async function k(){if(n.value.trim())try{const i=await D(R,{payload:{name:n.value.trim(),parentUid:r.value}},"createDocumentFolder");if(i&&"uid"in i&&(l.addFolder(i),r.value)){const e=l.folders.find(t=>t.uid===r.value);e&&!e.expanded&&l.toggleFolderExpanded(r.value)}}catch(i){console.error("Failed to create folder:",i)}finally{y()}}function _(i){return l.folders.find(e=>e.uid===i)}return(i,e)=>(d(),f("div",ue,[o("div",ce,[e[3]||(e[3]=o("h2",{class:"font-semibold text-sm text-card-foreground"},"Folders",-1)),o("button",{onClick:e[0]||(e[0]=t=>c(null)),class:"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none hover:bg-accent hover:text-accent-foreground h-8 w-8","aria-label":"Add new folder"},[g(u(H),{class:"w-4 h-4","aria-hidden":"true"})])]),o("div",fe,[o("div",me,[(d(!0),f(E,null,M(v.value,t=>(d(),p(se,{key:t.uid,folder:t,onAddSubfolder:c},null,8,["folder"]))),128))])]),h(" Add Folder Dialog "),(d(),p(P,{to:"body"},[s.value?(d(),f("div",ve,[o("div",{class:"bg-card rounded-lg shadow-lg p-6 max-w-md w-full mx-4 border border-border",onClick:e[2]||(e[2]=b(()=>{},["stop"]))},[o("h3",be,N(r.value?`Add subfolder to ${_(r.value)?.name}`:"Add new folder"),1),o("div",pe,[e[4]||(e[4]=o("label",{for:"folderName",class:"block text-sm font-medium text-card-foreground mb-1"},"Folder Name",-1)),j(o("input",{id:"folderName","onUpdate:modelValue":e[1]||(e[1]=t=>n.value=t),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:"Enter folder name",onKeyup:q(k,["enter"]),"aria-required":"true"},null,544),[[L,n.value]])]),o("div",ge,[o("button",{onClick:y,class:"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Cancel "),o("button",{onClick:k,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2",disabled:!n.value.trim()},[g(u(G),{class:"w-4 h-4 mr-2","aria-hidden":"true"}),e[5]||(e[5]=z(" Add Folder "))],8,he)])])])):h("v-if",!0)]))]))}}),De=O(xe,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/document/FolderNavigation.vue"]]);export{De as default};
