import{Y as G,u as K,a0 as g,_ as Y,c as i,o as a,C as f,z as o,F as D,H as h,I as n,D as m,aG as C,a as d,al as w,E as Z,B as z,an as oe,a9 as ue,aa as ce,ab as me,ac as fe,ad as be,ae as pe,af as ye,N as ge,K as s,M as u,A as V,av as $,a7 as ve,a8 as xe,bb as ke,aD as F}from"./index-OdhKCqIc.js";import{u as re,R as we,k as _e}from"./inventory-CcBllciv.js";import{d as Te,j as se,G as Pe}from"./inventory.queries-Bx-sCQu8.js";import{p as de}from"./index-CXV6PIcj.js";import De from"./DataTable-DLBrhw2Z.js";import{Multiselect as he}from"./vue-multiselect.esm-Cvm3ZCjW.js";import{c as ee,g as te,a as I,d as A,u as Se,b as v}from"./index.esm-BfHj8iGm.js";import{u as Ue}from"./storage-CAZM5V7o.js";import{u as Re}from"./setup-BcFG_bXr.js";import{u as Ce}from"./user-DYsgscqA.js";import{S as Le}from"./Spinner-Bl8RfjFA.js";import{E as qe,a as Ae,b as Ve,c as Be,d as Ie}from"./EmptyTitle-aCQRDpx3.js";import"./TooltipTrigger-BWIYwmnQ.js";import"./PopperContent-BfyCnGUj.js";import"./Input-BEm5S0CJ.js";import"./SelectValue-Ds0cfAgl.js";import"./useNonce-B4v0IDPb.js";import"./chevron-down-Dqf-ptA3.js";import"./useFocusGuards-Bjb6OG0k.js";const Ee=G({__name:"StockReceiveForm",emits:["close"],setup(L,{expose:t,emit:p}){t();const e=p,b=re(),l=Re(),r=Ue(),x=Ce(),{withClientMutation:_,withClientQuery:T}=K(),R=g([]),S=g(!1),B=ee({stockItemVariant:ee().required("StockItem is required"),supplierUid:I().required(),unitUid:I().required(),lotNumber:I().required(),unitPrice:A().nullable().default(0),totalPrice:A().nullable().default(0),singlesReceived:A().required().default(0),packagesReceived:A().required().default(0),packageFactor:A().required().default(1),quantityReceived:A().default(0),receiptType:I().required().default("purchase"),receiptDate:te().required("Date received is required"),receiptByUid:I().required("Receiver is required"),expiryDate:te().required("Date expiring is required")}),{handleSubmit:y,errors:H}=Se({validationSchema:B,initialValues:{singlesReceived:0,packagesReceived:0,packageFactor:1,quantityReceived:0}}),{value:E}=v("stockItemVariant"),{value:Q}=v("supplierUid"),{value:M}=v("unitUid"),{value:j}=v("lotNumber"),{value:U}=v("totalPrice"),{value:k}=v("packagesReceived"),{value:q}=v("packageFactor"),{value:c}=v("quantityReceived"),{value:O}=v("receiptType"),{value:ae}=v("receiptDate"),{value:ne}=v("receiptByUid"),{value:ie}=v("expiryDate"),le=y(P=>J(P));function J(P){S.value=!0;const N={...P,productUid:E?.value?.uid,unitPrice:0,totalPrice:0};delete N.stockItemVariant,_(we,{payload:N},"createStockReceipt").then(X=>{}).finally(()=>{S.value=!1,e("close")})}const W={emit:e,inventoryStore:b,setupStore:l,storageStore:r,userStore:x,withClientMutation:_,withClientQuery:T,stockItems:R,addingProduct:S,stockSchema:B,handleSubmit:y,errors:H,stockItemVariant:E,supplierUid:Q,unitUid:M,lotNumber:j,singlesReceived:U,packagesReceived:k,packageFactor:q,quantityReceived:c,receiptType:O,receiptDate:ae,receiptByUid:ne,expiryDate:ie,submitStockForm:le,receiveStockProduct:J,findProduct:async P=>{P.length>3&&T(Te,{first:50,after:"",text:P,sortBy:["name"]},"stockProductAll").then(X=>{R.value=X?.items})},customLabel:(P,N)=>`${P.stockItem?.name} - ${P.name}`,updateQuantityReceived:()=>{!U.value&&!k.value&&(c.value=0),!U.value&&k.value&&(c.value=k.value*q.value),U.value&&!k.value&&(c.value=U.value),k.value||(k.value=0),c.value=U.value+k.value*q.value},get VueMultiselect(){return he},get Spinner(){return Le}};return Object.defineProperty(W,"__isScriptSetup",{enumerable:!1,value:!0}),W}}),je=["inert"],Ne={key:0,class:"p-3 bg-destructive/10 text-destructive rounded-md mb-4"},Fe={class:"mt-2 list-disc list-inside text-sm"},He={class:"space-y-2"},Qe={key:0,class:"text-sm text-destructive"},Me={class:"space-y-2"},Oe={class:"w-full"},ze={key:0,class:"text-sm text-destructive"},Ge={class:"space-y-2"},Ke=["value"],Ye={key:0,class:"text-sm text-destructive"},Je={class:"space-y-2"},We=["value"],Xe={key:0,class:"text-sm text-destructive"},Ze={class:"space-y-2"},$e={class:"w-full"},et={key:0,class:"text-sm text-destructive"},tt={class:"space-y-2"},ot={class:"w-full"},rt={key:0,class:"text-sm text-destructive"},st={class:"space-y-2"},dt={class:"w-full"},at={key:0,class:"text-sm text-destructive"},nt={class:"space-y-2"},it={class:"w-full"},lt={key:0,class:"text-sm text-destructive"},ut={class:"space-y-2"},ct={class:"w-full"},mt={key:0,class:"text-sm text-destructive"},ft={class:"space-y-2"},bt={class:"w-full"},pt={key:0,class:"text-sm text-destructive"},yt={class:"space-y-2"},gt={class:"w-full"},vt={key:0,class:"text-sm text-destructive"},xt={class:"space-y-2"},kt=["value"],wt={key:0,class:"text-sm text-destructive"},_t={class:"flex justify-end"},Tt={type:"submit",class:"px-4 py-2 text-sm font-medium text-primary-foreground bg-primary border border-transparent rounded-md shadow-sm hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors duration-200"},Pt={class:"inline-flex items-center gap-2"};function Dt(L,t,p,e,b,l){return a(),i("form",{onSubmit:t[15]||(t[15]=z((...r)=>e.submitStockForm&&e.submitStockForm(...r),["prevent"])),class:"rounded-md py-4 space-y-4",autocomplete:"off",inert:e.addingProduct},[Object.keys(e.errors).length>0?(a(),i("div",Ne,[t[16]||(t[16]=o("p",{class:"text-sm font-medium"},"Please correct the following errors:",-1)),o("ul",Fe,[(a(!0),i(D,null,h(e.errors,(r,x)=>(a(),i("li",{key:x},n(r),1))),128))])])):f("",!0),o("div",He,[t[18]||(t[18]=o("label",{class:"block text-sm font-medium text-foreground"},"Receipt Type",-1)),m(o("select",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200","onUpdate:modelValue":t[0]||(t[0]=r=>e.receiptType=r),"aria-label":"Receipt Type"},[...t[17]||(t[17]=[o("option",{value:"null"},null,-1),o("option",{value:"purchase"},"Purchased",-1),o("option",{value:"pushed"},"Pushed",-1),o("option",{value:"transfer_in"},"Transfer In",-1)])],512),[[C,e.receiptType]]),e.errors.receiptType?(a(),i("div",Qe,n(e.errors.receiptType),1)):f("",!0)]),o("div",Me,[t[19]||(t[19]=o("label",{class:"block text-sm font-medium text-foreground"},"Stock Item",-1)),o("div",Oe,[d(e.VueMultiselect,{placeholder:"Select a Stock Item",modelValue:e.stockItemVariant,"onUpdate:modelValue":t[1]||(t[1]=r=>e.stockItemVariant=r),options:e.stockItems,searchable:!0,"track-by":"uid",customLabel:e.customLabel,onSearchChange:e.findProduct,class:"multiselect-primary"},null,8,["modelValue","options"]),e.errors.stockItemVariantUid?(a(),i("div",ze,n(e.errors.stockItemVariantUid),1)):f("",!0)])]),o("div",Ge,[t[21]||(t[21]=o("label",{class:"block text-sm font-medium text-foreground"},"Supplier",-1)),m(o("select",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200","onUpdate:modelValue":t[2]||(t[2]=r=>e.supplierUid=r),"aria-label":"Supplier"},[t[20]||(t[20]=o("option",{value:"null"},null,-1)),(a(!0),i(D,null,h(e.setupStore.suppliers,r=>(a(),i("option",{key:r.uid,value:r.uid},n(r.name),9,Ke))),128))],512),[[C,e.supplierUid]]),e.errors.supplierUid?(a(),i("div",Ye,n(e.errors.supplierUid),1)):f("",!0)]),o("div",Je,[t[23]||(t[23]=o("label",{class:"block text-sm font-medium text-foreground"},"Unit (Single)",-1)),m(o("select",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200","onUpdate:modelValue":t[3]||(t[3]=r=>e.unitUid=r),"aria-label":"Unit"},[t[22]||(t[22]=o("option",{value:"null"},null,-1)),(a(!0),i(D,null,h(e.inventoryStore.units,r=>(a(),i("option",{key:r.uid,value:r.uid},n(r.name),9,We))),128))],512),[[C,e.unitUid]]),e.errors.unitUid?(a(),i("div",Xe,n(e.errors.unitUid),1)):f("",!0)]),o("div",Ze,[t[24]||(t[24]=o("label",{class:"block text-sm font-medium text-foreground"},"Lot Number",-1)),o("div",$e,[m(o("input",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200","onUpdate:modelValue":t[4]||(t[4]=r=>e.lotNumber=r),placeholder:"Lot Number..."},null,512),[[w,e.lotNumber]]),e.errors.lotNumber?(a(),i("div",et,n(e.errors.lotNumber),1)):f("",!0)])]),o("div",tt,[t[25]||(t[25]=o("label",{class:"block text-sm font-medium text-foreground"},"Packages Received",-1)),o("div",ot,[m(o("input",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200",type:"number","onUpdate:modelValue":t[5]||(t[5]=r=>e.packagesReceived=r),placeholder:"Quantity Received...",onKeyup:e.updateQuantityReceived,onFocus:t[6]||(t[6]=r=>r.target.select())},null,544),[[w,e.packagesReceived]]),e.errors.packagesReceived?(a(),i("div",rt,n(e.errors.packagesReceived),1)):f("",!0)])]),o("div",st,[t[26]||(t[26]=o("label",{class:"block text-sm font-medium text-foreground"},"Package Factor",-1)),o("div",dt,[m(o("input",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200",type:"number","onUpdate:modelValue":t[7]||(t[7]=r=>e.packageFactor=r),placeholder:"Package Factor...",onKeyup:e.updateQuantityReceived,onFocus:t[8]||(t[8]=r=>r.target.select())},null,544),[[w,e.packageFactor]]),e.errors.packageFactor?(a(),i("div",at,n(e.errors.packageFactor),1)):f("",!0)])]),o("div",nt,[t[27]||(t[27]=o("label",{class:"block text-sm font-medium text-foreground"},"Singles Received",-1)),o("div",it,[m(o("input",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200",type:"number","onUpdate:modelValue":t[9]||(t[9]=r=>e.singlesReceived=r),placeholder:"Quantity Received...",onKeyup:e.updateQuantityReceived,onFocus:t[10]||(t[10]=r=>r.target.select())},null,544),[[w,e.singlesReceived]]),e.errors.singlesReceived?(a(),i("div",lt,n(e.errors.singlesReceived),1)):f("",!0)])]),o("div",ut,[t[28]||(t[28]=o("label",{class:"block text-sm font-medium text-foreground"},"Quantity Received",-1)),o("div",ct,[m(o("input",{class:"w-full px-3 py-2 text-foreground bg-muted border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200",type:"number","onUpdate:modelValue":t[11]||(t[11]=r=>e.quantityReceived=r),disabled:""},null,512),[[w,e.quantityReceived]]),e.errors.quantityReceived?(a(),i("div",mt,n(e.errors.quantityReceived),1)):f("",!0)])]),o("div",ft,[t[29]||(t[29]=o("label",{class:"block text-sm font-medium text-foreground"},"Expiry Date",-1)),o("div",bt,[m(o("input",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200",type:"date","onUpdate:modelValue":t[12]||(t[12]=r=>e.expiryDate=r),placeholder:"Expiry Date"},null,512),[[w,e.expiryDate]]),e.errors.expiryDate?(a(),i("div",pt,n(e.errors.expiryDate),1)):f("",!0)])]),o("div",yt,[t[30]||(t[30]=o("label",{class:"block text-sm font-medium text-foreground"},"Received Date",-1)),o("div",gt,[m(o("input",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200",type:"date","onUpdate:modelValue":t[13]||(t[13]=r=>e.receiptDate=r),placeholder:"Received Date"},null,512),[[w,e.receiptDate]]),e.errors.receiptDate?(a(),i("div",vt,n(e.errors.receiptDate),1)):f("",!0)])]),o("div",xt,[t[32]||(t[32]=o("label",{class:"block text-sm font-medium text-foreground"},"Received By",-1)),m(o("select",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200","onUpdate:modelValue":t[14]||(t[14]=r=>e.receiptByUid=r),"aria-label":"Received By"},[t[31]||(t[31]=o("option",{value:"null"},null,-1)),(a(!0),i(D,null,h(e.userStore.users,r=>(a(),i("option",{key:r.uid,value:r.uid},n(r.firstName)+" "+n(r.lastName),9,kt))),128))],512),[[C,e.receiptByUid]]),e.errors.receiptByUid?(a(),i("div",wt,n(e.errors.receiptByUid),1)):f("",!0)]),t[34]||(t[34]=o("div",{class:"border-t border-border my-6"},null,-1)),o("div",_t,[m(o("button",Tt," Save ",512),[[Z,!e.addingProduct]]),m(o("span",Pt,[d(e.Spinner,{class:"size-4"}),t[33]||(t[33]=o("span",{class:"text-sm"},"Adding Inventory ...",-1))],512),[[Z,e.addingProduct]])])],40,je)}const ht=Y(Ee,[["render",Dt],["__scopeId","data-v-65664c55"],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/inventory/StockReceiveForm.vue"]]),St=G({name:"ProductDetail",__name:"ProductDetail",props:{product:{type:[Object,null],required:!1}},setup(L,{expose:t}){t();const p=L,{withClientQuery:e}=K(),b=g([]),l=g([]),r=g("stock-lots"),x=g(["stock-lots","ledger"]);oe(()=>p.product?.uid,async T=>{if(!T)return;const R=await e(se,{productUid:T},"stockLots");b.value=R??[];const S=await e(Pe,{first:25,after:"",text:"",sortBy:["-uid"],productUid:T},"stockAdjustmentAll");l.value=S?.items??[]});const _={props:p,withClientQuery:e,stockLots:b,stockAdjustments:l,currentTab:r,inventoryTabs:x,get Table(){return ye},get TableBody(){return pe},get TableCell(){return be},get TableEmpty(){return fe},get TableHead(){return me},get TableHeader(){return ce},get TableRow(){return ue},get Empty(){return Ie},get EmptyContent(){return Be},get EmptyDescription(){return Ve},get EmptyHeader(){return Ae},get EmptyTitle(){return qe},get parseDate(){return de}};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}}),Ut={class:"space-y-4"},Rt={class:"text-lg font-medium text-foreground"},Ct={class:"text-sm text-muted-foreground"},Lt={class:"text-lg font-medium text-foreground"},qt={class:"text-sm text-muted-foreground"},At={class:"flex justify-between rounded-md bg-background shadow-md"},Vt={class:"flex justify-start"},Bt=["onClick"],It={class:"pt-4"},Et={key:0,class:"border border-border bg-card rounded-lg shadow-md"},jt={class:"relative w-full overflow-auto"},Nt={key:1,class:"border border-border bg-card rounded-lg shadow-md"},Ft={class:"relative w-full overflow-auto"};function Ht(L,t,p,e,b,l){return a(),i("div",Ut,[o("h3",Rt,"Stock Item: "+n(p.product?.stockItem?.name),1),o("p",Ct,n(p.product?.stockItem?.description),1),t[12]||(t[12]=o("div",{class:"my-4 border-t border-border"},null,-1)),o("h3",Lt,"Stock Variant: "+n(p.product?.name),1),o("p",qt,n(p.product?.description),1),t[13]||(t[13]=o("div",{class:"my-4 border-t border-border"},null,-1)),o("nav",At,[o("div",Vt,[(a(!0),i(D,null,h(e.inventoryTabs,r=>(a(),i("button",{key:r,type:"button",class:ge(["rounded-md px-4 py-2 text-xs font-bold uppercase tracking-wide no-underline transition-colors duration-200 text-muted-foreground",e.currentTab===r?"bg-primary text-primary-foreground":"hover:bg-muted"]),onClick:x=>e.currentTab=r},n(r),11,Bt))),128))])]),o("div",It,[e.currentTab==="stock-lots"?(a(),i("div",Et,[o("div",jt,[d(e.Table,{class:"w-full caption-bottom text-sm"},{default:s(()=>[d(e.TableHeader,{class:"[&_tr]:border-b"},{default:s(()=>[d(e.TableRow,{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:s(()=>[d(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:s(()=>[...t[0]||(t[0]=[u("Lot Number",-1)])]),_:1}),d(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:s(()=>[...t[1]||(t[1]=[u("Quantity",-1)])]),_:1}),d(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:s(()=>[...t[2]||(t[2]=[u("Expiry Date",-1)])]),_:1})]),_:1})]),_:1}),d(e.TableBody,{class:"[&_tr:last-child]:border-0"},{default:s(()=>[e.stockLots.length===0?(a(),V(e.TableEmpty,{key:0,colspan:3},{default:s(()=>[d(e.Empty,{class:"border-0 bg-transparent p-0"},{default:s(()=>[d(e.EmptyContent,null,{default:s(()=>[d(e.EmptyHeader,null,{default:s(()=>[d(e.EmptyTitle,null,{default:s(()=>[...t[3]||(t[3]=[u("No stock lots available",-1)])]),_:1}),d(e.EmptyDescription,null,{default:s(()=>[...t[4]||(t[4]=[u("Lots will appear here once stock is received.",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):(a(!0),i(D,{key:1},h(e.stockLots,r=>(a(),V(e.TableRow,{key:r.uid,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:s(()=>[d(e.TableCell,{class:"px-4 py-3 align-middle text-sm text-foreground"},{default:s(()=>[u(n(r.lotNumber),1)]),_:2},1024),d(e.TableCell,{class:"px-4 py-3 align-middle text-sm text-foreground"},{default:s(()=>[u(n(r.quantity),1)]),_:2},1024),d(e.TableCell,{class:"px-4 py-3 align-middle text-sm text-foreground"},{default:s(()=>[u(n(e.parseDate(r.expiryDate,!1)),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])):f("",!0),e.currentTab==="ledger"?(a(),i("div",Nt,[o("div",Ft,[d(e.Table,{class:"w-full caption-bottom text-sm"},{default:s(()=>[d(e.TableHeader,{class:"[&_tr]:border-b"},{default:s(()=>[d(e.TableRow,{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:s(()=>[d(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:s(()=>[...t[5]||(t[5]=[u("Date",-1)])]),_:1}),d(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:s(()=>[...t[6]||(t[6]=[u("Lot",-1)])]),_:1}),d(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:s(()=>[...t[7]||(t[7]=[u("Transaction Type",-1)])]),_:1}),d(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:s(()=>[...t[8]||(t[8]=[u("Quantity",-1)])]),_:1}),d(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:s(()=>[...t[9]||(t[9]=[u("By",-1)])]),_:1})]),_:1})]),_:1}),d(e.TableBody,{class:"[&_tr:last-child]:border-0"},{default:s(()=>[e.stockAdjustments.length===0?(a(),V(e.TableEmpty,{key:0,colspan:5},{default:s(()=>[d(e.Empty,{class:"border-0 bg-transparent p-0"},{default:s(()=>[d(e.EmptyContent,null,{default:s(()=>[d(e.EmptyHeader,null,{default:s(()=>[d(e.EmptyTitle,null,{default:s(()=>[...t[10]||(t[10]=[u("No adjustments recorded",-1)])]),_:1}),d(e.EmptyDescription,null,{default:s(()=>[...t[11]||(t[11]=[u("Ledger activity will appear here after updates.",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):(a(!0),i(D,{key:1},h(e.stockAdjustments,r=>(a(),V(e.TableRow,{key:r.uid,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:s(()=>[d(e.TableCell,{class:"px-4 py-3 align-middle text-sm text-foreground"},{default:s(()=>[u(n(e.parseDate(r?.adjustmentDate)),1)]),_:2},1024),d(e.TableCell,{class:"px-4 py-3 align-middle text-sm text-foreground"},{default:s(()=>[u(n(r?.stockLot?.lotNumber),1)]),_:2},1024),d(e.TableCell,{class:"px-4 py-3 align-middle text-sm text-foreground"},{default:s(()=>[u(n(r?.adjustmentType),1)]),_:2},1024),d(e.TableCell,{class:"px-4 py-3 align-middle text-sm text-foreground"},{default:s(()=>[u(n(r?.adjust),1)]),_:2},1024),d(e.TableCell,{class:"px-4 py-3 align-middle text-sm text-foreground"},{default:s(()=>[u(n(r?.adjustmentBy?.firstName),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])])):f("",!0)])])}const Qt=Y(St,[["render",Ht],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/inventory/ProductDetail.vue"]]),Mt=G({name:"StockListing",__name:"InvListing",setup(L,{expose:t}){t();const{withClientMutation:p,withClientQuery:e}=K(),b=re();b.fetchProducts({first:50,after:"",text:"",sortBy:["-uid"]});const l=$({product:{},quantity:0,stockLotUid:"",type:"",remarks:""}),r=g(!1),x=g(!1),_=g(!1),T=g(!1),R=g({}),S=g([]);function B(c){e(se,{productUid:c},"stockLots").then(O=>{S.value=O??[]})}oe(()=>l.product?.uid,c=>c&&B(c));const y=$({first:50,before:"",text:"",sortBy:["-uid"],filterAction:!1}),H=g([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Name",value:"stockItem.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Type",value:"name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Category",value:"stockItem.category.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Hazard",value:"stockItem.hazard.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Quantity",value:"quantity",sortable:!1,sortBy:"asc",hidden:!1},{name:"Description",value:"description",sortable:!1,sortBy:"asc",hidden:!1},{name:"Actions",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender(c){return F("div",{class:"flex justify-start align-items-center gap-x-4"},[F("button",{type:"button",class:"rounded-sm bg-primary px-2 py-1 leading-none text-primary-foreground disabled:bg-muted",disabled:c.quantity<1,onClick:()=>{l.product=c,l.quantity=0,l.stockLotUid="",x.value=!0}},"+ Basket"),F("button",{type:"button",class:"rounded-sm bg-primary px-2 py-1 leading-none text-primary-foreground disabled:bg-muted",disabled:c.quantity<1,onClick:()=>{l.product=c,l.quantity=0,l.stockLotUid="",l.type="",l.remarks="",_.value=!0}},"+/- Adjust"),F("button",{type:"button",class:"rounded-sm bg-primary px-2 py-1 leading-none text-primary-foreground",onClick:()=>{T.value=!0,R.value=c}},"View Detail")])}}]);function E(c){y.first=50,y.before="",y.text=c.filterText??"",y.filterAction=!0,b.fetchProducts(y)}function Q(c){y.first=c.fetchCount??50,y.before=b.productsPaging?.pageInfo?.endCursor??"",y.text=c.filterText??"",y.filterAction=!1,b.fetchProducts(y)}const M=ve(()=>`${b.products?.length??0} of ${b.productsPaging?.totalCount??0} products`);function j(){p(_e,{payload:{productUid:l.product.uid,stockLotUid:l.stockLotUid,adjustmentType:l.type,adjust:l.quantity,remarks:l.remarks}},"createStockAdjustment").then(()=>{})}function U(){b.addToBasket(l.product.uid,l.stockLotUid,l.quantity),x.value=!1}function k(){j(),_.value=!1}const q={withClientMutation:p,withClientQuery:e,inventoryStore:b,choiceProduct:l,openDrawer:r,openAddProduct:x,openAdjustProduct:_,openProductDetail:T,productDetailItem:R,stockLots:S,fetchLots:B,productParams:y,tableColumns:H,filterProducts:E,showMoreProducts:Q,countNone:M,adjustStock:j,addToBasketAndClose:U,doAdjustAndClose:k,Modal:ke,Drawer:xe,get parseDate(){return de},DataTable:De,StockReceiveForm:ht,ProductDetail:Qt};return Object.defineProperty(q,"__isScriptSetup",{enumerable:!1,value:!0}),q}}),Ot={class:"space-y-4"},zt={class:"text-lg font-medium text-foreground"},Gt={class:"space-y-2"},Kt=["value"],Yt={class:"space-y-2"},Jt=["disabled"],Wt={class:"text-lg font-medium text-foreground"},Xt={class:"space-y-2"},Zt=["value"],$t={class:"space-y-2"},eo={class:"space-y-2"},to={class:"space-y-2"},oo=["disabled"];function ro(L,t,p,e,b,l){return a(),i("div",Ot,[o("button",{type:"button",class:"rounded-md border border-transparent bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow-sm transition-colors duration-200 hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2",onClick:t[0]||(t[0]=r=>e.openDrawer=!0)}," Receive Stock "),d(e.DataTable,{columns:e.tableColumns,data:e.inventoryStore.products,"toggle-columns":!1,loading:!1,paginable:!0,"page-meta":{fetchCount:10,hasNextPage:!1,countNone:e.countNone},searchable:!0,filterable:!1,selectable:!1,onOnSearch:e.filterProducts,onOnPaginate:e.showMoreProducts},null,8,["columns","data","page-meta"]),d(e.Drawer,{show:e.openDrawer,onClose:t[2]||(t[2]=r=>e.openDrawer=!1)},{header:s(()=>[...t[12]||(t[12]=[u("Receive Stock",-1)])]),body:s(()=>[d(e.StockReceiveForm,{onClose:t[1]||(t[1]=r=>e.openDrawer=!1)})]),_:1},8,["show"]),d(e.Drawer,{show:e.openProductDetail,onClose:t[3]||(t[3]=r=>e.openProductDetail=!1)},{header:s(()=>[...t[13]||(t[13]=[u("Product Details",-1)])]),body:s(()=>[d(e.ProductDetail,{product:e.productDetailItem},null,8,["product"])]),_:1},8,["show"]),e.openAddProduct?(a(),V(e.Modal,{key:0,"content-width":"w-1/4",onClose:t[6]||(t[6]=r=>e.openAddProduct=!1)},{header:s(()=>[o("h3",zt,n(e.choiceProduct.product?.stockItem?.name)+" ("+n(e.choiceProduct.product?.name)+") ",1)]),body:s(()=>[o("form",{class:"space-y-4 p-4",action:"post",onSubmit:z(e.addToBasketAndClose,["prevent"])},[o("div",Gt,[t[15]||(t[15]=o("label",{class:"block text-sm font-medium text-foreground"},"Product Lot",-1)),m(o("select",{"onUpdate:modelValue":t[4]||(t[4]=r=>e.choiceProduct.stockLotUid=r),class:"w-full rounded-md border border-border bg-background px-3 py-2 text-foreground shadow-sm transition-colors duration-200 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Product Lot"},[t[14]||(t[14]=o("option",{value:""},"Select lot...",-1)),(a(!0),i(D,null,h(e.stockLots,r=>(a(),i("option",{key:r.uid,value:r.uid},n(r.lotNumber)+" ("+n(r.quantity)+") ["+n(e.parseDate(r.expiryDate,!1))+"] ",9,Kt))),128))],512),[[C,e.choiceProduct.stockLotUid]])]),o("div",Yt,[t[16]||(t[16]=o("label",{class:"block text-sm font-medium text-foreground"},"Quantity",-1)),m(o("input",{"onUpdate:modelValue":t[5]||(t[5]=r=>e.choiceProduct.quantity=r),type:"number",class:"w-full rounded-md border border-border bg-background px-3 py-2 text-foreground shadow-sm transition-colors duration-200 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Quantity..."},null,512),[[w,e.choiceProduct.quantity,void 0,{number:!0}]])]),t[17]||(t[17]=o("div",{class:"my-4 border-t border-border"},null,-1)),o("button",{type:"submit",class:"w-full rounded-md border border-transparent bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow-sm transition-colors duration-200 hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",disabled:!e.choiceProduct.stockLotUid}," Add to basket ",8,Jt)],32)]),_:1})):f("",!0),e.openAdjustProduct?(a(),V(e.Modal,{key:1,"content-width":"w-1/4",onClose:t[11]||(t[11]=r=>e.openAdjustProduct=!1)},{header:s(()=>[o("h3",Wt,n(e.choiceProduct.product?.stockItem?.name)+" ("+n(e.choiceProduct.product?.name)+") ",1)]),body:s(()=>[o("form",{class:"space-y-4 p-4",action:"post",onSubmit:z(e.doAdjustAndClose,["prevent"])},[o("div",Xt,[t[19]||(t[19]=o("label",{class:"block text-sm font-medium text-foreground"},"Product Lot",-1)),m(o("select",{"onUpdate:modelValue":t[7]||(t[7]=r=>e.choiceProduct.stockLotUid=r),class:"w-full rounded-md border border-border bg-background px-3 py-2 text-foreground shadow-sm transition-colors duration-200 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Product Lot"},[t[18]||(t[18]=o("option",{value:""},"Select lot...",-1)),(a(!0),i(D,null,h(e.stockLots,r=>(a(),i("option",{key:r.uid,value:r.uid},n(r.lotNumber),9,Zt))),128))],512),[[C,e.choiceProduct.stockLotUid]])]),o("div",$t,[t[21]||(t[21]=o("label",{class:"block text-sm font-medium text-foreground"},"Adjustment Type",-1)),m(o("select",{"onUpdate:modelValue":t[8]||(t[8]=r=>e.choiceProduct.type=r),class:"w-full rounded-md border border-border bg-background px-3 py-2 text-foreground shadow-sm transition-colors duration-200 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Adjustment Type"},[...t[20]||(t[20]=[o("option",{value:"lost"},"Lost",-1),o("option",{value:"theft"},"Theft",-1),o("option",{value:"transfer-out"},"Transfer Out",-1)])],512),[[C,e.choiceProduct.type]])]),o("div",eo,[t[22]||(t[22]=o("label",{class:"block text-sm font-medium text-foreground"},"Quantity",-1)),m(o("input",{"onUpdate:modelValue":t[9]||(t[9]=r=>e.choiceProduct.quantity=r),type:"number",class:"w-full rounded-md border border-border bg-background px-3 py-2 text-foreground shadow-sm transition-colors duration-200 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Quantity..."},null,512),[[w,e.choiceProduct.quantity,void 0,{number:!0}]])]),o("div",to,[t[23]||(t[23]=o("label",{class:"block text-sm font-medium text-foreground"},"Remarks",-1)),m(o("textarea",{"onUpdate:modelValue":t[10]||(t[10]=r=>e.choiceProduct.remarks=r),rows:"3",class:"w-full rounded-md border border-border bg-background px-3 py-2 text-foreground shadow-sm transition-colors duration-200 focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"Remarks..."},null,512),[[w,e.choiceProduct.remarks]])]),t[24]||(t[24]=o("div",{class:"my-4 border-t border-border"},null,-1)),o("button",{type:"submit",class:"w-full rounded-md border border-transparent bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow-sm transition-colors duration-200 hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",disabled:!e.choiceProduct.stockLotUid}," Adjust ",8,oo)],32)]),_:1})):f("",!0)])}const So=Y(Mt,[["render",ro],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/inventory/InvListing.vue"]]);export{So as default};
