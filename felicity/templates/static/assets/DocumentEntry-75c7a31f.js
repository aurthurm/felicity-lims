import{f as I,d as A,a2 as p,V as x,aj as E,a1 as S,a8 as w,r as C,o as h,c as k,a as v,O as s,L as u,a4 as O,a6 as c,z as g,F as M,$ as D,a0 as _,_ as P}from"./index-0a787601.js";import{a as B,b as R}from"./document.queries-f104a1c4.js";import{b as T}from"./_isIterateeCall-72ffbef1.js";import{t as b}from"./toFinite-8ab3aee8.js";var V=Math.floor,L=Math.random;function $(e,t){return e+V(L()*(t-e+1))}var j=parseFloat,N=Math.min,U=Math.random;function z(e,t,o){if(o&&typeof o!="boolean"&&T(e,t,o)&&(t=o=void 0),o===void 0&&(typeof t=="boolean"?(o=t,t=void 0):typeof e=="boolean"&&(o=e,e=void 0)),e===void 0&&t===void 0?(e=0,t=1):(e=b(e),t===void 0?(t=e,e=0):t=b(t)),e>t){var n=e;e=t,t=n}if(o||e%1||t%1){var r=U();return N(e+r*(t-e+j("1e-"+((r+"").length-1))),t)}return $(e,t)}const{withClientQuery:y}=I(),G=A("documents",{state:()=>({documents:[],folders:[],currentFolder:null,selectedDocument:null,isPreviewOpen:!1,recentDocuments:[]}),actions:{async fetchDocuments(e,t=!1){try{const o=await y(B,{first:100,text:"",sortBy:["-created_at"],...e},"documentAll");o&&typeof o=="object"&&"items"in o?(this.documents=o.items,t&&(this.recentDocuments=this.documents.sort((n,r)=>{const d=n.updatedAt?new Date(n.updatedAt).getTime():0;return(r.updatedAt?new Date(r.updatedAt).getTime():0)-d}).slice(0,25))):console.error("Invalid documents data received:",o)}catch(o){console.error("Error fetching documents:",o)}},addDocument(e){if(!e?.uid){console.error("Invalid document payload:",e);return}this.documents.push(e),this.recentDocuments=[e,...this.recentDocuments].slice(0,5)},updateDocument(e){if(!e?.uid){console.error("Invalid document payload:",e);return}const t={...e,updatedAt:new Date().toISOString()};this.documents=this.documents.map(o=>o.uid===e.uid?t:o),this.recentDocuments=[t,...this.recentDocuments.filter(o=>o.uid!==e.uid)].slice(0,5)},deleteDocument(e){if(!e){console.error("Invalid document ID provided to deleteDocument");return}this.documents=this.documents.filter(t=>t.uid!==e),this.recentDocuments=this.recentDocuments.filter(t=>t.uid!==e)},duplicateDocument(e){if(!e){console.error("Invalid document ID provided to duplicateDocument");return}const t=this.documents.find(n=>n.uid===e);if(!t){console.error("Document not found:",e);return}const o={...t,uid:z(1e3,9999).toString(),name:`${t.name} (Copy)`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};this.documents.push(o),this.recentDocuments=[o,...this.recentDocuments].slice(0,5)},async setCurrentFolder(e){this.currentFolder=e,await this.fetchDocuments({folderUid:e})},async getFolders(){try{const e=await y(R,{},"documentFolderAll");e&&typeof e=="object"&&"items"in e?this.folders=e.items:console.error("Invalid folders data received:",e)}catch(e){console.error("Error fetching folders:",e)}},addFolder(e){if(!e?.uid){console.error("Invalid folder payload:",e);return}this.folders.push(e)},deleteFolder(e){if(!e){console.error("Invalid folder ID provided to deleteFolder");return}this.folders=this.folders.filter(t=>t.uid!==e),this.documents=this.documents.filter(t=>t.folderUid!==e)},updateFolder(e){if(!e?.uid){console.error("Invalid folder payload:",e);return}this.folders=this.folders.map(t=>t.uid===e.uid?e:t)},setSelectedDocument(e){this.selectedDocument=e},togglePreview(e){this.isPreviewOpen=e},toggleFolderExpanded(e){if(!e){console.error("Invalid folder ID provided to toggleFolderExpanded");return}this.folders=this.folders.map(t=>t.uid===e?{...t,expanded:!t.expanded}:t)}},getters:{getChildFolders:e=>t=>e.folders.filter(o=>o.parentUid===t),getDocumentsInFolder:e=>t=>e.documents.filter(o=>o.folderUid===t)}});/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var m={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=({size:e,strokeWidth:t=2,absoluteStrokeWidth:o,color:n,iconNode:r,name:d,class:i,...f},{slots:a})=>p("svg",{...m,width:e||m.width,height:e||m.height,stroke:n||m.stroke,"stroke-width":o?Number(t)*24/Number(e):t,class:["lucide",`lucide-${Z(d??"icon")}`],...f},[...r.map(l=>p(...l)),...a.default?[a.default()]:[]]);/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=(e,t)=>(o,{slots:n})=>p(H,{...o,iconNode:t,name:e},n);/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=K("FolderIcon",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]),q={class:"flex h-[calc(100vh-4rem)] overflow-hidden"},J={class:"flex-1 overflow-hidden"},X={class:"lg:hidden p-4 flex items-center border-b border-border"},Y={class:"h-full overflow-auto p-6"},W=x({__name:"DocumentEntry",setup(e){const t=D(()=>_(()=>import("./FolderNavigation-b40fa03d.js"),["assets/FolderNavigation-b40fa03d.js","assets/index-0a787601.js","assets/index-8412b2a5.css","assets/plus-0ae73da3.js","assets/document.mutations-1346d165.js","assets/document.queries-f104a1c4.js","assets/_isIterateeCall-72ffbef1.js","assets/toFinite-8ab3aee8.js"])),o=D(()=>_(()=>import("./RecentDocuments-73c321ec.js"),["assets/RecentDocuments-73c321ec.js","assets/index-0a787601.js","assets/index-8412b2a5.css","assets/DocumentListing-81a099e3.js","assets/document.mutations-1346d165.js","assets/plus-0ae73da3.js","assets/document.queries-f104a1c4.js","assets/_isIterateeCall-72ffbef1.js","assets/toFinite-8ab3aee8.js"])),n=D(()=>_(()=>import("./FolderDocuments-f0e3457e.js"),["assets/FolderDocuments-f0e3457e.js","assets/index-0a787601.js","assets/index-8412b2a5.css","assets/DocumentListing-81a099e3.js","assets/document.mutations-1346d165.js","assets/plus-0ae73da3.js","assets/document.queries-f104a1c4.js","assets/_isIterateeCall-72ffbef1.js","assets/toFinite-8ab3aee8.js"])),r=G(),{currentFolder:d}=E(r),i=S(!1),f=()=>{i.value=!i.value};return w(async()=>{try{await r.getFolders()}catch(a){console.error("Error fetching folders:",a)}}),(a,l)=>{const F=C("fel-heading");return h(),k(M,null,[v(F,{title:"Documents"}),s("div",q,[u(" Sidebar "),s("div",{class:O(["fixed inset-y-0 left-0 z-10 w-64 transform bg-doc-folder border-r border-border transition-transform duration-300 ease-in-out lg:relative lg:translate-x-0",{"-translate-x-full":!i.value}])},[v(c(t))],2),u(" Main content "),s("div",J,[u(" Mobile header "),s("div",X,[s("button",{class:"mr-4 p-2 rounded-md border border-border hover:bg-accent",onClick:f},[v(c(Q),{class:"h-5 w-5"})]),l[0]||(l[0]=s("h1",{class:"text-xl font-semibold text-foreground"},"Document Manager",-1))]),u(" Content area "),s("div",Y,[c(d)?(h(),g(c(n),{key:1})):(h(),g(c(o),{key:0}))])])])],64)}}}),ee=P(W,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/document/DocumentEntry.vue"]]),se=Object.freeze(Object.defineProperty({__proto__:null,default:ee},Symbol.toStringTag,{value:"Module"}));export{se as D,Q as F,K as c,G as u};
