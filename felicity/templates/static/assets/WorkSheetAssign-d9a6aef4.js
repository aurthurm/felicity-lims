import{S as P,O as X,u as Z,f as ee,a0 as k,i as y,h as te,r as V,ak as F,o as r,c as n,N as t,C as l,F as u,E as m,H as a,a2 as h,A as w,D as _,a5 as A,a as C,L as M,M as N,Y as j,af as Y,aH as se,aI as oe,_ as re}from"./index-3686e2f1.js";import{u as ne}from"./analysis-7826d4bd.js";import{h as le,o as ae,a as ie}from"./constants-89d5d1e7.js";const de={class:"space-y-6"},ue={class:"border-t border-border pt-6"},ce={action:"post",class:"space-y-4"},pe={class:"flex items-center space-x-4"},me={class:"flex-1 max-w-xs"},fe=["value"],be={class:"overflow-x-auto mt-4"},ye={action:"post",class:"p-1"},he={class:"flex justify-start mb-4"},ge={class:"flex justify-between items-center"},xe=["value"],ve={class:"flex justify-between items-center ml-6"},ke=["value"],we={class:"ml-6 mt-2"},_e={class:"overflow-x-auto mt-4"},Ae={class:"align-middle inline-block min-w-full shadow overflow-hidden bg-background shadow-dashboard px-2 pt-1 rounded-bl-lg rounded-br-lg"},Ce={key:0,class:"py-4 text-center"},Se={key:1,class:"min-w-full"},Te={class:"px-1 py-1 border-b-2 border-border text-left leading-4 text-foreground tracking-wider"},Ue={class:"bg-background"},Be=["onUpdate:modelValue","onChange"],We={class:"px-1 py-1 whitespace-no-wrap border-b border-border"},De={class:"text-sm leading-5 text-primary font-semibold"},Ee={class:"px-1 py-1 whitespace-no-wrap border-b border-border"},Ve={class:"text-sm leading-5 text-primary"},Fe={class:"px-1 py-1 whitespace-no-wrap border-b border-border"},Me={class:"text-sm leading-5 text-primary"},Ne={class:"px-1 py-1 whitespace-no-wrap border-b border-border"},je={class:"text-sm leading-5 text-primary"},Ye={class:"px-1 py-1 whitespace-no-wrap border-b border-border"},qe={class:"text-sm leading-5 text-primary"},He={class:"my-4"},Ie={action:"post",class:"mb-4"},Qe={class:"flex justify-start items-center mr-4"},Re={class:"block mx-4"},$e=["value"],Le=P({__name:"WorkSheetAssign",setup(Oe){const d=X(),f=ne(),S=Z(),{withClientMutation:T}=ee(),g=k();d.fetchWorkSheetTemplates();const U=y(()=>d.getWorkSheet),q=y(()=>d.getWorkSheetTemplates),H=async()=>{try{Y.fire({title:"Are you sure?",text:"You want to apply this template to add samples?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, apply now!",cancelButtonText:"No, cancel apply!"}).then(o=>{o.isConfirmed&&T(se,{worksheetUid:U?.value?.uid,templateUid:g.value},"updateWorksheetApplyTemplate").then(e=>{})})}catch{}};f.fetchAnalysesServices({first:void 0,after:"",text:"",sortBy:["name"]}),S.fetchSampleTypes(),f.fetchQCTemplates();const I=y(()=>f.getQCTemplates),x=k(void 0),c=te({sampleTypeUid:void 0,analysisUid:void 0}),p=k(!1),b=y(()=>{const o=B;return d.getAnalysisResults?.forEach(i=>{o?.some(v=>v.uid===i.uid)||o.push(i)}),o}),Q=()=>{W(),d.fetchForWorkSheetsAssign({first:50,after:"",text:"",sortBy:void 0,...c})},R=()=>{const o=$();try{Y.fire({title:"Are you sure?",text:"You want to assign selected to worksheet?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, assign now!",cancelButtonText:"No, cancel apply!"}).then(e=>{e.isConfirmed&&T(oe,{uid:U?.value?.uid,qcTemplateUid:x.value,analysesUids:o},"updateWorksheetManualAssign").then(i=>{})})}catch{}};let B=[];function W(){let o=[];return b?.value?.forEach(e=>{e.checked&&o.push(e)}),B=o,o}function $(){const o=W();let e=[];return o?.forEach(i=>e.push(i.uid)),e}function L(o){G()?p.value=!0:p.value=!1}function O(o){o.checked=!0}function K(o){o.checked=!1}async function z(){await b?.value?.forEach(o=>p.value?O(o):K(o))}function G(){return b?.value?.every(o=>o.checked===!0)}return(o,e)=>{const i=V("FButton"),v=V("fel-loader"),D=F("motion-slide-right"),J=F("motion-slide-left");return r(),n(u,null,[t("section",de,[t("div",ue,[l((r(),n("form",ce,[t("div",pe,[e[8]||(e[8]=t("span",{class:"text-sm font-medium text-foreground"},"Worksheet Template",-1)),t("label",me,[l(t("select",{class:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary","onUpdate:modelValue":e[0]||(e[0]=s=>g.value=s)},[e[7]||(e[7]=t("option",{value:""},null,-1)),(r(!0),n(u,null,m(q.value,s=>(r(),n("option",{key:s.uid,value:s.uid},a(s.name),9,fe))),128))],512),[[h,g.value]])]),l(t("button",{type:"button",onClick:e[1]||(e[1]=w(s=>H(),["prevent"])),class:"px-4 py-2 bg-primary text-primary-foreground rounded-md text-sm font-medium hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors"}," Apply Template ",512),[[_,le(ie.CREATE,ae.WORKSHEET)]])])])),[[D]])])]),e[22]||(e[22]=t("hr",{class:"mt-4 mb-2"},null,-1)),e[23]||(e[23]=t("h3",{class:"font-bold"},"Manual Analyses Assignment",-1)),e[24]||(e[24]=t("hr",{class:"mb-4 mt-2"},null,-1)),t("div",be,[l((r(),n("form",ye,[t("div",he,[t("label",ge,[e[9]||(e[9]=t("span",{class:"text-foreground mr-2"},"SampleType",-1)),l(t("select",{name:"analyses_uids","onUpdate:modelValue":e[2]||(e[2]=s=>c.sampleTypeUid=s),class:"form-input mt-1 block w-full py-1"},[(r(!0),n(u,null,m(A(S).sampleTypes,s=>(r(),n("option",{key:s.uid,value:s.uid},a(s.name),9,xe))),128))],512),[[h,c.sampleTypeUid]])]),t("label",ve,[e[10]||(e[10]=t("span",{class:"text-foreground mr-2"},"Analyses",-1)),l(t("select",{name:"analyses_uids","onUpdate:modelValue":e[3]||(e[3]=s=>c.analysisUid=s),class:"form-input mt-1 block w-full py-1"},[(r(!0),n(u,null,m(A(f).analysesServices,s=>(r(),n("option",{key:s.uid,value:s.uid},a(s.name),9,ke))),128))],512),[[h,c.analysisUid]])]),t("div",we,[l(C(i,{onClick:e[4]||(e[4]=w(s=>Q(),["prevent"])),color:"sky-800",class:"p-1"},{default:M(()=>e[11]||(e[11]=[N("Apply Filters")])),_:1},512),[[_,!0]])])])])),[[J]])]),t("div",_e,[t("div",Ae,[A(d).fetchingAnalysisResults?(r(),n("div",Ce,[C(v,{message:"Fetching analytes ..."})])):(r(),n("table",Se,[t("thead",null,[t("tr",null,[t("th",Te,[l(t("input",{type:"checkbox",onChange:z,"onUpdate:modelValue":e[5]||(e[5]=s=>p.value=s)},null,544),[[j,p.value]])]),e[12]||(e[12]=t("th",{class:"px-1 py-1 border-b-2 border-border text-left leading-4 text-foreground tracking-wider"},null,-1)),e[13]||(e[13]=t("th",{class:"px-1 py-1 border-b-2 border-border text-left leading-4 text-foreground tracking-wider"}," Sample ID ",-1)),e[14]||(e[14]=t("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Analysis ",-1)),e[15]||(e[15]=t("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Date Created ",-1)),e[16]||(e[16]=t("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Date Received ",-1)),e[17]||(e[17]=t("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Status ",-1))])]),l((r(),n("tbody",Ue,[(r(!0),n(u,null,m(b.value,s=>(r(),n("tr",{key:s?.uid},[t("td",null,[l(t("input",{type:"checkbox","onUpdate:modelValue":E=>s.checked=E,onChange:E=>L()},null,40,Be),[[j,s.checked]])]),e[18]||(e[18]=t("td",{class:"px-1 py-1 whitespace-no-wrap border-b border-border"},null,-1)),t("td",We,[t("div",De,a(s?.sample?.sampleId),1)]),t("td",Ee,[t("div",Ve,a(s?.analysis?.name),1)]),t("td",Fe,[t("div",Me,a(s?.sample?.createdAt),1)]),t("td",Ne,[t("div",je,a(s?.sample?.dateReceived),1)]),t("td",Ye,[t("div",qe,a(s?.sample?.status),1)])]))),128))])),[[D]])]))])]),t("section",He,[t("form",Ie,[t("div",Qe,[e[20]||(e[20]=t("span",{class:"text-foreground"},"Apply QC Template",-1)),t("label",Re,[l(t("select",{class:"form-select block w-full py-1","onUpdate:modelValue":e[6]||(e[6]=s=>x.value=s)},[e[19]||(e[19]=t("option",null,null,-1)),(r(!0),n(u,null,m(I.value,s=>(r(),n("option",{key:s.uid,value:s.uid},a(s.name),9,$e))),128))],512),[[h,x.value]])])])]),l(C(i,{onClick:w(R,["prevent"]),color:"orange-600"},{default:M(()=>e[21]||(e[21]=[N("Assign Analyses")])),_:1},512),[[_,!0]])])],64)}}}),Je=re(Le,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/worksheet/_id/WorkSheetAssign.vue"]]);export{Je as default};
