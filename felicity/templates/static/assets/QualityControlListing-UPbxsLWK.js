const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vue-multiselect.esm-CZOh13og.js","assets/index-Cdc6vSVw.js","assets/index-B3SP4dh7.css","assets/FelDataTable-B98pg9sE.js"])))=>i.map(i=>d[i]);
import{a0 as ae,a7 as y,u as le,f as ne,as as re,g as Q,h as p,ad as ie,a1 as j,a6 as O,at as F,a8 as q,_ as ue,r as P,c as g,o as v,a as m,A as o,C as de,E as N,N as b,F as H,D as w,P as J,H as ce,J as V,K,L as me,a9 as fe}from"./index-Cdc6vSVw.js";import{u as pe}from"./setup-CYxvLUvq.js";import{u as ve}from"./analysis-C80mPHS9.js";import{s as ge}from"./index-Df7aGkrY.js";import{j as be}from"./analyses.mutations-DiZ_xJnn.js";import{p as Se}from"./index-DUkUXZe3.js";const he=ae({__name:"QualityControlListing",setup(W,{expose:e}){e();const k=j(()=>O(()=>import("./vue-multiselect.esm-CZOh13og.js"),__vite__mapDeps([0,1,2]))),t=j(()=>O(()=>import("./FelDataTable-B98pg9sE.js"),__vite__mapDeps([3,1,2]))),M=y([{name:"All",value:""},{name:"Pending",value:"pending"},{name:"Awaiting",value:"awaiting"},{name:"Approved",value:"approved"}]),L=y([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Date Created",value:"createdAt",sortable:!1,defaultSort:!0,showInToggler:!1,hidden:!1,customRender:function(s,a){return q("div",Se(s.createdAt))}},{name:"Run Sets (samples)",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(s,a){return q("div",E(s.samples??[]))}},{name:"Test(s)",value:"code",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(s,a){return q("div",I(s.samples??[]))}},{name:"Status",value:"status",sortable:!1,defaultSort:!1,showInToggler:!0},{name:"",value:"",sortable:!1,hidden:!1,showInToggler:!1,customRender:function(s,a){return q(F,{to:{name:"qc-set-detail",params:{qcSetUid:s.uid}},class:"px-2 mr-2 border-primary border text-gray-500rounded-smtransition duration-300 hover:bg-primary hover:text-primary-foreground focus:outline-none",innerHTML:"View Run Set"})}}]),i=le(),u=ve(),S=pe(),{withClientMutation:l}=ne(),{qcSets:h,fetchingQCSets:d}=re(i);let A=Q({first:void 0,after:"",text:"",sortBy:["name"]});u.fetchAnalysesServices(A),u.fetchQCLevels(),u.fetchQCTemplates(),u.fetchAnalysesProfiles(),S.fetchDepartments({}),i.resetQCSets();let C=y(25),R=p(()=>`Showing ${h?.value?.length} of ${i.getQCSetCount} QC Sets`),r=Q({first:C.value,after:"",status:"",sortBy:["-uid"],filterAction:!1});i.fetchQCSets(r);function Z(s){r.first=25,r.after="",r.status=s.filterStatus,r.filterAction=!0,i.fetchQCSets(r)}const z=p(()=>u.getAnalysesProfiles),G=p(()=>{const s=u.getAnalysesServicesSimple;let a=new Set;return s.forEach(n=>{n.profiles?.length===0&&a.add(n)}),[...a]});let _=y(!1),x=y(!0),f=Q({departmentUid:void 0,samples:[]});ie(()=>T());function T(){f.samples?.push({qcTemplate:void 0,qcLevels:[],analysisProfiles:[],analysisServices:[]})}function U(){const s=f.samples?.map(a=>({qcTemplateUid:a.qcTemplate?.uid,qcLevels:a.qcLevels?.map(n=>n.uid),analysisProfiles:a.analysisProfiles?.map(n=>n.uid),analysisServices:a.analysisServices?.map(n=>n.uid)}));l(be,{samples:s},"createQcSet").then(a=>i.addQCSets(a?.qcSets))}function X(s){f.samples?.splice(s,1)}function Y(s,a){x.value=s,_.value=!0,s?Object.assign(f,{}):Object.assign(f,{...a})}function $(){x.value===!0&&U(),_.value=!1}const D=p(()=>i.getQCSetPageInfo);function ee(){r.first=+C.value,r.after=D?.value?.pageInfo?.endCursor??"",r.text="",r.filterAction=!1,i.fetchQCSets(r)}function E(s){let a=[];return s?.forEach(n=>{n?.sampleId+""+n.status;let c=n?.qcLevel?.level?.match(/\b([A-Z])/g).join("")+" ("+n.status+")";a.includes(c)||a.push(c)}),a.join(", ")}function I(s){let a=[];return s?.forEach(n=>{n?.profiles?.forEach(c=>{a.includes(c.name)||a.push(c.name)})}),s?.forEach(n=>{n?.analyses?.forEach(c=>{a.includes(c.name)||a.push(c.name)})}),a.join(", ")}const te=p(()=>S.getDepartments),se=p(()=>u.getQCTemplates),oe=p(()=>u.getQCLevels),B={VueMultiselect:k,DataTable:t,filterOptions:M,tableColumns:L,sampleStore:i,analysisStore:u,setupStore:S,withClientMutation:l,qcSets:h,fetchingQCSets:d,get analysesParams(){return A},set analysesParams(s){A=s},get qcSetBatch(){return C},set qcSetBatch(s){C=s},get qcSetCount(){return R},set qcSetCount(s){R=s},get qcSetParams(){return r},set qcSetParams(s){r=s},searchQCSets:Z,analysesProfiles:z,analysesServices:G,get showModal(){return _},set showModal(s){_=s},get formAction(){return x},set formAction(s){x=s},get form(){return f},set form(s){f=s},addQCSet:T,addQCRequest:U,removeQCSet:X,FormManager:Y,saveForm:$,pageInfo:D,showMoreQCSets:ee,qcSetSamples:E,qcSetProfileAnalyses:I,departments:te,qcTemplates:se,qcLevels:oe,get RouterLink(){return F},get shield(){return ge}};return Object.defineProperty(B,"__isScriptSetup",{enumerable:!1,value:!0}),B}}),ye={class:"flex justify-start items-start gap-x-4"},Ce={class:"rounded-lg border border-border bg-card shadow-sm p-6"},_e={action:"post",class:"mb-8 bg-background"},xe={class:"grid grid-cols-3 gap-x-4 mb-4"},qe={class:"block col-span-1"},we=["value"],Ae={id:"samples"},Qe={class:"flex justify-between items-center py-2"},Pe={class:"flex items-center justify-between"},Ve={class:""},ke={class:"grid grid-cols-4 gap-x-4"},Me={class:"block col-span-1 mb-2"},Le={class:"block col-span-1 mb-2"},Re={class:"block col-span-1 mb-2"},Te={class:"block col-span-1 mb-2"},Ue={class:"ml-4"},De=["onClick"];function Ee(W,e,k,t,M,L){const i=P("fel-button"),u=P("fel-heading"),S=P("fel-modal");return v(),g(V,null,[m(u,{title:"Reference Runs (QC)"},{default:b(()=>[o("div",ye,[H(m(i,{onClick:e[0]||(e[0]=w(l=>t.showModal=!t.showModal,["prevent"]))},{default:b(()=>[...e[5]||(e[5]=[J(" Add Reference Runs ",-1)])]),_:1},512),[[ce,t.shield.hasRights(t.shield.actions.CREATE,t.shield.objects.SAMPLE)]]),m(t.RouterLink,{to:"/quality-control/charts",id:"control-charts",class:"px-4 py-2 bg-accent text-accent-foreground rounded-md hover:bg-accent/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-accent/50"},{default:b(()=>[...e[6]||(e[6]=[J(" View Run Charts ",-1)])]),_:1})])]),_:1}),o("div",Ce,[m(t.DataTable,{columns:t.tableColumns,data:t.qcSets,toggleColumns:!0,loading:t.fetchingQCSets,paginable:!0,pageMeta:{fetchCount:t.qcSetParams.first,hasNextPage:t.pageInfo?.pageInfo?.hasNextPage,qcSetCount:t.qcSetCount},searchable:!1,onOnSearch:t.searchQCSets,filterable:!0,filterMeta:{defaultFilter:t.qcSetParams.status,filters:t.filterOptions},onOnPaginate:t.showMoreQCSets,selectable:!1},{footer:b(()=>[...e[7]||(e[7]=[])]),_:1},8,["columns","data","loading","pageMeta","filterMeta"])]),t.showModal?(v(),de(S,{key:0,onClose:e[4]||(e[4]=l=>t.showModal=!1),contentWidth:"w-4/5"},{header:b(()=>[...e[8]||(e[8]=[o("h3",null,"Create QC Analyses Requests",-1)])]),body:b(()=>[o("form",_e,[o("div",xe,[o("label",qe,[e[10]||(e[10]=o("span",{class:"text-foreground"},"Department",-1)),H(o("select",{name:"clientContacts",id:"clientContacts","onUpdate:modelValue":e[1]||(e[1]=l=>t.form.departmentUid=l),class:"form-input mt-1 block w-full"},[e[9]||(e[9]=o("option",{value:""},null,-1)),(v(!0),g(V,null,K(t.departments,l=>(v(),g("option",{key:l.uid,value:l.uid},me(l.name),9,we))),128))],512),[[fe,t.form.departmentUid]])])]),o("section",Ae,[e[17]||(e[17]=o("hr",null,null,-1)),o("div",Qe,[e[11]||(e[11]=o("h5",null,"Add Control Samples",-1)),t.form.samples?.length<20?(v(),g("button",{key:0,onClick:e[2]||(e[2]=w(l=>t.addQCSet(),["prevent"])),class:"px-2 py-1 mr-2 border-primary border text-primary rounded-sm transition duration-300 hover:bg-primary hover:text-primary-foreground focus:outline-none"},"Add QCSet")):N("",!0)]),e[18]||(e[18]=o("hr",{class:"mb-4"},null,-1)),(v(!0),g(V,null,K(t.form.samples,(l,h)=>(v(),g("div",{key:h},[o("div",Pe,[o("div",Ve,[o("div",ke,[o("label",Me,[e[12]||(e[12]=o("span",{class:"text-foreground"},"QC Template",-1)),m(t.VueMultiselect,{class:"max-w-[300px]",modelValue:l.qcTemplateUid,"onUpdate:modelValue":d=>l.qcTemplateUid=d,options:t.qcTemplates,multiple:!1,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","onUpdate:modelValue","options"])]),o("label",Le,[e[13]||(e[13]=o("span",{class:"text-foreground"},"QC Levels",-1)),m(t.VueMultiselect,{class:"max-w-[300px]",modelValue:l.qcLevels,"onUpdate:modelValue":d=>l.qcLevels=d,options:t.qcLevels,multiple:!0,searchable:!0,label:"level","track-by":"uid"},null,8,["modelValue","onUpdate:modelValue","options"])]),o("label",Re,[e[14]||(e[14]=o("span",{class:"text-foreground"},"Analysis Profiles",-1)),m(t.VueMultiselect,{class:"max-w-[300px]",modelValue:l.analysisProfiles,"onUpdate:modelValue":d=>l.analysisProfiles=d,options:t.analysesProfiles,multiple:!0,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","onUpdate:modelValue","options"])]),o("label",Te,[e[15]||(e[15]=o("span",{class:"text-foreground"},"Analysis Services",-1)),m(t.VueMultiselect,{class:"max-w-[300px]",modelValue:l.analysisServices,"onUpdate:modelValue":d=>l.analysisServices=d,options:t.analysisStore.getAnalysesServicesSimple,multiple:!0,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","onUpdate:modelValue","options"])])])]),o("div",Ue,[o("button",{onClick:w(d=>t.removeQCSet(h),["prevent"]),class:"px-2 py-1 mr-2 border-destructive border text-orange-600rounded-smtransition duration-300 hover:bg-destructive hover:text-primary-foreground focus:outline-none"},"Remove",8,De)])]),e[16]||(e[16]=o("hr",null,null,-1))]))),128))]),e[19]||(e[19]=o("hr",null,null,-1)),o("button",{type:"button",onClick:e[3]||(e[3]=w(l=>t.saveForm(),["prevent"])),class:"-mb-4 w-full border border-primary bg-primary text-primary-foreground rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-primary focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):N("",!0)],64)}const He=ue(he,[["render",Ee],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/qcontrol/QualityControlListing.vue"]]);export{He as default};
