const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DataTable-DLBrhw2Z.js","assets/index-OdhKCqIc.js","assets/index-DD18L2yL.css","assets/TooltipTrigger-BWIYwmnQ.js","assets/PopperContent-BfyCnGUj.js","assets/Input-BEm5S0CJ.js","assets/SelectValue-Ds0cfAgl.js","assets/useNonce-B4v0IDPb.js","assets/chevron-down-Dqf-ptA3.js","assets/useFocusGuards-Bjb6OG0k.js","assets/Spinner-Bl8RfjFA.js","assets/BillDetail-BVRW0toL.js","assets/billing-COaJ61t1.js","assets/billing.queries-CxKPIhZs.js","assets/billing.mutations-BKsnFCTJ.js","assets/index.esm-BfHj8iGm.js","assets/FormMessage-CgXFMXx9.js","assets/FormLabel-DxP9wnWS.js","assets/Label-CS46LzLb.js","assets/BillDetail-Sa9oDNZ-.css"])))=>i.map(i=>d[i]);
import{Y as j,aB as Y,a0 as m,av as K,ah as q,a7 as G,a8 as H,a5 as w,a6 as I,aD as n,_ as J,c as Q,o as D,z as g,a as r,K as s,M as u,A as W,C as X,F as Z}from"./index-OdhKCqIc.js";import{u as $}from"./billing-COaJ61t1.js";import{S as ee,a as te,b as le,c as ae,d as re}from"./SelectValue-Ds0cfAgl.js";import{L as se}from"./Label-CS46LzLb.js";import{C as ne,a as ie}from"./CardContent-Ds7WIX9a.js";import"./billing.queries-CxKPIhZs.js";import"./useNonce-B4v0IDPb.js";import"./chevron-down-Dqf-ptA3.js";import"./useFocusGuards-Bjb6OG0k.js";import"./PopperContent-BfyCnGUj.js";const oe=j({__name:"BillingListing",setup(T,{expose:a}){a();const _=w(()=>I(()=>import("./DataTable-DLBrhw2Z.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),t=w(()=>I(()=>import("./BillDetail-BVRW0toL.js"),__vite__mapDeps([11,1,2,12,13,14,15,5,16,17,18,6,7,8,9,4,19]))),p=$(),{bills:v,billPageInfo:c,fetchingBills:F}=Y(p),b=m(!1),C=m(void 0);function B(e){return{pending:"bg-yellow-100 text-yellow-800",received:"bg-blue-100 text-blue-800",approved:"bg-green-100 text-green-800",published:"bg-purple-100 text-purple-800",rejected:"bg-red-100 text-red-800",cancelled:"bg-gray-100 text-gray-800"}[e?.toLowerCase()]||"bg-gray-100 text-gray-800"}function h(e){C.value=e,b.value=!0}function N(){b.value=!1,C.value=void 0}const L=m([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Bill #",value:"billId",sortable:!1,hidden:!1,customRender:function(e,d){return n("button",{onClick:()=>h(e),type:"button",class:"px-2 py-1 font-semibold rounded-md hover:underline transition-colors duration-200 text-left cursor-pointer"},e?.billId||"—")}},{name:"Client",value:"client.name",sortable:!1,hidden:!1},{name:"Patient",value:"",sortable:!1,hidden:!1,customRender:function(e,d){if(!e?.orders||e.orders.length===0)return n("span","—");const i=e.orders[0]?.patient;if(!i)return n("span","—");const o=`${i?.firstName||""} ${i?.lastName||""}`.trim(),x=i?.gender?` (${i.gender})`:"";return n("span",`${o}${x}`)}},{name:"Samples",value:"",sortable:!1,hidden:!1,customRender:function(e,d){if(!e?.orders||e.orders.length===0)return n("span","—");const i=[];return e.orders.forEach((o,x)=>{o.samples&&o.samples.length>0&&o.samples.forEach((S,z)=>{const O=B(S?.status);i.push(n("div",{key:`${x}-${z}`,class:"mb-2"},[n("span",{class:"font-mono text-sm"},S?.sampleId||"—"),n("span",{class:"mx-2"},"•"),n("span",{class:`text-xs px-2 py-1 rounded ${O}`},S?.status||"—")]))})}),n("div",i.length>0?i:n("span","—"))}},{name:"Amount Charged",value:"totalCharged",sortable:!1,hidden:!1,customRender:function(e,d){return n("span",`$${parseFloat(e?.totalCharged||0).toFixed(2)}`)}},{name:"Amount Paid",value:"totalPaid",sortable:!1,hidden:!1,customRender:function(e,d){return n("span",`$${parseFloat(e?.totalPaid||0).toFixed(2)}`)}},{name:"Balance",value:"",sortable:!1,hidden:!1,customRender:function(e,d){const i=parseFloat(e?.totalCharged||0)-parseFloat(e?.totalPaid||0),o=i>0?"text-red-600":"text-green-600";return n("span",{class:o},`$${i.toFixed(2)}`)}},{name:"Partial",value:"partial",sortable:!1,hidden:!1,customRender:function(e,d){const i=e?.partial?"Yes":"No",o=e?.partial?"bg-orange-100 text-orange-800":"bg-green-100 text-green-800";return n("span",{class:`px-2 py-1 rounded text-sm font-medium ${o}`},i)}},{name:"Status",value:"isActive",sortable:!1,hidden:!1,customRender:function(e,d){const i=e?.isActive?"Active":"Inactive",o=e?.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800";return n("span",{class:`px-2 py-1 rounded text-sm font-medium ${o}`},i)}},{name:"Date",value:"createdAt",sortable:!1,hidden:!1,customRender:function(e,d){return n("span",new Date(e?.createdAt).toLocaleDateString())}}]);let l=K({pageSize:50,afterCursor:"",beforeCursor:"",text:"",isActive:null,partial:null,clientUid:"",sortBy:["-uid"],filterAction:!1});const A=m(null),y=m(null);q(()=>{f()});async function f(){await p.searchBills({pageSize:l.pageSize,afterCursor:l.afterCursor||void 0,beforeCursor:l.beforeCursor||void 0,text:l.text||void 0,isActive:l.isActive!==null?l.isActive:void 0,partial:l.partial!==null?l.partial:void 0,clientUid:l.clientUid||void 0,sortBy:l.sortBy})}function R(e){e==="all"?l.partial=null:e==="partial"?l.partial=!0:e==="complete"&&(l.partial=!1),l.afterCursor="",l.beforeCursor="",l.filterAction=!0,A.value=e,f()}function V(e){e==="all"?l.isActive=null:e==="active"?l.isActive=!0:e==="inactive"&&(l.isActive=!1),l.afterCursor="",l.beforeCursor="",l.filterAction=!0,y.value=e,f()}function U(e){l.pageSize=100,l.afterCursor="",l.beforeCursor="",l.text=e.filterText,l.filterAction=!0,f()}function E(e){l.pageSize=e.fetchCount,l.afterCursor=c?.value?.endCursor??"",l.beforeCursor="",l.text=e.filterText,l.filterAction=!1,f()}function M(e){l.isActive=e,l.afterCursor="",l.beforeCursor="",l.filterAction=!0,f()}const k=G(()=>`${v?.value?.length} of ${c?.value?.totalCount??0} bills`),P={DataTable:_,BillDetail:t,billingStore:p,bills:v,billPageInfo:c,fetchingBills:F,showBillDetail:b,selectedBill:C,getStatusBadgeClass:B,openBillDetail:h,closeBillDetail:N,tableColumns:L,get billParams(){return l},set billParams(e){l=e},selectedPartial:A,selectedIsActive:y,fetchBills:f,handlePartialFilter:R,handleIsActiveFilter:V,searchBills:U,showMoreBills:E,filterByStatus:M,countNone:k,Drawer:H,get Select(){return re},get SelectContent(){return ae},get SelectItem(){return le},get SelectTrigger(){return te},get SelectValue(){return ee},get Label(){return se},get Card(){return ie},get CardContent(){return ne}};return Object.defineProperty(P,"__isScriptSetup",{enumerable:!1,value:!0}),P}}),de={class:"space-y-4"},ue={class:"flex flex-wrap items-end gap-4"},ce={class:"min-w-[180px] space-y-1.5"},fe={class:"min-w-[180px] space-y-1.5"};function me(T,a,_,t,p,v){return D(),Q(Z,null,[g("div",de,[g("div",ue,[g("div",ce,[r(t.Label,{for:"billing-type"},{default:s(()=>[...a[2]||(a[2]=[u("Billing Type",-1)])]),_:1}),r(t.Select,{"model-value":t.selectedPartial??"all","onUpdate:modelValue":a[0]||(a[0]=c=>t.handlePartialFilter(c))},{default:s(()=>[r(t.SelectTrigger,{id:"billing-type",class:"w-full"},{default:s(()=>[r(t.SelectValue,{placeholder:"All Types"})]),_:1}),r(t.SelectContent,null,{default:s(()=>[r(t.SelectItem,{value:"all"},{default:s(()=>[...a[3]||(a[3]=[u("All Types",-1)])]),_:1}),r(t.SelectItem,{value:"complete"},{default:s(()=>[...a[4]||(a[4]=[u("Complete Bills",-1)])]),_:1}),r(t.SelectItem,{value:"partial"},{default:s(()=>[...a[5]||(a[5]=[u("Partial Bills",-1)])]),_:1})]),_:1})]),_:1},8,["model-value"])]),g("div",fe,[r(t.Label,{for:"bill-status"},{default:s(()=>[...a[6]||(a[6]=[u("Bill Status",-1)])]),_:1}),r(t.Select,{"model-value":t.selectedIsActive??"all","onUpdate:modelValue":a[1]||(a[1]=c=>t.handleIsActiveFilter(c))},{default:s(()=>[r(t.SelectTrigger,{id:"bill-status",class:"w-full"},{default:s(()=>[r(t.SelectValue,{placeholder:"All Status"})]),_:1}),r(t.SelectContent,null,{default:s(()=>[r(t.SelectItem,{value:"all"},{default:s(()=>[...a[7]||(a[7]=[u("All Status",-1)])]),_:1}),r(t.SelectItem,{value:"active"},{default:s(()=>[...a[8]||(a[8]=[u("Active",-1)])]),_:1}),r(t.SelectItem,{value:"inactive"},{default:s(()=>[...a[9]||(a[9]=[u("Inactive",-1)])]),_:1})]),_:1})]),_:1},8,["model-value"])])]),r(t.Card,null,{default:s(()=>[r(t.CardContent,{class:"pt-4"},{default:s(()=>[r(t.DataTable,{columns:t.tableColumns,data:t.bills,toggleColumns:!0,loading:t.fetchingBills,paginable:!0,pageMeta:{fetchCount:t.billParams.pageSize,hasNextPage:t.billPageInfo?.hasNextPage,countNone:t.countNone},searchable:!0,filterable:!1,onOnSearch:t.searchBills,onOnPaginate:t.showMoreBills,selectable:!1},null,8,["columns","data","loading","pageMeta"])]),_:1})]),_:1})]),r(t.Drawer,{show:t.showBillDetail,onClose:t.closeBillDetail,"content-width":"w-2/4"},{header:s(()=>[...a[10]||(a[10]=[g("span",null,"Bill Details",-1)])]),body:s(()=>[t.selectedBill?(D(),W(t.BillDetail,{key:0,customerUid:t.selectedBill?.patientUid??"",testBill:t.selectedBill},null,8,["customerUid","testBill"])):X("",!0)]),_:1},8,["show"])],64)}const Ae=J(oe,[["render",me],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/billing/BillingListing.vue"]]);export{Ae as default};
