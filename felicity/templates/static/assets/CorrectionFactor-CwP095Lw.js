import{Y as P,u as z,aw as Y,a0 as C,an as G,a7 as H,bb as K,a9 as W,aa as J,ab as Q,ad as X,ae as Z,af as j,a3 as $,_ as ee,c as S,o as s,a as t,z as m,A as v,C as te,K as r,M as n,F as T,H as I,I as c,B as re,a4 as ae}from"./index-OdhKCqIc.js";import{c as oe,d as le,a as L,u as ne,F as de}from"./index.esm-BfHj8iGm.js";import{F as ie,G as se}from"./analyses.mutations-DUxQZn1r.js";import{u as me}from"./analysis-PB9AMevg.js";import{u as ue}from"./setup-BcFG_bXr.js";import{I as ce}from"./Input-BEm5S0CJ.js";import{F as fe,a as ge,b as Fe}from"./FormMessage-CgXFMXx9.js";import{F as be}from"./FormLabel-DxP9wnWS.js";import{S as _e,a as Ce,b as Se,c as ve,d as Te}from"./SelectValue-Ds0cfAgl.js";import{P as ye}from"./PageHeading-Czi_4opS.js";import"./Label-CS46LzLb.js";import"./useNonce-B4v0IDPb.js";import"./chevron-down-Dqf-ptA3.js";import"./useFocusGuards-Bjb6OG0k.js";import"./PopperContent-BfyCnGUj.js";const M="__none__",he=P({__name:"CorrectionFactor",props:{analysis:{type:Object,required:!0,default:()=>({})},analysisUid:{type:String,required:!0,default:""}},setup(U,{expose:a}){a();const g=me(),e=ue(),{withClientMutation:F}=z(),b=U,{analysis:l}=Y(b);let i=C(!1),y=C("");const _=C(!0),f=C(null),E=oe({instrumentUid:L().trim().required("Instrument is required"),methodUid:L().trim().required("Method is required"),factor:le().typeError("Factor must be a number").required("Factor is required")}),{handleSubmit:N,resetForm:A,setValues:p,setFieldValue:h}=ne({validationSchema:E,initialValues:{instrumentUid:"",methodUid:"",factor:""}});G(()=>b.analysisUid,(o,d)=>{}),e.fetchInstruments();const x=H(()=>e.getInstruments);e.fetchMethods();const w=H(()=>e.getMethods);function O(o){h("instrumentUid",o===M?"":o)}function R(o){h("methodUid",o===M?"":o)}function V(o){F(ie,{payload:o},"createAnalysisCorrectionFactor").then(d=>g.AddAnalysisCorrectionFactor(d))}function k(o){f.value&&F(se,{uid:f.value,payload:o},"updateAnalysisCorrectionFactor").then(d=>g.updateAnalysisCorrectionFactor(d))}function q(o,d={}){_.value=o,i.value=!0,y.value=(o?"CREATE":"EDIT")+" ANALYSIS CORRECTION FACTOR",o?(f.value=null,A({values:{instrumentUid:"",methodUid:"",factor:""}})):(f.value=d.uid??null,p({instrumentUid:d.instrumentUid??"",methodUid:d.methodUid??"",factor:d.factor??""}))}const D=N(o=>{const d=l?.value?.uid;if(!d)return;const u={instrumentUid:o.instrumentUid,methodUid:o.methodUid,factor:Number(o.factor),analysisUid:d};_.value===!0&&V(u),_.value===!1&&k(u),i.value=!1}),B={SELECT_NONE:M,analysisStore:g,setupStore:e,withClientMutation:F,props:b,analysis:l,get showModal(){return i},set showModal(o){i=o},get formTitle(){return y},set formTitle(o){y=o},formAction:_,currentUid:f,correctionSchema:E,handleSubmit:N,resetForm:A,setValues:p,setFieldValue:h,instruments:x,methods:w,onInstrumentChange:O,onMethodChange:R,addAnalysisCorrectionFactor:V,editAnalysisCorrectionFactor:k,FormManager:q,saveForm:D,instrumentName:o=>{const d=x?.value?.findIndex(u=>u.uid===o);return x?.value[d]?.name||"unknown"},methodName:o=>{const d=w?.value?.findIndex(u=>u.uid===o);return w?.value[d]?.name||"unknown"},get Button(){return $},get Input(){return ce},get FormControl(){return Fe},get FormField(){return de},get FormItem(){return ge},get FormLabel(){return be},get FormMessage(){return fe},get Select(){return Te},get SelectContent(){return ve},get SelectItem(){return Se},get SelectTrigger(){return Ce},get SelectValue(){return _e},get Table(){return j},get TableBody(){return Z},get TableCell(){return X},get TableHead(){return Q},get TableHeader(){return J},get TableRow(){return W},Modal:K,PageHeading:ye};return Object.defineProperty(B,"__isScriptSetup",{enumerable:!1,value:!0}),B}}),xe={class:"mt-4 border border-border bg-card rounded-lg shadow-md"},we={class:"relative w-full overflow-auto"},Ie={class:"text-lg font-bold text-foreground"},Me={class:"space-y-4"},Ue={class:"grid grid-cols-3 gap-4"},Ee={class:"pt-4"};function Ne(U,a,g,e,F,b){return s(),S(T,null,[t(e.PageHeading,{title:"Correction Factors"},{default:r(()=>[t(e.Button,{onClick:a[0]||(a[0]=l=>e.FormManager(!0))},{default:r(()=>[...a[3]||(a[3]=[n("Add Correction Factor",-1)])]),_:1})]),_:1}),m("div",xe,[m("div",we,[t(e.Table,{class:"w-full caption-bottom text-sm"},{default:r(()=>[t(e.TableHeader,{class:"[&_tr]:border-b"},{default:r(()=>[t(e.TableRow,{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:r(()=>[t(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:r(()=>[...a[4]||(a[4]=[n("Instrument",-1)])]),_:1}),t(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:r(()=>[...a[5]||(a[5]=[n("Method",-1)])]),_:1}),t(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:r(()=>[...a[6]||(a[6]=[n("Factor",-1)])]),_:1}),t(e.TableHead,{class:"h-12 px-4 text-right align-middle font-medium text-muted-foreground"},{default:r(()=>[...a[7]||(a[7]=[n("Actions",-1)])]),_:1})]),_:1})]),_:1}),t(e.TableBody,{class:"[&_tr:last-child]:border-0"},{default:r(()=>[(s(!0),S(T,null,I(e.analysis?.correctionFactors,l=>(s(),v(e.TableRow,{key:l?.uid,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:r(()=>[t(e.TableCell,{class:"px-4 py-3 align-middle whitespace-nowrap text-sm text-foreground"},{default:r(()=>[n(c(e.instrumentName(l?.instrumentUid)),1)]),_:2},1024),t(e.TableCell,{class:"px-4 py-3 align-middle whitespace-nowrap text-sm text-foreground"},{default:r(()=>[n(c(e.methodName(l?.methodUid)),1)]),_:2},1024),t(e.TableCell,{class:"px-4 py-3 align-middle whitespace-nowrap text-sm text-foreground"},{default:r(()=>[n(c(l.factor),1)]),_:2},1024),t(e.TableCell,{class:"px-4 py-3 align-middle text-right"},{default:r(()=>[t(e.Button,{variant:"outline",size:"sm",onClick:i=>e.FormManager(!1,l)},{default:r(()=>[...a[8]||(a[8]=[n(" Edit ",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])]),e.showModal?(s(),v(e.Modal,{key:0,onClose:a[2]||(a[2]=l=>e.showModal=!1),contentWidth:"w-2/4"},{header:r(()=>[m("h3",Ie,c(e.formTitle),1)]),body:r(()=>[m("form",{onSubmit:a[1]||(a[1]=re((...l)=>e.saveForm&&e.saveForm(...l),["prevent"])),class:"p-6 space-y-6"},[m("div",Me,[m("div",Ue,[t(e.FormField,{name:"instrumentUid"},{default:r(({componentField:l})=>[t(e.FormItem,null,{default:r(()=>[t(e.FormLabel,null,{default:r(()=>[...a[9]||(a[9]=[n("Instrument",-1)])]),_:1}),t(e.FormControl,null,{default:r(()=>[t(e.Select,{"model-value":l.modelValue||e.SELECT_NONE,"onUpdate:modelValue":e.onInstrumentChange},{default:r(()=>[t(e.SelectTrigger,null,{default:r(()=>[t(e.SelectValue,{placeholder:"Select Instrument"})]),_:1}),t(e.SelectContent,null,{default:r(()=>[t(e.SelectItem,{value:e.SELECT_NONE},{default:r(()=>[...a[10]||(a[10]=[n("Select Instrument",-1)])]),_:1}),(s(!0),S(T,null,I(e.instruments,i=>(s(),v(e.SelectItem,{key:i?.uid,value:i.uid},{default:r(()=>[n(c(i?.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1}),t(e.FormField,{name:"methodUid"},{default:r(({componentField:l})=>[t(e.FormItem,null,{default:r(()=>[t(e.FormLabel,null,{default:r(()=>[...a[11]||(a[11]=[n("Method",-1)])]),_:1}),t(e.FormControl,null,{default:r(()=>[t(e.Select,{"model-value":l.modelValue||e.SELECT_NONE,"onUpdate:modelValue":e.onMethodChange},{default:r(()=>[t(e.SelectTrigger,null,{default:r(()=>[t(e.SelectValue,{placeholder:"Select Method"})]),_:1}),t(e.SelectContent,null,{default:r(()=>[t(e.SelectItem,{value:e.SELECT_NONE},{default:r(()=>[...a[12]||(a[12]=[n("Select Method",-1)])]),_:1}),(s(!0),S(T,null,I(e.methods,i=>(s(),v(e.SelectItem,{key:i?.uid,value:i.uid},{default:r(()=>[n(c(i?.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},8,["model-value"])]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1}),t(e.FormField,{name:"factor"},{default:r(({componentField:l})=>[t(e.FormItem,null,{default:r(()=>[t(e.FormLabel,null,{default:r(()=>[...a[13]||(a[13]=[n("Factor",-1)])]),_:1}),t(e.FormControl,null,{default:r(()=>[t(e.Input,ae(l,{type:"number",placeholder:"Factor ..."}),null,16)]),_:2},1024),t(e.FormMessage)]),_:2},1024)]),_:1})])]),m("div",Ee,[t(e.Button,{type:"submit",class:"w-full"},{default:r(()=>[...a[14]||(a[14]=[n("Save Form",-1)])]),_:1})])],32)]),_:1})):te("",!0)],64)}const Je=ee(he,[["render",Ne],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/analyses/services/CorrectionFactor.vue"]]);export{Je as default};
