import{W as G,P as Q,f as X,ak as Y,a8 as ee,a2 as y,a3 as k,al as te,h as se,ap as oe,i as A,r as T,o as l,c as u,a as M,M as f,D as m,O as s,C as R,af as d,E as re,a7 as a,z as ae,F as c,H as S,J as w,L as N,a4 as E,Z as ne,a0 as le,a1 as ie,_ as ue}from"./index-93739211.js";import{u as de}from"./user-3b0a83d1.js";import{c as fe,e as p,u as me,f as h}from"./array-2f9882bb.js";import{h as ce,a as pe,o as he}from"./constants-c5e2e8e5.js";import"./_queries-2ba61825.js";const ge={class:"space-y-6"},ve={class:"rounded-lg border border-border bg-card shadow-sm p-6"},be={class:"space-y-4"},ye={key:0,class:"space-y-1"},ke={action:"post",class:"space-y-6 p-4"},Se={class:"grid grid-cols-3 gap-4"},we={class:"block space-y-2"},xe=["value"],_e={class:"block space-y-2"},We=["value"],Ue={class:"block space-y-2"},Ce={class:"border-t border-border pt-4"},Ae=G({__name:"WorkSheetListing",setup(Te){const B=le(()=>ie(()=>import("./FelDataTable-2f84e0fb.js"),["assets/FelDataTable-2f84e0fb.js","assets/index-93739211.js","assets/index-0f090789.css"])),i=Q(),x=de(),{withClientMutation:L}=X(),{workSheets:_,fetchingWorkSheets:P,workSheetPageInfo:W,workSheetTemplates:D}=Y(i);ee();let n=y(!1);const I=y([{name:"All",value:""},{name:"Pending",value:"pending"},{name:"Awaiting",value:"awaiting"},{name:"Approved",value:"approved"},{name:"Empty",value:"empty"}]),O=y([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"WorkSheet Id",value:"workSheetId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(t,e){return k(te,{to:{name:"worksheet-detail",params:{workSheetUid:t?.uid}},innerHTML:t?.worksheetId})}},{name:"Analysis/Test",value:"analysis.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Samples",value:"assignedCount",sortable:!1,sortBy:"asc",hidden:!1},{name:"Instrument",value:"instrument.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Analyst",value:"clientPatientId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(t,e){return k("div",{innerHTML:C(t?.analyst)})}},{name:"Status",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(t,e){return k("button",{type:"button",class:"bg-primary text-primary-foreground py-1 px-2 rounded-sm leading-none",innerHTML:t?.state||"unknown"})}}]);i.removeWorksheet();let r=se({first:25,before:"",status:"",text:"",sort:["-uid"],filterAction:!1});i.fetchWorkSheets(r),i.fetchWorkSheetTemplates(),x.fetchUsers({});const V=fe({analystUid:p().required("Analyst is Required").typeError("Analyst is Required"),templateUid:p().typeError("Worksheet Template is required"),instrumentUid:p(),count:p().typeError("Required number of worksheets must be defined")}),{handleSubmit:F,errors:U}=me({validationSchema:V,initialValues:{count:1,analystUid:void 0,templateUid:void 0,instrumentUid:void 0}}),{value:g}=h("count"),{value:v}=h("analystUid"),{value:b}=h("templateUid");h("instrumentUid");const H=F(t=>{n.value=!1,L(oe,t,"createWorksheet").then(e=>{i.addWorksheet(e),n.value=!1})});function q(t){r.first=t.fetchCount,r.before=W?.value?.endCursor??"",r.text=t.filterText,r.status=t.filterStatus,r.filterAction=!1,i.fetchWorkSheets(r)}function $(t){r.first=25,r.before="",r.text=t.filterText,r.status=t.filterStatus,r.filterAction=!0,i.fetchWorkSheets(r)}const j=A(()=>x.getUsers),C=t=>t?.auth?.userName?t?.auth?.userName:t?.firstName?t.firstName+" "+t.lastName:"----",z=A(()=>_?.value?.length+" of "+i.getWorkSheetCount+" WorkSheets");return(t,e)=>{const J=T("fel-heading"),K=T("fel-modal");return l(),u(c,null,[M(J,{title:"Worksheets"},{default:f(()=>[m(s("button",{onClick:e[0]||(e[0]=R(o=>d(n)?n.value=!0:n=!0,["prevent"])),class:"px-4 py-2 bg-primary text-primary-foreground rounded-md transition-colors duration-200 hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Add WorkSheet ",512),[[re,ce(pe.CREATE,he.WORKSHEET)]])]),_:1}),s("div",ge,[s("div",ve,[M(a(B),{columns:O.value,data:a(_),toggleColumns:!0,loading:a(P),paginable:!0,pageMeta:{fetchCount:a(r).first,hasNextPage:a(W)?.hasNextPage,countNone:z.value},searchable:!0,filterable:!0,filterMeta:{defaultFilter:a(r).status,filters:I.value},onOnSearch:$,onOnPaginate:q,selectable:!1,class:"bg-background rounded-lg shadow-sm"},{footer:f(()=>e[6]||(e[6]=[])),_:1},8,["columns","data","loading","pageMeta","filterMeta"])]),a(n)?(l(),ae(K,{key:0,onClose:e[5]||(e[5]=o=>d(n)?n.value=!1:n=!1),contentWidth:"w-1/2"},{header:f(()=>[s("div",be,[e[7]||(e[7]=s("h3",{class:"text-lg font-medium"},"Create Worksheet",-1)),e[8]||(e[8]=s("div",{class:"border-t border-border"},null,-1)),Object.keys(a(U)).length>0?(l(),u("ul",ye,[(l(!0),u(c,null,S(Object.values(a(U)),(o,Z)=>(l(),u("li",{key:Z,class:"text-destructive text-sm"},w(o),1))),128))])):N("",!0)])]),body:f(()=>[s("form",ke,[s("div",Se,[s("label",we,[e[9]||(e[9]=s("span",{class:"text-sm font-medium"},"Analyst",-1)),m(s("select",{class:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary","onUpdate:modelValue":e[1]||(e[1]=o=>d(v)?v.value=o:null)},[(l(!0),u(c,null,S(j.value,o=>(l(),u("option",{key:o.uid,value:o.uid},w(C(o)),9,xe))),128))],512),[[E,a(v)]])]),s("label",_e,[e[11]||(e[11]=s("span",{class:"text-sm font-medium"},"Worksheet Template",-1)),m(s("select",{class:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary","onUpdate:modelValue":e[2]||(e[2]=o=>d(b)?b.value=o:null)},[e[10]||(e[10]=s("option",{value:"undefined"},null,-1)),(l(!0),u(c,null,S(a(D),o=>(l(),u("option",{key:o.uid,value:o.uid},w(o.name),9,We))),128))],512),[[E,a(b)]])]),s("label",Ue,[e[12]||(e[12]=s("span",{class:"text-sm font-medium"},"How Many",-1)),m(s("input",{type:"number",class:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary","onUpdate:modelValue":e[3]||(e[3]=o=>d(g)?g.value=o:null),min:"1"},null,512),[[ne,a(g)]])])]),s("div",Ce,[s("button",{type:"button",onClick:e[4]||(e[4]=R(o=>a(H)(),["prevent"])),class:"w-full px-4 py-2 bg-primary text-primary-foreground rounded-md transition-colors duration-200 hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Save Form ")])])]),_:1})):N("",!0)])],64)}}}),Le=ue(Ae,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/worksheet/WorkSheetListing.vue"]]);export{Le as default};
