import{P as F,e as G,aa as N,Z as l,f as j,r as S,o as a,c as p,b as t,F as g,D as T,a1 as h,E as d,x as $,K as k,z as L,L as q,A as f,V as w,a as z,a2 as J,W as K,J as P,ar as Q,as as W,_ as Z}from"./index-d30fd8e2.js";import{U as H}from"./_queries-3ca7633b.js";import{f as I,g as O,h as R}from"./grind.queries-02516afc.js";import X from"./vue-multiselect.esm-26d4ec41.js";const Y=["onDblclick"],ee={class:"absolute left-0 top-0 transform -translate-x-1/2 bg-white p-1 border border-gray-300 rounded-full w-4 h-4 flex items-center justify-center"},te={class:"mb-6"},se={class:"font-medium"},oe={class:"text-sm text-gray-500"},re={class:"text-lg font-semibold"},ne={class:"mb-4"},le={class:"mb-4"},ie={class:"my-4 flex justify-start"},ae={class:"flex justify-end"},de={type:"submit",class:"px-4 py-2 text-sm font-medium text-white bg-sky-600 border border-transparent rounded-md shadow-sm hover:bg-sky-700 focus:outline-none focus:ring-2 focus:ring-sky-500"},ue=F({__name:"ErrandMilestone",props:{errandUid:{type:String,required:!0}},emits:["milestoneUpdated"],setup(M,{emit:U}){const u=M,{withClientMutation:b,withClientQuery:y}=G();N(()=>{m(),A()});const _=U,v=l([]);function m(r="cache-first"){y(I,{errandUid:u.errandUid},"grindMilestonesByErrand",r).then(e=>{e&&(v.value=e)})}const n=l(!1),i=l(!1),c=l(""),o=j({});function C(){n.value=!0,c.value="Add Milestone",i.value=!0,Q(o)}function D(r){n.value=!0,c.value="Edit Milestone",i.value=!1,W(o,r)}function V(){n.value=!1;const r={title:o.title,description:o.description,complete:o.complete,assigneeUid:o.assignee?.uid,errandUid:u.errandUid};i.value?b(O,{payload:{...r,errandUid:u.errandUid}},"createGrindMilestone").then(()=>m("network-only")):b(R,{uid:o.uid,payload:r},"updateGrindMilestone").then(()=>{m("network-only"),_("milestoneUpdated")})}function E({firstName:r,lastName:e}){return`${r} ${e}`}const x=l();function A(){y(H,{first:100},"userAll").then(r=>{x.value=r.items})}return(r,e)=>{const B=S("modal");return a(),p(g,null,[t("div",{class:"flex justify-between items-center"},[e[6]||(e[6]=t("h3",{class:"text-gray-700 font-medium"},"Milestones",-1)),t("button",{class:"text-sm text-gray-600 hover:text-gray-800 flex items-center gap-1",onClick:C},e[5]||(e[5]=[t("span",null,"+ Add New",-1)]))]),(a(!0),p(g,null,T(v.value,s=>(a(),p("div",{key:s.uid,class:h(["pl-6 border-l-2 relative",{"border-green-200":s.complete,"border-red-200":!s.complete}]),onDblclick:me=>D(s)},[t("div",ee,[t("div",{class:h(["w-2 h-2 rounded-full",{"bg-green-500":s.complete,"bg-red-500":!s.complete}])},null,2)]),t("div",te,[t("h4",se,d(s.title),1),t("p",oe,d(s.description),1)])],42,Y))),128)),n.value?(a(),$(B,{key:0,onClose:e[4]||(e[4]=s=>n.value=!1),"content-width":"w-full max-w-2xl"},{header:k(()=>[t("h3",re,d(c.value),1)]),body:k(()=>[t("form",{onSubmit:L(V,["prevent"])},[t("div",ne,[e[7]||(e[7]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1",for:"title"},[q(" Title "),t("span",{class:"text-red-500"},"*")],-1)),f(t("input",{id:"title","onUpdate:modelValue":e[0]||(e[0]=s=>o.title=s),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500",placeholder:"Enter errand title"},null,512),[[w,o.title]])]),t("div",le,[e[8]||(e[8]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1",for:"description"}," Description ",-1)),f(t("textarea",{id:"description","onUpdate:modelValue":e[1]||(e[1]=s=>o.description=s),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500",placeholder:"Enter errand description"},null,512),[[w,o.description]])]),t("div",null,[e[9]||(e[9]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Assignee",-1)),z(J(X),{modelValue:o.assignee,"onUpdate:modelValue":e[2]||(e[2]=s=>o.assignee=s),options:x.value,"track-by":"uid",searchable:!0,"custom-label":E,placeholder:"Select assignee"},null,8,["modelValue","options"])]),t("div",ie,[f(t("input",{id:"complete","onUpdate:modelValue":e[3]||(e[3]=s=>o.complete=s),type:"checkbox",class:"mr-2 px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500"},null,512),[[K,o.complete]]),e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1",for:"complete"}," Complete ",-1))]),t("div",ae,[t("button",de,d(i.value?"Create":"Update"),1)])],32)]),_:1})):P("",!0)],64)}}}),ye=Z(ue,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/grind/_id/ErrandMilestone.vue"]]);export{ye as default};
