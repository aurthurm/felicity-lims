const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vue-multiselect.esm-CntbZnFq.js","assets/index-DApeomWQ.js","assets/index-CfJ_N7IC.css","assets/FelDataTable-CqqGlMhZ.js"])))=>i.map(i=>d[i]);
import{a0 as te,a7 as C,u as se,f as oe,aq as ae,g as Q,h as p,ad as le,a1 as B,a6 as j,ar as N,a8 as _,_ as ne,r as A,c as v,o as f,a as m,A as o,C as re,E as O,N as g,F,D as q,P as H,H as ie,J as P,K as J,L as de,a9 as ue}from"./index-DApeomWQ.js";import{u as ce}from"./setup-HNpvekU2.js";import{u as me}from"./analysis-BTUsl5OO.js";import{s as fe}from"./index-DmuM67UT.js";import{A as pe}from"./analyses.mutations-Bu696l9I.js";import{p as ve}from"./index-BqfY99Wm.js";const ge=te({__name:"QualityControlListing",setup(K,{expose:e}){e();const V=B(()=>j(()=>import("./vue-multiselect.esm-CntbZnFq.js"),__vite__mapDeps([0,1,2]))),t=B(()=>j(()=>import("./FelDataTable-CqqGlMhZ.js"),__vite__mapDeps([3,1,2]))),k=C([{name:"All",value:""},{name:"Pending",value:"pending"},{name:"Awaiting",value:"awaiting"},{name:"Approved",value:"approved"}]),M=C([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Date Created",value:"createdAt",sortable:!1,defaultSort:!0,showInToggler:!1,hidden:!1,customRender:function(s){return _("div",ve(s.createdAt))}},{name:"Run Sets (samples)",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(s){return _("div",D(s.samples??[]))}},{name:"Test(s)",value:"code",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(s){return _("div",E(s.samples??[]))}},{name:"Status",value:"status",sortable:!1,defaultSort:!1,showInToggler:!0},{name:"",value:"",sortable:!1,hidden:!1,showInToggler:!1,customRender:function(s){return _(N,{to:{name:"qc-set-detail",params:{qcSetUid:s.uid}},class:"px-2 mr-2 border border-primary text-muted-foreground rounded-sm transition duration-300 hover:bg-primary hover:text-primary-foreground focus:outline-none",innerHTML:"View Run Set"})}}]),i=se(),d=me(),b=ce(),{withClientMutation:a}=oe(),{qcSets:S,fetchingQCSets:u}=ae(i);let x=Q({first:void 0,after:"",text:"",sortBy:["name"]});d.fetchAnalysesServices(x),d.fetchQCLevels(),d.fetchQCTemplates(),d.fetchAnalysesProfiles(),b.fetchDepartments({}),i.resetQCSets();let y=C(25),L=p(()=>`Showing ${S?.value?.length} of ${i.getQCSetCount} QC Sets`),r=Q({first:y.value,after:"",status:"",sortBy:["-uid"],filterAction:!1});i.fetchQCSets(r);function W(s){r.first=25,r.after="",r.status=s.filterStatus,r.filterAction=!0,i.fetchQCSets(r)}const Z=p(()=>d.getAnalysesProfiles);let w=C(!1),h=Q({departmentUid:void 0,samples:[]});le(()=>R());function R(){h.samples?.push({qcTemplate:void 0,qcLevels:[],analysisProfiles:[],analysisServices:[]})}function T(){const s=h.samples?.map(l=>({qcTemplateUid:l.qcTemplate?.uid,qcLevels:l.qcLevels?.map(n=>n.uid),analysisProfiles:l.analysisProfiles?.map(n=>n.uid),analysisServices:l.analysisServices?.map(n=>n.uid)}));a(pe,{samples:s},"createQcSet").then(l=>i.addQCSets(l?.qcSets))}function z(s){h.samples?.splice(s,1)}function G(){T(),w.value=!1}const U=p(()=>i.getQCSetPageInfo);function X(){r.first=+y.value,r.after=U?.value?.pageInfo?.endCursor??"",r.text="",r.filterAction=!1,i.fetchQCSets(r)}function D(s){let l=[];return s?.forEach(n=>{n?.sampleId+""+n.status;let c=n?.qcLevel?.level?.match(/\b([A-Z])/g).join("")+" ("+n.status+")";l.includes(c)||l.push(c)}),l.join(", ")}function E(s){let l=[];return s?.forEach(n=>{n?.profiles?.forEach(c=>{l.includes(c.name)||l.push(c.name)})}),s?.forEach(n=>{n?.analyses?.forEach(c=>{l.includes(c.name)||l.push(c.name)})}),l.join(", ")}const Y=p(()=>b.getDepartments),$=p(()=>d.getQCTemplates),ee=p(()=>d.getQCLevels),I={VueMultiselect:V,DataTable:t,filterOptions:k,tableColumns:M,sampleStore:i,analysisStore:d,setupStore:b,withClientMutation:a,qcSets:S,fetchingQCSets:u,get analysesParams(){return x},set analysesParams(s){x=s},get qcSetBatch(){return y},set qcSetBatch(s){y=s},get qcSetCount(){return L},set qcSetCount(s){L=s},get qcSetParams(){return r},set qcSetParams(s){r=s},searchQCSets:W,analysesProfiles:Z,get showModal(){return w},set showModal(s){w=s},get form(){return h},set form(s){h=s},addQCSet:R,addQCRequest:T,removeQCSet:z,saveForm:G,pageInfo:U,showMoreQCSets:X,qcSetSamples:D,qcSetProfileAnalyses:E,departments:Y,qcTemplates:$,qcLevels:ee,get RouterLink(){return N},get shield(){return fe}};return Object.defineProperty(I,"__isScriptSetup",{enumerable:!1,value:!0}),I}}),be={class:"flex justify-start items-start gap-x-4"},Se={class:"rounded-lg border border-border bg-card shadow-sm p-6"},he={action:"post",class:"mb-8 bg-background"},ye={class:"grid grid-cols-3 gap-x-4 mb-4"},Ce={class:"block col-span-1"},_e=["value"],qe={id:"samples"},xe={class:"flex justify-between items-center py-2"},we={class:"flex items-center justify-between"},Qe={class:""},Ae={class:"grid grid-cols-4 gap-x-4"},Pe={class:"block col-span-1 mb-2"},Ve={class:"block col-span-1 mb-2"},ke={class:"block col-span-1 mb-2"},Me={class:"block col-span-1 mb-2"},Le={class:"ml-4"},Re=["onClick"];function Te(K,e,V,t,k,M){const i=A("fel-button"),d=A("fel-heading"),b=A("fel-modal");return f(),v(P,null,[m(d,{title:"Reference Runs (QC)"},{default:g(()=>[o("div",be,[F(m(i,{onClick:e[0]||(e[0]=q(a=>t.showModal=!t.showModal,["prevent"]))},{default:g(()=>[...e[5]||(e[5]=[H(" Add Reference Runs ",-1)])]),_:1},512),[[ie,t.shield.hasRights(t.shield.actions.CREATE,t.shield.objects.SAMPLE)]]),m(t.RouterLink,{to:"/quality-control/charts",id:"control-charts",class:"px-4 py-2 bg-accent text-accent-foreground rounded-md hover:bg-accent/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-accent/50"},{default:g(()=>[...e[6]||(e[6]=[H(" View Run Charts ",-1)])]),_:1})])]),_:1}),o("div",Se,[m(t.DataTable,{columns:t.tableColumns,data:t.qcSets,toggleColumns:!0,loading:t.fetchingQCSets,paginable:!0,pageMeta:{fetchCount:t.qcSetParams.first,hasNextPage:t.pageInfo?.pageInfo?.hasNextPage,qcSetCount:t.qcSetCount},searchable:!1,onOnSearch:t.searchQCSets,filterable:!0,filterMeta:{defaultFilter:t.qcSetParams.status,filters:t.filterOptions},onOnPaginate:t.showMoreQCSets,selectable:!1},{footer:g(()=>[...e[7]||(e[7]=[])]),_:1},8,["columns","data","loading","pageMeta","filterMeta"])]),t.showModal?(f(),re(b,{key:0,onClose:e[4]||(e[4]=a=>t.showModal=!1),contentWidth:"w-4/5"},{header:g(()=>[...e[8]||(e[8]=[o("h3",null,"Create QC Analyses Requests",-1)])]),body:g(()=>[o("form",he,[o("div",ye,[o("label",Ce,[e[10]||(e[10]=o("span",{class:"text-foreground"},"Department",-1)),F(o("select",{name:"clientContacts",id:"clientContacts","onUpdate:modelValue":e[1]||(e[1]=a=>t.form.departmentUid=a),class:"form-input mt-1 block w-full"},[e[9]||(e[9]=o("option",{value:""},null,-1)),(f(!0),v(P,null,J(t.departments,a=>(f(),v("option",{key:a.uid,value:a.uid},de(a.name),9,_e))),128))],512),[[ue,t.form.departmentUid]])])]),o("section",qe,[e[17]||(e[17]=o("hr",null,null,-1)),o("div",xe,[e[11]||(e[11]=o("h5",null,"Add Control Samples",-1)),t.form.samples?.length<20?(f(),v("button",{key:0,onClick:e[2]||(e[2]=q(a=>t.addQCSet(),["prevent"])),class:"px-2 py-1 mr-2 border-primary border text-primary rounded-sm transition duration-300 hover:bg-primary hover:text-primary-foreground focus:outline-none"},"Add QCSet")):O("",!0)]),e[18]||(e[18]=o("hr",{class:"mb-4"},null,-1)),(f(!0),v(P,null,J(t.form.samples,(a,S)=>(f(),v("div",{key:S},[o("div",we,[o("div",Qe,[o("div",Ae,[o("label",Pe,[e[12]||(e[12]=o("span",{class:"text-foreground"},"QC Template",-1)),m(t.VueMultiselect,{class:"max-w-[300px]",modelValue:a.qcTemplateUid,"onUpdate:modelValue":u=>a.qcTemplateUid=u,options:t.qcTemplates,multiple:!1,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","onUpdate:modelValue","options"])]),o("label",Ve,[e[13]||(e[13]=o("span",{class:"text-foreground"},"QC Levels",-1)),m(t.VueMultiselect,{class:"max-w-[300px]",modelValue:a.qcLevels,"onUpdate:modelValue":u=>a.qcLevels=u,options:t.qcLevels,multiple:!0,searchable:!0,label:"level","track-by":"uid"},null,8,["modelValue","onUpdate:modelValue","options"])]),o("label",ke,[e[14]||(e[14]=o("span",{class:"text-foreground"},"Analysis Profiles",-1)),m(t.VueMultiselect,{class:"max-w-[300px]",modelValue:a.analysisProfiles,"onUpdate:modelValue":u=>a.analysisProfiles=u,options:t.analysesProfiles,multiple:!0,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","onUpdate:modelValue","options"])]),o("label",Me,[e[15]||(e[15]=o("span",{class:"text-foreground"},"Analysis Services",-1)),m(t.VueMultiselect,{class:"max-w-[300px]",modelValue:a.analysisServices,"onUpdate:modelValue":u=>a.analysisServices=u,options:t.analysisStore.getAnalysesServicesSimple,multiple:!0,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","onUpdate:modelValue","options"])])])]),o("div",Le,[o("button",{onClick:q(u=>t.removeQCSet(S),["prevent"]),class:"px-2 py-1 mr-2 border border-destructive text-destructive rounded-sm transition duration-300 hover:bg-destructive hover:text-primary-foreground focus:outline-none"},"Remove",8,Re)])]),e[16]||(e[16]=o("hr",null,null,-1))]))),128))]),e[19]||(e[19]=o("hr",null,null,-1)),o("button",{type:"button",onClick:e[3]||(e[3]=q(a=>t.saveForm(),["prevent"])),class:"-mb-4 w-full border border-primary bg-primary text-primary-foreground rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-primary focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):O("",!0)],64)}const Ne=ne(ge,[["render",Te],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/qcontrol/QualityControlListing.vue"]]);export{Ne as default};
