import{P as ee,e as te,Z as f,f as T,h as $,aa as se,r as oe,o as i,c as l,a as w,a2 as o,b as e,A as v,V as y,H as ne,L as k,E as d,F as M,D as H,K as N,ak as S,au as I,aX as G,at as F,J as p,x as re,z as ie,a7 as z,X as V,Y as j,_ as le}from"./index-03a7f0eb.js";import{j as ae,k as de,l as ue}from"./grind.queries-4e5f98f5.js";import{U as me}from"./_queries-175415ec.js";const ce={class:"pb-8"},fe={class:"flex justify-between items-center mb-6"},ge={class:"flex space-x-4"},pe={class:"relative"},xe={class:"mb-4 text-sm text-gray-600"},ve={key:0},ye={key:1},be={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},he={class:"p-6"},we={class:"flex justify-between items-start mb-3"},ke=["onClick"],_e={class:"text-gray-600 text-sm mb-4 line-clamp-2"},Ce={class:"flex items-center text-xs text-gray-500 mb-4"},De={class:"flex items-center mr-4"},Me={key:0,class:"mb-4"},Ne={class:"flex items-center"},Se={class:"text-sm"},Ve={key:1},je={class:"flex -space-x-2 overflow-hidden"},Ae=["title"],Be=["title"],Ee={class:"mt-4 pt-3 border-t border-gray-100 text-xs text-gray-500 flex justify-between"},Le={key:0},Pe={key:0,class:"mt-8 flex justify-center"},Ue=["disabled"],Ye={key:0},Te={key:1},$e={key:1,class:"flex flex-col items-center justify-center py-12"},He={class:"text-lg font-semibold"},Ie={class:"mb-4"},Ge={class:"mb-4"},Fe={class:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4"},ze={class:"mb-4"},Oe={class:"mb-6"},Re={class:"flex justify-end"},Ke={type:"submit",class:"px-4 py-2 text-sm font-medium text-white bg-sky-600 border border-transparent rounded-md shadow-sm hover:bg-sky-700 focus:outline-none focus:ring-2 focus:ring-sky-500"},Xe=ee({__name:"SchemeListing",setup(qe){const O=V(()=>j(()=>import("./index-03a7f0eb.js").then(r=>r.cN),["assets/index-03a7f0eb.js","assets/index-81d3252e.css"])),R=V(()=>j(()=>import("./index-03a7f0eb.js").then(r=>r.cM),["assets/index-03a7f0eb.js","assets/index-81d3252e.css"])),A=V(()=>j(()=>import("./vue-multiselect.esm-e5326598.js"),["assets/vue-multiselect.esm-e5326598.js","assets/index-03a7f0eb.js","assets/index-81d3252e.css"])),{withClientMutation:B,withClientQuery:E}=te();let m=f(!1),_=f(""),n=T({});const b=f(!0),x=f(!1),g=f([]),C=f([]);let a=T({first:12,after:"",text:"",sortBy:["created_at"],filterAction:!1});const L=f(0);let h=f({startCursor:"",endCursor:"",hasNextPage:!1,hasPreviousPage:!1});const K=$(()=>g.value.length+" of "+L.value+" schemes"),P=$(()=>x.value);function D(r){x.value=!0,E(ae,{first:r.first,after:r.after,text:r.text,sortBy:r.sortBy},"grindSchemeAll").then(t=>{t&&(g.value=t?.items,L.value=t?.totalCount||0,h.value=t?.pageInfo)}).finally(()=>{x.value=!1})}se(()=>{D(a),X()});function X(){E(me,{first:100,after:"",text:"",sortBy:["first_name"]},"userAll").then(r=>{r&&(C.value=r?.items)})}function U(r){a.first=12,a.after="",a.text=r,a.filterAction=!0,D(a)}function q(){!h.value.hasNextPage||x.value||(a.first=6,a.after=h.value.endCursor,a.filterAction=!1,D(a))}function J(){Object.assign(n,{title:"",description:"",startDate:"",endDate:"",assignee:null,members:[]})}function Y(){b.value=!0,m.value=!0,_.value="Create New Scheme",J()}function Q(r){b.value=!1,m.value=!0,_.value="Edit Scheme",Object.assign(n,{...r})}function Z(){const r=n.members?.map(c=>c.uid)||[],t={title:n.title,description:n.description,startDate:n.startDate,endDate:n.endDate,assignee:n.assignee?.uid,members:r};b.value===!0?B(de,{payload:t},"createGrindScheme").then(c=>{c&&g.value.unshift(c)}):B(ue,{uid:n.uid,payload:t},"updateGrindScheme").then(c=>{if(c){const s=g.value.findIndex(u=>u.uid===c.uid);s!==-1&&(g.value[s]=c)}}),m.value=!1}return(r,t)=>{const c=oe("router-link");return i(),l(M,null,[w(o(R),{title:"Projects"}),e("div",ce,[e("div",fe,[e("div",ge,[e("div",pe,[v(e("input",{type:"text",placeholder:"Search schemes...",class:"px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-sky-500","onUpdate:modelValue":t[0]||(t[0]=s=>o(a).text=s),onKeyup:t[1]||(t[1]=ne(s=>U(o(a).text),["enter"]))},null,544),[[y,o(a).text]]),e("button",{onClick:t[2]||(t[2]=s=>U(o(a).text)),class:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-sky-700"},t[11]||(t[11]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)]))]),e("button",{onClick:Y,class:"px-4 py-2 bg-sky-600 text-white rounded-lg hover:bg-sky-700 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-500"},t[12]||(t[12]=[e("span",{class:"flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),k(" Add Scheme ")],-1)]))])]),e("div",xe,[P.value?(i(),l("span",ve,"Loading schemes...")):(i(),l("span",ye,d(K.value),1))]),e("div",be,[(i(!0),l(M,null,H(g.value,s=>(i(),l("div",{key:s.uid,class:"bg-white rounded-lg shadow-md overflow-hidden border border-gray-200 hover:shadow-lg transition-shadow"},[e("div",he,[e("div",we,[w(c,{to:{name:"scheme-detail",params:{schemeUid:s?.uid}},class:"text-lg font-semibold text-gray-800 truncate"},{default:N(()=>[k(d(s.title),1)]),_:2},1032,["to"]),e("button",{onClick:u=>Q(s),class:"text-gray-500 hover:text-sky-600 transition-colors"},[...t[13]||(t[13]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,ke)]),e("p",_e,d(s.description||"No description provided"),1),e("div",Ce,[e("div",De,[t[14]||(t[14]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),e("span",null,d(o(S)(s.startDate,"D MMMM YYYY"))+" - "+d(o(S)(s.endDate,"D MMMM YYYY")),1)])]),s.assignee?(i(),l("div",Me,[t[15]||(t[15]=e("p",{class:"text-xs text-gray-500 mb-1"},"Assignee:",-1)),e("div",Ne,[e("div",{class:"w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-medium mr-2",style:I({backgroundColor:o(G)(s.assignee.firstName+s.assignee.lastName)})},d(o(F)(s.assignee.firstName,s.assignee.lastName)),5),e("span",Se,d(s.assignee.firstName)+" "+d(s.assignee.lastName),1)])])):p("",!0),s.members&&s.members.length>0?(i(),l("div",Ve,[t[16]||(t[16]=e("p",{class:"text-xs text-gray-500 mb-1"},"Members:",-1)),e("div",je,[(i(!0),l(M,null,H(s.members.slice(0,5),(u,W)=>(i(),l("div",{key:W,class:"w-8 h-8 rounded-full border-2 border-white flex items-center justify-center text-white text-xs font-medium",style:I({backgroundColor:o(G)(u.firstName+u.lastName)}),title:`${u.firstName} ${u.lastName}`},d(o(F)(u.firstName,u.lastName)),13,Ae))),128)),s.members.length>5?(i(),l("div",{key:0,class:"w-8 h-8 rounded-full border-2 border-white flex items-center justify-center bg-gray-300 text-gray-800 text-xs font-medium",title:s.members.slice(5).map(u=>`${u.firstName} ${u.lastName}`).join(", ")}," +"+d(s.members.length-5),9,Be)):p("",!0)])])):p("",!0),e("div",Ee,[e("span",null,"Created "+d(o(S)(s.createdAt,"D MMMM YYYY")),1),s.createdBy?(i(),l("span",Le,"by "+d(s.createdBy.firstName),1)):p("",!0)])])]))),128))]),o(h).hasNextPage?(i(),l("div",Pe,[e("button",{onClick:q,class:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors focus:outline-none focus:ring-2 focus:ring-gray-400",disabled:x.value},[x.value?(i(),l("span",Ye,"Loading...")):(i(),l("span",Te,"Load More"))],8,Ue)])):p("",!0),g.value.length===0&&!P.value?(i(),l("div",$e,[t[18]||(t[18]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-16 w-16 text-gray-300 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1)),t[19]||(t[19]=e("h3",{class:"text-lg font-medium text-gray-600 mb-2"},"No schemes found",-1)),t[20]||(t[20]=e("p",{class:"text-gray-500 mb-4"},"Get started by creating your first scheme",-1)),e("button",{onClick:Y,class:"px-4 py-2 bg-sky-600 text-white rounded-lg hover:bg-sky-700 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-500"},t[17]||(t[17]=[e("span",{class:"flex items-center"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),k(" Create Scheme ")],-1)]))])):p("",!0)]),o(m)?(i(),re(o(O),{key:0,onClose:t[10]||(t[10]=s=>z(m)?m.value=!1:m=!1),"content-width":"w-full max-w-2xl"},{header:N(()=>[e("h3",He,d(o(_)),1)]),body:N(()=>[e("form",{onSubmit:ie(Z,["prevent"]),class:"p-6"},[e("div",Ie,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1",for:"title"},[k(" Scheme Title "),e("span",{class:"text-red-500"},"*")],-1)),v(e("input",{id:"title","onUpdate:modelValue":t[3]||(t[3]=s=>o(n).title=s),type:"text",required:"",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500",placeholder:"Enter scheme title"},null,512),[[y,o(n).title]])]),e("div",Ge,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1",for:"description"}," Description ",-1)),v(e("textarea",{id:"description","onUpdate:modelValue":t[4]||(t[4]=s=>o(n).description=s),rows:"3",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500",placeholder:"Enter scheme description"},null,512),[[y,o(n).description]])]),e("div",Fe,[e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1",for:"startDate"}," Start Date ",-1)),v(e("input",{id:"startDate","onUpdate:modelValue":t[5]||(t[5]=s=>o(n).startDate=s),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500"},null,512),[[y,o(n).startDate]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1",for:"endDate"}," End Date ",-1)),v(e("input",{id:"endDate","onUpdate:modelValue":t[6]||(t[6]=s=>o(n).endDate=s),type:"date",class:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500"},null,512),[[y,o(n).endDate]])])]),e("div",ze,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Assignee ",-1)),w(o(A),{modelValue:o(n).assignee,"onUpdate:modelValue":t[7]||(t[7]=s=>o(n).assignee=s),options:C.value,label:"firstName",searchable:!0,"track-by":"uid",placeholder:"Select an assignee"},null,8,["modelValue","options"])]),e("div",Oe,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-gray-700 mb-1"}," Members ",-1)),w(o(A),{modelValue:o(n).members,"onUpdate:modelValue":t[8]||(t[8]=s=>o(n).members=s),options:C.value,label:"firstName",searchable:!0,"track-by":"uid",multiple:!0,placeholder:"Select members"},null,8,["modelValue","options"])]),e("div",Re,[e("button",{type:"button",onClick:t[9]||(t[9]=s=>z(m)?m.value=!1:m=!1),class:"mr-3 px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-sky-500"}," Cancel "),e("button",Ke,d(b.value?"Create":"Update"),1)])],32)]),_:1})):p("",!0)],64)}}});const We=le(Xe,[["__scopeId","data-v-3bab7638"],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/grind/SchemeListing.vue"]]);export{We as default};
