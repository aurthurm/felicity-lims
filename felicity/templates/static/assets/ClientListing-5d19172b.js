import{P as Q,e as W,Z as c,a3 as ee,aj as te,ai as E,f as A,h as se,r as oe,o as i,c as u,a as B,a2 as n,A as m,C as ne,b as s,K as g,x as le,E as b,V as T,a7 as y,F as h,D as k,a4 as x,z as ae,J as ie,X as M,Y as N,_ as re}from"./index-fa13e788.js";import{A as ce,E as ue}from"./clients.mutations-905d6f2e.js";import{u as de}from"./client-c277185d.js";import{u as me}from"./location-80f34c04.js";import{h as fe,o as pe,a as ve}from"./constants-68671847.js";const be=s("hr",null,null,-1),he={action:"post",class:"p-1"},_e={class:"grid grid-cols-2 gap-x-4 mb-4"},Ce={class:"block col-span-1 mb-2"},ge=s("span",{class:"text-gray-700"},"Name",-1),ye={class:"block col-span-1 mb-2"},ke=s("span",{class:"text-gray-700"},"Code",-1),xe={class:"grid grid-cols-3 gap-x-4 mb-4"},we={class:"block col-span-1 mb-2"},Ue=s("span",{class:"text-gray-700"},"Country",-1),De=s("option",null,null,-1),Pe=["value"],Ee={class:"block col-span-1 mb-2"},Ae=s("span",{class:"text-gray-700"},"Province",-1),Be=s("option",null,null,-1),Te=["value"],Me={class:"block col-span-1 mb-2"},Ne=s("span",{class:"text-gray-700"},"District",-1),Se=s("option",null,null,-1),Ve=["value"],Ie=s("hr",null,null,-1),Le=Q({__name:"ClientListing",setup(Re){const S=M(()=>N(()=>import("./FelDataTable-76696623.js"),["assets/FelDataTable-76696623.js","assets/index-fa13e788.js","assets/index-ccc6a521.css"])),V=M(()=>N(()=>import("./index-fa13e788.js").then(o=>o.cM),["assets/index-fa13e788.js","assets/index-ccc6a521.css"])),r=de(),v=me(),{withClientMutation:w}=W(),I=c([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Client Name",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(o,t){return ee(te,{to:{name:"client-detail",query:{clientUid:o?.uid}},class:"px-1 ml-2 border-white border text-gray-500rounded-smtransition duration-300 hover:border-sky-800 hover:text-sky-800 focus:outline-none",innerHTML:o?.name})}},{name:"Client ID",value:"code",sortable:!1,sortBy:"asc",hidden:!1},{name:"District",value:"district.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Province",value:"district.province.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Mobile Number",value:"mobilePhone",sortable:!1,sortBy:"asc",hidden:!1},{name:"Email Asdress",value:"email",sortable:!1,sortBy:"asc",hidden:!1}]),{countries:L,provinces:R,districts:O}=E(v),{clients:U,clientPageInfo:D,fetchingClients:F}=E(r);let d=c(!1),_=c(!1),j=c(""),l=A({});const P=c(""),H=()=>Object.assign(l,{});let a=A({first:50,after:"",text:"",sortBy:["uid"],filterAction:!1}),f=c(),p=c();r.fetchClients(a),v.fetchCountries();function K(){w(ce,{payload:{name:l.name,code:l.code,districtUid:l.districtUid}},"createClient").then(o=>r.addClient(o))}function q(){w(ue,{uid:l.uid,payload:{name:l.name,code:l.code,districtUid:l.districtUid}},"updateClient").then(o=>r.updateClient(o))}function z(o){v.filterProvincesByCountry(f.value)}function J(o){v.filterDistrictsByProvince(p.value)}function X(o){a.first=100,a.after="",a.text=o.filterText,a.filterAction=!0,r.fetchClients(a)}function Y(o){a.first=o.fetchCount,a.after=D?.value?.endCursor,a.text=o.filterText,a.filterAction=!1,r.fetchClients(a)}function Z(o,t,C={}){_.value=o,j.value=t,P.value=(o?"CREATE":"EDIT")+" "+t.toUpperCase(),t=="client"&&(d.value=!0),o?t=="client"&&Object.assign(l,{}):t=="client"&&Object.assign(l,{...C})}function $(){_.value&&K(),_.value||q(),d.value=!1}const G=se(()=>U?.value?.length+" of "+r.getClientCount+" clients");return(o,t)=>{const C=oe("modal");return i(),u(h,null,[B(n(V),{title:"Clients"}),m(s("button",{class:"p-2 my-2 text-sm border-sky-800 border text-dark-700 transition-colors duration-150 rounded-sm focus:outline-none hover:bg-sky-800 hover:text-gray-100",onClick:t[0]||(t[0]=e=>Z(!0,"client"))}," Add client ",512),[[ne,fe(ve.CREATE,pe.CLIENT)]]),be,B(n(S),{columns:I.value,data:n(U),toggleColumns:!0,loading:n(F),paginable:!0,pageMeta:{fetchCount:n(a).first,hasNextPage:n(D)?.hasNextPage,countNone:G.value},searchable:!0,filterable:!1,onOnSearchKeyUp:X,onOnSearchFocus:H,onOnPaginate:Y,selectable:!1},{footer:g(()=>[]),_:1},8,["columns","data","loading","pageMeta"]),n(d)?(i(),le(C,{key:0,onClose:t[9]||(t[9]=e=>y(d)?d.value=!1:d=!1)},{header:g(()=>[s("h3",null,b(P.value),1)]),body:g(()=>[s("form",he,[s("div",_e,[s("label",Ce,[ge,m(s("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":t[1]||(t[1]=e=>n(l).name=e),placeholder:"Name ..."},null,512),[[T,n(l).name]])]),s("label",ye,[ke,m(s("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":t[2]||(t[2]=e=>n(l).code=e),placeholder:"Code ..."},null,512),[[T,n(l).code]])])]),s("div",xe,[s("label",we,[Ue,m(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":t[3]||(t[3]=e=>y(f)?f.value=e:f=e),onChange:t[4]||(t[4]=e=>z(e))},[De,(i(!0),u(h,null,k(n(L),e=>(i(),u("option",{key:e.uid,value:e.uid},b(e.name),9,Pe))),128))],544),[[x,n(f)]])]),s("label",Ee,[Ae,m(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":t[5]||(t[5]=e=>y(p)?p.value=e:p=e),onChange:t[6]||(t[6]=e=>J(e))},[Be,(i(!0),u(h,null,k(n(R),e=>(i(),u("option",{key:e.uid,value:e.uid},b(e.name),9,Te))),128))],544),[[x,n(p)]])]),s("label",Me,[Ne,m(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":t[7]||(t[7]=e=>n(l).districtUid=e)},[Se,(i(!0),u(h,null,k(n(O),e=>(i(),u("option",{key:e.uid,value:e.uid},b(e.name),9,Ve))),128))],512),[[x,n(l).districtUid]])])]),Ie,s("button",{type:"button",onClick:t[8]||(t[8]=ae(e=>$(),["prevent"])),class:"-mb-4 w-full border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):ie("",!0)],64)}}}),qe=re(Le,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/client/ClientListing.vue"]]);export{qe as default};
