import{Y as N,P as j,a7 as H,av as q,a0 as z,a3 as L,_ as P,r as _,aF as I,c as f,o as r,D as b,z as n,F as U,H as B,I as m,aG as G,a as t,K as l,M as u,E,A as D}from"./index-OdhKCqIc.js";import{u as K}from"./shipment-DcKVexkp.js";import{u as O}from"./shipment-BZXEcwwZ.js";import{S as Y}from"./Spinner-Bl8RfjFA.js";const J=N({__name:"ShipmentAssign",setup(V,{expose:e}){e();const p=K(),i=j(),{manageSamples:C}=O();p.fetchReferralLaboratories();const T=H(()=>p.getShipment);i.fetchSampleTypes();const g=q({sampleTypeUid:void 0,analysisUid:void 0}),d=z(!1),h=H(()=>{const o=[];return p.getSamples?.forEach(R=>{o?.some(M=>M.uid===R.uid)||o.push(R)}),o}),w=()=>{x(),p.fetchFoShipmentAssign({first:50,after:"",text:"",sortBy:void 0,...g})},a=()=>{const o=k();C(T?.value?.uid,o,"assign")};function x(){return p.samples?.filter(o=>o.checked)}function k(){return x().map(o=>({sampleUid:o.uid,shipedSampleUid:void 0,analyses:o.analysisResults?.filter(y=>y.checked)?.map(y=>y.uid)}))?.filter(o=>o?.analyses?.length>0)}function A(o){S()?d.value=!0:d.value=!1}function v(o){o.checked=!0}function s(o){o.checked=!1}async function c(){await h?.value?.forEach(o=>d.value?v(o):s(o))}function S(){return h?.value?.every(o=>o.checked===!0)}const F={shipmentStore:p,sampleStore:i,manageSamples:C,shipment:T,filterForm:g,allChecked:d,samples:h,filterSamples:w,assignToShipment:a,getSamplesChecked:x,getSelectedMetadata:k,checkCheck:A,check:v,unCheck:s,toggleCheckAll:c,areAllChecked:S,get Button(){return L},get Spinner(){return Y}};return Object.defineProperty(F,"__isScriptSetup",{enumerable:!1,value:!0}),F}}),Q={class:"space-y-6"},W={action:"post",class:"space-y-4"},X={class:"flex flex-wrap gap-4 items-end"},Z={class:"flex-1 min-w-[200px]"},$={class:"block space-y-1.5"},ee=["value"],te={class:"border border-border bg-card rounded-lg shadow-md"},se={class:"relative w-full overflow-auto"},le={key:0,class:"p-4 text-center"},oe={class:"inline-flex items-center gap-2"},ne={class:"text-sm font-medium text-foreground"},ie={class:"text-sm font-medium text-foreground"},de={class:"text-sm font-medium text-foreground"},ae={class:"text-sm text-foreground"},re={class:"space-y-2"},ce={class:"flex-1"},me={class:"inline-flex items-center rounded-md bg-primary/10 px-2 py-1 text-xs font-medium text-primary"},ue={class:"text-sm text-foreground"},fe={class:"text-sm text-foreground"},pe={class:"inline-flex items-center rounded-md bg-primary/10 px-2 py-1 text-xs font-medium text-primary"},_e={class:"flex justify-end"};function ge(V,e,p,i,C,T){const g=_("Checkbox"),d=_("TableHead"),h=_("TableRow"),w=_("TableHeader"),a=_("TableCell"),x=_("TableBody"),k=_("Table"),A=I("motion-slide-left"),v=I("motion-slide-right");return r(),f("div",Q,[b((r(),f("form",W,[n("div",X,[n("div",Z,[n("label",$,[e[3]||(e[3]=n("span",{class:"text-sm font-medium leading-none"},"Sample Type",-1)),b(n("select",{name:"analyses_uids","onUpdate:modelValue":e[0]||(e[0]=s=>i.filterForm.sampleTypeUid=s),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"},[(r(!0),f(U,null,B(i.sampleStore.sampleTypes,s=>(r(),f("option",{key:s.uid,value:s.uid},m(s.name),9,ee))),128))],512),[[G,i.filterForm.sampleTypeUid]])])]),n("div",null,[b(t(i.Button,{onClick:e[1]||(e[1]=s=>i.filterSamples()),color:"sky-800",class:"h-10 px-4"},{default:l(()=>[...e[4]||(e[4]=[u(" Apply Filters ",-1)])]),_:1},512),[[E,!0]])])])])),[[A]]),n("div",te,[n("div",se,[i.shipmentStore.fetchingSamples?(r(),f("div",le,[n("span",oe,[t(i.Spinner,{class:"size-4"}),e[5]||(e[5]=n("span",{class:"text-sm"},"Fetching samples ...",-1))])])):(r(),D(k,{key:1,class:"w-full caption-bottom text-sm"},{default:l(()=>[t(w,{class:"[&_tr]:border-b"},{default:l(()=>[t(h,{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:l(()=>[t(d,{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[t(g,{checked:i.allChecked,"onUpdate:checked":e[2]||(e[2]=s=>{i.allChecked=s,i.toggleCheckAll()})},null,8,["checked"])]),_:1}),t(d,{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground"}),t(d,{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...e[6]||(e[6]=[u("Sample ID",-1)])]),_:1}),t(d,{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...e[7]||(e[7]=[u("Sample Type",-1)])]),_:1}),t(d,{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...e[8]||(e[8]=[u("Client Sample ID",-1)])]),_:1}),t(d,{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...e[9]||(e[9]=[u("Analysis",-1)])]),_:1}),t(d,{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...e[10]||(e[10]=[u("Date Created",-1)])]),_:1}),t(d,{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...e[11]||(e[11]=[u("Date Received",-1)])]),_:1}),t(d,{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...e[12]||(e[12]=[u("Status",-1)])]),_:1})]),_:1})]),_:1}),b((r(),D(x,{class:"[&_tr:last-child]:border-0"},{default:l(()=>[(r(!0),f(U,null,B(i.shipmentStore.samples,s=>(r(),D(h,{key:s?.uid,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:l(()=>[t(a,{class:"p-4 align-middle"},{default:l(()=>[t(g,{checked:s.checked,"onUpdate:checked":c=>{s.checked=c,i.checkCheck(s)}},null,8,["checked","onUpdate:checked"])]),_:2},1024),t(a,{class:"p-4 align-middle"}),t(a,{class:"p-4 align-middle"},{default:l(()=>[n("div",ne,m(s?.sampleId),1)]),_:2},1024),t(a,{class:"p-4 align-middle"},{default:l(()=>[n("div",ie,m(s?.sampleType?.name),1)]),_:2},1024),t(a,{class:"p-4 align-middle"},{default:l(()=>[n("div",de,m(s?.analysisRequest?.clientRequestId),1)]),_:2},1024),t(a,{class:"p-4 align-middle"},{default:l(()=>[n("div",ae,[n("ul",re,[(r(!0),f(U,null,B(s?.analysisResults,c=>(r(),f("li",{key:c.uid,class:"flex items-center space-x-2"},[t(g,{checked:c.checked,"onUpdate:checked":S=>c.checked=S,disabled:!s.checked},null,8,["checked","onUpdate:checked","disabled"]),n("span",ce,m(c?.analysis?.name),1),n("span",me,m(c?.status),1)]))),128))])])]),_:2},1024),t(a,{class:"p-4 align-middle"},{default:l(()=>[n("div",ue,m(s?.createdAt),1)]),_:2},1024),t(a,{class:"p-4 align-middle"},{default:l(()=>[n("div",fe,m(s?.dateReceived),1)]),_:2},1024),t(a,{class:"p-4 align-middle"},{default:l(()=>[n("span",pe,m(s?.status),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})),[[v]])]),_:1}))])]),n("section",_e,[b(t(i.Button,{onClick:i.assignToShipment,color:"orange-600",class:"h-10 px-4"},{default:l(()=>[...e[13]||(e[13]=[u(" Assign Samples ",-1)])]),_:1},512),[[E,!0]])])])}const ve=P(J,[["render",ge],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/shipment/_id/ShipmentAssign.vue"]]);export{ve as default};
