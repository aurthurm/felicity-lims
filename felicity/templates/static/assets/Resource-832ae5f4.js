import{S as V,ai as $,h as B,a0 as L,a7 as N,W as h,r as x,o as l,c as m,K as d,N as o,C as g,D as _,a5 as n,F as w,E as k,y as S,L as b,M as U,H as f,a3 as j,a as E,b as A,X as C,A as H,e as R,_ as I}from"./index-9a11e11f.js";import{C as W}from"./index-79477c52.js";import{u as z}from"./dashboard-35467a5a.js";import"./value-c2034ca5.js";import"./string-6dabfbe0.js";const K={class:"mt-4"},P={class:"flex justify-between mb-8"},X={class:"flex justify-end items-center"},q=["onClick"],G={key:0,class:"text-start my-4"},J={class:"mb-8"},O={key:0,class:"text-muted-foreground"},Q={key:1,class:"flex justify-start"},Y={class:"mr-4 font-bold text-foreground text-xl"},Z={class:"font-semibold text-muted-foreground text-l"},ee={action:"post",class:"p-1"},te={class:"grid grid-cols-2 gap-x-4 mb-4"},oe={class:"block col-span-2 mb-2"},se={class:"block col-span-2 mb-2"},re=V({__name:"Resource",setup(ne){const u=z(),{dashboard:r}=$(u),p=B({range:{from:"",to:""}}),v=L(!1),F=()=>{u.setFilterRange(R(p.range.from),R(p.range.to)),v.value=!1};N(async()=>{y(),u.setShowFilters(!0),u.getResourceStats()}),h(()=>r.value.filterRange.from,()=>{y(),u.getResourceStats()}),h(()=>r.value.resourceStats?.samples,a=>{a?.forEach(e=>{const c=[],s=e.counts?.reduce((i,t)=>i+t.count,0)||0;e.counts?.forEach(i=>{c.push({item:i.group,count:i.count,percent:i.count/s})}),console.log(e.group),D(c,e.group,e.group)})});const M=a=>{const e=r.value.resourceStats?.instruments?.reduce((s,i)=>s+i.count,0)||0;return`${(a/e*100).toFixed(2)}%`},D=(a,e,c)=>{const s=new W({container:e,autoFit:!0,height:250,width:500,localRefresh:!1});s.coordinate("theta",{radius:.75,innerRadius:.5}),s.data(a),s.scale("percent",{formatter:t=>`${(t*100).toFixed(2)}%`}),s.tooltip({showTitle:!1,showMarkers:!1}),s.legend(!1),s.interval().position("percent").color("item").label("percent",{layout:[{type:"pie-spider"},{type:"hide-overlap"}],offset:8,labelHeight:38,content:t=>`${t.item} (${t.count})`,labelLine:{style:{lineWidth:.5}}}).adjust("stack"),s.createView().annotation().text({position:["50%","50%"],content:c,style:{fill:"#262626",textAlign:"center"}}),s.interaction("element-active"),s.render()},y=()=>{const a=document.getElementById("user-matrix");a&&(a.innerHTML=`
      <div>
        <div id="registration"></div>
      </div>
      <div>
        <div id="submission"></div>
      </div>
      <div>
        <div id="verification"></div>
      </div>
      <div>
        <div id="publication"></div>
      </div>
    `)};return(a,e)=>{const c=x("VTooltip"),s=x("fel-loader"),i=x("fel-modal");return l(),m("div",K,[d(" Filters Section "),o("section",P,[g(o("div",X,[(l(!0),m(w,null,k(n(r).filters,(t,T)=>g((l(),S(c,{key:T,placements:["right-start"]},{popper:b(()=>[U(f(n(u).filterToolTip(t)),1)]),default:b(()=>[o("button",{onClick:ie=>n(u).setCurrentFilter(t),type:"button",class:j(["px-2 py-1 mr-2 border border-foreground text-foreground rounded-sm transition duration-300 hover:bg-primary hover:text-primary-foreground focus:outline-none",{"bg-primary text-primary-foreground":n(r).currentFilter===t}])},f(t),11,q)]),_:2},1024)),[[_,t!==n(r).filters[n(r).filters.length]]])),128)),o("button",{onClick:e[0]||(e[0]=t=>v.value=!0),class:"ml-4 mr-1 px-2 py-1 border border-border text-muted-foreground rounded-sm transition duration-300 hover:bg-muted hover:text-primary-foreground focus:outline-none"},f(n(r).filterRange.from)+" - "+f(n(r).filterRange.to),1)],512),[[_,n(r).showFilters]])]),d(" Loading State "),n(r).fetchingResourceStats?(l(),m("div",G,[E(s,{message:"Fetching resource stats..."})])):d("v-if",!0),d(" Content Section "),o("section",null,[d(" Instrument Matrix "),o("div",J,[e[5]||(e[5]=o("h1",{class:"text-xl text-foreground font-semibold"},"Instrument Matrix / Load",-1)),e[6]||(e[6]=o("hr",{class:"my-2"},null,-1)),n(r).resourceStats?.instruments?.length?(l(),m("div",Q,[(l(!0),m(w,null,k(n(r).resourceStats?.instruments,t=>(l(),m("div",{key:t.group,class:"flex items-center bg-background shadow rounded-sm px-6 pt-3 pb-5 border border-foreground mr-8"},[o("span",Y,f(M(t?.count)),1),o("span",Z,f(t.group),1)]))),128))])):(l(),m("div",O," No instrument data available "))]),d(" User Matrix "),e[7]||(e[7]=A('<div class="mb-8"><h1 class="text-xl text-foreground font-semibold">User Matrix / Load</h1><hr class="my-2"><div class="flex flex-wrap justify-start" id="user-matrix"><div><div id="registration"></div></div><div><div id="submission"></div></div><div><div id="verification"></div></div><div><div id="publication"></div></div></div></div>',1))]),d(" Custom Date Range Modal "),v.value?(l(),S(i,{key:1,onClose:e[4]||(e[4]=t=>v.value=!1),contentWidth:"w-1/4"},{header:b(()=>e[8]||(e[8]=[o("h3",null,"Custom Filter Date Range",-1)])),body:b(()=>[o("form",ee,[o("div",te,[o("label",oe,[e[9]||(e[9]=o("span",{class:"text-foreground"},"Date From",-1)),g(o("input",{type:"datetime-local",class:"form-input mt-1 block w-full",autocomplete:"off","onUpdate:modelValue":e[1]||(e[1]=t=>p.range.from=t),placeholder:"Select start date..."},null,512),[[C,p.range.from]])]),o("label",se,[e[10]||(e[10]=o("span",{class:"text-foreground"},"Date To",-1)),g(o("input",{type:"datetime-local",class:"form-input mt-1 block w-full",autocomplete:"off","onUpdate:modelValue":e[2]||(e[2]=t=>p.range.to=t),placeholder:"Select end date..."},null,512),[[C,p.range.to]])])]),e[11]||(e[11]=o("hr",null,null,-1)),o("button",{type:"button",onClick:e[3]||(e[3]=H(t=>F(),["prevent"])),class:"m-2 -mb-4 w-full rounded-sm border border-primary bg-primary px-4 py-2 text-primary-foreground transition-colors duration-500 ease select-none hover:bg-primary focus:outline-none focus:shadow-outline"}," Apply Filter ")])]),_:1})):d("v-if",!0)])}}});const me=I(re,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/dashboard/Resource.vue"]]);export{me as default};
