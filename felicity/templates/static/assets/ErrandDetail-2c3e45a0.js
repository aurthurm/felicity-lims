import{P as ye,Z as i,aa as fe,a9 as he,h as R,e as _e,a5 as F,r as j,a2 as s,o as r,c as u,b as t,E as c,A as K,V as xe,H as ke,as as De,L as B,ak as T,J as g,x as Ve,C as Ee,at as Ue,a1 as _,a as d,K as O,X as x,au as we,Y as k,_ as Ce}from"./index-f86d8273.js";import{a as Se,b as Ae,c as Be,d as Te,E as Me}from"./grind.queries-12f686e0.js";import{S as z}from"./schema-f3233b53.js";import{C as Pe,A as He,a as Le,b as $e,B as Ye,c as Ie,E as Ne,H as Ge,I as Re,d as Fe,e as je,L as Ke,P as Oe,S as ze,T as Qe,f as Je,U as We,g as Xe}from"./index-5e693479.js";import v from"./vue-multiselect.esm-1db37a44.js";import{U as Ze}from"./_queries-4c7a9cfd.js";import"./_baseForOwn-0c538494.js";import"./merge-66d44e03.js";import"./_isIterateeCall-3ed5658a.js";import"./isArray-513c67aa.js";import"./mapValues-165ea98a.js";import"./isString-d243093d.js";import"./clone-3a4eb68c.js";import"./_baseSet-6d67a00a.js";const qe={key:0,class:"bg-white rounded-lg shadow"},et={class:"flex flex-col md:flex-row"},tt={class:"flex-1 p-6 border-r"},st={class:"p-6 border-b"},at={class:"flex justify-between items-center"},ot={class:"relative w-full"},lt={class:"mt-4 text-xs flex items-center gap-2"},it={class:"h-8 w-8 rounded-full bg-orange-200 flex items-center justify-center text-orange-600"},nt={class:"my-1 font-semibold"},rt={class:"text-sm text-gray-600"},dt=["innerHTML"],ut={key:1,class:"mt-6"},ct={class:"main-container min-w-full prose prose-slate"},mt={class:"editor-container editor-container_balloon-editor",ref:"editorContainerElement"},pt={class:"editor-container__editor"},gt={ref:"editorElement"},vt={class:"flex justify-start items-center gap-x-2 mt-1"},bt={class:"my-2 w-full bg-gray-200 rounded-full h-1 dark:bg-gray-700"},yt={class:"text-xs"},ft={class:"border-b border-gray-200"},ht={class:"flex"},_t={class:"py-4"},xt={key:0,class:"space-y-6"},kt={key:1,class:"space-y-4"},Dt={key:2,class:"space-y-4"},Vt={key:3},Et={class:"w-full md:w-80 p-6"},Ut={class:"space-y-6"},wt={class:"multiselect-tag"},Ct=["onClick"],St={class:"multiselect-tag"},At=["onClick"],Bt=ye({__name:"ErrandDetail",setup(Tt){const Q=x(()=>k(()=>import("./ErrandActivity-d702377c.js"),["assets/ErrandActivity-d702377c.js","assets/index-f86d8273.js","assets/index-ba19faea.css"])),J=x(()=>k(()=>import("./CommentSystem-b0542148.js"),["assets/CommentSystem-b0542148.js","assets/index-f86d8273.js","assets/index-ba19faea.css","assets/grind.queries-12f686e0.js","assets/CommentSystem-d474aa42.css"])),W=x(()=>k(()=>import("./ErrandFile-0a545890.js"),["assets/ErrandFile-0a545890.js","assets/index-f86d8273.js","assets/index-ba19faea.css","assets/grind.queries-12f686e0.js","assets/schema-f3233b53.js","assets/ErrandFile-67bd3621.css"])),X=x(()=>k(()=>import("./ErrandMilestone-c57096de.js"),["assets/ErrandMilestone-c57096de.js","assets/index-f86d8273.js","assets/index-ba19faea.css","assets/_queries-4c7a9cfd.js","assets/grind.queries-12f686e0.js","assets/vue-multiselect.esm-1db37a44.js"])),D=i(!1),M=i(null),Z=i(Pe);function q(){M.value={toolbar:{items:["undo","redo","|","heading","|","bold","italic","underline","|","link","insertTable","blockQuote","|","bulletedList","numberedList","todoList","outdent","indent"],shouldNotGroupWhenFull:!1},plugins:[He,Le,$e,Ye,Ie,Ne,Ge,Re,Fe,je,Ke,Oe,ze,Qe,Je,We,Xe],heading:{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h1",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h2",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h3",title:"Heading 3",class:"ck-heading_heading3"},{model:"heading4",view:"h4",title:"Heading 4",class:"ck-heading_heading4"},{model:"heading5",view:"h5",title:"Heading 5",class:"ck-heading_heading5"},{model:"heading6",view:"h6",title:"Heading 6",class:"ck-heading_heading6"}]},placeholder:"Begin typing..."},D.value=!0}fe(()=>{q(),$(),ne(),de(),ve()});const n=i("discussions"),P=he(),H=R(()=>P.params.errandUid),ee=R(()=>P.params.boardUid);let a=i();const{withClientQuery:y,withClientMutation:L}=_e();function $(){y(Se,{uid:H.value},"grindErrandByUid").then(o=>{a.value=o;const e=F(a.value.startDate,!0)??new Date,p=F(a.value.endDate,!0)??new Date(new Date().setDate(e.getDate()+7));U.value=[e,p]})}function m(o){L(Me,{uid:H.value,payload:o},"updateGrindErrand").then(()=>$())}const V=i(!1),E=i(null),te=()=>{V.value=!0,we(()=>{E.value?.focus(),E.value?.select()})},Y=()=>{V.value=!1,m({title:a.value?.title})},f=i(!1),I=i(""),se=()=>{f.value=!0,I.value=a.value?.description??""},ae=()=>{f.value=!1,m({description:a.value?.description})},oe=()=>{a.value.description=I.value,f.value=!1},U=i(),le=o=>{const e=o[0]?.getDate(),p=o[0]?.getMonth()+1,S=o[0]?.getFullYear(),l=o[1]?.getDate(),b=o[1]?.getMonth()+1,A=o[1]?.getFullYear();return`${e}/${p}/${S} - ${l}/${b}/${A}`},ie=o=>{if(o.length!==2){alert("Invalid date range");return}m({startDate:T(o[0],"YYYY-MM-DD HH:mm"),endDate:T(o[1],"YYYY-MM-DD HH:mm")})},N=i([]);function ne(){y(Ae,{boardUid:ee.value},"grindPostersByBoard").then(o=>{N.value=o.filter(e=>e.uid!==a.value?.posterUid)})}function re(o){m({posterUid:o.uid})}const h=i();function de(){y(Ze,{first:100},"userAll").then(o=>{h.value=o.items})}function w({firstName:o,lastName:e}){return`${o} ${e}`}function ue(o){m({assigneeUid:o.uid})}function ce(o){m({reporterUid:o.uid})}function me(o){m({members:o.map(e=>e.uid)})}const pe=["Low","Normal","High","Critical"];function ge(o){m({priority:o})}const C=i([]);function ve(){y(Be,{category:z.Project},"grindStampByCategory").then(o=>{C.value=o})}function G(o){m({stamps:o?.map(e=>e.uid)})}const be=o=>{L(Te,{payload:{title:o,category:z.Project}},"createGrindStamp").then(e=>{if(e.uid){C.value.push(e);const p=a.value?.stamps??[];p.push(e),G(p)}})};return(o,e)=>{const p=j("ckeditor"),S=j("VueDatePicker");return s(a)?(r(),u("div",qe,[t("div",et,[t("div",tt,[t("div",st,[t("div",at,[t("div",ot,[V.value?K((r(),u("input",{key:1,type:"text","onUpdate:modelValue":e[0]||(e[0]=l=>s(a).title=l),onBlur:Y,onKeyup:ke(Y,["enter"]),ref_key:"titleInput",ref:E,class:"text-2xl font-semibold text-gray-800 w-full px-2 py-1 border border-blue-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500"},null,544)),[[xe,s(a).title]]):(r(),u("h1",{key:0,onClick:te,class:"text-3xl font-bold text-gray-800 cursor-pointer hover:bg-gray-50 rounded"},c(s(a).title),1))])]),t("div",lt,[t("div",it,c(s(De)(s(a).createdBy?.firstName,s(a).createdBy?.lastName)),1),e[13]||(e[13]=B(" by ")),t("span",nt,c(s(a).createdBy?.firstName)+" "+c(s(a).createdBy?.lastName),1),t("span",rt,"on "+c(s(T)(s(a).createdAt,"D MMMM YYYY")),1)]),f.value?(r(),u("div",ut,[t("div",ct,[t("p",null,"isLayoutReady : "+c(D.value),1),t("div",mt,[t("div",pt,[t("div",gt,[D.value?(r(),Ve(p,{key:0,modelValue:s(a).description,"onUpdate:modelValue":e[1]||(e[1]=l=>s(a).description=l),editor:Z.value,config:M.value,"tag-name":"textarea"},null,8,["modelValue","editor","config"])):g("",!0)],512)])],512)]),t("div",{class:"mt-2 flex gap-2"},[t("button",{onClick:ae,class:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm"}," Save "),t("button",{onClick:oe,class:"px-3 py-1 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 text-sm"}," Cancel ")])])):(r(),u("div",{key:0,class:"mt-6 prose",onClick:se},[s(a).description?(r(),u("article",{key:0,class:"text-lg text-gray-800",innerHTML:s(a).description},null,8,dt)):g("",!0)]))]),K(t("div",vt,[t("div",bt,[t("div",{class:"bg-green-600 h-1 rounded-full",style:Ue(`width: ${s(a)?.milestonesAt}%`)},null,4)]),t("span",yt,c(s(a)?.milestonesAt)+"%",1)],512),[[Ee,s(a)?.milestonesAt]]),t("div",ft,[t("div",ht,[t("button",{onClick:e[2]||(e[2]=l=>n.value="discussions"),class:_(["py-3 px-4 text-sm font-medium border-b-2 focus:outline-none",n.value==="discussions"?"border-blue-500 text-blue-500":"border-transparent text-gray-500 hover:text-gray-700"])}," Discussions ",2),t("button",{onClick:e[3]||(e[3]=l=>n.value="milestones"),class:_(["py-3 px-4 text-sm font-medium border-b-2 focus:outline-none",n.value==="milestones"?"border-blue-500 text-blue-500":"border-transparent text-gray-500 hover:text-gray-700"])}," Milestones ",2),t("button",{onClick:e[4]||(e[4]=l=>n.value="activity"),class:_(["py-3 px-4 text-sm font-medium border-b-2 focus:outline-none",n.value==="activity"?"border-blue-500 text-blue-500":"border-transparent text-gray-500 hover:text-gray-700"])}," Activity Stream ",2),t("button",{onClick:e[5]||(e[5]=l=>n.value="files"),class:_(["py-3 px-4 text-sm font-medium border-b-2 focus:outline-none",n.value==="files"?"border-blue-500 text-blue-500":"border-transparent text-gray-500 hover:text-gray-700"])}," Files ",2)])]),t("div",_t,[n.value==="discussions"?(r(),u("div",xt,[d(s(J),{errandUid:s(a).uid},null,8,["errandUid"])])):g("",!0),n.value==="milestones"?(r(),u("div",kt,[d(s(X),{errandUid:s(a).uid},null,8,["errandUid"])])):g("",!0),n.value==="activity"?(r(),u("div",Dt,[d(s(Q),{errandUid:s(a).uid},null,8,["errandUid"])])):g("",!0),n.value==="files"?(r(),u("div",Vt,[d(s(W),{errandUid:s(a).uid},null,8,["errandUid"])])):g("",!0)])]),t("div",Et,[t("div",Ut,[d(S,{class:"z-60",modelValue:U.value,"onUpdate:modelValue":[e[6]||(e[6]=l=>U.value=l),ie],range:"",format:le},null,8,["modelValue"]),t("div",null,[e[14]||(e[14]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Status",-1)),d(s(v),{modelValue:s(a).poster,"onUpdate:modelValue":[e[7]||(e[7]=l=>s(a).poster=l),re],options:N.value,label:"title","track-by":"uid",placeholder:"Select status"},null,8,["modelValue","options"])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Assignee",-1)),d(s(v),{modelValue:s(a).assignee,"onUpdate:modelValue":[e[8]||(e[8]=l=>s(a).assignee=l),ue],options:h.value,"track-by":"uid",searchable:!0,"custom-label":w,placeholder:"Select assignee"},null,8,["modelValue","options"])]),t("div",null,[e[16]||(e[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Reporter",-1)),d(s(v),{modelValue:s(a).reporter,"onUpdate:modelValue":[e[9]||(e[9]=l=>s(a).reporter=l),ce],options:h.value,"track-by":"uid",searchable:!0,"custom-label":w,placeholder:"Select reporter"},null,8,["modelValue","options"])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Team Members",-1)),d(s(v),{modelValue:s(a).members,"onUpdate:modelValue":[e[10]||(e[10]=l=>s(a).members=l),me],options:h.value,multiple:!0,searchable:!0,"custom-label":w,"track-by":"uid",placeholder:"Select members"},{tag:O(({option:l,remove:b})=>[t("div",wt,[B(c(l.firstName)+" "+c(l.lastName)+" ",1),t("i",{class:"multiselect-tag-remove",onClick:A=>b(l)},"×",8,Ct)])]),_:1},8,["modelValue","options"])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Priority",-1)),d(s(v),{modelValue:s(a).priority,"onUpdate:modelValue":[e[11]||(e[11]=l=>s(a).priority=l),ge],options:pe,searchable:!1,"show-labels":!1,placeholder:"Select priority"},null,8,["modelValue"])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tags",-1)),d(s(v),{modelValue:s(a).stamps,"onUpdate:modelValue":[e[12]||(e[12]=l=>s(a).stamps=l),G],options:C.value,multiple:!0,taggable:!0,searchable:!0,"track-by":"uid","show-labels":!1,placeholder:"Select or add tags",onTag:be,"custom-label":({title:l})=>`${l}`},{tag:O(({option:l,remove:b})=>[t("div",St,[B(c(l.title)+" ",1),t("i",{class:"multiselect-tag-remove",onClick:A=>b(l)},"×",8,At)])]),_:1},8,["modelValue","options","custom-label"])])])])])])):g("",!0)}}}),zt=Ce(Bt,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/grind/_id/ErrandDetail.vue"]]);export{zt as default};
