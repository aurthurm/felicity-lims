import{d as z,I as O,s as G,p as W,q as H,P as J,r as K,m as Q,o as u,c as m,b as e,f as i,g as w,F as U,C as X,t as y,z as Y,A,e as x,G as L,i as p,v as S,ae as Z,w as ee,y as oe,j as D,_ as I,D as se,E as te,k as ie}from"./index-fc86f1fc.js";import{u as de,g as ae,h as le}from"./billing-18b19522.js";import{c as ne,a as _,d as re,g as ue,u as ce,b as c}from"./array-110655e3.js";const l=h=>(se("data-v-8e7b96f9"),h=h(),te(),h),he={class:"mt-4"},me={key:0},pe={key:1},_e=l(()=>e("h4",{class:"text-gray-800 text-l font-semibold"},"Voucher Codes",-1)),ve=l(()=>e("hr",null,null,-1)),fe={class:"grid grid-cols-5 gap-2 mt-2"},be={class:"font-semibold text-gray-800 flex justify-between items-center"},ge={class:"text-sm text-gray-500 flex-grow text-right"},ye=["onClick"],xe=l(()=>e("h3",null,"Voucher Code Form",-1)),Ce={class:"grid grid-cols-2 gap-x-4 mb-4"},Ve={class:"block col-span-1 mb-2"},ke=l(()=>e("span",{class:"text-gray-700"},"Voucher Code",-1)),we={class:"block col-span-1 mb-2"},Ue=l(()=>e("span",{class:"text-gray-700"},"Usage Limit",-1)),Ae={class:"grid grid-cols-2 gap-x-4 mb-4"},Le={class:"block col-span-1 mb-2"},Se=l(()=>e("span",{class:"text-gray-700"},"Is Active",-1)),De=l(()=>e("hr",null,null,-1)),Ie=z({__name:"VoucherCodes",props:{voucherUid:String},setup(h){const F=D(()=>I(()=>import("./FelLoadingMessage-50e7808b.js"),["assets/FelLoadingMessage-50e7808b.js","assets/index-fc86f1fc.js","assets/index-246842b1.css"])),E=D(()=>I(()=>import("./index-fc86f1fc.js").then(o=>o.bs),["assets/index-fc86f1fc.js","assets/index-246842b1.css"])),n=h,{withClientMutation:C}=O();let r=de();const{fetchingVoucherCodes:M}=G(r),q=W(()=>{const o=r.getVouchers,s=o?.findIndex(g=>g.uid===n.voucherUid);return s>-1?o[s]?.codes:[]});H(()=>r.fetchVoucherCodes(n.voucherUid)),J(()=>n.voucherUid,o=>{r.fetchVoucherCodes(n.voucherUid)});let a=K(!1);const R=ne({uid:_().nullable(),voucherUid:_().required(),code:_().required("Code is Required"),usageLimit:re().required("Usage Limit is Required"),used:_().nullable(),isActive:ue().default(!0)}),{handleSubmit:B,errors:V,setFieldValue:d}=ce({validationSchema:R,initialValues:{isActive:!0,voucherUid:n.voucherUid}}),{value:$}=c("uid");c("voucherUid");const{value:v}=c("code"),{value:f}=c("usageLimit");c("used");const{value:b}=c("isActive"),k=B(o=>{o.uid||j(o),o.uid&&N(o)});let P=o=>{d("uid",o.uid),d("code",o.code),d("usageLimit",o.usageLimit),d("used",o.used),d("isActive",o.isActive),a.value=!0};const T=()=>{d("uid",void 0),d("voucherUid",n.voucherUid),d("code",void 0),d("usageLimit",void 0),d("used",void 0),d("isActive",!0),a.value=!0},j=o=>{delete o.uid,C(ae,{payload:o},"createVoucherCode").then(s=>r.addVoucherCode(s)).finally(()=>a.value=!1)},N=o=>{delete o.uid,delete o.used,C(le,{uid:$?.value,payload:o},"updateVoucherCode").then(s=>r.updateVoucherCode(s)).finally(()=>a.value=!1)};return(o,s)=>{const g=Q("font-awesome-icon");return u(),m(U,null,[e("div",he,[i(M)?(u(),m("div",me,[w(i(F),{message:"Fetching voucher codes ..."})])):(u(),m("section",pe,[e("div",{class:"flex justify-between"},[_e,e("button",{class:"px-4 my-2 p-1 text-sm border-sky-800 border text-dark-700 transition-colors duration-150 rounded-sm focus:outline-none hover:bg-sky-800 hover:text-gray-100",onClick:T}," Add Voucher Code ")]),ve,e("div",fe,[(u(!0),m(U,null,X(q.value,t=>(u(),m("div",{key:t.uid,class:"col-span-1 bg-white rounded-sm shadow-sm hover:shadow-md duration-500 px-2 py-2"},[e("div",be,[e("h5",null,y(t.code),1),e("div",ge,y(t.used)+" of "+y(t.usageLimit),1),e("a",{class:"ml-2 pl-2 text-gray-400 border-l-2 border-l-gray-400",onClick:Fe=>i(P)(t)},[w(g,{class:"text-xs hover:text-gray-800",icon:"pen"})],8,ye)])]))),128))])]))]),i(a)?(u(),Y(i(E),{key:0,onClose:s[4]||(s[4]=t=>p(a)?a.value=!1:a=!1),contentWidth:"w-3/6"},{header:A(()=>[xe]),body:A(()=>[e("form",null,[e("div",Ce,[e("label",Ve,[ke,x(e("input",{class:L(["form-input mt-1 block w-full",{"border-red-500 animate-pulse":i(V).code}]),type:"text","onUpdate:modelValue":s[0]||(s[0]=t=>p(v)?v.value=t:null),placeholder:"Code ..."},null,2),[[S,i(v)]])]),e("label",we,[Ue,x(e("input",{class:L(["form-input mt-1 block w-full",{"border-red-500 animate-pulse":i(V).usageLimit}]),type:"number",min:"1","onUpdate:modelValue":s[1]||(s[1]=t=>p(f)?f.value=t:null)},null,2),[[S,i(f)]])])]),e("div",Ae,[e("label",Le,[Se,x(e("input",{class:"form-checkbox ml-4",type:"checkbox","onUpdate:modelValue":s[2]||(s[2]=t=>p(b)?b.value=t:null),checked:""},null,512),[[Z,i(b)]])])]),De,e("button",{type:"submit",class:"-mb-4 border border-sky-800 bg-sky-800 text-white rounded-sm px-2 py-1 mt-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline",onClick:s[3]||(s[3]=ee((...t)=>i(k)&&i(k)(...t),["prevent"]))}," Save Voucher ")])]),_:1})):oe("v-if",!0)],64)}}});const Re=ie(Ie,[["__scopeId","data-v-8e7b96f9"],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/admin/billing/VoucherCodes.vue"]]);export{Re as default};
