import{P as M,e as Q,aa as q,h as D,Z as i,R as V,r as B,o as u,c,b as y,a as d,a2 as r,a7 as x,F as A,L as F,D as O,X as h,ao as b,Y as v,_ as j}from"./index-fa13e788.js";import{u as I}from"./analysis-235f825e.js";const N={class:"min-h-[500px]"},U={class:"flex justify-between"},Y={class:"flex justify-start items-center gap-x-2"},z=y("hr",{class:"my-4"},null,-1),G=M({__name:"QualityCharts",setup(H){const k=h(()=>v(()=>import("./vue-multiselect.esm-d8a2873c.js"),["assets/vue-multiselect.esm-d8a2873c.js","assets/index-fa13e788.js","assets/index-ccc6a521.css"])),w=h(()=>v(()=>import("./index-fa13e788.js").then(e=>e.cM),["assets/index-fa13e788.js","assets/index-ccc6a521.css"])),L=h(()=>v(()=>import("./ChartLJ-17538d2e.js"),["assets/ChartLJ-17538d2e.js","assets/index-fa13e788.js","assets/index-ccc6a521.css","assets/index-b0b0d38f.js","assets/value-c2034ca5.js","assets/string-6dabfbe0.js"])),f=I(),{withClientQuery:_}=Q();q(()=>{f.fetchAnalysesServices({})});const P=D(()=>f.getAnalysesServicesSimple),o=i([]),m=new Date;let l=i({month:m.getMonth(),year:m.getFullYear()}),n=i(null);const p=i(!1),S=async e=>{if(!l.value)return;const a={analyses:[e.uid],month:l.value.month+1,year:l.value.year};await _(b,a,"qcChartData").then(s=>{o.value=s??[]}).finally(()=>p.value=!1)},E=async e=>{if(!n.value)return;const a={analyses:[n.value?.uid],month:e.month+1,year:e.year};await _(b,a,"qcChartData").then(s=>{o.value=s??[]}).finally(()=>p.value=!1)},C=D(()=>o.value?T(R(o.value)):[]);function R(e){return e.reduce((a,s)=>{const t=s.sample.qcLevel.level;return a[t]||(a[t]={results:[],dates:[]}),a[t].results.push(parseFloat(s.result)),a[t].dates.push(s.dateVerified),a},{})}function T(e){return Object.entries(e).map(([a,s])=>({name:a,data:s.results.map((t,g)=>({date:s.dates[g],value:t}))}))}return V(n,async e=>{e&&await S(e)}),V(l,async e=>{e&&await E(e)}),(e,a)=>{const s=B("VueDatePicker");return u(),c("div",N,[y("div",U,[d(r(w),{title:"Analyses Service Control Charts"}),y("div",Y,[d(s,{class:"z-60 disabled:bg-slate-200",modelValue:r(l),"onUpdate:modelValue":a[0]||(a[0]=t=>x(l)?l.value=t:l=t),"max-date":r(m),"month-picker":""},null,8,["modelValue","max-date"]),d(r(k),{class:"max-w-[300px]",modelValue:r(n),"onUpdate:modelValue":a[1]||(a[1]=t=>x(n)?n.value=t:n=t),options:P.value,multiple:!1,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","options"])])]),z,C.value?.length==0?(u(),c(A,{key:0},[F(" The selected analysis has no data for the selected period. ")],64)):(u(!0),c(A,{key:1},O(C.value,t=>(u(),c("div",{class:"mb-4",key:t.name},[d(r(L),{title:t.name,series:t.data},null,8,["title","series"])]))),128))])}}}),Z=j(G,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/qcontrol/QualityCharts.vue"]]);export{Z as default};
