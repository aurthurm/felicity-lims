const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FelDataTable-BgRrYa9n.js","assets/index-Daoe3XS9.js","assets/index-C7Rn7ES8.css","assets/BillDetail-DoWIvg2h.js","assets/billing-CBiZn6uF.js","assets/billing.queries-BnjjrvVy.js","assets/billing.mutations-AVfhx3a7.js","assets/index.esm-BT7_X8h2.js","assets/BillDetail-Sa9oDNZ-.css"])))=>i.map(i=>d[i]);
import{a0 as V,ap as $,a7 as f,g as j,ad as J,h as Y,a1 as P,a6 as w,a8 as l,_ as q,r as G,c as H,o as S,A as s,a as D,N as I,C as K,E as Q,J as W}from"./index-Daoe3XS9.js";import{u as X}from"./billing-CBiZn6uF.js";import"./billing.queries-BnjjrvVy.js";const Z=V({__name:"BillingListing",setup(N,{expose:r}){r();const x=P(()=>w(()=>import("./FelDataTable-BgRrYa9n.js"),__vite__mapDeps([0,1,2]))),a=P(()=>w(()=>import("./BillDetail-DoWIvg2h.js"),__vite__mapDeps([3,1,2,4,5,6,7,8]))),p=X(),{bills:m,billPageInfo:u,fetchingBills:c}=$(p),g=f(!1),v=f(void 0);function C(e){return{pending:"bg-yellow-100 text-yellow-800",received:"bg-blue-100 text-blue-800",approved:"bg-green-100 text-green-800",published:"bg-purple-100 text-purple-800",rejected:"bg-red-100 text-red-800",cancelled:"bg-gray-100 text-gray-800"}[e?.toLowerCase()]||"bg-gray-100 text-gray-800"}function _(e){v.value=e,g.value=!0}function F(){g.value=!1,v.value=void 0}const R=f([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Bill #",value:"billId",sortable:!1,hidden:!1,customRender:function(e,i){return l("button",{onClick:()=>_(e),type:"button",class:"px-2 py-1 font-semibold rounded-md hover:underline transition-colors duration-200 text-left cursor-pointer"},e?.billId||"—")}},{name:"Client",value:"client.name",sortable:!1,hidden:!1},{name:"Patient",value:"",sortable:!1,hidden:!1,customRender:function(e,i){if(!e?.orders||e.orders.length===0)return l("span","—");const o=e.orders[0]?.patient;if(!o)return l("span","—");const n=`${o?.firstName||""} ${o?.lastName||""}`.trim(),b=o?.gender?` (${o.gender})`:"";return l("span",`${n}${b}`)}},{name:"Samples",value:"",sortable:!1,hidden:!1,customRender:function(e,i){if(!e?.orders||e.orders.length===0)return l("span","—");const o=[];return e.orders.forEach((n,b)=>{n.samples&&n.samples.length>0&&n.samples.forEach((h,z)=>{const O=C(h?.status);o.push(l("div",{key:`${b}-${z}`,class:"mb-2"},[l("span",{class:"font-mono text-sm"},h?.sampleId||"—"),l("span",{class:"mx-2"},"•"),l("span",{class:`text-xs px-2 py-1 rounded ${O}`},h?.status||"—")]))})}),l("div",o.length>0?o:l("span","—"))}},{name:"Amount Charged",value:"totalCharged",sortable:!1,hidden:!1,customRender:function(e,i){return l("span",`$${parseFloat(e?.totalCharged||0).toFixed(2)}`)}},{name:"Amount Paid",value:"totalPaid",sortable:!1,hidden:!1,customRender:function(e,i){return l("span",`$${parseFloat(e?.totalPaid||0).toFixed(2)}`)}},{name:"Balance",value:"",sortable:!1,hidden:!1,customRender:function(e,i){const o=parseFloat(e?.totalCharged||0)-parseFloat(e?.totalPaid||0),n=o>0?"text-red-600":"text-green-600";return l("span",{class:n},`$${o.toFixed(2)}`)}},{name:"Partial",value:"partial",sortable:!1,hidden:!1,customRender:function(e,i){const o=e?.partial?"Yes":"No",n=e?.partial?"bg-orange-100 text-orange-800":"bg-green-100 text-green-800";return l("span",{class:`px-2 py-1 rounded text-sm font-medium ${n}`},o)}},{name:"Status",value:"isActive",sortable:!1,hidden:!1,customRender:function(e,i){const o=e?.isActive?"Active":"Inactive",n=e?.isActive?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800";return l("span",{class:`px-2 py-1 rounded text-sm font-medium ${n}`},o)}},{name:"Date",value:"createdAt",sortable:!1,hidden:!1,customRender:function(e,i){return l("span",new Date(e?.createdAt).toLocaleDateString())}}]);let t=j({pageSize:50,afterCursor:"",beforeCursor:"",text:"",isActive:null,partial:null,clientUid:"",sortBy:["-uid"],filterAction:!1});const B=f(null),y=f(null);J(()=>{d()});async function d(){await p.searchBills({pageSize:t.pageSize,afterCursor:t.afterCursor||void 0,beforeCursor:t.beforeCursor||void 0,text:t.text||void 0,isActive:t.isActive!==null?t.isActive:void 0,partial:t.partial!==null?t.partial:void 0,clientUid:t.clientUid||void 0,sortBy:t.sortBy})}function T(e){e==="all"?t.partial=null:e==="partial"?t.partial=!0:e==="complete"&&(t.partial=!1),t.afterCursor="",t.beforeCursor="",t.filterAction=!0,B.value=e,d()}function k(e){e==="all"?t.isActive=null:e==="active"?t.isActive=!0:e==="inactive"&&(t.isActive=!1),t.afterCursor="",t.beforeCursor="",t.filterAction=!0,y.value=e,d()}function E(e){t.pageSize=100,t.afterCursor="",t.beforeCursor="",t.text=e.filterText,t.filterAction=!0,d()}function L(e){t.pageSize=e.fetchCount,t.afterCursor=u?.value?.endCursor??"",t.beforeCursor="",t.text=e.filterText,t.filterAction=!1,d()}function M(e){t.isActive=e,t.afterCursor="",t.beforeCursor="",t.filterAction=!0,d()}const U=Y(()=>`${m?.value?.length} of ${u?.value?.totalCount??0} bills`),A={DataTable:x,BillDetail:a,billingStore:p,bills:m,billPageInfo:u,fetchingBills:c,showBillDetail:g,selectedBill:v,getStatusBadgeClass:C,openBillDetail:_,closeBillDetail:F,tableColumns:R,get billParams(){return t},set billParams(e){t=e},selectedPartial:B,selectedIsActive:y,fetchBills:d,handlePartialFilter:T,handleIsActiveFilter:k,searchBills:E,showMoreBills:L,filterByStatus:M,countNone:U};return Object.defineProperty(A,"__isScriptSetup",{enumerable:!1,value:!0}),A}}),ee={class:"space-y-6"},te={class:"rounded-lg border border-border bg-card shadow-sm p-4"},ae={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},le=["value"],se=["value"],re={class:"rounded-lg border border-border bg-card shadow-sm p-6"};function oe(N,r,x,a,p,m){const u=G("fel-drawer");return S(),H(W,null,[s("div",ee,[s("div",te,[s("div",ae,[s("div",null,[r[3]||(r[3]=s("label",{class:"block text-sm font-medium text-foreground mb-2"},"Billing Type",-1)),s("select",{value:a.selectedPartial,onChange:r[0]||(r[0]=c=>a.handlePartialFilter(c.target.value)),class:"w-full px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary"},[...r[2]||(r[2]=[s("option",{value:"all"},"All Types",-1),s("option",{value:"complete"},"Complete Bills",-1),s("option",{value:"partial"},"Partial Bills",-1)])],40,le)]),s("div",null,[r[5]||(r[5]=s("label",{class:"block text-sm font-medium text-foreground mb-2"},"Bill Status",-1)),s("select",{value:a.selectedIsActive,onChange:r[1]||(r[1]=c=>a.handleIsActiveFilter(c.target.value)),class:"w-full px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary"},[...r[4]||(r[4]=[s("option",{value:"all"},"All Status",-1),s("option",{value:"active"},"Active",-1),s("option",{value:"inactive"},"Inactive",-1)])],40,se)])])]),s("div",re,[D(a.DataTable,{columns:a.tableColumns,data:a.bills,toggleColumns:!0,loading:a.fetchingBills,paginable:!0,pageMeta:{fetchCount:a.billParams.pageSize,hasNextPage:a.billPageInfo?.hasNextPage,countNone:a.countNone},searchable:!0,filterable:!1,onOnSearch:a.searchBills,onOnPaginate:a.showMoreBills,selectable:!1},null,8,["columns","data","loading","pageMeta"])])]),D(u,{show:a.showBillDetail,onClose:a.closeBillDetail,"content-width":"w-2/4"},{header:I(()=>[...r[6]||(r[6]=[s("span",null,"Bill Details",-1)])]),body:I(()=>[a.selectedBill?(S(),K(a.BillDetail,{key:0,customerUid:a.selectedBill?.patientUid??"",testBill:a.selectedBill},null,8,["customerUid","testBill"])):Q("",!0)]),_:1},8,["show"])],64)}const ue=q(Z,[["render",oe],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/billing/BillingListing.vue"]]);export{ue as default};
