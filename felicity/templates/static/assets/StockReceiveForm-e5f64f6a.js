import{W as ee,f as te,a2 as C,r as oe,o as i,c as l,a7 as s,O as t,F as R,H as S,J as u,L as n,D as a,a4 as U,af as d,a as L,Z as b,E as M,C as se,_ as re}from"./index-93739211.js";import ie from"./vue-multiselect.esm-183ee7c8.js";import{c as Q,a as k,e as y,g as $,u as le,f as c}from"./array-2f9882bb.js";import{u as ue,R as ne,n as ae}from"./inventory-962a7375.js";import{a as de}from"./storage-e041f071.js";import{u as ce}from"./setup-e711c708.js";import{u as me}from"./user-3b0a83d1.js";import"./_queries-2ba61825.js";const pe=["inert"],ve={key:0,class:"p-3 bg-destructive/10 text-destructive rounded-md mb-4"},fe={class:"mt-2 list-disc list-inside text-sm"},be={class:"space-y-2"},ye={key:0,class:"text-sm text-destructive"},ge={class:"space-y-2"},xe={class:"w-full"},ke={key:0,class:"text-sm text-destructive"},_e={class:"space-y-2"},we=["value"],Re={key:0,class:"text-sm text-destructive"},Se={class:"space-y-2"},Ue=["value"],Ve={key:0,class:"text-sm text-destructive"},De={class:"space-y-2"},qe={class:"w-full"},Fe={key:0,class:"text-sm text-destructive"},Pe={class:"space-y-2"},he={class:"w-full"},Ie={key:0,class:"text-sm text-destructive"},Ne={class:"space-y-2"},Be={class:"w-full"},Te={key:0,class:"text-sm text-destructive"},Ce={class:"space-y-2"},Le={class:"w-full"},Me={key:0,class:"text-sm text-destructive"},Qe={class:"space-y-2"},$e={class:"w-full"},Ae={key:0,class:"text-sm text-destructive"},Ee={class:"space-y-2"},Ke={class:"w-full"},je={key:0,class:"text-sm text-destructive"},Oe={class:"space-y-2"},Ge={class:"w-full"},He={key:0,class:"text-sm text-destructive"},Je={class:"space-y-2"},We=["value"],Ze={key:0,class:"text-sm text-destructive"},ze={class:"flex justify-end"},Xe={type:"submit",class:"px-4 py-2 text-sm font-medium text-primary-foreground bg-primary border border-transparent rounded-md shadow-sm hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors duration-200"},Ye=ee({__name:"StockReceiveForm",emits:["close"],setup(et,{emit:A}){const E=A,K=ue(),j=ce();de();const O=me(),{withClientMutation:G,withClientQuery:H}=te(),B=C([]),g=C(!1),J=Q({stockItemVariant:Q().required("StockItem is required"),supplierUid:k().required(),unitUid:k().required(),lotNumber:k().required(),unitPrice:y().nullable().default(0),totalPrice:y().nullable().default(0),singlesReceived:y().required().default(0),packagesReceived:y().required().default(0),packageFactor:y().required().default(1),quantityReceived:y().default(0),receiptType:k().required().default("purchase"),receiptDate:$().required("Date received is required"),receiptByUid:k().required("Receiver is required"),expiryDate:$().required("Date expiring is required")}),{handleSubmit:W,errors:r}=le({validationSchema:J,initialValues:{singlesReceived:0,packagesReceived:0,packageFactor:1,quantityReceived:0}}),{value:_}=c("stockItemVariant"),{value:V}=c("supplierUid"),{value:D}=c("unitUid"),{value:q}=c("lotNumber"),{value:v}=c("totalPrice"),{value:m}=c("packagesReceived"),{value:x}=c("packageFactor"),{value:f}=c("quantityReceived"),{value:F}=c("receiptType"),{value:P}=c("receiptDate"),{value:h}=c("receiptByUid"),{value:I}=c("expiryDate"),T=W(p=>Z(p));function Z(p){g.value=!0;const e={...p,productUid:_?.value?.uid,unitPrice:0,totalPrice:0};delete e.stockItemVariant,G(ne,{payload:e},"createStockReceipt").then(w=>{}).finally(()=>{g.value=!1,E("close")})}const z=async p=>{p.length>3&&H(ae,{first:50,after:"",text:p,sortBy:["name"]},"stockProductAll").then(w=>{B.value=w?.items})},X=(p,e)=>`${p.stockItem?.name} - ${p.name}`,N=()=>{!v.value&&!m.value&&(f.value=0),!v.value&&m.value&&(f.value=m.value*x.value),v.value&&!m.value&&(f.value=v.value),m.value||(m.value=0),f.value=v.value+m.value*x.value};return(p,e)=>{const w=oe("fel-loader");return i(),l("form",{onSubmit:e[15]||(e[15]=se((...o)=>s(T)&&s(T)(...o),["prevent"])),class:"rounded-md py-4 space-y-4",autocomplete:"off",inert:g.value},[Object.keys(s(r)).length>0?(i(),l("div",ve,[e[16]||(e[16]=t("p",{class:"text-sm font-medium"},"Please correct the following errors:",-1)),t("ul",fe,[(i(!0),l(R,null,S(s(r),(o,Y)=>(i(),l("li",{key:Y},u(o),1))),128))])])):n("",!0),t("div",be,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-foreground"},"Receipt Type",-1)),a(t("select",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200","onUpdate:modelValue":e[0]||(e[0]=o=>d(F)?F.value=o:null),"aria-label":"Receipt Type"},e[17]||(e[17]=[t("option",{value:"null"},null,-1),t("option",{value:"purchase"},"Purchased",-1),t("option",{value:"pushed"},"Pushed",-1),t("option",{value:"transfer_in"},"Transfer In",-1)]),512),[[U,s(F)]]),s(r).receiptType?(i(),l("div",ye,u(s(r).receiptType),1)):n("",!0)]),t("div",ge,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-foreground"},"Stock Item",-1)),t("div",xe,[L(s(ie),{placeholder:"Select a Stock Item",modelValue:s(_),"onUpdate:modelValue":e[1]||(e[1]=o=>d(_)?_.value=o:null),options:B.value,searchable:!0,"track-by":"uid",customLabel:X,onSearchChange:z,class:"multiselect-primary"},null,8,["modelValue","options"]),s(r).stockItemVariantUid?(i(),l("div",ke,u(s(r).stockItemVariantUid),1)):n("",!0)])]),t("div",_e,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-foreground"},"Supplier",-1)),a(t("select",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200","onUpdate:modelValue":e[2]||(e[2]=o=>d(V)?V.value=o:null),"aria-label":"Supplier"},[e[20]||(e[20]=t("option",{value:"null"},null,-1)),(i(!0),l(R,null,S(s(j).suppliers,o=>(i(),l("option",{key:o.uid,value:o.uid},u(o.name),9,we))),128))],512),[[U,s(V)]]),s(r).supplierUid?(i(),l("div",Re,u(s(r).supplierUid),1)):n("",!0)]),t("div",Se,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-foreground"},"Unit (Single)",-1)),a(t("select",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200","onUpdate:modelValue":e[3]||(e[3]=o=>d(D)?D.value=o:null),"aria-label":"Unit"},[e[22]||(e[22]=t("option",{value:"null"},null,-1)),(i(!0),l(R,null,S(s(K).units,o=>(i(),l("option",{key:o.uid,value:o.uid},u(o.name),9,Ue))),128))],512),[[U,s(D)]]),s(r).unitUid?(i(),l("div",Ve,u(s(r).unitUid),1)):n("",!0)]),t("div",De,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-foreground"},"Lot Number",-1)),t("div",qe,[a(t("input",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200","onUpdate:modelValue":e[4]||(e[4]=o=>d(q)?q.value=o:null),placeholder:"Lot Number..."},null,512),[[b,s(q)]]),s(r).lotNumber?(i(),l("div",Fe,u(s(r).lotNumber),1)):n("",!0)])]),t("div",Pe,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-foreground"},"Packages Received",-1)),t("div",he,[a(t("input",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200",type:"number","onUpdate:modelValue":e[5]||(e[5]=o=>d(m)?m.value=o:null),placeholder:"Quantity Received...",onKeyup:N,onFocus:e[6]||(e[6]=o=>o.target.select())},null,544),[[b,s(m)]]),s(r).packagesReceived?(i(),l("div",Ie,u(s(r).packagesReceived),1)):n("",!0)])]),t("div",Ne,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-foreground"},"Package Factor",-1)),t("div",Be,[a(t("input",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200",type:"number","onUpdate:modelValue":e[7]||(e[7]=o=>d(x)?x.value=o:null),placeholder:"Package Factor...",onKeyup:N,onFocus:e[8]||(e[8]=o=>o.target.select())},null,544),[[b,s(x)]]),s(r).packageFactor?(i(),l("div",Te,u(s(r).packageFactor),1)):n("",!0)])]),t("div",Ce,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-foreground"},"Singles Received",-1)),t("div",Le,[a(t("input",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200",type:"number","onUpdate:modelValue":e[9]||(e[9]=o=>d(v)?v.value=o:null),placeholder:"Quantity Received...",onKeyup:N,onFocus:e[10]||(e[10]=o=>o.target.select())},null,544),[[b,s(v)]]),s(r).singlesReceived?(i(),l("div",Me,u(s(r).singlesReceived),1)):n("",!0)])]),t("div",Qe,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-foreground"},"Quantity Received",-1)),t("div",$e,[a(t("input",{class:"w-full px-3 py-2 text-foreground bg-muted border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200",type:"number","onUpdate:modelValue":e[11]||(e[11]=o=>d(f)?f.value=o:null),disabled:""},null,512),[[b,s(f)]]),s(r).quantityReceived?(i(),l("div",Ae,u(s(r).quantityReceived),1)):n("",!0)])]),t("div",Ee,[e[29]||(e[29]=t("label",{class:"block text-sm font-medium text-foreground"},"Expiry Date",-1)),t("div",Ke,[a(t("input",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200",type:"date","onUpdate:modelValue":e[12]||(e[12]=o=>d(I)?I.value=o:null),placeholder:"Expiry Date"},null,512),[[b,s(I)]]),s(r).expiryDate?(i(),l("div",je,u(s(r).expiryDate),1)):n("",!0)])]),t("div",Oe,[e[30]||(e[30]=t("label",{class:"block text-sm font-medium text-foreground"},"Received Date",-1)),t("div",Ge,[a(t("input",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200",type:"date","onUpdate:modelValue":e[13]||(e[13]=o=>d(P)?P.value=o:null),placeholder:"Received Date"},null,512),[[b,s(P)]]),s(r).receiptDate?(i(),l("div",He,u(s(r).receiptDate),1)):n("",!0)])]),t("div",Je,[e[32]||(e[32]=t("label",{class:"block text-sm font-medium text-foreground"},"Received By",-1)),a(t("select",{class:"w-full px-3 py-2 text-foreground bg-background border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary transition-colors duration-200","onUpdate:modelValue":e[14]||(e[14]=o=>d(h)?h.value=o:null),"aria-label":"Received By"},[e[31]||(e[31]=t("option",{value:"null"},null,-1)),(i(!0),l(R,null,S(s(O).users,o=>(i(),l("option",{key:o.uid,value:o.uid},u(o.firstName)+" "+u(o.lastName),9,We))),128))],512),[[U,s(h)]]),s(r).receiptByUid?(i(),l("div",Ze,u(s(r).receiptByUid),1)):n("",!0)]),e[33]||(e[33]=t("div",{class:"border-t border-border my-6"},null,-1)),t("div",ze,[a(t("button",Xe," Save ",512),[[M,!g.value]]),a(L(w,{message:"Adding Inventory ..."},null,512),[[M,g.value]])])],40,pe)}}});const at=re(Ye,[["__scopeId","data-v-65664c55"],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/inventory/StockReceiveForm.vue"]]);export{at as default};
