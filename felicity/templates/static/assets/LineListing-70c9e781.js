import{V,as as M,a1 as c,h as E,a8 as B,r as g,o as s,c as d,O as e,a as P,a6 as l,F as v,H as _,J as n,a4 as A,L as b,z as H,M as w,C as U,D as a,a3 as m,Y as k,at as G,_ as T}from"./index-74595aff.js";import{u as $}from"./analysis-7c37619c.js";import{f}from"./index-52e9caa2.js";const j={class:"mt-4"},I={class:"flex justify-between items-center mb-4"},N={key:0,class:"text-center py-4"},q={key:1,class:"text-center py-4 text-muted-foreground"},O={key:2,class:"overflow-x-auto"},z={class:"min-w-full bg-background shadow rounded-sm border border-foreground"},J={class:"px-4 py-2 border-b border-foreground text-primary"},K={class:"px-4 py-2 border-b border-foreground text-primary"},Q={class:"px-4 py-2 border-b border-foreground text-primary"},W={class:"px-4 py-2 border-b border-foreground text-primary"},X={class:"px-4 py-2 border-b border-foreground text-primary"},Z={class:"px-4 py-2 border-b border-foreground"},ee={class:"px-4 py-2 border-b border-foreground text-right space-x-2"},te=["onClick"],oe=["onClick"],re={class:"grid grid-cols-3 gap-4"},se=["value"],de={class:"grid grid-cols-3 gap-4"},ne={class:"flex justify-end space-x-2"},le=["disabled"],ae=V({__name:"LineListing",setup(ie){const y=$(),{reports:x,fetchReports:D,generateReport:C,deleteReport:h}=M(),u=c(!1),i=c(!1),r=E({listingForm:{report_type:"",analyses_uids:[],sample_states:[],date_column:"",period_start:"",period_end:""}});B(async()=>{u.value=!0,y.fetchAnalysesServices({first:void 0,after:"",text:"",sortBy:["name"]}),await D().finally(()=>{u.value=!1})});const L=()=>{C({...r.listingForm}),i.value=!1},F=p=>{const t=document.createElement("a");t.download=p.report_type+"-"+p.crated_at,t.href=G+"/"+p.location,document.body.appendChild(t),t.click(),document.body.removeChild(t)};return(p,t)=>{const S=g("fel-loader"),R=g("fel-modal");return s(),d("div",j,[e("div",I,[t[9]||(t[9]=e("h1",{class:"text-xl text-foreground font-semibold"},"Line Listing Reports",-1)),e("button",{class:"bg-primary text-primary-foreground px-4 py-2 rounded-md hover:bg-primary/90",onClick:t[0]||(t[0]=o=>i.value=!0)}," Generate Report ")]),u.value?(s(),d("div",N,[P(S,{message:"Loading reports..."})])):l(x)?.length?(s(),d("div",O,[e("table",z,[t[12]||(t[12]=e("thead",null,[e("tr",null,[e("th",{class:"px-4 py-2 border-b border-foreground text-left text-foreground"},[e("input",{type:"checkbox"})]),e("th",{class:"px-4 py-2 border-b border-foreground text-left text-foreground"}," Report Type "),e("th",{class:"px-4 py-2 border-b border-foreground text-left text-foreground"}," Generated By "),e("th",{class:"px-4 py-2 border-b border-foreground text-left text-foreground"}," Date Generated "),e("th",{class:"px-4 py-2 border-b border-foreground text-left text-foreground"}," Period Start "),e("th",{class:"px-4 py-2 border-b border-foreground text-left text-foreground"}," Period End "),e("th",{class:"px-4 py-2 border-b border-foreground text-left text-foreground"}," Status "),e("th",{class:"px-4 py-2 border-b border-foreground"})])],-1)),e("tbody",null,[(s(!0),d(v,null,_(l(x),o=>(s(),d("tr",{key:o.uid,class:"hover:bg-accent/50"},[t[11]||(t[11]=e("td",{class:"px-4 py-2 border-b border-foreground"},[e("input",{type:"checkbox"})],-1)),e("td",J,n(o.report_type),1),e("td",K,n(o?.created_by?.first_name)+" "+n(o?.created_by?.last_name),1),e("td",Q,n(l(f)(o?.created_at,"YYYY-MM-DD HH:mm")),1),e("td",W,n(l(f)(o?.period_start,"YYYY-MM-DD HH:mm")),1),e("td",X,n(l(f)(o?.period_end,"YYYY-MM-DD HH:mm")),1),e("td",Z,[e("span",{class:A([{"bg-success/10 text-success":o?.status==="READY","bg-warning/10 text-warning":o?.status==="PROCESSING","bg-destructive/10 text-destructive":o?.status==="FAILED"},"px-2 py-1 rounded-full text-sm"])},n(o?.status),3)]),e("td",ee,[o.status?.toLowerCase()==="ready"?(s(),d("button",{key:0,class:"px-3 py-1 border border-primary text-primary rounded-md hover:bg-primary hover:text-primary-foreground",onClick:Y=>F(o)}," Download ",8,te)):b("v-if",!0),o.status?.toLowerCase()==="ready"?(s(),d("button",{key:1,class:"px-3 py-1 border border-destructive text-destructive rounded-md hover:bg-destructive hover:text-destructive-foreground",onClick:Y=>l(h)(o)}," Delete ",8,oe)):b("v-if",!0)])]))),128))])])])):(s(),d("div",q,t[10]||(t[10]=[e("p",{class:"text-destructive"},"There are no downloaded reports yet",-1),e("hr",{class:"my-2"},null,-1),e("p",{class:"italic"}," Once a download request has been made, your reports will appear here ",-1)]))),i.value?(s(),H(R,{key:3,onClose:t[8]||(t[8]=o=>i.value=!1),"content-width":"w-3/4"},{header:w(()=>t[13]||(t[13]=[e("h3",{class:"text-lg font-semibold text-foreground"},"Generate Line Listing Report",-1)])),body:w(()=>[e("form",{onSubmit:U(L,["prevent"]),class:"space-y-4"},[e("div",re,[e("div",null,[t[15]||(t[15]=e("label",{class:"block text-sm font-medium text-foreground mb-1"},"Report Type",-1)),a(e("select",{"onUpdate:modelValue":t[1]||(t[1]=o=>r.listingForm.report_type=o),class:"w-full px-3 py-2 border border-input rounded-md"},t[14]||(t[14]=[e("option",{value:"line_listing"},"Line Listing",-1)]),512),[[m,r.listingForm.report_type]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block text-sm font-medium text-foreground mb-1"},"Analyses",-1)),a(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>r.listingForm.analyses_uids=o),class:"w-full px-3 py-2 border border-input rounded-md",multiple:""},[(s(!0),d(v,null,_(l(y).analysesServices,o=>(s(),d("option",{key:o.uid,value:o.uid},n(o.name),9,se))),128))],512),[[m,r.listingForm.analyses_uids]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-foreground mb-1"},"States",-1)),a(e("select",{"onUpdate:modelValue":t[3]||(t[3]=o=>r.listingForm.sample_states=o),class:"w-full px-3 py-2 border border-input rounded-md",multiple:""},t[17]||(t[17]=[e("option",{value:"published"},"Published",-1),e("option",{value:"verified"},"Verified",-1),e("option",{value:"to_be_verified"},"To Be Verified",-1),e("option",{value:"received"},"Received",-1),e("option",{value:"cancelled"},"Cancelled",-1),e("option",{value:"rejected"},"Rejected",-1),e("option",{value:"invalidated"},"Invalidated",-1),e("option",{value:"due"},"Due",-1)]),512),[[m,r.listingForm.sample_states]])])]),e("div",de,[e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-foreground mb-1"},"Period Date Criteria",-1)),a(e("select",{"onUpdate:modelValue":t[4]||(t[4]=o=>r.listingForm.date_column=o),class:"w-full px-3 py-2 border border-input rounded-md"},t[19]||(t[19]=[e("option",{value:"created_at"},"Created Date",-1),e("option",{value:"date_published"},"Published Date",-1),e("option",{value:"date_submitted"},"Submission Date",-1),e("option",{value:"date_verified"},"Verified Date",-1),e("option",{value:"date_cancelled"},"Cancellation Date",-1),e("option",{value:"date_invalidated"},"Invalidation Date",-1)]),512),[[m,r.listingForm.date_column]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-foreground mb-1"},"Period Start",-1)),a(e("input",{"onUpdate:modelValue":t[5]||(t[5]=o=>r.listingForm.period_start=o),type:"datetime-local",class:"w-full px-3 py-2 border border-input rounded-md",required:""},null,512),[[k,r.listingForm.period_start]])]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-foreground mb-1"},"Period End",-1)),a(e("input",{"onUpdate:modelValue":t[6]||(t[6]=o=>r.listingForm.period_end=o),type:"datetime-local",class:"w-full px-3 py-2 border border-input rounded-md",required:""},null,512),[[k,r.listingForm.period_end]])])]),e("div",ne,[e("button",{type:"button",class:"px-4 py-2 border border-input rounded-md hover:bg-accent",onClick:t[7]||(t[7]=o=>i.value=!1)}," Cancel "),e("button",{type:"submit",class:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90",disabled:u.value}," Generate ",8,le)])],32)]),_:1})):b("v-if",!0)])}}}),be=T(ae,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/dashboard/LineListing.vue"]]);export{be as default};
