import{P as U,e as D,Z as b,o as i,c as l,A as B,V as j,b as n,a1 as s,J as f,L as P,E as x,_ as R,aa as L,h as y,a2 as Q,as as J,a as w,F as E,aT as W,aU as Z,D as K}from"./index-fa13e788.js";import{o as X,p as Y,q as _,r as ee}from"./grind.queries-2a7b3de7.js";const te={class:"mb-4"},ne=["rows","placeholder"],oe={class:"flex items-center justify-end mt-2 gap-2"},ie={key:0,class:"flex items-center gap-2 font-sm"},le=n("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},[n("path",{"fill-rule":"evenodd",d:"M7.707 3.293a1 1 0 010 1.414L5.414 7H11a7 7 0 017 7v2a1 1 0 11-2 0v-2a5 5 0 00-5-5H5.414l2.293 2.293a1 1 0 11-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1),se=[le],de=U({__name:"CommentForm",props:{errandUid:{type:String,required:!0},parentDiscussion:{type:Object,default:void 0},isReply:{type:Boolean,default:!1}},emits:["commentAdded","cancelReply"],setup(e,{emit:g}){const t=e,o=g,{withClientMutation:u}=D(),d=b("");function a(){d.value.trim()&&u(X,{payload:{comment:d.value,errandUid:t.errandUid,parentUid:t.parentDiscussion?.uid}},"createGrindErrandDiscussion").then(()=>{d.value="",o("commentAdded")})}function m(){o("cancelReply")}return(v,c)=>(i(),l("div",te,[B(n("textarea",{"onUpdate:modelValue":c[0]||(c[0]=p=>d.value=p),rows:e.isReply?2:3,class:s(`w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500 ${e.isReply?"text-sm":""}`),placeholder:e.isReply?"Write a reply...":"Add a comment..."},null,10,ne),[[j,d.value]]),n("div",oe,[e.isReply?(i(),l("button",{key:0,onClick:m,class:"px-2 py-1 border border-gray-300 rounded hover:bg-gray-50 text-sm"}," Cancel ")):f("",!0),n("button",{onClick:a,class:s(`px-3 py-1.5 bg-blue-500 text-white rounded hover:bg-blue-600 flex items-center gap-2 ${e.isReply?"text-sm px-2 py-1":""}`)},[e.isReply?f("",!0):(i(),l("div",ie,[...se])),P(" "+x(e.isReply?"Reply":"Comment"),1)],2)])]))}}),M=R(de,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/grind/CommentForm.vue"]]),N=e=>(W("data-v-31ab5fff"),e=e(),Z(),e),me={class:"flex items-start gap-4"},ae={class:"flex-1"},re={class:"flex justify-between"},ce={key:0,class:"flex gap-2"},ue=N(()=>n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"},null,-1)),ge=[ue],ve=N(()=>n("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h10a8 8 0 018 8v2M3 10l6 6m-6-6l6-6"},null,-1)),ye=[ve],fe=["rows"],he={class:"flex items-center justify-end gap-2 mt-2"},pe=["innerHTML"],Ce=U({__name:"CommentItem",props:{comment:{type:Object,required:!0},replyingTo:{type:Object,default:null},editingComment:{type:Object,default:null},level:{type:Number,default:0}},emits:["setReplyingTo","setEditingComment","commentAdded","commentUpdated"],setup(e,{emit:g}){const t=e;L(()=>{m(t.comment.uid)});const o=g,{withClientMutation:u,withClientQuery:d}=D(),a=b([]);function m(h){d(Y,{parentUid:h},"grindErrandDiscussionsByParent").then(C=>{C&&(a.value=C)})}const v=y(()=>t.editingComment&&t.editingComment.uid===t.comment.uid),c=y(()=>t.replyingTo&&t.replyingTo.uid===t.comment.uid),p=y(()=>t.level<2),$=y(()=>{switch(t.level){case 0:return"h-10 w-10";case 1:return"h-8 w-8";case 2:return"h-6 w-6";default:return"h-10 w-10"}}),r=y(()=>{switch(t.level){case 0:return"bg-orange-100 text-orange-600";case 1:return"bg-blue-100 text-blue-600";case 2:return"bg-green-100 text-green-600";default:return"bg-orange-100 text-orange-600"}}),k=y(()=>{switch(t.level){case 0:return"";case 1:return"text-sm";case 2:return"text-xs";default:return""}}),T=y(()=>{switch(t.level){case 0:return"h-5 w-5";case 1:return"h-4 w-4";case 2:return"h-3.5 w-3.5";default:return"h-5 w-5"}});function S(){c.value?o("setReplyingTo",null):o("setReplyingTo",t.comment)}function G(){o("setEditingComment",{...t.comment})}function V(){o("setEditingComment",null)}function z(){t.editingComment&&u(_,{uid:t.comment.uid,payload:{comment:t.editingComment.comment,errandUid:t.editingComment.errandUid}},"updateGrindErrandDiscussion").then(()=>{o("commentUpdated")})}function A(){o("commentAdded"),m(t.comment.uid)}function H(){o("commentUpdated"),m(t.comment.uid)}function O(h){o("setReplyingTo",h)}function F(h){o("setEditingComment",h)}return(h,C)=>(i(),l(E,null,[n("div",me,[n("div",{class:s(`${$.value} shrink-0 rounded-full ${r.value} flex items-center justify-center font-semibold ${k.value}`)},x(Q(J)(e.comment.createdBy?.firstName,e.comment.createdBy?.lastName)),3),n("div",ae,[n("div",re,[n("div",null,[n("h3",{class:s(`font-medium ${k.value}`)},x(e.comment.createdBy?.firstName)+" "+x(e.comment.createdBy?.lastName),3),n("div",{class:s(`${e.level>0?"text-xs":"text-sm"} text-gray-500`)},x(e.comment.createdAt),3)]),v.value?f("",!0):(i(),l("div",ce,[e.comment.canEdit?(i(),l("button",{key:0,onClick:G,class:"text-gray-500 hover:text-blue-500"},[(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",class:s(T.value),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...ge],2))])):f("",!0),p.value?(i(),l("button",{key:1,onClick:S,class:"text-gray-500 hover:text-blue-500"},[(i(),l("svg",{xmlns:"http://www.w3.org/2000/svg",class:s(T.value),fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[...ye],2))])):f("",!0)]))]),v.value?(i(),l("div",{key:0,class:s(`mt-${e.level===0||e.level===1?2:1}`)},[B(n("textarea",{"onUpdate:modelValue":C[0]||(C[0]=q=>e.editingComment.comment=q),rows:e.level===0?3:2,class:s(`w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-sky-500 focus:border-sky-500 ${e.level===2?"text-xs":""}`)},null,10,fe),[[j,e.editingComment.comment]]),n("div",he,[n("button",{onClick:V,class:s(`px-${e.level<2?3:2} py-${e.level<2?"1.5":1} border border-gray-300 rounded hover:bg-gray-50 ${e.level>0?"text-sm":""}`)}," Cancel ",2),n("button",{onClick:z,class:s(`px-${e.level<2?3:2} py-${e.level<2?"1.5":1} bg-blue-500 text-white rounded hover:bg-blue-600 ${e.level>0?"text-sm":""}`)}," Save ",2)])],2)):(i(),l("div",{key:1,class:s(`mt-${e.level===0?2:1} text-gray-600 ${k.value}`),innerHTML:e.comment.comment},null,10,pe)),c.value?(i(),l("div",{key:2,class:s(`mt-${e.level===0?3:2}`)},[w(M,{"parent-discussion":e.comment,"is-reply":!0,errandUid:e.comment.errandUid,onCommentAdded:A,onCancelReply:S},null,8,["parent-discussion","errandUid"])],2)):f("",!0)])]),a.value.length>0?(i(),l("div",{key:0,class:s(`ml-${e.level===0?14:12} mt-4`)},[w(I,{comments:a.value,"replying-to":e.replyingTo,"editing-comment":e.editingComment,level:e.level+1,onSetReplyingTo:O,onSetEditingComment:F,onCommentAdded:A,onCommentUpdated:H},null,8,["comments","replying-to","editing-comment","level"])],2)):f("",!0)],64))}});const xe=R(Ce,[["__scopeId","data-v-31ab5fff"],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/grind/CommentItem.vue"]]),be=U({__name:"CommentList",props:{comments:{type:Array,required:!0},replyingTo:{type:Object,default:null},editingComment:{type:Object,default:null},level:{type:Number,default:0}},emits:["setReplyingTo","setEditingComment","commentAdded","commentUpdated"],setup(e,{emit:g}){const t=g;function o(m){t("setReplyingTo",m)}function u(m){t("setEditingComment",m)}function d(){t("commentAdded")}function a(){t("commentUpdated")}return(m,v)=>(i(),l("div",{class:s(`space-y-${e.level===0?"6":"4"}`)},[(i(!0),l(E,null,K(e.comments,c=>(i(),l("div",{key:c.uid,class:s(e.level===0?"border-b border-gray-200 pb-4":"")},[w(xe,{comment:c,"replying-to":e.replyingTo,"editing-comment":e.editingComment,level:e.level,onSetReplyingTo:o,onSetEditingComment:u,onCommentAdded:d,onCommentUpdated:a},null,8,["comment","replying-to","editing-comment","level"])],2))),128))],2))}}),I=R(be,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/grind/CommentList.vue"]]),we=U({__name:"CommentSystem",props:["errandUid"],setup(e){const g=e,{withClientQuery:t}=D(),o=b([]),u=b(null),d=b(null);L(()=>{a()});function a(){t(ee,{errandUid:g.errandUid},"grindErrandDiscussions").then(r=>{r&&(o.value=r)})}function m(){return o.value.filter(r=>!r.parentUid)}function v(){a(),u.value=null}function c(){a(),d.value=null}function p(r){u.value=r}function $(r){d.value=r}return(r,k)=>(i(),l(E,null,[w(M,{"errand-uid":e.errandUid,onCommentAdded:v},null,8,["errand-uid"]),w(I,{comments:m(),"replying-to":u.value,"editing-comment":d.value,"errand-uid":e.errandUid,onSetReplyingTo:p,onSetEditingComment:$,onCommentAdded:v,onCommentUpdated:c},null,8,["comments","replying-to","editing-comment","errand-uid"])],64))}}),Re=R(we,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/grind/CommentSystem.vue"]]);export{Re as default};
