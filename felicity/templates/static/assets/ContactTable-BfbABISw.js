import{a0 as F,ac as U,f as A,aq as S,a7 as b,_ as R,r as k,c as f,o as u,A as e,C as V,E as N,F as i,H as g,J as T,K as j,L as m,P as L,a as q,N as E,a2 as v,D as B}from"./index-DApeomWQ.js";import{a as I,b as O,D as H}from"./clients.mutations-m4eW20un.js";import{u as J}from"./client-BLllGT-l.js";import{s as K}from"./index-DmuM67UT.js";import"./location-CzglHsxT.js";const z=F({__name:"ContactTable",setup(D,{expose:o}){o();let a=J(),t=U();const{withClientMutation:d}=A(),{clientContacts:x,fetchingClientContacts:p}=S(a);let c=b(""),r=b(!1),s=b(!1),l=b({});const h=t.query.clientUid||"";h&&a.fetchClientContacts(h);function _(){d(I,{payload:{clientUid:t.query.clientUid,firstName:l.value.firstName,mobilePhone:l.value.mobilePhone,email:l.value.email}},"createClientContact").then(n=>a.addClientContact(n))}function y(){d(O,{uid:l.value.uid,payload:{clientUid:t.query.clientUid,firstName:l.value.firstName,mobilePhone:l.value.mobilePhone,email:l.value.email}},"updateClientContact").then(n=>a.updateClientContact(n))}function P(n,C={}){s.value=n,c.value=(n?"CREATE":"EDIT")+" CONTACT",r.value=!0,n?Object.assign(l,{}):Object.assign(l.value,{...C})}function M(){s.value===!0&&_(),s.value||y(),r.value=!1}const w={get clientStore(){return a},set clientStore(n){a=n},get router(){return t},set router(n){t=n},withClientMutation:d,clientContacts:x,fetchingClientContacts:p,get formTitle(){return c},set formTitle(n){c=n},get showContactModal(){return r},set showContactModal(n){r=n},get createContact(){return s},set createContact(n){s=n},get contact(){return l},set contact(n){l=n},clientUid:h,addClientContact:_,editClientContact:y,FormManager:P,saveForm:M,deleteClientContact:n=>{d(H,{uid:n.uid},"deleteClientContact").then(C=>{C&&a.deleteClientContact(n.uid)})},get shield(){return K}};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}}),G={class:"overflow-x-auto"},Q={class:"align-middle inline-block min-w-full shadow overflow-hidden bg-background shadow-dashboard px-2 pt-1 rounded-bl-lg rounded-br-lg"},W={class:"min-w-full fel-table"},X={class:"bg-background"},Y={class:"px-1 py-1 whitespace-nowrap border-b border-border"},Z={class:"flex items-center"},$={class:"text-sm leading-5 text-foreground"},ee={class:"px-1 py-1 whitespace-nowrap border-b border-border"},te={class:"text-sm leading-5 text-primary"},oe={class:"px-1 py-1 whitespace-nowrap border-b border-border"},ne={class:"text-sm leading-5 text-primary"},re={class:"px-1 py-1 whitespace-nowrap text-right border-b border-border text-sm leading-5"},le=["onClick"],ae=["onClick"],se={key:0,class:"py-4 text-center"},ie={action:"post",class:"p-1"},de={class:"grid grid-cols-2 gap-x-4 mb-4"},ce={class:"block col-span-1 mb-2"},ue={class:"block col-span-1 mb-2"},me={class:"block col-span-1 mb-2"};function be(D,o,a,t,d,x){const p=k("fel-loader"),c=k("fel-modal");return u(),f(T,null,[e("div",G,[i(e("button",{onClick:o[0]||(o[0]=r=>t.FormManager(!0)),class:"px-1 py-0 mb-4 border-primary border text-primary rounded-sm transition duration-300 hover:bg-primary hover:text-primary-foreground focus:outline-none"}," Add Contact ",512),[[g,t.shield.hasRights(t.shield.actions.CREATE,t.shield.objects.CLIENT)]]),e("div",Q,[e("table",W,[o[7]||(o[7]=e("thead",null,[e("tr",null,[e("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Full Name "),e("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Email "),e("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Phone "),e("th",{class:"px-1 py-1 border-b-2 border-border"})])],-1)),e("tbody",X,[(u(!0),f(T,null,j(t.clientContacts,r=>(u(),f("tr",{key:r.uid},[e("td",Y,[e("div",Z,[e("div",null,[e("div",$,m(r.firstName)+" "+m(r.lastName),1)])])]),e("td",ee,[e("div",te,m(r.email),1)]),e("td",oe,[e("div",ne,m(r.mobilePhone),1)]),e("td",re,[i(e("button",{onClick:s=>t.FormManager(!1,r),class:"px-2 py-1 mr-2 border border-border text-muted-foreground rounded-sm transition duration-300 hover:bg-muted hover:text-primary-foreground focus:outline-none"}," Edit ",8,le),[[g,t.shield.hasRights(t.shield.actions.UPDATE,t.shield.objects.CLIENT)]]),o[6]||(o[6]=L()),i(e("button",{onClick:s=>t.deleteClientContact(r),class:"px-2 py-1 mr-2 border border-destructive text-destructive rounded-sm transition duration-300 hover:bg-destructive hover:text-primary-foreground focus:outline-none"}," Deactivate ",8,ae),[[g,t.shield.hasRights(t.shield.actions.UPDATE,t.shield.objects.CLIENT)]])])]))),128))])]),t.fetchingClientContacts?(u(),f("div",se,[q(p,{message:"Fetching client contacts ..."})])):N("",!0)])]),t.showContactModal?(u(),V(c,{key:0,onClose:o[5]||(o[5]=r=>t.showContactModal=!1)},{header:E(()=>[e("h3",null,m(t.formTitle),1)]),body:E(()=>[e("form",ie,[e("div",de,[e("label",ce,[o[8]||(o[8]=e("span",{class:"text-foreground"},"Full Name",-1)),i(e("input",{class:"form-input mt-1 block w-full",autocomplete:"off","onUpdate:modelValue":o[1]||(o[1]=r=>t.contact.firstName=r),placeholder:"Full Name ..."},null,512),[[v,t.contact.firstName]])]),e("label",ue,[o[9]||(o[9]=e("span",{class:"text-foreground"},"Email",-1)),i(e("input",{class:"form-input mt-1 block w-full",autocomplete:"off","onUpdate:modelValue":o[2]||(o[2]=r=>t.contact.email=r),placeholder:"Email ..."},null,512),[[v,t.contact.email]])]),e("label",me,[o[10]||(o[10]=e("span",{class:"text-foreground"},"Mobile Phone",-1)),i(e("input",{class:"form-input mt-1 block w-full",autocomplete:"off","onUpdate:modelValue":o[3]||(o[3]=r=>t.contact.mobilePhone=r),placeholder:"Mobile Phone ..."},null,512),[[v,t.contact.mobilePhone]])])]),o[11]||(o[11]=e("hr",null,null,-1)),e("button",{type:"button",onClick:o[4]||(o[4]=B(r=>t.saveForm(),["prevent"])),class:"-mb-4 w-full border border-primary bg-primary text-primary-foreground rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-primary focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):N("",!0)],64)}const xe=R(z,[["render",be],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/client/_id/ContactTable.vue"]]);export{xe as default};
