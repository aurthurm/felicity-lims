const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vue-multiselect.esm-Cvm3ZCjW.js","assets/index-OdhKCqIc.js","assets/index-DD18L2yL.css"])))=>i.map(i=>d[i]);
import{Y as R,u as W,a0 as p,av as B,a7 as T,ah as X,U as Z,a5 as $,a6 as ee,bl as te,bm as oe,_ as re,r as U,c as a,o as i,a as u,z as e,A as I,C as x,D as w,al as k,J as se,I as l,F as S,H as L,K as f,M as C,L as Y,B as ne}from"./index-OdhKCqIc.js";import{f as ie}from"./index-CXV6PIcj.js";import{E as ae,a as le,b as de,c as me,d as ue}from"./EmptyTitle-aCQRDpx3.js";import{E as fe}from"./index-B3gRxKMC.js";import{G as ce,A as ge,E as pe}from"./grind.queries-D_H4x9UG.js";import{P as be}from"./PageHeading-Czi_4opS.js";const xe=R({__name:"SchemeListing",setup(H,{expose:o}){o();const E=$(()=>ee(()=>import("./vue-multiselect.esm-Cvm3ZCjW.js"),__vite__mapDeps([0,1,2]))),{withClientMutation:t,withClientQuery:_}=W();let y=p(!1),v=p(""),d=B({});const r=p(!0),n=p(!1),c=p([]),N=p([]);let m=B({first:12,after:"",text:"",sortBy:["created_at"],filterAction:!1});const D=p(0);let h=p({startCursor:"",endCursor:"",hasNextPage:!1,hasPreviousPage:!1});const F=T(()=>c.value.length+" of "+D.value+" schemes"),G=T(()=>n.value);function M(s){n.value=!0,_(ce,{first:s.first,after:s.after,text:s.text,sortBy:s.sortBy},"grindSchemeAll").then(b=>{b&&(c.value=b?.items,D.value=b?.totalCount||0,h.value=b?.pageInfo)}).finally(()=>{n.value=!1})}X(()=>{M(m),P()});function P(){_(Z,{first:100,after:"",text:"",sortBy:["first_name"]},"userAll").then(s=>{s&&(N.value=s?.items)})}function z(s){m.first=12,m.after="",m.text=s,m.filterAction=!0,M(m)}function O(){!h.value.hasNextPage||n.value||(m.first=6,m.after=h.value.endCursor,m.filterAction=!1,M(m))}function V(){Object.assign(d,{title:"",description:"",startDate:"",endDate:"",assignee:null,members:[]})}function K(){r.value=!0,y.value=!0,v.value="Create New Scheme",V()}function q(s){r.value=!1,y.value=!0,v.value="Edit Scheme",Object.assign(d,{...s})}function J(){const s=d.members?.map(g=>g.uid)||[],b={title:d.title,description:d.description,startDate:d.startDate,endDate:d.endDate,assignee:d.assignee?.uid,members:s};r.value===!0?t(ge,{payload:b},"createGrindScheme").then(g=>{g&&c.value.unshift(g)}):t(pe,{uid:d.uid,payload:b},"updateGrindScheme").then(g=>{if(g){const j=c.value.findIndex(Q=>Q.uid===g.uid);j!==-1&&(c.value[j]=g)}}),y.value=!1}const A={VueMultiselect:E,withClientMutation:t,withClientQuery:_,get showModal(){return y},set showModal(s){y=s},get formTitle(){return v},set formTitle(s){v=s},get form(){return d},set form(s){d=s},formAction:r,fetchingSchemes:n,schemes:c,users:N,get schemeParams(){return m},set schemeParams(s){m=s},schemesCount:D,get schemesPageInfo(){return h},set schemesPageInfo(s){h=s},countText:F,isLoading:G,fetchSchemes:M,fetchAvailableUsers:P,searchSchemes:z,loadMoreSchemes:O,resetForm:V,openCreateForm:K,openEditForm:q,saveForm:J,get formatDate(){return ie},get stringToColor(){return oe},get getUserInitials(){return te},get Empty(){return ue},get EmptyContent(){return me},get EmptyDescription(){return de},get EmptyHeader(){return le},get EmptyMedia(){return fe},get EmptyTitle(){return ae},PageHeading:be};return Object.defineProperty(A,"__isScriptSetup",{enumerable:!1,value:!0}),A}}),ye={class:"pb-8"},ve={class:"flex justify-between items-center mb-6"},he={class:"flex space-x-4"},we={class:"relative"},ke={class:"mb-4 text-sm text-foreground"},_e={key:0,class:"text-muted-foreground"},Me={key:1},Ce={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},De={class:"p-6"},Se={class:"flex justify-between items-start mb-3"},Ee=["onClick"],Ne={class:"text-foreground text-sm mb-4 line-clamp-2"},Pe={class:"flex items-center text-xs text-muted-foreground mb-4"},Ve={class:"flex items-center space-x-1"},Ae={key:0,class:"mb-4"},je={class:"flex items-center space-x-2"},Be={class:"text-sm text-foreground"},Te={key:1},Ue={class:"flex -space-x-2 overflow-hidden"},Ie=["title"],Le=["title"],Ye={class:"mt-4 pt-3 border-t border-border text-xs text-muted-foreground flex justify-between"},He={key:0},Fe={key:0,class:"mt-8 flex justify-center"},Ge=["disabled"],ze={key:0},Oe={key:1},Ke={class:"text-lg font-semibold text-foreground"},qe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Je={class:"flex justify-end space-x-3"},Qe={type:"submit",class:"px-4 py-2 text-sm font-medium text-primary-foreground bg-primary border border-transparent rounded-md shadow-sm hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors duration-200"};function Re(H,o,E,t,_,y){const v=U("router-link"),d=U("Modal");return i(),a(S,null,[u(t.PageHeading,{title:"Projects"}),e("div",ye,[e("div",ve,[e("div",he,[e("div",we,[w(e("input",{type:"text",placeholder:"Search schemes...",class:"w-full px-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-background text-foreground","onUpdate:modelValue":o[0]||(o[0]=r=>t.schemeParams.text=r),onKeyup:o[1]||(o[1]=se(r=>t.searchSchemes(t.schemeParams.text),["enter"]))},null,544),[[k,t.schemeParams.text]]),e("button",{onClick:o[2]||(o[2]=r=>t.searchSchemes(t.schemeParams.text)),class:"absolute right-2 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-primary transition-colors duration-200"},[...o[11]||(o[11]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)])])]),e("button",{onClick:t.openCreateForm,class:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"},[...o[12]||(o[12]=[e("span",{class:"flex items-center space-x-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",null,"Add Scheme")],-1)])])])]),e("div",ke,[t.isLoading?(i(),a("span",_e,"Loading schemes...")):(i(),a("span",Me,l(t.countText),1))]),e("div",Ce,[(i(!0),a(S,null,L(t.schemes,r=>(i(),a("div",{key:r.uid,class:"bg-background rounded-lg shadow-sm overflow-hidden border border-border hover:shadow-md transition-all duration-200"},[e("div",De,[e("div",Se,[u(v,{to:{name:"scheme-detail",params:{schemeUid:r?.uid}},class:"text-lg font-semibold text-foreground hover:text-primary transition-colors duration-200 truncate"},{default:f(()=>[C(l(r.title),1)]),_:2},1032,["to"]),e("button",{onClick:n=>t.openEditForm(r),class:"text-muted-foreground hover:text-primary transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary rounded-md p-1"},[...o[13]||(o[13]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,Ee)]),e("p",Ne,l(r.description||"No description provided"),1),e("div",Pe,[e("div",Ve,[o[14]||(o[14]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),e("span",null,l(t.formatDate(r.startDate,"D MMMM YYYY"))+" - "+l(t.formatDate(r.endDate,"D MMMM YYYY")),1)])]),r.assignee?(i(),a("div",Ae,[o[15]||(o[15]=e("p",{class:"text-xs text-muted-foreground mb-1"},"Assignee:",-1)),e("div",je,[e("div",{class:"w-8 h-8 rounded-full flex items-center justify-center text-primary-foreground text-xs font-medium",style:Y({backgroundColor:t.stringToColor(r.assignee.firstName+r.assignee.lastName)})},l(t.getUserInitials(r.assignee.firstName,r.assignee.lastName)),5),e("span",Be,l(r.assignee.firstName)+" "+l(r.assignee.lastName),1)])])):x("",!0),r.members&&r.members.length>0?(i(),a("div",Te,[o[16]||(o[16]=e("p",{class:"text-xs text-muted-foreground mb-1"},"Members:",-1)),e("div",Ue,[(i(!0),a(S,null,L(r.members.slice(0,5),(n,c)=>(i(),a("div",{key:c,class:"w-8 h-8 rounded-full border-2 border-background flex items-center justify-center text-primary-foreground text-xs font-medium",style:Y({backgroundColor:t.stringToColor(n.firstName+n.lastName)}),title:`${n.firstName} ${n.lastName}`},l(t.getUserInitials(n.firstName,n.lastName)),13,Ie))),128)),r.members.length>5?(i(),a("div",{key:0,class:"w-8 h-8 rounded-full border-2 border-background flex items-center justify-center bg-muted text-foreground text-xs font-medium",title:r.members.slice(5).map(n=>`${n.firstName} ${n.lastName}`).join(", ")}," +"+l(r.members.length-5),9,Le)):x("",!0)])])):x("",!0),e("div",Ye,[e("span",null,"Created "+l(t.formatDate(r.createdAt,"D MMMM YYYY")),1),r.createdBy?(i(),a("span",He,"by "+l(r.createdBy.firstName),1)):x("",!0)])])]))),128))]),t.schemesPageInfo.hasNextPage?(i(),a("div",Fe,[e("button",{onClick:t.loadMoreSchemes,class:"px-4 py-2 bg-secondary text-foreground rounded-lg hover:bg-secondary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-secondary focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:t.fetchingSchemes},[t.fetchingSchemes?(i(),a("span",ze,"Loading...")):(i(),a("span",Oe,"Load More"))],8,Ge)])):x("",!0),t.schemes.length===0&&!t.isLoading?(i(),I(t.Empty,{key:1,class:"py-12"},{default:f(()=>[u(t.EmptyContent,null,{default:f(()=>[u(t.EmptyMedia,{variant:"icon"},{default:f(()=>[...o[17]||(o[17]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-muted-foreground",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1)])]),_:1}),u(t.EmptyHeader,null,{default:f(()=>[u(t.EmptyTitle,null,{default:f(()=>[...o[18]||(o[18]=[C("No schemes found",-1)])]),_:1}),u(t.EmptyDescription,null,{default:f(()=>[...o[19]||(o[19]=[C("Get started by creating your first scheme.",-1)])]),_:1})]),_:1}),e("button",{onClick:t.openCreateForm,class:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"},[...o[20]||(o[20]=[e("span",{class:"flex items-center space-x-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",null,"Create Scheme")],-1)])])]),_:1})]),_:1})):x("",!0)]),t.showModal?(i(),I(d,{key:0,onClose:o[10]||(o[10]=r=>t.showModal=!1),"content-width":"w-full max-w-2xl"},{header:f(()=>[e("h3",Ke,l(t.formTitle),1)]),body:f(()=>[e("form",{onSubmit:ne(t.saveForm,["prevent"]),class:"p-6 space-y-6"},[e("div",null,[o[21]||(o[21]=e("label",{class:"block text-sm font-medium text-foreground mb-1",for:"title"},[C(" Scheme Title "),e("span",{class:"text-destructive"},"*")],-1)),w(e("input",{id:"title","onUpdate:modelValue":o[3]||(o[3]=r=>t.form.title=r),type:"text",required:"",class:"w-full px-3 py-2 border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-background text-foreground",placeholder:"Enter scheme title"},null,512),[[k,t.form.title]])]),e("div",null,[o[22]||(o[22]=e("label",{class:"block text-sm font-medium text-foreground mb-1",for:"description"}," Description ",-1)),w(e("textarea",{id:"description","onUpdate:modelValue":o[4]||(o[4]=r=>t.form.description=r),rows:"3",class:"w-full px-3 py-2 border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-background text-foreground",placeholder:"Enter scheme description"},null,512),[[k,t.form.description]])]),e("div",qe,[e("div",null,[o[23]||(o[23]=e("label",{class:"block text-sm font-medium text-foreground mb-1",for:"startDate"}," Start Date ",-1)),w(e("input",{id:"startDate","onUpdate:modelValue":o[5]||(o[5]=r=>t.form.startDate=r),type:"date",class:"w-full px-3 py-2 border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-background text-foreground"},null,512),[[k,t.form.startDate]])]),e("div",null,[o[24]||(o[24]=e("label",{class:"block text-sm font-medium text-foreground mb-1",for:"endDate"}," End Date ",-1)),w(e("input",{id:"endDate","onUpdate:modelValue":o[6]||(o[6]=r=>t.form.endDate=r),type:"date",class:"w-full px-3 py-2 border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-background text-foreground"},null,512),[[k,t.form.endDate]])])]),e("div",null,[o[25]||(o[25]=e("label",{class:"block text-sm font-medium text-foreground mb-1"}," Assignee ",-1)),u(t.VueMultiselect,{modelValue:t.form.assignee,"onUpdate:modelValue":o[7]||(o[7]=r=>t.form.assignee=r),options:t.users,label:"firstName",searchable:!0,"track-by":"uid",placeholder:"Select an assignee",class:"multiselect-primary"},null,8,["modelValue","options"])]),e("div",null,[o[26]||(o[26]=e("label",{class:"block text-sm font-medium text-foreground mb-1"}," Members ",-1)),u(t.VueMultiselect,{modelValue:t.form.members,"onUpdate:modelValue":o[8]||(o[8]=r=>t.form.members=r),options:t.users,label:"firstName",searchable:!0,"track-by":"uid",multiple:!0,placeholder:"Select members",class:"multiselect-primary"},null,8,["modelValue","options"])]),e("div",Je,[e("button",{type:"button",onClick:o[9]||(o[9]=r=>t.showModal=!1),class:"px-4 py-2 text-sm font-medium text-foreground bg-background border border-border rounded-md shadow-sm hover:bg-muted focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors duration-200"}," Cancel "),e("button",Qe,l(t.formAction?"Create":"Update"),1)])],32)]),_:1})):x("",!0)],64)}const ot=re(xe,[["render",Re],["__scopeId","data-v-3bab7638"],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/grind/SchemeListing.vue"]]);export{ot as default};
