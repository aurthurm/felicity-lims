import{d as G,I as K,s as Q,J as W,r as p,at as i,au as X,n as Y,p as Z,o as u,c as m,g as C,f as o,b as e,w as A,i as c,z as h,e as f,ae as ee,A as te,y as se,F as x,C as L,t as M,ad as ae,v as S,aA as ne,B as oe,j as B,_ as I,k as le}from"./index-d5ae4e74.js";import{u as re,A as ie}from"./shipment-71b8a45e.js";import{c as ue,d as R,a as T,u as ce,b}from"./array-b622a333.js";const de={class:"flex justify-between items-center"},me={class:"flex"},fe=e("span",{class:"mx-2"},"InBound",-1),pe=e("h3",null,"Create Shipment",-1),he=e("hr",null,null,-1),be={action:"post",class:"p-1"},ve={class:"grid grid-cols-3 gap-x-4 mb-4"},ge={class:"block col-span-1 mb-2"},_e=e("span",{class:"text-gray-700"},"External Laboratory",-1),ye=["value"],xe={class:"block col-span-1 mb-2"},Se=e("span",{class:"text-gray-700"},"Courier",-1),ke={class:"block col-span-1 mb-2"},we=e("span",{class:"text-gray-700"},"How Many",-1),Ce={class:"grid grid-cols-3 gap-x-4 mb-4"},Ae={class:"block col-span-3 mb-2"},Le=e("span",{class:"text-gray-700"},"Comment",-1),Me=e("hr",null,null,-1),Be=G({__name:"ShipmentListing",setup(Ie){const U=B(()=>I(()=>import("./index-d5ae4e74.js").then(s=>s.br),["assets/index-d5ae4e74.js","assets/index-246842b1.css"])),V=B(()=>I(()=>import("./FelDataTable-ca271ba4.js"),["assets/FelDataTable-ca271ba4.js","assets/index-d5ae4e74.js","assets/index-246842b1.css"])),l=re(),{withClientMutation:D}=K(),{shipments:k,fetchingShipments:N,shipmentPageInfo:w}=Q(l);W();let r=p(!1);const d=p(!1),P=p([{name:"All",value:""},{name:"Due",value:"due"},{name:"Awaiting",value:"awaiting"},{name:"Failed",value:"failed"}]),E=p([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Shipment Id",value:"shipmentId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(s,t){return i(X,{to:{name:"shipment-detail",params:{shipmentUid:s?.uid}},innerHTML:s?.shipmentId})}},{name:"External Laboratory",value:"laboratory.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Courier",value:"courier",sortable:!1,sortBy:"asc",hidden:!1},{name:"Flow Detail",value:"",sortable:!1,sortBy:"asc",hidden:!1},{name:"Assigned Count",value:"assignedCount",sortable:!1,sortBy:"asc",hidden:!1},{name:"Current Status",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(s,t){return i("button",{type:"button",class:"bg-sky-800 text-white py-1 px-2 rounded-sm leading-none",innerHTML:s?.state||"unknown"})}},{name:"",value:"",sortable:!1,showInToggler:!1,hidden:!1,customRender:function(s,t){return s.incoming?i("span",{class:"text-green-600"},i("i",{class:"fa fa-reply-all"})):i("span",{class:"text-orange-600"},i("i",{class:"fa fa-share-from-square"}))}}]);l.removeShipment();let n=Y({first:25,before:"",incoming:d.value,status:"",text:"",sort:["-uid"],filterAction:!1});l.fetcShipments(n),l.fetchReferralLaboratories();const F=ue({laboratoryUid:R().required("Laboratory is Required").typeError("Laboratory is Required"),comment:T().nullable(),courier:T().required("Courier is required"),count:R()}),{handleSubmit:q,errors:O}=ce({validationSchema:F,initialValues:{laboratoryUid:void 0,comment:"",courier:"",count:1}}),{value:v}=b("laboratoryUid"),{value:g}=b("comment"),{value:_}=b("courier"),{value:y}=b("count"),$=q(s=>{r.value=!1,D(ie,{payload:s},"createShipment").then(t=>{l.addShipment(t),r.value=!1})});function H(s){n.first=s.fetchCount,n.before=w?.value?.endCursor??"",n.text=s.filterText,n.status=s.filterStatus,n.incoming=d.value,n.filterAction=!1,l.fetcShipments(n)}function j(s){n.first=25,n.before="",n.text=s.filterText,n.status=s.filterStatus,n.incoming=d.value,n.filterAction=!0,l.clearShipment(),l.fetcShipments(n)}const z=Z(()=>k?.value?.length+" of "+l.getShipmentCount+" Shipments");return(s,t)=>(u(),m(x,null,[C(o(U),{title:"Shipments"}),e("div",de,[e("div",null,[e("button",{onClick:t[0]||(t[0]=A(a=>c(r)?r.value=!0:r=!0,["prevent"])),class:"p-2 h-10 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Add Shipment ")])]),C(o(V),{columns:E.value,data:o(k),toggleColumns:!0,loading:o(N),paginable:!0,pageMeta:{fetchCount:o(n).first,hasNextPage:o(w)?.hasNextPage,countNone:z.value},searchable:!0,filterable:!0,filterMeta:{defaultFilter:o(n).status,filters:P.value},onOnSearch:j,onOnPaginate:H,selectable:!1},{"pre-filter":h(()=>[e("label",me,[f(e("input",{type:"checkbox","onUpdate:modelValue":t[1]||(t[1]=a=>d.value=a)},null,512),[[ee,d.value]]),te(),fe])]),footer:h(()=>[]),_:1},8,["columns","data","loading","pageMeta","filterMeta"]),o(r)?(u(),se(ne,{key:0,onClose:t[7]||(t[7]=a=>c(r)?r.value=!1:r=!1)},{header:h(()=>[e("div",null,[pe,he,e("ul",null,[(u(!0),m(x,null,L(Object.values(o(O)),(a,J)=>(u(),m("li",{key:J,class:"text-orange-600"},M(a),1))),128))])])]),body:h(()=>[e("form",be,[e("div",ve,[e("label",ge,[_e,f(e("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":t[2]||(t[2]=a=>c(v)?v.value=a:null)},[(u(!0),m(x,null,L(o(l).laboratories,a=>(u(),m("option",{key:a.uid,value:a.uid},M(a.name),9,ye))),128))],512),[[ae,o(v)]])]),e("label",xe,[Se,f(e("input",{type:"text",class:"form-input mt-1 block w-full","onUpdate:modelValue":t[3]||(t[3]=a=>c(_)?_.value=a:null)},null,512),[[S,o(_)]])]),e("label",ke,[we,f(e("input",{type:"number",class:"form-input mt-1 block w-full","onUpdate:modelValue":t[4]||(t[4]=a=>c(y)?y.value=a:null),min:"1",default:"1/"},null,512),[[S,o(y)]])])]),e("div",Ce,[e("label",Ae,[Le,f(e("textarea",{class:"form-input mt-1 block w-full",rows:"2",placeholder:"Notes ...","onUpdate:modelValue":t[5]||(t[5]=a=>c(g)?g.value=a:null)},null,512),[[S,o(g)]])])]),Me,e("button",{type:"button",onClick:t[6]||(t[6]=A(a=>o($)(),["prevent"])),class:"-mb-4 w-full border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Create Shipment ")])]),_:1})):oe("",!0)],64))}}),Ve=le(Be,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/shipment/ShipmentListing.vue"]]);export{Ve as default};
