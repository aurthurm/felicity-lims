import{a0 as X,h as f,_ as Z,c as r,o as a,A as t,E as w,J as x,K as h,L as p,Q as N,u as Pe,a4 as qe,f as Me,a7 as M,g as de,e as Q,a5 as B,bn as Ee,r as ce,C as Ne,a as C,F as A,a9 as G,a2 as T,M as Fe,D as j,P as W}from"./index-DApeomWQ.js";import{Multiselect as Ie}from"./vue-multiselect.esm-CntbZnFq.js";import{u as Be}from"./patient-BT86h0ju.js";import{u as Te}from"./analysis-BTUsl5OO.js";import{u as je}from"./client-BLllGT-l.js";import{u as Le}from"./billing-BI13Y5Zt.js";import{u as be}from"./setup-HNpvekU2.js";import{$ as Ye}from"./analyses.mutations-Bu696l9I.js";import{c as k,e as L,i as ue,d as ze,f as me,a as E,u as He,b as U}from"./index.esm-Cx9agkcQ.js";import{f as pe}from"./index-BqfY99Wm.js";/* empty css                                                                 */import"./location-CzglHsxT.js";import"./billing.queries-DvXlf0-X.js";const Ke=X({__name:"SampleCostBreakdown",props:{profiles:{type:Array,default:()=>[]},analyses:{type:Array,default:()=>[]},priceMap:{type:Map,required:!0},loading:{type:Boolean,default:!1}},setup(D,{expose:s}){s();const m=be(),e=D,g=f(()=>m.getLaboratory?.settings?.currency??"USD"),y=d=>d==null?"N/A":new Intl.NumberFormat("en-US",{style:"currency",currency:g.value}).format(d),u=f(()=>e.profiles?.map(d=>({name:d.name,price:e.priceMap.get(`profile_${d.uid}`)??null}))??[]),b=f(()=>e.analyses?.map(d=>({name:d.name,price:e.priceMap.get(`analysis_${d.uid}`)??null}))??[]),o=f(()=>{let d=0;return u.value.forEach(_=>{_.price!==null&&(d+=_.price)}),b.value.forEach(_=>{_.price!==null&&(d+=_.price)}),d}),c={setupStore:m,props:e,currency:g,formatCurrency:y,profileCosts:u,analysisCosts:b,subtotal:o};return Object.defineProperty(c,"__isScriptSetup",{enumerable:!1,value:!0}),c}}),Oe={class:"space-y-2 text-sm"},Je={key:0,class:"animate-pulse space-y-2"},Qe={key:1},Ge={key:0,class:"space-y-1"},We={class:"text-foreground truncate flex-1 mr-2"},Xe={class:"text-foreground truncate flex-1 mr-2"},Ze={key:2,class:"border-t border-border pt-2 mt-2"},$e={class:"flex justify-between items-center font-semibold"},et={class:"text-primary text-base"},tt={key:3,class:"text-muted-foreground italic"};function st(D,s,m,e,g,y){return a(),r("div",Oe,[m.loading?(a(),r("div",Je,[...s[0]||(s[0]=[t("div",{class:"h-4 bg-muted rounded w-3/4"},null,-1),t("div",{class:"h-4 bg-muted rounded w-1/2"},null,-1),t("div",{class:"h-4 bg-muted rounded w-full"},null,-1)])])):(a(),r("div",Qe,[e.profileCosts.length>0?(a(),r("div",Ge,[s[1]||(s[1]=t("div",{class:"text-xs font-semibold text-muted-foreground uppercase"},"Profiles",-1)),(a(!0),r(x,null,h(e.profileCosts,(u,b)=>(a(),r("div",{key:`profile-${b}`,class:"flex justify-between items-center"},[t("span",We,p(u.name),1),t("span",{class:N(u.price===null?"text-destructive":"text-foreground font-medium")},p(e.formatCurrency(u.price)),3)]))),128))])):w("",!0),e.analysisCosts.length>0?(a(),r("div",{key:1,class:N(["space-y-1",{"mt-3":e.profileCosts.length>0}])},[s[2]||(s[2]=t("div",{class:"text-xs font-semibold text-muted-foreground uppercase"},"Analyses",-1)),(a(!0),r(x,null,h(e.analysisCosts,(u,b)=>(a(),r("div",{key:`analysis-${b}`,class:"flex justify-between items-center"},[t("span",Xe,p(u.name),1),t("span",{class:N(u.price===null?"text-destructive":"text-foreground font-medium")},p(e.formatCurrency(u.price)),3)]))),128))],2)):w("",!0),e.profileCosts.length>0||e.analysisCosts.length>0?(a(),r("div",Ze,[t("div",$e,[s[3]||(s[3]=t("span",{class:"text-foreground"},"Subtotal:",-1)),t("span",et,p(e.formatCurrency(e.subtotal)),1)])])):w("",!0),e.profileCosts.length===0&&e.analysisCosts.length===0?(a(),r("div",tt," No tests selected ")):w("",!0)]))])}const ot=Z(Ke,[["render",st],["__scopeId","data-v-d366cf69"],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/components/billing/SampleCostBreakdown.vue"]]),lt=X({__name:"CostSummary",props:{sampleCosts:{type:Array,required:!0},grandTotal:{type:Number,required:!0},currency:{type:String,default:"USD"},loading:{type:Boolean,default:!1}},setup(D,{expose:s}){s();const m=D,e=u=>new Intl.NumberFormat("en-US",{style:"currency",currency:m.currency}).format(u),g=f(()=>m.sampleCosts.some(u=>u.subtotal>0)),y={props:m,formatCurrency:e,hasCosts:g};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}}),at={class:"bg-muted rounded-lg p-6 mt-6 border border-border"},rt={key:0,class:"animate-pulse space-y-3"},nt={key:1},it={class:"space-y-2 mb-4"},dt={class:"text-foreground"},ct={class:"font-medium text-foreground"},ut={class:"border-t border-border pt-4 mt-4"},mt={class:"flex justify-between items-center"},pt={class:"text-2xl font-bold text-primary"},bt={key:2,class:"text-muted-foreground italic text-sm"};function ft(D,s,m,e,g,y){return a(),r("div",at,[s[3]||(s[3]=t("h3",{class:"text-lg font-semibold text-foreground mb-4"},"Cost Summary",-1)),m.loading?(a(),r("div",rt,[...s[0]||(s[0]=[t("div",{class:"h-4 bg-background rounded w-3/4"},null,-1),t("div",{class:"h-4 bg-background rounded w-1/2"},null,-1),t("div",{class:"h-6 bg-background rounded w-full mt-4"},null,-1)])])):e.hasCosts?(a(),r("div",nt,[t("div",it,[(a(!0),r(x,null,h(m.sampleCosts,(u,b)=>(a(),r("div",{key:b,class:"flex justify-between items-center text-sm"},[t("span",dt,"Sample "+p(b+1)+":",1),t("span",ct,p(e.formatCurrency(u.subtotal)),1)]))),128))]),t("div",ut,[t("div",mt,[s[1]||(s[1]=t("span",{class:"text-xl font-bold text-foreground"},"Total:",-1)),t("span",pt,p(e.formatCurrency(m.grandTotal)),1)])]),s[2]||(s[2]=t("div",{class:"mt-4 text-xs text-muted-foreground italic"}," * Final cost may vary after discounts and adjustments are applied ",-1))])):(a(),r("div",bt," No tests selected. Add profiles or analyses to see cost breakdown. "))])}const gt=Z(lt,[["render",ft],["__scopeId","data-v-8d1e035b"],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/components/billing/CostSummary.vue"]]),yt=X({__name:"SamplesAdd",setup(D,{expose:s}){s();const m=Pe(),e=Be(),g=Te(),y=je(),u=Le(),b=be(),o=qe(),{withClientMutation:c}=Me(),d=M(!1);let _=f(()=>e.getPatient),Y=de({first:void 0,after:"",text:"",sortBy:["name"],contacts:!0});y.fetchClients(Y);const fe=f(()=>y.getClients),P=M(null),F=M([]),ge=l=>{P.value=l,V.value=null};m.fetchSampleTypes();const ye=f(()=>m.getSampleTypes);let z=de({first:void 0,after:"",text:"",sortBy:["name"]});g.fetchAnalysesServices(z);const ve=f(()=>{const l=g.getAnalysesServicesSimple;let n=new Set;return l.forEach((i,v)=>{i.profiles?.length===0&&n.add(i)}),[...n]});g.fetchAnalysesProfiles();const xe=f(()=>g.getAnalysesProfiles),H=M(!1),he=Q().endOf("day").toDate(),$=k({sampleType:k().required("Sample type is required").test("sample-type-uid","Sample type is required",l=>!!l?.uid),dateCollected:ue().nullable(),dateReceived:ue().nullable(),profiles:L().nullable(),analyses:L().nullable()}).test("profiles-or-analyses","Samples must have either profiles or services",l=>(l?.profiles?.length??0)+(l?.analyses?.length??0)>0),ee=k({clientRequestId:E().required("Client Request ID is Required"),clinicalData:k({clinicalIndication:E().nullable(),symptoms:L().of(E()),symptomsRaw:E().nullable(),treatmentNotes:E().nullable(),pregnancyStatus:me().nullable(),breastFeeding:me().nullable(),vitals:k().nullable(),otherContext:k().nullable()}).nullable(),client:k().required("Client is Required"),clientContact:k().nullable().required("Client Contact is Required"),samples:L().of($).required().min(1,"Add at least 1 sample"),priority:ze()});function K(l){return{sampleType:null,dateCollected:Q(new Date),dateReceived:Q(new Date),profiles:[],analyses:[],...l}}function te(){return{clinicalIndication:"",symptoms:[],symptomsRaw:"",treatmentNotes:"",pregnancyStatus:null,breastFeeding:null,vitals:{},otherContext:{}}}const{handleSubmit:se,errors:_e,setFieldValue:oe}=He({validationSchema:ee,initialValues:{priority:0,client:null,clientContact:null,samples:[K({})],clinicalData:te()}});B(()=>_.value?.client,l=>{l&&oe("client",l)},{immediate:!0});const{value:Se}=U("clientRequestId"),{value:I}=U("clinicalData"),{value:O}=U("client"),{value:V}=U("clientContact"),{value:we}=U("priority");B(O,l=>{P.value=l??null,V.value&&V.value?.clientUid!==l?.uid&&(V.value=null)},{immediate:!0}),B(P,async l=>{if(!l){F.value=[];return}let n;if(l.contacts?.length)n=l.contacts,F.value=n;else{const i=l.uid;if(await y.fetchClientContacts(i),P.value?.uid!==i)return;n=[...y.getClientContacts],F.value=n}n.length===1&&(V.value=n[0])},{immediate:!0});const{value:R}=U("samples"),q=M(""),Ce=()=>{q.value.trim()&&!I.value?.symptoms?.includes(q.value.trim())&&(I.value?.symptoms?.push(q.value.trim()),q.value="")},ke=l=>{I.value?.symptoms?.splice(l,1)},De=se(l=>{H.value=!0,le(l)});function le(l){const n={patientUid:_.value?.uid,clientRequestId:l.clientRequestId,clinicalData:l.clinicalData,clientUid:O?.value?.uid,clientContactUid:V?.value?.uid,samples:l.samples?.map(i=>({...i,profiles:i.profiles?.map(v=>v.uid),analyses:i.analyses?.map(v=>v.uid),sampleType:i.sampleType?.uid,dateCollected:i.dateCollected?pe(i.dateCollected,"YYYY-MM-DD HH:mm"):null,dateReceived:i.dateReceived?pe(i.dateReceived,"YYYY-MM-DD HH:mm"):null}))};c(Ye,{payload:n},"createAnalysisRequest").then(i=>{m.addAnalysisRequest(i),o.push({name:"patient-detail",params:{patientUid:_.value?.uid}})}).finally(()=>{H.value=!1})}function Ve(){const l=K({});R.value.push(l)}function Re(l){R.value.length>1&&R.value.splice(l,1)}const Ae=f(()=>R.value.length>1),ae=f(()=>b.getLaboratory?.settings?.allowBilling??!1),J=f(()=>{const l=new Map;return u.profilePrices.forEach((n,i)=>{l.set(`profile_${i}`,n.amount)}),u.analysisPrices.forEach((n,i)=>{l.set(`analysis_${i}`,n.amount)}),l}),re=f(()=>R.value.map(l=>{let n=0;const i={profiles:[],analyses:[],subtotal:0};return l.profiles?.forEach(v=>{const S=J.value.get(`profile_${v.uid}`);S!==void 0&&(n+=S,i.profiles.push({name:v.name,price:S}))}),l.analyses?.forEach(v=>{const S=J.value.get(`analysis_${v.uid}`);S!==void 0&&(n+=S,i.analyses.push({name:v.name,price:S}))}),i.subtotal=n,i})),Ue=f(()=>re.value.reduce((l,n)=>l+n.subtotal,0)),ne=Ee((l,n)=>{u.fetchBatchPrices(l,n)},300);B(()=>R.value.map(l=>({profiles:l.profiles?.map(n=>n.uid)??[],analyses:l.analyses?.map(n=>n.uid)??[]})),l=>{if(!ae.value)return;const n=new Set,i=new Set;l.forEach(v=>{v.profiles.forEach(S=>n.add(S)),v.analyses.forEach(S=>i.add(S))}),(n.size>0||i.size>0)&&ne(Array.from(n),Array.from(i))},{deep:!0});const ie={sampleStore:m,patientStore:e,analysisStore:g,clientStore:y,billingStore:u,setupStore:b,router:o,withClientMutation:c,clinicalDataExpanded:d,get patient(){return _},set patient(l){_=l},get clientParams(){return Y},set clientParams(l){Y=l},clients:fe,selectedClient:P,clientContactsForDropdown:F,selectContact:ge,sampleTypes:ye,get analysesParams(){return z},set analysesParams(l){z=l},analysesServices:ve,analysesProfiles:xe,arSaving:H,maxDate:he,sampleSchema:$,arSchema:ee,createDefaultSample:K,createDefaultClinicalData:te,handleSubmit:se,errors:_e,setFieldValue:oe,clientRequestId:Se,clinicalData:I,client:O,clientContact:V,priority:we,samples:R,newSymptom:q,addSymptom:Ce,removeSymptom:ke,submitARForm:De,addAnalysesRequest:le,addSample:Ve,removeSample:Re,canRemoveSample:Ae,billingEnabled:ae,priceMap:J,sampleCosts:re,grandTotal:Ue,debouncedFetchPrices:ne,contactLabel:l=>`${l.firstName} ${l.lastName}`,get VueMultiselect(){return Ie},SampleCostBreakdown:ot,CostSummary:gt};return Object.defineProperty(ie,"__isScriptSetup",{enumerable:!1,value:!0}),ie}}),vt={class:"space-y-6"},xt={key:0,class:"absolute inset-0 bg-background/10 backdrop-blur-sm z-50 flex items-center justify-center rounded-lg",role:"status","aria-live":"polite"},ht={class:"flex flex-col items-center gap-4"},_t={class:"space-y-4"},St={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},wt={class:"flex items-center gap-x-4"},Ct={class:"flex items-center gap-x-4"},kt={class:"text-sm text-destructive"},Dt={class:"flex items-center gap-x-4"},Vt=["disabled"],Rt={class:"text-sm text-destructive"},At={class:"flex items-center gap-x-4"},Ut=["disabled"],Pt={class:"text-sm text-destructive"},qt={class:"border border-border rounded-lg bg-background/50"},Mt=["disabled"],Et={key:0,class:"px-4 py-4 space-y-4 border-t border-border"},Nt={class:"flex items-center gap-x-4"},Ft=["disabled"],It={class:"flex flex-wrap mt-2"},Bt={class:"flex gap-2"},Tt=["disabled","onKeydown"],jt=["disabled"],Lt={class:"flex flex-wrap gap-2 mt-2"},Yt=["onClick","disabled"],zt={class:"flex items-center gap-x-4"},Ht=["disabled"],Kt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ot={class:"flex items-center gap-x-4"},Jt=["disabled"],Qt={class:"flex items-center gap-x-4"},Gt=["disabled"],Wt={id:"samples",class:"space-y-4"},Xt={class:"flex justify-between items-center"},Zt={class:"flex items-center gap-4"},$t={class:"text-sm text-destructive"},es=["disabled"],ts={class:"relative border border-border rounded-lg bg-background/50 overflow-visible"},ss={class:"absolute left-0 top-0 bottom-0 w-48 bg-muted/30 border-r border-border z-10"},os={class:"w-full h-full fel-table"},ls={key:0,class:"border-b border-border"},as={class:"overflow-x-auto overflow-y-visible pl-48"},rs={class:"w-80 min-w-80 fel-table"},ns={class:"border-b border-border bg-muted/30"},is={class:"flex items-center justify-between"},ds=["onClick","disabled","title"],cs={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},us={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},ms={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},ps={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},bs={class:"border-b border-border hover:bg-muted/20 h-20 min-h-20 max-h-20"},fs={key:0,class:"border-b border-border hover:bg-muted/20"},gs={class:"hover:bg-muted/20 h-24"},ys={class:"p-3 bg-muted/50 rounded-md text-sm space-y-1"},vs={key:0,class:"text-xs text-destructive whitespace-nowrap"},xs={key:1},hs={class:"text-xs text-muted-foreground"},_s={class:"text-xs text-muted-foreground"},Ss={class:"flex justify-end pt-4"},ws=["disabled"];function Cs(D,s,m,e,g,y){const u=ce("fel-loader"),b=ce("VueDatePicker");return a(),r("div",vt,[s[37]||(s[37]=t("h5",{class:"text-xl font-semibold text-foreground mb-4"},"Add Analysis Request",-1)),t("form",{action:"post",class:"relative p-6 bg-background rounded-lg shadow-sm space-y-6",onSubmit:s[11]||(s[11]=j((...o)=>e.submitARForm&&e.submitARForm(...o),["prevent"]))},[e.arSaving?(a(),r("div",xt,[t("div",ht,[C(u,{message:"Adding Samples...",variant:"primary",size:"lg"})])])):w("",!0),t("div",_t,[t("div",St,[t("label",wt,[s[12]||(s[12]=t("span",{class:"text-sm font-medium text-foreground"},"Client",-1)),C(e.VueMultiselect,{class:"w-full",placeholder:"Select a Client",modelValue:e.client,"onUpdate:modelValue":s[0]||(s[0]=o=>e.client=o),options:e.clients,searchable:!0,disabled:e.arSaving,label:"name","track-by":"uid",onSelect:e.selectContact,"option-height":60,"close-on-select":!0},null,8,["modelValue","options","disabled"])]),t("label",Ct,[s[13]||(s[13]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap"},"Client Contact",-1)),C(e.VueMultiselect,{class:"w-full",placeholder:"Select a Client Contact",modelValue:e.clientContact,"onUpdate:modelValue":s[1]||(s[1]=o=>e.clientContact=o),options:e.clientContactsForDropdown,"custom-label":e.contactLabel,disabled:e.arSaving,"track-by":"uid","close-on-select":!0,searchable:!0},null,8,["modelValue","options","disabled"]),t("div",kt,p(e.errors.clientContact),1)]),t("label",Dt,[s[15]||(s[15]=t("span",{class:"text-sm font-medium text-foreground"},"Priority",-1)),A(t("select",{name:"priority",id:"priority","onUpdate:modelValue":s[2]||(s[2]=o=>e.priority=o),disabled:e.arSaving,class:"w-full px-3 py-2 bg-background/10 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","aria-label":"Select priority level"},[...s[14]||(s[14]=[t("option",{value:"0"},"Low",-1),t("option",{value:"1"},"Medium",-1),t("option",{value:"2"},"High",-1)])],8,Vt),[[G,e.priority]]),t("div",Rt,p(e.errors.priority),1)])]),t("label",At,[s[16]||(s[16]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap"},"Client Request ID",-1)),A(t("input",{class:"w-full px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","onUpdate:modelValue":s[3]||(s[3]=o=>e.clientRequestId=o),disabled:e.arSaving,placeholder:"CRID ..."},null,8,Ut),[[T,e.clientRequestId]]),t("div",Pt,p(e.errors.clientRequestId),1)]),t("div",qt,[t("button",{type:"button",onClick:s[4]||(s[4]=o=>e.clinicalDataExpanded=!e.clinicalDataExpanded),disabled:e.arSaving,class:"w-full px-4 py-3 flex items-center justify-between text-left hover:bg-muted/20 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50 rounded-t-lg disabled:opacity-50 disabled:cursor-not-allowed"},[s[18]||(s[18]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap"},"Clinical Data (click to expand)",-1)),(a(),r("svg",{class:N(["w-5 h-5 transition-transform duration-200",{"rotate-180":e.clinicalDataExpanded}]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[...s[17]||(s[17]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])],2))],8,Mt),e.clinicalDataExpanded?(a(),r("div",Et,[t("label",Nt,[s[19]||(s[19]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap w-40"},"Clinical Indication",-1)),A(t("input",{class:"w-full px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","onUpdate:modelValue":s[5]||(s[5]=o=>e.clinicalData.clinicalIndication=o),disabled:e.arSaving,placeholder:"Enter clinical indication..."},null,8,Ft),[[T,e.clinicalData.clinicalIndication]])]),t("div",It,[s[20]||(s[20]=t("span",{class:"text-sm font-medium text-foreground w-40"},"Symptoms",-1)),t("div",Bt,[A(t("input",{class:"flex-1 px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","onUpdate:modelValue":s[6]||(s[6]=o=>e.newSymptom=o),disabled:e.arSaving,placeholder:"Add symptom...",onKeydown:Fe(j(e.addSymptom,["prevent","stop"]),["enter"])},null,40,Tt),[[T,e.newSymptom]]),t("button",{type:"button",onClick:e.addSymptom,disabled:e.arSaving,class:"px-3 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50 disabled:cursor-not-allowed"}," Add ",8,jt)]),t("div",Lt,[(a(!0),r(x,null,h(e.clinicalData.symptoms,(o,c)=>(a(),r("span",{key:c,class:"inline-flex items-center gap-1 px-2 py-1 bg-muted text-muted-foreground rounded-md text-sm"},[W(p(o)+" ",1),t("button",{type:"button",onClick:d=>e.removeSymptom(c),disabled:e.arSaving,class:"text-destructive hover:text-destructive/80 ml-1 disabled:opacity-50 disabled:cursor-not-allowed"}," × ",8,Yt)]))),128))])]),t("label",zt,[s[21]||(s[21]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap w-40"},"Treatment Notes",-1)),A(t("textarea",{class:"w-full px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50","onUpdate:modelValue":s[7]||(s[7]=o=>e.clinicalData.treatmentNotes=o),disabled:e.arSaving,placeholder:"Enter treatment notes...",rows:"2"},null,8,Ht),[[T,e.clinicalData.treatmentNotes]])]),t("div",Kt,[t("label",Ot,[s[23]||(s[23]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap w-40"},"Pregnancy Status",-1)),A(t("select",{"onUpdate:modelValue":s[8]||(s[8]=o=>e.clinicalData.pregnancyStatus=o),disabled:e.arSaving,class:"w-full ml-4 px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50"},[...s[22]||(s[22]=[t("option",{value:null},"Not specified",-1),t("option",{value:!0},"Pregnant",-1),t("option",{value:!1},"Not pregnant",-1)])],8,Jt),[[G,e.clinicalData.pregnancyStatus]])]),t("label",Qt,[s[25]||(s[25]=t("span",{class:"text-sm font-medium text-foreground whitespace-nowrap w-40"},"Breastfeeding Status",-1)),A(t("select",{"onUpdate:modelValue":s[9]||(s[9]=o=>e.clinicalData.breastFeeding=o),disabled:e.arSaving,class:"w-full px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50"},[...s[24]||(s[24]=[t("option",{value:null},"Not specified",-1),t("option",{value:!0},"Breastfeeding",-1),t("option",{value:!1},"Not breastfeeding",-1)])],8,Gt),[[G,e.clinicalData.breastFeeding]])])])])):w("",!0)])]),t("section",Wt,[t("div",Xt,[s[26]||(s[26]=t("h5",{class:"text-lg font-semibold text-foreground"},"Samples",-1)),t("div",Zt,[t("span",$t,p(e.errors.samples),1),e.samples?.length!==20?(a(),r("button",{key:0,type:"button",onClick:s[10]||(s[10]=j(o=>e.addSample(),["prevent"])),disabled:e.arSaving,class:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50 disabled:cursor-not-allowed"}," Add Sample ",8,es)):w("",!0)])]),t("div",ts,[t("div",ss,[t("table",os,[s[34]||(s[34]=t("thead",null,[t("tr",{class:"border-b border-border bg-muted/30"},[t("th",{class:"p-4 text-left text-sm font-medium text-foreground h-16"}," Field ")])],-1)),t("tbody",null,[s[28]||(s[28]=t("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Sample Type ")],-1)),s[29]||(s[29]=t("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Date Collected ")],-1)),s[30]||(s[30]=t("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Date Received ")],-1)),s[31]||(s[31]=t("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Analysis Profiles ")],-1)),s[32]||(s[32]=t("tr",{class:"border-b border-border h-20 min-h-20 max-h-20"},[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Analysis Services ")],-1)),e.billingEnabled?(a(),r("tr",ls,[...s[27]||(s[27]=[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Cost Breakdown ",-1)])])):w("",!0),s[33]||(s[33]=t("tr",{class:"h-24"},[t("td",{class:"p-4 text-sm font-medium text-foreground bg-muted/10"}," Selection Summary ")],-1))])])]),t("div",as,[t("table",rs,[t("thead",null,[t("tr",ns,[(a(!0),r(x,null,h(e.samples,(o,c)=>(a(),r("th",{key:c,class:"p-4 text-center text-sm font-medium text-foreground w-80 min-w-80 relative h-16 border-r"},[t("div",is,[t("span",null,"Sample "+p(c+1),1),t("button",{type:"button",onClick:j(d=>e.removeSample(c),["prevent"]),disabled:!e.canRemoveSample||e.arSaving,class:N(["px-2 py-1 rounded-md transition-colors duration-200 focus:outline-none focus:ring-2 text-xs ml-2",e.canRemoveSample&&!e.arSaving?"bg-destructive text-destructive-foreground hover:bg-destructive/90 focus:ring-destructive/50":"bg-muted text-muted-foreground cursor-not-allowed"]),title:e.canRemoveSample&&!e.arSaving?"Remove sample":"At least one sample is required"}," Remove ",10,ds)])]))),128))])]),t("tbody",null,[t("tr",cs,[(a(!0),r(x,null,h(e.samples,(o,c)=>(a(),r("td",{key:c,class:"p-4 w-80 border-r"},[C(e.VueMultiselect,{class:"w-full",placeholder:"Select sample type",modelValue:o.sampleType,"onUpdate:modelValue":d=>o.sampleType=d,options:e.sampleTypes,searchable:!0,disabled:e.arSaving,label:"name","track-by":"uid",openDirection:"below"},null,8,["modelValue","onUpdate:modelValue","options","disabled"])]))),128))]),t("tr",us,[(a(!0),r(x,null,h(e.samples,(o,c)=>(a(),r("td",{key:c,class:"p-4 w-80 border-r"},[C(b,{class:"w-full",modelValue:o.dateCollected,"onUpdate:modelValue":d=>o.dateCollected=d,"max-date":e.maxDate,disabled:e.arSaving,"time-picker-inline":"",teleport:!0},null,8,["modelValue","onUpdate:modelValue","max-date","disabled"])]))),128))]),t("tr",ms,[(a(!0),r(x,null,h(e.samples,(o,c)=>(a(),r("td",{key:c,class:"p-4 w-80 border-r"},[C(b,{class:"w-full",modelValue:o.dateReceived,"onUpdate:modelValue":d=>o.dateReceived=d,"min-date":o.dateCollected&&typeof o.dateCollected=="object"&&!(o.dateCollected instanceof Date)&&typeof o.dateCollected.toDate=="function"?o.dateCollected.toDate():o.dateCollected||null,"max-date":e.maxDate,disabled:e.arSaving,"time-picker-inline":"",teleport:!0},null,8,["modelValue","onUpdate:modelValue","min-date","max-date","disabled"])]))),128))]),t("tr",ps,[(a(!0),r(x,null,h(e.samples,(o,c)=>(a(),r("td",{key:c,class:"p-4 w-80 border-r"},[C(e.VueMultiselect,{class:"w-full whitespace-nowrap z-10",placeholder:"Select analysis profiles",modelValue:o.profiles,"onUpdate:modelValue":d=>o.profiles=d,options:e.analysesProfiles,searchable:!0,disabled:e.arSaving,multiple:!0,label:"name","track-by":"uid",openDirection:"below"},null,8,["modelValue","onUpdate:modelValue","options","disabled"])]))),128))]),t("tr",bs,[(a(!0),r(x,null,h(e.samples,(o,c)=>(a(),r("td",{key:c,class:"p-4 w-80 border-r"},[C(e.VueMultiselect,{class:"w-full whitespace-nowrap",placeholder:"Select analysis services",modelValue:o.analyses,"onUpdate:modelValue":d=>o.analyses=d,options:e.analysesServices,searchable:!0,disabled:e.arSaving,multiple:!0,label:"name","track-by":"uid",openDirection:"below"},null,8,["modelValue","onUpdate:modelValue","options","disabled"])]))),128))]),e.billingEnabled?(a(),r("tr",fs,[(a(!0),r(x,null,h(e.samples,(o,c)=>(a(),r("td",{key:c,class:"p-4 w-80 border-r align-top"},[C(e.SampleCostBreakdown,{profiles:o.profiles,analyses:o.analyses,"price-map":e.priceMap,loading:e.billingStore.fetchingPrices},null,8,["profiles","analyses","price-map","loading"])]))),128))])):w("",!0),t("tr",gs,[(a(!0),r(x,null,h(e.samples,(o,c)=>(a(),r("td",{key:c,class:"p-4 w-80 border-r"},[t("div",ys,[o.profiles?.length===0&&o.analyses?.length===0?(a(),r("div",vs," ⚠️ Select profiles or services ")):(a(),r("div",xs,[t("div",hs,[s[35]||(s[35]=t("strong",null,"Profiles:",-1)),W(" "+p(o.profiles?.length||0)+" selected ",1)]),t("div",_s,[s[36]||(s[36]=t("strong",null,"Services:",-1)),W(" "+p(o.analyses?.length||0)+" selected ",1)])]))])]))),128))])])])])])]),e.billingEnabled?(a(),Ne(e.CostSummary,{key:1,"sample-costs":e.sampleCosts,"grand-total":e.grandTotal,currency:e.setupStore.getLaboratory?.settings?.currency??"USD",loading:e.billingStore.fetchingPrices},null,8,["sample-costs","grand-total","currency","loading"])):w("",!0),t("div",Ss,[t("button",{type:"submit",disabled:e.arSaving,class:"px-6 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50 disabled:opacity-50 disabled:cursor-not-allowed"}," Save Sample(s) ",8,ws)])],32)])}const Ts=Z(yt,[["render",Cs],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/sample/SamplesAdd.vue"]]);export{Ts as default};
