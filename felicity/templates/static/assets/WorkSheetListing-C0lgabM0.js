const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/FelDataTable-B98pg9sE.js","assets/index-Cdc6vSVw.js","assets/index-B3SP4dh7.css"])))=>i.map(i=>d[i]);
import{a0 as Y,S as Z,f as $,as as ee,ac as te,a7 as v,g as oe,ax as se,h as T,a1 as re,a6 as ae,a8 as S,at as ne,_ as le,r as A,c as l,o as n,a as N,A as r,N as c,F as f,D as P,H as ie,C as de,E,J as h,K as w,L as _,a9 as R,a2 as ue}from"./index-Cdc6vSVw.js";import{u as me}from"./user-DvEjaZsO.js";import{c as ce,a as p,u as fe,f as g}from"./index.esm-CxvirWgB.js";import{s as he}from"./index-Df7aGkrY.js";const pe=Y({__name:"WorkSheetListing",setup(B,{expose:t}){t();const x=re(()=>ae(()=>import("./FelDataTable-B98pg9sE.js"),__vite__mapDeps([0,1,2]))),e=Z(),d=me(),{withClientMutation:b}=$(),{workSheets:u,fetchingWorkSheets:y,workSheetPageInfo:s,workSheetTemplates:k}=ee(e),D=te();let m=v(!1);const I=v([{name:"All",value:""},{name:"Pending",value:"pending"},{name:"Awaiting",value:"awaiting"},{name:"Approved",value:"approved"},{name:"Empty",value:"empty"}]),L=v([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"WorkSheet Id",value:"workSheetId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(o,i){return S(ne,{to:{name:"worksheet-detail",params:{workSheetUid:o?.uid}},innerHTML:o?.worksheetId})}},{name:"Analysis/Test",value:"analysis.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Samples",value:"assignedCount",sortable:!1,sortBy:"asc",hidden:!1},{name:"Instrument",value:"instrument.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Analyst",value:"clientPatientId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(o,i){return S("div",{innerHTML:C(o?.analyst)})}},{name:"Status",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(o,i){return S("button",{type:"button",class:"bg-primary text-primary-foreground py-1 px-2 rounded-sm leading-none",innerHTML:o?.state||"unknown"})}}]);e.removeWorksheet();let a=oe({first:25,before:"",status:"",text:"",sort:["-uid"],filterAction:!1});e.fetchWorkSheets(a),e.fetchWorkSheetTemplates(),d.fetchUsers({});const W=ce({analystUid:p().required("Analyst is Required").typeError("Analyst is Required"),templateUid:p().typeError("Worksheet Template is required"),instrumentUid:p(),count:p().typeError("Required number of worksheets must be defined")}),{handleSubmit:U,errors:O}=fe({validationSchema:W,initialValues:{count:1,analystUid:void 0,templateUid:void 0,instrumentUid:void 0}}),{value:F}=g("count"),{value:V}=g("analystUid"),{value:H}=g("templateUid"),{value:j}=g("instrumentUid"),q=U(o=>{m.value=!1,b(se,o,"createWorksheet").then(i=>{e.addWorksheet(i),m.value=!1})});function K(o){let i=[];return o?.forEach(X=>i.push(X.name)),i?.join(", ")}function J(o){a.first=o.fetchCount,a.before=s?.value?.endCursor??"",a.text=o.filterText,a.status=o.filterStatus,a.filterAction=!1,e.fetchWorkSheets(a)}function z(o){a.first=25,a.before="",a.text=o.filterText,a.status=o.filterStatus,a.filterAction=!0,e.fetchWorkSheets(a)}const G=T(()=>d.getUsers),C=o=>o?.auth?.userName?o?.auth?.userName:o?.firstName?o.firstName+" "+o.lastName:"----",Q=T(()=>u?.value?.length+" of "+e.getWorkSheetCount+" WorkSheets"),M={DataTable:x,worksheetStore:e,userStore:d,withClientMutation:b,workSheets:u,fetchingWorkSheets:y,workSheetPageInfo:s,workSheetTemplates:k,route:D,get showModal(){return m},set showModal(o){m=o},filterOptions:I,tableColumns:L,get workSheetParams(){return a},set workSheetParams(o){a=o},worksheetSchema:W,handleSubmit:U,errors:O,count:F,analystUid:V,templateUid:H,instrumentUid:j,saveForm:q,analysesText:K,showMoreWorkSheets:J,searchWorkSheets:z,analysts:G,analystName:C,countNone:Q,get shield(){return he}};return Object.defineProperty(M,"__isScriptSetup",{enumerable:!1,value:!0}),M}}),ge={class:"space-y-6"},be={class:"rounded-lg border border-border bg-card shadow-sm p-6"},ye={class:"space-y-4"},ke={key:0,class:"space-y-1"},ve={action:"post",class:"space-y-6 p-4"},Se={class:"grid grid-cols-3 gap-4"},we={class:"block space-y-2"},_e=["value"],xe={class:"block space-y-2"},We=["value"],Ue={class:"block space-y-2"},Ce={class:"border-t border-border pt-4"};function Me(B,t,x,e,d,b){const u=A("fel-heading"),y=A("fel-modal");return n(),l(h,null,[N(u,{title:"Worksheets"},{default:c(()=>[f(r("button",{onClick:t[0]||(t[0]=P(s=>e.showModal=!0,["prevent"])),class:"px-4 py-2 bg-primary text-primary-foreground rounded-md transition-colors duration-200 hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Add WorkSheet ",512),[[ie,e.shield.hasRights(e.shield.actions.CREATE,e.shield.objects.WORKSHEET)]])]),_:1}),r("div",ge,[r("div",be,[N(e.DataTable,{columns:e.tableColumns,data:e.workSheets,toggleColumns:!0,loading:e.fetchingWorkSheets,paginable:!0,pageMeta:{fetchCount:e.workSheetParams.first,hasNextPage:e.workSheetPageInfo?.hasNextPage,countNone:e.countNone},searchable:!0,filterable:!0,filterMeta:{defaultFilter:e.workSheetParams.status,filters:e.filterOptions},onOnSearch:e.searchWorkSheets,onOnPaginate:e.showMoreWorkSheets,selectable:!1,class:"bg-background rounded-lg shadow-sm"},{footer:c(()=>[...t[6]||(t[6]=[])]),_:1},8,["columns","data","loading","pageMeta","filterMeta"])]),e.showModal?(n(),de(y,{key:0,onClose:t[5]||(t[5]=s=>e.showModal=!1),contentWidth:"w-1/2"},{header:c(()=>[r("div",ye,[t[7]||(t[7]=r("h3",{class:"text-lg font-medium"},"Create Worksheet",-1)),t[8]||(t[8]=r("div",{class:"border-t border-border"},null,-1)),Object.keys(e.errors).length>0?(n(),l("ul",ke,[(n(!0),l(h,null,w(Object.values(e.errors),(s,k)=>(n(),l("li",{key:k,class:"text-destructive text-sm"},_(s),1))),128))])):E("",!0)])]),body:c(()=>[r("form",ve,[r("div",Se,[r("label",we,[t[9]||(t[9]=r("span",{class:"text-sm font-medium"},"Analyst",-1)),f(r("select",{class:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary","onUpdate:modelValue":t[1]||(t[1]=s=>e.analystUid=s)},[(n(!0),l(h,null,w(e.analysts,s=>(n(),l("option",{key:s.uid,value:s.uid},_(e.analystName(s)),9,_e))),128))],512),[[R,e.analystUid]])]),r("label",xe,[t[11]||(t[11]=r("span",{class:"text-sm font-medium"},"Worksheet Template",-1)),f(r("select",{class:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary","onUpdate:modelValue":t[2]||(t[2]=s=>e.templateUid=s)},[t[10]||(t[10]=r("option",{value:"undefined"},null,-1)),(n(!0),l(h,null,w(e.workSheetTemplates,s=>(n(),l("option",{key:s.uid,value:s.uid},_(s.name),9,We))),128))],512),[[R,e.templateUid]])]),r("label",Ue,[t[12]||(t[12]=r("span",{class:"text-sm font-medium"},"How Many",-1)),f(r("input",{type:"number",class:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary","onUpdate:modelValue":t[3]||(t[3]=s=>e.count=s),min:"1"},null,512),[[ue,e.count]])])]),r("div",Ce,[r("button",{type:"button",onClick:t[4]||(t[4]=P(s=>e.saveForm(),["prevent"])),class:"w-full px-4 py-2 bg-primary text-primary-foreground rounded-md transition-colors duration-200 hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Save Form ")])])]),_:1})):E("",!0)])],64)}const Ee=le(pe,[["render",Me],["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/worksheet/WorkSheetListing.vue"]]);export{Ee as default};
