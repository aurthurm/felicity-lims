import{S as I,f as T,ah as W,i as z,a7 as H,W as K,a0 as X,r as h,o as u,c,a5 as r,a as w,N as o,F as Y,E as G,H as x,y as J,L as k,C as y,a3 as U,ac as f,X as A,Y as O,A as P,K as Q,_ as Z}from"./index-8d0a01b3.js";import{u as ee,g as oe,h as se}from"./billing-35f84a68.js";import{c as te,a as m,b as ie,g as re,u as ne,e as a}from"./array-0034f731.js";const de={class:"space-y-6"},le={key:0,class:"rounded-lg border border-border bg-card p-4"},ue={key:1,class:"space-y-6"},ae={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"},ce={class:"flex items-center justify-between"},fe={class:"space-y-1"},me={class:"font-medium text-foreground"},pe={class:"text-sm text-muted-foreground"},ge=["onClick"],be={class:"space-y-6"},ve={class:"grid grid-cols-2 gap-4"},he={class:"space-y-2"},xe={class:"space-y-2"},ye={class:"flex items-center space-x-2"},_e={class:"flex justify-end"},Ce=I({__name:"VoucherCodes",props:{voucherUid:String},setup(L){const d=L,{withClientMutation:_}=T();let l=ee();const{fetchingVoucherCodes:S}=W(l),F=z(()=>{const s=l.getVouchers,e=s?.findIndex(v=>v.uid===d.voucherUid);return e>-1?s[e]?.codes:[]});H(()=>l.fetchVoucherCodes(d.voucherUid)),K(()=>d.voucherUid,s=>{l.fetchVoucherCodes(d.voucherUid)});let n=X(!1);const j=te({uid:m().nullable(),voucherUid:m().required(),code:m().required("Code is Required"),usageLimit:ie().required("Usage Limit is Required"),used:m().nullable(),isActive:re().default(!0)}),{handleSubmit:D,errors:C,setFieldValue:i}=ne({validationSchema:j,initialValues:{isActive:!0,voucherUid:d.voucherUid}}),{value:M}=a("uid");a("voucherUid");const{value:p}=a("code"),{value:g}=a("usageLimit");a("used");const{value:b}=a("isActive"),V=D(s=>{s.uid||$(s),s.uid&&N(s)});let q=s=>{i("uid",s.uid),i("code",s.code),i("usageLimit",s.usageLimit),i("used",s.used),i("isActive",s.isActive),n.value=!0};const B=()=>{i("uid",void 0),i("voucherUid",d.voucherUid),i("code",void 0),i("usageLimit",void 0),i("used",void 0),i("isActive",!0),n.value=!0},$=s=>{delete s.uid,_(oe,{payload:s},"createVoucherCode").then(e=>l.addVoucherCode(e)).finally(()=>n.value=!1)},N=s=>{delete s.uid,delete s.used,_(se,{uid:M?.value,payload:s},"updateVoucherCode").then(e=>l.updateVoucherCode(e)).finally(()=>n.value=!1)};return(s,e)=>{const v=h("fel-loader"),R=h("font-awesome-icon"),E=h("fel-modal");return u(),c("div",de,[r(S)?(u(),c("div",le,[w(v,{message:"Fetching voucher codes ..."})])):(u(),c("section",ue,[o("div",{class:"flex justify-between items-center"},[e[5]||(e[5]=o("h4",{class:"text-lg font-semibold text-foreground"},"Voucher Codes",-1)),o("button",{class:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-9 px-4 py-2",onClick:B}," Add Voucher Code ")]),o("div",ae,[(u(!0),c(Y,null,G(F.value,t=>(u(),c("div",{key:t.uid,class:"rounded-lg border border-border bg-card p-4 transition-colors hover:bg-accent hover:text-accent-foreground"},[o("div",ce,[o("div",fe,[o("h5",me,x(t.code),1),o("p",pe,x(t.used)+" of "+x(t.usageLimit),1)]),o("button",{class:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-9 w-9",onClick:Ve=>r(q)(t)},[w(R,{icon:"pen",class:"text-muted-foreground"})],8,ge)])]))),128))])])),r(n)?(u(),J(E,{key:2,onClose:e[4]||(e[4]=t=>f(n)?n.value=!1:n=!1),contentWidth:"w-2/6"},{header:k(()=>e[6]||(e[6]=[o("h3",{class:"text-lg font-semibold text-foreground"},"Voucher Code Form",-1)])),body:k(()=>[o("form",be,[o("div",ve,[o("label",he,[e[7]||(e[7]=o("span",{class:"text-sm font-medium text-foreground"},"Voucher Code",-1)),y(o("input",{class:U(["form-input w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive animate-pulse":r(C).code}]),type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>f(p)?p.value=t:null),placeholder:"Code ..."},null,2),[[A,r(p)]])]),o("label",xe,[e[8]||(e[8]=o("span",{class:"text-sm font-medium text-foreground"},"Usage Limit",-1)),y(o("input",{class:U(["form-input w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive animate-pulse":r(C).usageLimit}]),type:"number",min:"1","onUpdate:modelValue":e[1]||(e[1]=t=>f(g)?g.value=t:null)},null,2),[[A,r(g)]])])]),o("div",ye,[y(o("input",{class:"form-checkbox h-4 w-4 rounded border-input text-primary focus:ring-primary",type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=t=>f(b)?b.value=t:null),checked:""},null,512),[[O,r(b)]]),e[9]||(e[9]=o("label",{class:"text-sm font-medium text-foreground"},"Is Active",-1))]),o("div",_e,[o("button",{type:"submit",class:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-9 px-4 py-2",onClick:e[3]||(e[3]=P((...t)=>r(V)&&r(V)(...t),["prevent"]))}," Save Voucher Code ")])])]),_:1})):Q("",!0)])}}});const Ae=Z(Ce,[["__scopeId","data-v-8e7b96f9"],["__file","/Users/admin/Documents/Development/felicity/felicity-lims/webapp/views/admin/billing/VoucherCodes.vue"]]);export{Ae as default};
