import{Y as J,u as Q,a0 as S,av as W,a7 as w,aZ as X,a3 as $,_ as ee,r as te,c as p,o as m,z as o,A,C as k,a,K as n,M as f,F as x,H as F,N as ae,B as M,I as _,a4 as V,aK as se,aL as ne}from"./index-OdhKCqIc.js";import{c as le,a as U,u as oe,F as re}from"./index.esm-BfHj8iGm.js";import{m as ie,n as de}from"./analyses.mutations-DUxQZn1r.js";import{u as me}from"./setup-BcFG_bXr.js";import{u as ue}from"./analysis-PB9AMevg.js";import{I as ce}from"./Input-BEm5S0CJ.js";import{T as pe}from"./Textarea-T3VcJTEo.js";import{F as fe,a as ge,b as ve}from"./FormMessage-CgXFMXx9.js";import{F as ye}from"./FormLabel-DxP9wnWS.js";import{S as _e,a as be,b as Te,c as Se,d as xe}from"./SelectValue-Ds0cfAgl.js";import{E as he,a as Ce,b as Fe,c as Ee,d as we}from"./EmptyTitle-aCQRDpx3.js";import{E as Ae}from"./index-B3gRxKMC.js";import{C as ke,a as Me,b as Ue}from"./CollapsibleTrigger-BinpFqP8.js";import{P as Ie}from"./PageHeading-Czi_4opS.js";import"./Label-CS46LzLb.js";import"./useNonce-B4v0IDPb.js";import"./chevron-down-Dqf-ptA3.js";import"./useFocusGuards-Bjb6OG0k.js";import"./PopperContent-BfyCnGUj.js";import"./CollapsibleTrigger-CC-LRQ5L.js";const h="__none__",De=J({__name:"AnalysesTemplates",setup(j,{expose:t}){t();const v=ue(),e=me(),{withClientMutation:C}=Q();let b=S(!1),T=S("");const l=S(!0),r=S(null);let c=W({});const z=w(()=>e.getDepartments);v.fetchAnalysesServices({}),v.fetchAnalysesTemplates();const H=w(()=>v.getAnalysesServices),O=w(()=>v.getAnalysesTemplates),u=S([]);function R(s,d){const g=u.value,i=g.includes(s);if(d===!0&&!i){u.value=[...g,s];return}if(d!==!0&&i){u.value=g.filter(y=>y!==s);return}d===void 0&&(u.value=i?g.filter(y=>y!==s):[...g,s])}function q(s){return u.value.includes(s)}const I=le({name:U().trim().required("Template name is required"),description:U().trim().nullable(),departmentUid:U().trim().nullable()}),{handleSubmit:D,resetForm:N,setValues:B}=oe({validationSchema:I,initialValues:{name:"",description:"",departmentUid:h}});function L(s){C(ie,{payload:s},"createAnalysisTemplate").then(d=>v.addAnalysisTemplate(d))}function E(s){if(!r.value)return;const d=c.analyses?.map(i=>i.uid)??[],g=s.services??(u.value.length>0?[...u.value]:d);C(de,{uid:r.value,payload:{...s,services:g}},"updateAnalysisTemplate").then(i=>{i&&"uid"in i&&"analyses"in i&&(v.updateAnalysesTemplate(i),i.uid===r.value&&(Object.assign(c,i),u.value=i.analyses?.map(y=>y.uid)??[]))})}function K(s){Object.assign(c,{...s}),r.value=s.uid??null,u.value=s.analyses?.map(d=>d.uid)??[]}function Y(){const s=[...u.value];E({name:c.name??"",description:c.description??null,departmentUid:c.departmentUid??null,services:s})}function Z(s,d){const g=r.value;if(l.value=s,b.value=!0,T.value=(s?"CREATE":"EDIT")+" ANALYSES TEMPLATE",s)r.value=null,u.value=[],N({values:{name:"",description:"",departmentUid:h}});else{const i=d??c;r.value=i?.uid??null,(!g||g!==i?.uid)&&(u.value=i?.analyses?.map(y=>y.uid)??[]),B({name:i?.name??"",description:i?.description??"",departmentUid:i?.departmentUid??h})}}const G=D(s=>{const d={name:s.name,description:s.description??"",departmentUid:s.departmentUid&&s.departmentUid!==h?s.departmentUid:null,services:l.value===!1?void 0:[]};l.value===!0&&L(d),l.value===!1&&E(d),b.value=!1}),P={analysisStore:v,setupStore:e,withClientMutation:C,get showModal(){return b},set showModal(s){b=s},get formTitle(){return T},set formTitle(s){T=s},formAction:l,currentUid:r,get analysisTemplate(){return c},set analysisTemplate(s){c=s},departments:z,analysesServices:H,analysesTemplates:O,selectedServiceUids:u,selectService:R,isServiceSelected:q,templateSchema:I,DEPARTMENT_NONE:h,handleSubmit:D,resetForm:N,setValues:B,addAnalysisTemplate:L,editAnalysisTemplate:E,select:K,updateTemplate:Y,FormManager:Z,saveForm:G,get Button(){return $},get Input(){return ce},get Textarea(){return pe},get FormControl(){return ve},get FormField(){return re},get FormItem(){return ge},get FormLabel(){return ye},get FormMessage(){return fe},get Select(){return xe},get SelectContent(){return Se},get SelectItem(){return Te},get SelectTrigger(){return be},get SelectValue(){return _e},get Empty(){return we},get EmptyContent(){return Ee},get EmptyDescription(){return Fe},get EmptyHeader(){return Ce},get EmptyMedia(){return Ae},get EmptyTitle(){return he},get Collapsible(){return Ue},get CollapsibleContent(){return Me},get CollapsibleTrigger(){return ke},get Switch(){return X},PageHeading:Ie};return Object.defineProperty(P,"__isScriptSetup",{enumerable:!1,value:!0}),P}}),Ne={class:"space-y-6"},Be={class:"grid grid-cols-12 gap-6"},Le={class:"col-span-3"},Pe={class:"rounded-lg border border-border bg-card"},Ve={class:"overflow-y-auto max-h-[540px] p-2"},je={class:"space-y-1"},ze=["onClick"],He={class:"flex items-center justify-between gap-2"},Oe={class:"min-w-0 flex-1"},Re={class:"flex items-center justify-between"},qe={class:"text-sm font-medium truncate"},Ke={key:0,class:"text-xs text-muted-foreground shrink-0 ml-1"},Ye={key:0,class:"text-xs text-muted-foreground mt-1 line-clamp-2"},Ze={key:0,class:"col-span-9"},Ge={class:"space-y-6"},Je={class:"rounded-lg border border-border bg-card"},Qe={class:"p-6"},We={class:"space-y-4"},Xe={class:"flex items-center justify-between"},$e={class:"max-h-[420px] overflow-y-auto space-y-1 pr-1"},et={class:"px-3 pb-2 pt-0 grid grid-cols-1 md:grid-cols-3 xl:grid-cols-4 gap-1.5"},tt=["for"],at={key:1,class:"col-span-9"},st={class:"text-xl font-semibold text-foreground"},nt={class:"space-y-4"},lt={class:"pt-4"};function ot(j,t,v,e,C,b){const T=te("Modal");return m(),p(x,null,[o("div",Ne,[a(e.PageHeading,{title:"Analyses Templates"},{default:n(()=>[a(e.Button,{onClick:t[0]||(t[0]=l=>e.FormManager(!0))},{default:n(()=>[...t[4]||(t[4]=[f("Add Analyses Template",-1)])]),_:1})]),_:1}),o("div",Be,[o("section",Le,[o("div",Pe,[t[6]||(t[6]=o("div",{class:"p-4 border-b border-border"},[o("h3",{class:"text-sm font-medium text-muted-foreground"},"Templates")],-1)),o("div",Ve,[o("ul",je,[(m(!0),p(x,null,F(e.analysesTemplates,l=>(m(),p("li",{key:l.uid,onClick:M(r=>e.select(l),["prevent","stop"]),class:ae(["rounded-md p-2 cursor-pointer transition-colors duration-200 group",l?.uid===e.analysisTemplate?.uid?"bg-accent text-accent-foreground":"hover:bg-accent/50"])},[o("div",He,[o("div",Oe,[o("div",Re,[o("span",qe,_(l?.name),1),l?.department?.name?(m(),p("span",Ke,_(l?.department?.name),1)):k("",!0)]),l?.description?(m(),p("p",Ye,_(l?.description),1)):k("",!0)]),a(e.Button,{variant:"ghost",size:"icon",class:"h-7 w-7 shrink-0 opacity-0 group-hover:opacity-100 focus:opacity-100",onClick:M(r=>e.FormManager(!1,l),["prevent","stop"])},{default:n(()=>[...t[5]||(t[5]=[o("svg",{class:"w-3.5 h-3.5",viewBox:"0 0 20 20"},[o("path",{fill:"currentColor",d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})],-1)])]),_:1},8,["onClick"])])],10,ze))),128))])])])]),e.analysisTemplate?.uid!==void 0?(m(),p("section",Ze,[o("div",Ge,[o("div",Je,[o("div",Qe,[o("div",We,[o("div",Xe,[t[8]||(t[8]=o("h3",{class:"text-sm font-medium text-foreground"},"Analyses",-1)),a(e.Button,{size:"sm",onClick:t[1]||(t[1]=l=>e.updateTemplate())},{default:n(()=>[...t[7]||(t[7]=[f(" Update Template ",-1)])]),_:1})]),o("div",$e,[(m(!0),p(x,null,F(e.analysesServices,l=>(m(),A(e.Collapsible,{key:String(l[0]),class:"rounded-md border border-border"},{default:n(()=>[a(e.CollapsibleTrigger,{class:"flex w-full items-center justify-between px-3 py-2 text-left text-sm font-medium hover:bg-accent/50 rounded-md transition-colors [&[data-state=open]>svg]:rotate-180"},{default:n(()=>[f(_(l[0])+" ",1),t[9]||(t[9]=o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"shrink-0 transition-transform"},[o("path",{d:"m6 9 6 6 6-6"})],-1))]),_:2},1024),a(e.CollapsibleContent,null,{default:n(()=>[o("ul",et,[(m(!0),p(x,null,F(l[1],r=>(m(),p("li",{key:r?.uid,class:"flex items-center gap-2 rounded-sm py-1.5 pr-2 pl-2 text-sm outline-none cursor-default select-none hover:bg-accent/50 min-w-0"},[a(e.Switch,{id:`toggle-${r?.uid}`,checked:e.isServiceSelected(r?.uid),"onUpdate:checked":c=>r?.uid!=null&&e.selectService(r.uid,c)},null,8,["id","checked","onUpdate:checked"]),o("label",{for:`toggle-${r?.uid}`,class:"flex-1 cursor-pointer text-muted-foreground hover:text-foreground"},_(r?.name),9,tt)]))),128))])]),_:2},1024)]),_:2},1024))),128))])])])])])])):(m(),p("section",at,[a(e.Empty,{class:"min-h-[400px] bg-card"},{default:n(()=>[a(e.EmptyContent,null,{default:n(()=>[a(e.EmptyMedia,{variant:"icon"},{default:n(()=>[...t[10]||(t[10]=[o("span",{class:"text-2xl"},"ðŸ“‹",-1)])]),_:1}),a(e.EmptyHeader,null,{default:n(()=>[a(e.EmptyTitle,null,{default:n(()=>[...t[11]||(t[11]=[f("No template selected",-1)])]),_:1}),a(e.EmptyDescription,null,{default:n(()=>[...t[12]||(t[12]=[f("Select a template from the list to view its details.",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]))])]),e.showModal?(m(),A(T,{key:0,onClose:t[3]||(t[3]=l=>e.showModal=!1)},{header:n(()=>[o("h3",st,_(e.formTitle),1)]),body:n(()=>[o("form",{onSubmit:t[2]||(t[2]=M((...l)=>e.saveForm&&e.saveForm(...l),["prevent"])),class:"p-6 space-y-6"},[o("div",nt,[a(e.FormField,{name:"name"},{default:n(({componentField:l})=>[a(e.FormItem,null,{default:n(()=>[a(e.FormLabel,null,{default:n(()=>[...t[13]||(t[13]=[f("Template Name",-1)])]),_:1}),a(e.FormControl,null,{default:n(()=>[a(e.Input,V(l,{placeholder:"Enter template name"}),null,16)]),_:2},1024),a(e.FormMessage)]),_:2},1024)]),_:1}),a(e.FormField,{name:"departmentUid"},{default:n(({componentField:l})=>[a(e.FormItem,null,{default:n(()=>[a(e.FormLabel,null,{default:n(()=>[...t[14]||(t[14]=[f("Department",-1)])]),_:1}),a(e.FormControl,null,{default:n(()=>[a(e.Select,se(ne(l)),{default:n(()=>[a(e.SelectTrigger,null,{default:n(()=>[a(e.SelectValue,{placeholder:"Select department"})]),_:1}),a(e.SelectContent,null,{default:n(()=>[a(e.SelectItem,{value:e.DEPARTMENT_NONE},{default:n(()=>[...t[15]||(t[15]=[f("Select department",-1)])]),_:1}),(m(!0),p(x,null,F(e.departments,r=>(m(),A(e.SelectItem,{key:r.uid,value:r.uid},{default:n(()=>[f(_(r.name),1)]),_:2},1032,["value"]))),128))]),_:1})]),_:1},16)]),_:2},1024),a(e.FormMessage)]),_:2},1024)]),_:1}),a(e.FormField,{name:"description"},{default:n(({componentField:l})=>[a(e.FormItem,null,{default:n(()=>[a(e.FormLabel,null,{default:n(()=>[...t[16]||(t[16]=[f("Description",-1)])]),_:1}),a(e.FormControl,null,{default:n(()=>[a(e.Textarea,V(l,{rows:"3",placeholder:"Enter template description"}),null,16)]),_:2},1024),a(e.FormMessage)]),_:2},1024)]),_:1})]),o("div",lt,[a(e.Button,{type:"submit",class:"w-full"},{default:n(()=>[...t[17]||(t[17]=[f("Save Changes",-1)])]),_:1})])],32)]),_:1})):k("",!0)],64)}const wt=ee(De,[["render",ot],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/analyses/AnalysesTemplates.vue"]]);export{wt as default};
