import{Y as I,an as U,a3 as L,_ as B,c as F,o as f,z as r,a as o,K as l,M as s,a4 as v,B as j,ag as q,u as V,aB as O,a0 as y,bb as z,a9 as K,aa as Y,ab as G,ac as J,ad as Q,ae as W,af as X,A as T,C as E,D as N,E as S,F as k,H as Z,I as h}from"./index-OdhKCqIc.js";import{a as $,b as ee,D as te}from"./clients.mutations-B0cLk_GK.js";import{u as oe}from"./client-BNZY_Y1e.js";import{s as le}from"./index-DJJ2wcNX.js";import{S as ae}from"./Spinner-Bl8RfjFA.js";import{E as ne,a as ie,b as re,c as se,d as me}from"./EmptyTitle-aCQRDpx3.js";import{c as de,a as P,u as ce,F as ue}from"./index.esm-BfHj8iGm.js";import{F as fe,a as be,b as Ce}from"./FormMessage-CgXFMXx9.js";import{F as ge}from"./FormLabel-DxP9wnWS.js";import{I as pe}from"./Input-BEm5S0CJ.js";import"./location-zigt6URg.js";import"./Label-CS46LzLb.js";const _e=I({__name:"ContactForm",props:{contact:{type:[Object,null],required:!1,default:null},create:{type:Boolean,required:!1,default:!0}},emits:["submit","close"],setup(_,{expose:t,emit:m}){t();const e=_,d=m,b=de({firstName:P().required("Full name is required"),email:P().nullable().email("Enter a valid email"),mobilePhone:P().nullable()}),{handleSubmit:a,setValues:c}=ce({validationSchema:b,initialValues:{firstName:e.contact?.firstName??"",email:e.contact?.email??"",mobilePhone:e.contact?.mobilePhone??""}}),C=a(i=>{d("submit",{firstName:i.firstName,email:i.email&&String(i.email).trim()?i.email:void 0,mobilePhone:i.mobilePhone&&String(i.mobilePhone).trim()?i.mobilePhone:void 0})});function g(i){if(!i){c({firstName:"",email:"",mobilePhone:""});return}c({firstName:i.firstName??"",email:i.email??"",mobilePhone:i.mobilePhone??""})}U(()=>e.contact,i=>g(i??null),{immediate:!0});const p={props:e,emit:d,contactSchema:b,handleSubmit:a,setValues:c,onSubmit:C,initFromContact:g,get FormControl(){return Ce},get FormField(){return ue},get FormItem(){return be},get FormLabel(){return ge},get FormMessage(){return fe},get Input(){return pe},get Button(){return L}};return Object.defineProperty(p,"__isScriptSetup",{enumerable:!1,value:!0}),p}}),he={class:"grid grid-cols-1 gap-4 sm:grid-cols-2"},ye={class:"flex justify-end gap-2 pt-2"};function Fe(_,t,m,e,d,b){return f(),F("form",{class:"space-y-6",autocomplete:"off",onSubmit:t[2]||(t[2]=j((...a)=>e.onSubmit&&e.onSubmit(...a),["prevent"]))},[r("div",he,[o(e.FormField,{name:"firstName"},{default:l(({componentField:a})=>[o(e.FormItem,null,{default:l(()=>[o(e.FormLabel,null,{default:l(()=>[...t[3]||(t[3]=[s("Full Name",-1)])]),_:1}),o(e.FormControl,null,{default:l(()=>[o(e.Input,v(a,{placeholder:"Full Name ..."}),null,16)]),_:2},1024),o(e.FormMessage)]),_:2},1024)]),_:1}),o(e.FormField,{name:"email"},{default:l(({componentField:a})=>[o(e.FormItem,null,{default:l(()=>[o(e.FormLabel,null,{default:l(()=>[...t[4]||(t[4]=[s("Email",-1)])]),_:1}),o(e.FormControl,null,{default:l(()=>[o(e.Input,v(a,{type:"email",placeholder:"Email ...",autocomplete:"off"}),null,16)]),_:2},1024),o(e.FormMessage)]),_:2},1024)]),_:1}),o(e.FormField,{name:"mobilePhone"},{default:l(({componentField:a})=>[o(e.FormItem,{class:"sm:col-span-2"},{default:l(()=>[o(e.FormLabel,null,{default:l(()=>[...t[5]||(t[5]=[s("Mobile Phone",-1)])]),_:1}),o(e.FormControl,null,{default:l(()=>[o(e.Input,v(a,{type:"tel",placeholder:"Mobile Phone ...",autocomplete:"off"}),null,16)]),_:2},1024),o(e.FormMessage)]),_:2},1024)]),_:1})]),r("div",ye,[o(e.Button,{type:"button",variant:"secondary",onClick:t[0]||(t[0]=a=>e.emit("close"))},{default:l(()=>[...t[6]||(t[6]=[s(" Cancel ",-1)])]),_:1}),o(e.Button,{type:"button",variant:"outline",onClick:t[1]||(t[1]=a=>e.emit("close"))},{default:l(()=>[...t[7]||(t[7]=[s(" Close ",-1)])]),_:1}),o(e.Button,{type:"submit"},{default:l(()=>[...t[8]||(t[8]=[s("Save Form",-1)])]),_:1})])],32)}const xe=B(_e,[["render",Fe],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/components/client/ContactForm.vue"]]),ve=I({__name:"ContactTable",props:{clientUid:String},setup(_,{expose:t}){t();const m=oe(),e=q(),{withClientMutation:d}=V(),{clientContacts:b,fetchingClientContacts:a}=O(m),c=y(""),C=y(!1),g=y(!1),p=y({}),i=_,x=e.query.clientUid||"";x&&m.fetchClientContacts(x);function w(n){d($,{payload:{clientUid:e.query.clientUid,firstName:n.firstName,mobilePhone:n.mobilePhone,email:n.email}},"createClientContact").then(u=>m.addClientContact(u))}function D(n){d(ee,{uid:p.value.uid,payload:{clientUid:e.query.clientUid,firstName:n.firstName,mobilePhone:n.mobilePhone,email:n.email}},"updateClientContact").then(u=>m.updateClientContact(u))}function H(n,u={}){g.value=n,c.value=(n?"CREATE":"EDIT")+" CONTACT",C.value=!0,p.value=n?{}:{...u}}function A(n){g.value?w(n):D(n),C.value=!1}function R(){C.value=!1}const M={clientStore:m,router:e,withClientMutation:d,clientContacts:b,fetchingClientContacts:a,formTitle:c,showContactModal:C,createContact:g,contact:p,props:i,clientUid:x,addClientContact:w,editClientContact:D,FormManager:H,onFormSubmit:A,onFormClose:R,deleteClientContact:n=>{d(te,{uid:n.uid},"deleteClientContact").then(u=>{u&&m.deleteClientContact(n.uid)})},get shield(){return le},get Spinner(){return ae},get Table(){return X},get TableBody(){return W},get TableCell(){return Q},get TableEmpty(){return J},get TableHead(){return G},get TableHeader(){return Y},get TableRow(){return K},get Empty(){return me},get EmptyContent(){return se},get EmptyDescription(){return re},get EmptyHeader(){return ie},get EmptyTitle(){return ne},Modal:z,ContactForm:xe};return Object.defineProperty(M,"__isScriptSetup",{enumerable:!1,value:!0}),M}}),Te={class:"overflow-x-auto"},Ee={class:"border border-border bg-card rounded-lg shadow-md"},Ne={class:"relative w-full overflow-auto"},Se={class:"flex items-center"},Pe={class:"text-sm leading-5 text-foreground"},we={class:"text-sm leading-5 text-primary"},De={class:"text-sm leading-5 text-primary"},Me=["onClick"],ke=["onClick"],Ie={key:0,class:"py-4 text-center"},Be={class:"inline-flex items-center gap-2"};function He(_,t,m,e,d,b){return f(),F(k,null,[r("div",Te,[N(r("button",{onClick:t[0]||(t[0]=a=>e.FormManager(!0)),class:"px-1 py-0 mb-4 border-primary border text-primary rounded-sm transition duration-300 hover:bg-primary hover:text-primary-foreground focus:outline-none"}," Add Contact ",512),[[S,e.shield.hasRights(e.shield.actions.CREATE,e.shield.objects.CLIENT)]]),r("div",Ee,[r("div",Ne,[o(e.Table,{class:"w-full caption-bottom text-sm"},{default:l(()=>[o(e.TableHeader,{class:"[&_tr]:border-b"},{default:l(()=>[o(e.TableRow,{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:l(()=>[o(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...t[1]||(t[1]=[s(" Full Name ",-1)])]),_:1}),o(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...t[2]||(t[2]=[s(" Email ",-1)])]),_:1}),o(e.TableHead,{class:"h-12 px-4 text-left align-middle font-medium text-muted-foreground"},{default:l(()=>[...t[3]||(t[3]=[s(" Phone ",-1)])]),_:1}),o(e.TableHead,{class:"h-12 px-4 text-right align-middle font-medium text-muted-foreground"},{default:l(()=>[...t[4]||(t[4]=[s("Actions",-1)])]),_:1})]),_:1})]),_:1}),o(e.TableBody,{class:"[&_tr:last-child]:border-0"},{default:l(()=>[(f(!0),F(k,null,Z(e.clientContacts,a=>(f(),T(e.TableRow,{key:a.uid,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:l(()=>[o(e.TableCell,{class:"px-4 py-3 align-middle text-sm"},{default:l(()=>[r("div",Se,[r("div",null,[r("div",Pe,h(a.firstName)+" "+h(a.lastName),1)])])]),_:2},1024),o(e.TableCell,{class:"px-4 py-3 align-middle text-sm"},{default:l(()=>[r("div",we,h(a.email),1)]),_:2},1024),o(e.TableCell,{class:"px-4 py-3 align-middle text-sm"},{default:l(()=>[r("div",De,h(a.mobilePhone),1)]),_:2},1024),o(e.TableCell,{class:"px-4 py-3 align-middle text-right"},{default:l(()=>[N(r("button",{onClick:c=>e.FormManager(!1,a),class:"px-2 py-1 mr-2 border-border border text-orange-500rounded-smtransition duration-300 hover:bg-muted hover:text-primary-foreground focus:outline-none"}," Edit ",8,Me),[[S,e.shield.hasRights(e.shield.actions.UPDATE,e.shield.objects.CLIENT)]]),t[5]||(t[5]=s()),N(r("button",{onClick:c=>e.deleteClientContact(a),class:"px-2 py-1 mr-2 border-destructive border text-orange-500rounded-smtransition duration-300 hover:bg-destructive hover:text-primary-foreground focus:outline-none"}," Deactivate ",8,ke),[[S,e.shield.hasRights(e.shield.actions.UPDATE,e.shield.objects.CLIENT)]])]),_:2},1024)]),_:2},1024))),128)),!e.fetchingClientContacts&&e.clientContacts.length===0?(f(),T(e.TableEmpty,{key:0,colspan:4},{default:l(()=>[o(e.Empty,{class:"border-0 bg-transparent p-0"},{default:l(()=>[o(e.EmptyContent,null,{default:l(()=>[o(e.EmptyHeader,null,{default:l(()=>[o(e.EmptyTitle,null,{default:l(()=>[...t[6]||(t[6]=[s("No contacts found",-1)])]),_:1}),o(e.EmptyDescription,null,{default:l(()=>[...t[7]||(t[7]=[s("Add a client contact to get started.",-1)])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):E("",!0)]),_:1})]),_:1})]),e.fetchingClientContacts?(f(),F("div",Ie,[r("span",Be,[o(e.Spinner,{class:"size-4"}),t[8]||(t[8]=r("span",{class:"text-sm"},"Fetching client contacts ...",-1))])])):E("",!0)])]),e.showContactModal?(f(),T(e.Modal,{key:0,onClose:e.onFormClose},{header:l(()=>[r("h3",null,h(e.formTitle),1)]),body:l(()=>[o(e.ContactForm,{contact:e.contact,create:e.createContact,onSubmit:e.onFormSubmit,onClose:e.onFormClose},null,8,["contact","create"])]),_:1})):E("",!0)],64)}const Qe=B(ve,[["render",He],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/client/_id/ContactTable.vue"]]);export{Qe as default};
