import{a0 as se,f as oe,a7 as b,g as ne,h as C,_ as re,r as h,c as l,o as r,A as e,C as ae,E as m,a as V,N as g,P,J as y,K as x,Q as w,D as q,L as d,F as T,a3 as le,a2 as O,a9 as ie}from"./index-Daoe3XS9.js";import{c as de,f as ce,a as D,u as ue,b as k}from"./index.esm-BT7_X8h2.js";import{m as me,n as pe}from"./analyses.mutations-DmiK7cfK.js";import{u as fe}from"./setup-B4brziEy.js";import{u as ge}from"./analysis-D7-3mDtD.js";const ye=se({__name:"AnalysesTemplates",setup(I,{expose:t}){t();const u=ge(),o=fe(),{withClientMutation:_}=oe();let A=b("analyses-services");const E=["analyses-services"];let p=b(!1),v=b("");const f=b(!0),s=b(null);let a=ne({});const S=C(()=>o.getDepartments);u.fetchAnalysesServices({}),u.fetchAnalysesTemplates();const U=C(()=>u.getAnalysesServices),J=C(()=>u.getAnalysesTemplates),F=de({name:D().trim().required("Template name is required"),description:D().trim().nullable(),departmentUid:D().trim().nullable(),active:ce().default(!0)}),{handleSubmit:N,resetForm:j,setValues:B}=ue({validationSchema:F,initialValues:{name:"",description:"",departmentUid:"",active:!0}}),{value:K,errorMessage:Q}=k("name"),{value:R,errorMessage:Y}=k("description"),{value:G,errorMessage:H}=k("departmentUid"),{value:W}=k("active");function L(n){_(me,{payload:n},"createAnalysisTemplate").then(c=>u.addAnalysisTemplate(c))}function M(n){if(!s.value)return;const c=a.analyses?.map(i=>i.uid);_(pe,{uid:s.value,payload:{...n,services:c}},"updateAnalysisTemplate").then(i=>u.updateAnalysesTemplate(i))}function X(n){Object.assign(a,{...n}),s.value=n.uid??null,U.value?.forEach(c=>{c[1].forEach(i=>{i.checked=!1,n.analyses?.some(te=>te.uid===i.uid)&&(i.checked=!0)})})}function Z(){const n=[];U.value?.forEach(c=>{c[1].forEach(i=>{i.checked&&n.push(i)})}),a.analyses=n,M({name:a.name??"",description:a.description??null,departmentUid:a.departmentUid??null,active:a.active??!0})}function $(n,c){if(f.value=n,p.value=!0,v.value=(n?"CREATE":"EDIT")+" ANALYSES TEMPLATE",n)s.value=null,j({values:{name:"",description:"",departmentUid:"",active:!0}});else{const i=c??a;s.value=i?.uid??null,B({name:i?.name??"",description:i?.description??"",departmentUid:i?.departmentUid??"",active:i?.active??!0})}}const ee=N(n=>{const c={name:n.name,description:n.description??null,departmentUid:n.departmentUid?n.departmentUid:null,active:n.active};f.value===!0&&L(c),f.value===!1&&M(c),p.value=!1}),z={analysisStore:u,setupStore:o,withClientMutation:_,get currentTab(){return A},set currentTab(n){A=n},tabs:E,get showModal(){return p},set showModal(n){p=n},get formTitle(){return v},set formTitle(n){v=n},formAction:f,currentUid:s,get analysisTemplate(){return a},set analysisTemplate(n){a=n},departments:S,analysesServices:U,analysesTemplates:J,templateSchema:F,handleSubmit:N,resetForm:j,setValues:B,name:K,nameError:Q,description:R,descriptionError:Y,departmentUid:G,departmentError:H,active:W,addAnalysisTemplate:L,editAnalysisTemplate:M,select:X,updateTemplate:Z,FormManager:$,saveForm:ee};return Object.defineProperty(z,"__isScriptSetup",{enumerable:!1,value:!0}),z}}),ve={class:"space-y-6"},be={class:"grid grid-cols-12 gap-6"},xe={class:"col-span-3"},_e={class:"rounded-lg border border-border bg-card"},he={class:"overflow-y-auto max-h-[540px] p-2"},Te={class:"space-y-1"},ke=["onClick"],we={class:"flex items-center justify-between"},Ae={class:"text-sm font-medium"},Ee={key:0,class:"text-xs text-muted-foreground"},Se={key:0,class:"text-xs text-muted-foreground mt-1 line-clamp-2"},Ue={key:0,class:"col-span-9"},Me={class:"space-y-6"},Ce={class:"rounded-lg border border-border bg-card p-6"},Ve={class:"flex items-center justify-between"},De={class:"space-y-1"},Fe={class:"text-xl font-semibold text-foreground"},Ne={key:0,class:"text-sm text-muted-foreground"},je={class:"flex items-center space-x-2"},Be={class:"border-b border-border"},Le={class:"flex space-x-2"},ze=["onClick"],Pe={class:"rounded-lg border border-border bg-card"},qe={class:"p-6"},Oe={key:0},Ie={class:"col-span-4 overflow-y-scroll overscroll-contain analyses-scroll bg-white p-1"},Je={class:"grid grid-cols-6 gap-2 w-full"},Ke={class:"grow p-1"},Qe={class:w(["font-medium text-gray-500 hover:text-gray-700",{"text-gray-700 font-medium":!1}])},Re=["id","onUpdate:modelValue"],Ye=["for"],Ge={key:1,class:"col-span-9"},He={class:"text-xl font-semibold text-foreground"},We={class:"space-y-4"},Xe={class:"space-y-2"},Ze={key:0,class:"text-sm text-destructive"},$e={class:"space-y-2"},et=["value"],tt={key:0,class:"text-sm text-destructive"},st={class:"space-y-2"},ot={key:0,class:"text-sm text-destructive"};function nt(I,t,u,o,_,A){const E=h("fel-button"),p=h("fel-heading"),v=h("fel-accordion"),f=h("fel-modal");return r(),l(y,null,[e("div",ve,[V(p,{title:"Analyses Templates"},{default:g(()=>[V(E,{onClick:t[0]||(t[0]=s=>o.FormManager(!0))},{default:g(()=>[...t[8]||(t[8]=[P("Add Analyses Template",-1)])]),_:1})]),_:1}),e("div",be,[e("section",xe,[e("div",_e,[t[9]||(t[9]=e("div",{class:"p-4 border-b border-border"},[e("h3",{class:"text-sm font-medium text-muted-foreground"},"Templates")],-1)),e("div",he,[e("ul",Te,[(r(!0),l(y,null,x(o.analysesTemplates,s=>(r(),l("li",{key:s.uid,onClick:q(a=>o.select(s),["prevent","stop"]),class:w(["rounded-md p-2 cursor-pointer transition-colors duration-200",s?.uid===o.analysisTemplate?.uid?"bg-accent text-accent-foreground":"hover:bg-accent/50"])},[e("div",we,[e("span",Ae,d(s?.name),1),s?.department?.name?(r(),l("span",Ee,d(s?.department?.name),1)):m("",!0)]),s?.description?(r(),l("p",Se,d(s?.description),1)):m("",!0)],10,ke))),128))])])])]),o.analysisTemplate?.uid!==void 0?(r(),l("section",Ue,[e("div",Me,[e("div",Ce,[e("div",Ve,[e("div",De,[e("h2",Fe,d(o.analysisTemplate?.name),1),o.analysisTemplate?.description?(r(),l("p",Ne,d(o.analysisTemplate?.description),1)):m("",!0)]),e("div",je,[e("button",{onClick:t[1]||(t[1]=s=>o.FormManager(!1,o.analysisTemplate)),class:"inline-flex items-center justify-center h-9 w-9 rounded-md border border-input bg-background text-foreground hover:bg-accent hover:text-accent-foreground transition-colors focus:outline-none focus:ring-2 focus:ring-ring"},[...t[10]||(t[10]=[e("svg",{class:"w-4 h-4",viewBox:"0 0 20 20"},[e("path",{d:"M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"})],-1)])])])])]),e("nav",Be,[e("div",Le,[(r(),l(y,null,x(o.tabs,s=>e("button",{key:s,class:w(["px-4 py-2 text-sm font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",o.currentTab===s?"border-b-2 border-primary text-foreground":"text-muted-foreground hover:text-foreground"]),onClick:a=>o.currentTab=s},d(s),11,ze)),64))])]),e("div",Pe,[e("div",qe,[o.currentTab==="analyses-services"?(r(),l("div",Oe,[t[12]||(t[12]=e("h3",null,"Analyses",-1)),t[13]||(t[13]=e("hr",null,null,-1)),e("section",Ie,[e("div",Je,[(r(!0),l(y,null,x(o.analysesServices,s=>(r(),l("div",{class:"col-span-2",key:s[0]},[V(v,null,{title:g(()=>[P(d(s[0]),1)]),body:g(()=>[e("div",null,[e("ul",null,[(r(!0),l(y,null,x(s[1],a=>(r(),l("li",{key:a?.uid,class:w(["cursor-pointer",[{"border-sky-800 bg-gray-200 underline pl-3":!1}]])},[e("div",Ke,[e("div",Qe,[T(e("input",{type:"checkbox",id:`toggle-${a?.uid}`,class:"form-control","onUpdate:modelValue":S=>a.checked=S},null,8,Re),[[le,a.checked]]),e("label",{for:`toggle-${a?.uid}`,class:"text-gray-700 ml-4"},d(a?.name),9,Ye)])]),t[11]||(t[11]=e("hr",null,null,-1))]))),128))])])]),_:2},1024)]))),128))]),e("button",{class:"px-2 py-1 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none",onClick:t[2]||(t[2]=s=>o.updateTemplate())}," Update Template ")])])):m("",!0)])])])])):(r(),l("section",Ge,[...t[14]||(t[14]=[e("div",{class:"rounded-lg border border-border bg-card p-6 flex flex-col items-center justify-center space-y-4 min-h-[400px]"},[e("div",{class:"text-4xl text-muted-foreground"},"ðŸ“‹"),e("h3",{class:"text-lg font-medium text-foreground"},"No Template Selected"),e("p",{class:"text-sm text-muted-foreground"},"Select a template from the list to view its details")],-1)])]))])]),o.showModal?(r(),ae(f,{key:0,onClose:t[7]||(t[7]=s=>o.showModal=!1)},{header:g(()=>[e("h3",He,d(o.formTitle),1)]),body:g(()=>[e("form",{onSubmit:t[6]||(t[6]=q((...s)=>o.saveForm&&o.saveForm(...s),["prevent"])),class:"p-6 space-y-6"},[e("div",We,[e("label",Xe,[t[15]||(t[15]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Template Name",-1)),T(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>o.name=s),type:"text",class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring placeholder:text-muted-foreground",placeholder:"Enter template name"},null,512),[[O,o.name]]),o.nameError?(r(),l("p",Ze,d(o.nameError),1)):m("",!0)]),e("label",$e,[t[17]||(t[17]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Department",-1)),T(e("select",{"onUpdate:modelValue":t[4]||(t[4]=s=>o.departmentUid=s),class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring"},[t[16]||(t[16]=e("option",{value:""},"Select department",-1)),(r(!0),l(y,null,x(o.departments,s=>(r(),l("option",{key:s.uid,value:s.uid},d(s.name),9,et))),128))],512),[[ie,o.departmentUid]]),o.departmentError?(r(),l("p",tt,d(o.departmentError),1)):m("",!0)]),e("label",st,[t[18]||(t[18]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Description",-1)),T(e("textarea",{"onUpdate:modelValue":t[5]||(t[5]=s=>o.description=s),rows:"3",class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring placeholder:text-muted-foreground resize-none",placeholder:"Enter template description"},null,512),[[O,o.description]]),o.descriptionError?(r(),l("p",ot,d(o.descriptionError),1)):m("",!0)])]),t[19]||(t[19]=e("div",{class:"pt-4"},[e("button",{type:"submit",class:"w-full bg-primary text-primary-foreground hover:bg-primary/90 rounded-lg px-4 py-2 text-sm font-medium transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-ring"}," Save Changes ")],-1))],32)]),_:1})):m("",!0)],64)}const ct=re(ye,[["render",nt],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/analyses/AnalysesTemplates.vue"]]);export{ct as default};
