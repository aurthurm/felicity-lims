import{u as R,O as f,f as p,j as h}from"./index-54016222.js";import{e as d,f as w,S as m,g as A,h as $,i as b}from"./analyses.mutations-fdbdb917.js";function P(){const r=R(),i=f(),{withClientMutation:o}=p(),{toastSuccess:l,toastError:n,swalConfirm:u}=h();return{submitResult:async s=>{if(s.status!=="pending"){n("Cannot submit non-pending analysis");return}try{if(!(await u("Are you sure you want to submit this result?","Submit Result")).isConfirmed)return;s.result=s.editResult;const e={uid:s.uid||"",result:s.result||"",laboratoryInstrumentUid:s.laboratoryInstrumentUid||"",methodUid:s.methodUid||""},a=await o(m,{analysisResults:[e],sourceObject:"sample",sourceObjectUid:s.sampleUid||""},"submitAnalysisResults");a?.message&&(l(a.message),r.backgroundProcessing([{uid:s.uid,result:s.result}],void 0,"submitting"),i.backgroundProcessing([{uid:s.uid,result:s.result}],void 0,"submitting"))}catch(t){n(`Failed to submit result: ${t instanceof Error?t.message:"Unknown error"}`)}},submitResults:async(s,t,e)=>{try{if((await u(`Are you sure you want to submit ${s.length} result${s.length>1?"s":""}?`,"Submit Results")).isConfirmed){const c=await o(m,{analysisResults:s,sourceObject:t,sourceObjectUid:e},"submitAnalysisResults");c?.message&&(l(c.message),r.backgroundProcessing(s,t==="sample"?e:void 0,"submitting"),i.backgroundProcessing(s,t==="worksheet"?e:void 0,"submitting"))}}catch(a){n(`Failed to submit results: ${a instanceof Error?a.message:"Unknown error"}`)}},cancelResults:async s=>{try{if((await u(`Are you sure you want to cancel ${s.length} analyte${s.length>1?"s":""}?`,"Cancel Analysis")).isConfirmed){const e=await o(d,{analyses:s},"cancelAnalysisResults");e?.results&&(r.updateAnalysesResultsStatus(e.results),i.updateWorksheetResultsStatus(e.results),l(`Successfully cancelled ${s.length} analyte${s.length>1?"s":""}`))}}catch(t){n(`Failed to cancel analyses: ${t instanceof Error?t.message:"Unknown error"}`)}},reInstateResults:async s=>{try{if((await u(`Are you sure you want to reinstate ${s.length} analyte${s.length>1?"s":""}?`,"Reinstate Analysis")).isConfirmed){const e=await o(w,{analyses:s},"reInstateAnalysisResults");e?.results&&(r.updateAnalysesResultsStatus(e.results),i.updateWorksheetResultsStatus(e.results),l(`Successfully reinstated ${s.length} analyte${s.length>1?"s":""}`))}}catch(t){n(`Failed to reinstate analyses: ${t instanceof Error?t.message:"Unknown error"}`)}},approveResults:async(s,t,e)=>{try{if((await u(`Are you sure you want to approve ${s.length} result${s.length>1?"s":""}?`,"Approve Results")).isConfirmed){const c=await o(A,{analyses:s,sourceObject:t,sourceObjectUid:e},"verifyAnalysisResults");if(c?.message){l(c.message);const y=s.map(g=>({uid:g}));r.backgroundProcessing(y,t==="sample"?e:void 0,"approving"),i.backgroundProcessing(y,t==="worksheet"?e:void 0,"approving")}}}catch(a){n(`Failed to approve results: ${a instanceof Error?a.message:"Unknown error"}`)}},retractResults:async s=>{try{if((await u(`Are you sure you want to retract ${s.length} result${s.length>1?"s":""}?`,"Retract Results")).isConfirmed){const e=await o($,{analyses:s},"retractAnalysisResults");e?.results&&(r.updateAnalysesResults(e.results),i.updateWorksheetResultsStatus(e.results),l(`Successfully retracted ${s.length} result${s.length>1?"s":""}`))}}catch(t){n(`Failed to retract results: ${t instanceof Error?t.message:"Unknown error"}`)}},retestResults:async s=>{try{if((await u(`Are you sure you want to retest ${s.length} analyte${s.length>1?"s":""}?`,"Retest Analysis")).isConfirmed){const e=await o(b,{analyses:s},"retestAnalysisResults");e?.results&&(r.updateAnalysesResults(e.results),l(`Successfully initiated retest for ${s.length} analyte${s.length>1?"s":""}`))}}catch(t){n(`Failed to retest analyses: ${t instanceof Error?t.message:"Unknown error"}`)}}}}export{P as u};
