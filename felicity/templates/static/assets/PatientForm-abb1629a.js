import{P as xe,e as Ue,Q as ye,a9 as Ne,f as W,h as B,aa as De,t as Pe,Z as I,ap as he,ak as Ve,r as ke,o as m,c as p,b as t,A as o,V as c,a2 as n,a7 as d,E as a,W as Q,C as Me,a as X,a4 as h,F as x,D as U,z as Z,aA as Se,_ as Ce}from"./index-03a7f0eb.js";import Be from"./vue-multiselect.esm-e5326598.js";import{A as Ie}from"./patient.mutations-182d3c57.js";import{u as _e}from"./client-519834e4.js";import{u as Oe}from"./location-ddfa2664.js";import{u as $e}from"./patient-41f2f0bf.js";import{c as J,d as V,a as w,f as Ee,g as ee,u as Fe,b as u}from"./array-9b204d8d.js";/* empty css                                                                 */const Ye={class:"flex whitespace-nowrap w-full"},qe={class:"w-full"},Ae={class:"text-orange-600 w-4/12"},Re={class:"flex whitespace-nowrap w-full"},je={class:"w-full"},He={class:"text-orange-600 w-4/12"},Le={class:"flex whitespace-nowrap mb-2 w-full"},Ge={class:"w-full"},Ke={class:"text-orange-600 w-4/12"},Te={class:"flex whitespace-nowrap w-full"},ze={class:"w-full"},We={class:"text-orange-600 w-4/12"},Qe={class:"flex whitespace-nowrap my-2 w-full"},Xe={class:"w-full flex justify-between items-center"},Ze={class:"flex justify-start items-center gap-x-2 ml-4"},Je={for:"estimateYears"},et={for:"estimateMonths"},tt={for:"estimateDays"},st={class:"text-orange-600 w-4/12"},lt={class:"flex whitespace-nowrap mb-2 w-full"},nt={class:"w-full"},it={class:"text-orange-600 w-4/12"},at={class:"flex whitespace-nowrap mb-2 w-full"},ot={class:"w-full"},ut={class:"text-orange-600 w-4/12"},rt={class:"flex whitespace-nowrap mb-2 w-full"},dt={class:"w-full"},mt=["value"],pt={class:"text-orange-600 w-4/12"},ct={class:"flex whitespace-nowrap mb-2 w-full"},ft={class:"w-full"},vt={class:"text-orange-600 w-4/12"},wt={class:"flex whitespace-nowrap mb-2 w-full"},bt={class:"w-full"},gt={class:"text-orange-600 w-4/12"},xt={class:"flex whitespace-nowrap mb-2 w-full"},Ut={class:"w-full"},yt={class:"text-orange-600 w-4/12"},Nt={class:"flex whitespace-nowrap mb-2 w-full"},Dt={class:"text-gray-700 w-4/12 flex justify-between items-center"},Pt={class:"w-full border-gray-200"},ht={class:"flex justify-around items-center w-full"},Vt=["onUpdate:modelValue"],kt=["value"],Mt=["onUpdate:modelValue"],St=["onClick"],Ct={class:"grid grid-cols-3 gap-x-4 mb-4"},Bt={class:"col-span-1"},It={class:"flex gap-x-2 items-center whitespace-nowrap w-full"},_t=["value"],Ot={class:"text-orange-600 w-4/12"},$t={class:"col-span-1"},Et={class:"flex gap-x-2 items-center whitespace-nowrap col-span-1 w-full"},Ft=["value"],Yt={class:"text-orange-600 w-4/12"},qt={class:"col-span-1"},At={class:"flex gap-x-2 items-center whitespace-nowrap col-span-1 w-full"},Rt=["value"],jt={class:"text-orange-600 w-4/12"},Ht=xe({__name:"PatientForm",props:{patient:Object,navigate:{type:Boolean,default:!1}},emits:["close"],setup(te,{emit:se}){const y=te,G=se;let K=_e(),f=Oe(),k=$e();const{withClientMutation:T}=Ue();let le=ye(),ne=Ne();const N=W({genders:["Male","Female","Missing","Trans Gender"],createAction:!0,countries:B(()=>f.getCountries),provinces:B(()=>f.getProvinces),districts:B(()=>f.getDistricts),clients:B(()=>K.getClients)});let ie=W({first:void 0,after:"",text:"",sortBy:["name"],filterAction:!1});De(async()=>{await f.fetchCountries(),await K.fetchClients(ie),y.patient?.countryUid&&await f.filterProvincesByCountry(y.patient?.countryUid),y.patient?.provinceUid&&await f.filterDistrictsByProvince(y.patient?.provinceUid),await k.fetchIdentifications()});const{patient:i,navigate:ae}=Pe(y),oe=I(new Date),M=I(0),_=I(0),O=I(0),b=()=>{const l=Se().subtract(M.value,"year").subtract(_.value,"month").subtract(O.value,"day");g.value=l.format("YYYY-MM-DD"),D.value=M.value},ue=()=>{var l=new Date().getFullYear();if(g.value){const e=new Date(g.value).getFullYear();D.value=l-e}},re=J({uid:V(),clientPatientId:w().required("Client Patient ID is Required"),patientId:w().nullable(),firstName:w().required("First Name is Required"),middleName:w().nullable(),lastName:w().required("Last Name is Required"),client:J().required("Client is Required"),gender:w().required("Gender is Required"),age:V().nullable(),dateOfBirth:Ee().nullable(),ageDobEstimated:ee().nullable(),phoneHome:w().nullable(),phoneMobile:w().nullable(),consentSms:ee().nullable(),districtUid:V().nullable(),provinceUid:V().nullable(),countryUid:V().nullable()}),{handleSubmit:de,errors:r}=Fe({validationSchema:re,initialValues:{uid:i?.value?.uid,clientPatientId:i?.value?.clientPatientId||ne?.query?.cpid,patientId:i?.value?.patientId,firstName:i?.value?.firstName,middleName:i?.value?.middleName,lastName:i?.value?.lastName,client:i?.value?.client,gender:i?.value?.gender,age:i?.value?.age,dateOfBirth:he(i?.value?.dateOfBirth)?void 0:new Date(i?.value?.dateOfBirth).toISOString().split("T")[0],ageDobEstimated:i?.value?.ageDobEstimated,phoneHome:i?.value?.phoneHome,phoneMobile:i?.value?.phoneMobile,consentSms:i?.value?.consentSms,districtUid:i?.value?.districtUid,provinceUid:i?.value?.provinceUid,countryUid:i?.value?.countryUid,identifications:i?.value?.identifications??[]}}),{value:$}=u("clientPatientId"),{value:E}=u("firstName"),{value:F}=u("middleName"),{value:Y}=u("lastName"),{value:q}=u("client"),{value:A}=u("gender"),{value:D}=u("age"),{value:g}=u("dateOfBirth"),{value:P}=u("ageDobEstimated"),{value:R}=u("phoneMobile"),{value:j}=u("consentSms"),{value:H}=u("districtUid"),{value:S}=u("provinceUid"),{value:C}=u("countryUid"),{value:L}=u("identifications"),z=de(l=>{l.uid||me(l),l.uid&&pe(l)});function me(l){T(Ie,{payload:{clientPatientId:l.clientPatientId,firstName:l.firstName,middleName:l.middleName,lastName:l.lastName,age:l.age,gender:l.gender,dateOfBirth:Ve(l.dateOfBirth,"YYYY-MM-DD HH:mm"),ageDobEstimated:l.ageDobEstimated,clientUid:l.client.uid,phoneMobile:l.phoneMobile,consentSms:l.consentSms,countryUid:l.countryUid,provinceUid:l.provinceUid,districtUid:l.districtUid,identifications:l.identifications}},"createPatient").then(e=>{k.addPatient(e),G("close",e),ae.value===!0&&le.push({name:"patient-detail",params:{patientUid:e.uid}})})}function pe(l){T(UpdatePatientDocument,{uid:l.uid,payload:{clientPatientId:l.clientPatientId,firstName:l.firstName,middleName:l.middleName,lastName:l.lastName,age:l.age,gender:l.gender,dateOfBirth:l.dateOfBirth,ageDobEstimated:l.ageDobEstimated,clientUid:l.client.uid,phoneMobile:l.phoneMobile,consentSms:l.consentSms,countryUid:l.countryUid,provinceUid:l.provinceUid,districtUid:l.districtUid,identifications:l.identifications?.map(e=>({identificationUid:e.identificationUid,value:e.value}))}},"updatePatient").then(e=>{k.updatePatient(e),G("close",e)})}function ce(l){f.filterProvincesByCountry(C.value)}function fe(l){f.filterDistrictsByProvince(S.value)}const ve=()=>{L.value.push({identificationUid:"12122",value:""})},we=l=>{L.value.splice(l,1)};return(l,e)=>{const be=ke("VueDatePicker");return m(),p("form",{onSubmit:e[27]||(e[27]=Z((...s)=>n(z)&&n(z)(...s),["prevent"])),class:"border-2 border-gray-900 border-dotted rounded-sm px-4 py-8",autocomplete:"off"},[t("label",Ye,[e[28]||(e[28]=t("span",{class:"text-gray-700 w-4/12"},"Patient Unique Identifier",-1)),t("div",qe,[o(t("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":e[0]||(e[0]=s=>d($)?$.value=s:null),placeholder:"Patient Unique Identifier"},null,512),[[c,n($)]]),t("div",Ae,a(n(r).clientPatientId),1)])]),t("label",Re,[e[29]||(e[29]=t("span",{class:"text-gray-700 w-4/12"},"First Name",-1)),t("div",je,[o(t("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":e[1]||(e[1]=s=>d(E)?E.value=s:null),placeholder:"First Name"},null,512),[[c,n(E)]]),t("div",He,a(n(r).firstName),1)])]),t("label",Le,[e[30]||(e[30]=t("span",{class:"text-gray-700 w-4/12"},"Middle Name",-1)),t("div",Ge,[o(t("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":e[2]||(e[2]=s=>d(F)?F.value=s:null),placeholder:"Middle Name"},null,512),[[c,n(F)]]),t("div",Ke,a(n(r).middleName),1)])]),t("label",Te,[e[31]||(e[31]=t("span",{class:"text-gray-700 w-4/12"},"Last Name",-1)),t("div",ze,[o(t("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":e[3]||(e[3]=s=>d(Y)?Y.value=s:null),placeholder:"Last Name"},null,512),[[c,n(Y)]]),t("div",We,a(n(r).lastName),1)])]),t("label",Qe,[e[35]||(e[35]=t("span",{class:"text-gray-700 w-4/12"},"Age/DOB Estimated?",-1)),t("div",Xe,[o(t("input",{type:"checkbox",class:"form-checkbox text-sky-800","onUpdate:modelValue":e[4]||(e[4]=s=>d(P)?P.value=s:null)},null,512),[[Q,n(P)]]),o(t("div",Ze,[t("label",Je,[e[32]||(e[32]=t("span",{class:"mr-1"},"Years",-1)),o(t("input",{name:"estimateYears",type:"number",min:"0",class:"form-input w-24 py-0 text-sky-800","onUpdate:modelValue":e[5]||(e[5]=s=>M.value=s),onChange:e[6]||(e[6]=s=>b()),onKeyup:e[7]||(e[7]=s=>b())},null,544),[[c,M.value]])]),t("label",et,[e[33]||(e[33]=t("span",{class:"mr-1"},"Months",-1)),o(t("input",{name:"estimateMonths",type:"number",min:"0",max:"12",class:"form-input w-24 py-0 text-sky-800","onUpdate:modelValue":e[8]||(e[8]=s=>_.value=s),onChange:e[9]||(e[9]=s=>b()),onKeyup:e[10]||(e[10]=s=>b())},null,544),[[c,_.value]])]),t("label",tt,[e[34]||(e[34]=t("span",{class:"mr-1"},"Days",-1)),o(t("input",{name:"estimateDays",type:"number",min:"0",max:"365",class:"form-input w-24 py-0 text-sky-800","onUpdate:modelValue":e[11]||(e[11]=s=>O.value=s),onChange:e[12]||(e[12]=s=>b()),onKeyup:e[13]||(e[13]=s=>b())},null,544),[[c,O.value]])])],512),[[Me,n(P)]]),t("div",st,a(n(r).ageDobEstimated),1)])]),t("label",lt,[e[36]||(e[36]=t("span",{class:"text-gray-700 w-4/12"},"Date of Birth",-1)),t("div",nt,[X(be,{class:"z-60 disabled:bg-slate-200",modelValue:n(g),"onUpdate:modelValue":e[14]||(e[14]=s=>d(g)?g.value=s:null),disabled:n(P),onClosed:e[15]||(e[15]=s=>ue()),"max-date":oe.value},null,8,["modelValue","disabled","max-date"]),t("div",it,a(n(r).dateOfBirth),1)])]),t("label",at,[e[37]||(e[37]=t("span",{class:"text-gray-700 w-4/12"},"Age",-1)),t("div",ot,[o(t("input",{class:"form-input mt-1 w-full disabled:bg-slate-200",type:"number","onUpdate:modelValue":e[16]||(e[16]=s=>d(D)?D.value=s:null),placeholder:"Age",disabled:""},null,512),[[c,n(D)]]),t("div",ut,a(n(r).age),1)])]),t("label",rt,[e[39]||(e[39]=t("span",{class:"text-gray-700 w-4/12"},"Gender",-1)),t("div",dt,[o(t("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":e[17]||(e[17]=s=>d(A)?A.value=s:null)},[e[38]||(e[38]=t("option",null,null,-1)),(m(!0),p(x,null,U(N.genders,s=>(m(),p("option",{key:s,value:s},a(s),9,mt))),128))],512),[[h,n(A)]]),t("div",pt,a(n(r).gender),1)])]),t("label",ct,[e[40]||(e[40]=t("span",{class:"text-gray-700 w-4/12"},"Mobile Number",-1)),t("div",ft,[o(t("input",{class:"form-input mt-1 w-full","onUpdate:modelValue":e[18]||(e[18]=s=>d(R)?R.value=s:null),placeholder:"Mobile Number"},null,512),[[c,n(R)]]),t("div",vt,a(n(r).phoneMobile),1)])]),t("label",wt,[e[41]||(e[41]=t("span",{class:"text-gray-700 w-4/12"},"Consent to SMS",-1)),t("div",bt,[o(t("input",{type:"checkbox",class:"form-checkbox text-sky-800","onUpdate:modelValue":e[19]||(e[19]=s=>d(j)?j.value=s:null)},null,512),[[Q,n(j)]]),t("div",gt,a(n(r).consentSms),1)])]),t("label",xt,[e[42]||(e[42]=t("span",{class:"text-gray-700 w-4/12"},"Primary Referrer",-1)),t("div",Ut,[X(n(Be),{placeholder:"Select a Primary Referrer",modelValue:n(q),"onUpdate:modelValue":e[20]||(e[20]=s=>d(q)?q.value=s:null),options:N.clients,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","options"]),t("div",yt,a(n(r).client),1)])]),t("label",Nt,[t("span",Dt,[e[43]||(e[43]=t("span",{class:"mr-4"},"Extra Ids:",-1)),t("div",null,[t("span",{class:"relative px-1 mr-2 mt-4 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none",onClick:e[21]||(e[21]=s=>ve())}," Add ")])]),t("div",Pt,[(m(!0),p(x,null,U(n(L),(s,ge)=>(m(),p("div",ht,[e[45]||(e[45]=t("span",null,"Identification",-1)),o(t("select",{class:"form-select mt-1","onUpdate:modelValue":v=>s.identificationUid=v},[e[44]||(e[44]=t("option",null,null,-1)),(m(!0),p(x,null,U(n(k).identifications,v=>(m(),p("option",{key:v.uid,value:v.uid},a(v.name),9,kt))),128))],8,Vt),[[h,s.identificationUid]]),e[46]||(e[46]=t("span",null,"Value",-1)),o(t("input",{type:"text",class:"form-input text-sky-800","onUpdate:modelValue":v=>s.value=v},null,8,Mt),[[c,s.value]]),t("span",{class:"p-2 text-red-800",onClick:Z(v=>we(ge),["prevent"])},"X",8,St)]))),256))])]),e[53]||(e[53]=t("hr",{class:"my-2"},null,-1)),t("div",Ct,[t("div",Bt,[t("label",It,[e[48]||(e[48]=t("span",{class:"text-gray-700 w-4/12"},"Country",-1)),o(t("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":e[22]||(e[22]=s=>d(C)?C.value=s:null),onChange:e[23]||(e[23]=s=>ce())},[e[47]||(e[47]=t("option",{value:null},null,-1)),(m(!0),p(x,null,U(N.countries,s=>(m(),p("option",{key:s.uid,value:s.uid},a(s.name),9,_t))),128))],544),[[h,n(C)]])]),t("div",Ot,a(n(r).countryUid),1)]),t("div",$t,[t("label",Et,[e[50]||(e[50]=t("span",{class:"text-gray-700 w-4/12"},"Province",-1)),o(t("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":e[24]||(e[24]=s=>d(S)?S.value=s:null),onChange:e[25]||(e[25]=s=>fe())},[e[49]||(e[49]=t("option",{value:null},null,-1)),(m(!0),p(x,null,U(N.provinces,s=>(m(),p("option",{key:s.uid,value:s.uid},a(s.name),9,Ft))),128))],544),[[h,n(S)]])]),t("div",Yt,a(n(r).provinceUid),1)]),t("div",qt,[t("label",At,[e[52]||(e[52]=t("span",{class:"text-gray-700 w-4/12"},"District",-1)),o(t("select",{class:"form-select mt-1 w-full","onUpdate:modelValue":e[26]||(e[26]=s=>d(H)?H.value=s:null)},[e[51]||(e[51]=t("option",{value:null},null,-1)),(m(!0),p(x,null,U(N.districts,s=>(m(),p("option",{key:s.uid,value:s.uid},a(s.name),9,Rt))),128))],512),[[h,n(H)]])])]),t("div",jt,a(n(r).districtUid),1)]),e[54]||(e[54]=t("hr",null,null,-1)),e[55]||(e[55]=t("button",{type:"submit",class:"-mb-4 w-1/5 border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Save Patient ",-1))],32)}}}),Zt=Ce(Ht,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/components/person/PatientForm.vue"]]);export{Zt as default};
