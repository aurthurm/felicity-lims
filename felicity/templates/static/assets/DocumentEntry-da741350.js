import{f as F,d as I,a1 as _,S as A,ah as x,a0 as E,a7 as S,r as w,o as f,c as k,a as h,N as s,a3 as C,a5 as c,y as p,F as O,Z as v,$ as D,_ as M}from"./index-54016222.js";import{a as P,b as B}from"./document.queries-e5422c7f.js";import{b as R}from"./_isIterateeCall-77d89b8a.js";import{t as g}from"./toFinite-29f9859a.js";var T=Math.floor,$=Math.random;function L(e,t){return e+T($()*(t-e+1))}var N=parseFloat,U=Math.min,V=Math.random;function j(e,t,o){if(o&&typeof o!="boolean"&&R(e,t,o)&&(t=o=void 0),o===void 0&&(typeof t=="boolean"?(o=t,t=void 0):typeof e=="boolean"&&(o=e,e=void 0)),e===void 0&&t===void 0?(e=0,t=1):(e=g(e),t===void 0?(t=e,e=0):t=g(t)),e>t){var n=e;e=t,t=n}if(o||e%1||t%1){var r=V();return U(e+r*(t-e+N("1e-"+((r+"").length-1))),t)}return L(e,t)}const{withClientQuery:y}=F(),Z=I("documents",{state:()=>({documents:[],folders:[],currentFolder:null,selectedDocument:null,isPreviewOpen:!1,recentDocuments:[]}),actions:{async fetchDocuments(e,t=!1){try{const o=await y(P,{first:100,text:"",sortBy:["-created_at"],...e},"documentAll");o&&typeof o=="object"&&"items"in o?(this.documents=o.items,t&&(this.recentDocuments=this.documents.sort((n,r)=>{const d=n.updatedAt?new Date(n.updatedAt).getTime():0;return(r.updatedAt?new Date(r.updatedAt).getTime():0)-d}).slice(0,25))):console.error("Invalid documents data received:",o)}catch(o){console.error("Error fetching documents:",o)}},addDocument(e){if(!e?.uid){console.error("Invalid document payload:",e);return}this.documents.push(e),this.recentDocuments=[e,...this.recentDocuments].slice(0,5)},updateDocument(e){if(!e?.uid){console.error("Invalid document payload:",e);return}const t={...e,updatedAt:new Date().toISOString()};this.documents=this.documents.map(o=>o.uid===e.uid?t:o),this.recentDocuments=[t,...this.recentDocuments.filter(o=>o.uid!==e.uid)].slice(0,5)},deleteDocument(e){if(!e){console.error("Invalid document ID provided to deleteDocument");return}this.documents=this.documents.filter(t=>t.uid!==e),this.recentDocuments=this.recentDocuments.filter(t=>t.uid!==e)},duplicateDocument(e){if(!e){console.error("Invalid document ID provided to duplicateDocument");return}const t=this.documents.find(n=>n.uid===e);if(!t){console.error("Document not found:",e);return}const o={...t,uid:j(1e3,9999).toString(),name:`${t.name} (Copy)`,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};this.documents.push(o),this.recentDocuments=[o,...this.recentDocuments].slice(0,5)},async setCurrentFolder(e){this.currentFolder=e,await this.fetchDocuments({folderUid:e})},async getFolders(){try{const e=await y(B,{},"documentFolderAll");e&&typeof e=="object"&&"items"in e?this.folders=e.items:console.error("Invalid folders data received:",e)}catch(e){console.error("Error fetching folders:",e)}},addFolder(e){if(!e?.uid){console.error("Invalid folder payload:",e);return}this.folders.push(e)},deleteFolder(e){if(!e){console.error("Invalid folder ID provided to deleteFolder");return}this.folders=this.folders.filter(t=>t.uid!==e),this.documents=this.documents.filter(t=>t.folderUid!==e)},updateFolder(e){if(!e?.uid){console.error("Invalid folder payload:",e);return}this.folders=this.folders.map(t=>t.uid===e.uid?e:t)},setSelectedDocument(e){this.selectedDocument=e},togglePreview(e){this.isPreviewOpen=e},toggleFolderExpanded(e){if(!e){console.error("Invalid folder ID provided to toggleFolderExpanded");return}this.folders=this.folders.map(t=>t.uid===e?{...t,expanded:!t.expanded}:t)}},getters:{getChildFolders:e=>t=>e.folders.filter(o=>o.parentUid===t),getDocumentsInFolder:e=>t=>e.documents.filter(o=>o.folderUid===t)}});/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var u={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":2,"stroke-linecap":"round","stroke-linejoin":"round"};/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=({size:e,strokeWidth:t=2,absoluteStrokeWidth:o,color:n,iconNode:r,name:d,class:i,...m},{slots:a})=>_("svg",{...u,width:e||u.width,height:e||u.height,stroke:n||u.stroke,"stroke-width":o?Number(t)*24/Number(e):t,class:["lucide",`lucide-${z(d??"icon")}`],...m},[...r.map(l=>_(...l)),...a.default?[a.default()]:[]]);/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=(e,t)=>(o,{slots:n})=>_(G,{...o,iconNode:t,name:e},n);/**
 * @license lucide-vue-next v0.477.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=H("FolderIcon",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]),Q={class:"flex h-[calc(100vh-4rem)] overflow-hidden"},q={class:"flex-1 overflow-hidden"},J={class:"lg:hidden p-4 flex items-center border-b border-border"},X={class:"h-full overflow-auto p-6"},Y=A({__name:"DocumentEntry",setup(e){const t=v(()=>D(()=>import("./FolderNavigation-023b688a.js"),["assets/FolderNavigation-023b688a.js","assets/index-54016222.js","assets/index-a1ed10d8.css","assets/plus-2dd8afac.js","assets/document.mutations-805a45fb.js","assets/document.queries-e5422c7f.js","assets/_isIterateeCall-77d89b8a.js","assets/toFinite-29f9859a.js"])),o=v(()=>D(()=>import("./RecentDocuments-31426039.js"),["assets/RecentDocuments-31426039.js","assets/index-54016222.js","assets/index-a1ed10d8.css","assets/DocumentListing-3b9a417c.js","assets/document.mutations-805a45fb.js","assets/plus-2dd8afac.js","assets/document.queries-e5422c7f.js","assets/_isIterateeCall-77d89b8a.js","assets/toFinite-29f9859a.js"])),n=v(()=>D(()=>import("./FolderDocuments-91af105b.js"),["assets/FolderDocuments-91af105b.js","assets/index-54016222.js","assets/index-a1ed10d8.css","assets/DocumentListing-3b9a417c.js","assets/document.mutations-805a45fb.js","assets/plus-2dd8afac.js","assets/document.queries-e5422c7f.js","assets/_isIterateeCall-77d89b8a.js","assets/toFinite-29f9859a.js"])),r=Z(),{currentFolder:d}=x(r),i=E(!1),m=()=>{i.value=!i.value};return S(async()=>{try{await r.getFolders()}catch(a){console.error("Error fetching folders:",a)}}),(a,l)=>{const b=w("fel-heading");return f(),k(O,null,[h(b,{title:"Documents"}),s("div",Q,[s("div",{class:C(["fixed inset-y-0 left-0 z-10 w-64 transform bg-doc-folder border-r border-border transition-transform duration-300 ease-in-out lg:relative lg:translate-x-0",{"-translate-x-full":!i.value}])},[h(c(t))],2),s("div",q,[s("div",J,[s("button",{class:"mr-4 p-2 rounded-md border border-border hover:bg-accent",onClick:m},[h(c(K),{class:"h-5 w-5"})]),l[0]||(l[0]=s("h1",{class:"text-xl font-semibold text-foreground"},"Document Manager",-1))]),s("div",X,[c(d)?(f(),p(c(n),{key:1})):(f(),p(c(o),{key:0}))])])])],64)}}}),W=M(Y,[["__file","/Users/admin/Documents/Development/felicity/felicity-lims/webapp/views/document/DocumentEntry.vue"]]),re=Object.freeze(Object.defineProperty({__proto__:null,default:W},Symbol.toStringTag,{value:"Module"}));export{re as D,K as F,H as c,Z as u};
