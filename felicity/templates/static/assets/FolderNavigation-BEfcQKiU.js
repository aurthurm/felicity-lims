import{h as w,Y as E,a0 as _,a7 as k,aN as z,_ as j,r as B,c,o as d,z as r,C as M,B as v,A as h,ap as N,N as O,I,a as p,D as P,F as T,H as S,u as L,al as U,J as q,M as R,O as K}from"./index-OdhKCqIc.js";import{u as V,F as J}from"./DocumentEntry-CjG2uhYk.js";import{P as H}from"./plus-3a6EQFdX.js";import{C as Y}from"./chevron-down-Dqf-ptA3.js";import{C as Z}from"./chevron-right-DQgQPcek.js";import{A as G}from"./document.mutations-DOSH3hTX.js";import"./document.queries-ZdmMK7wF.js";import"./_isIterateeCall-DnrZM974.js";import"./toFinite-6PuaOTJs.js";import"./PageHeading-Czi_4opS.js";const Q=w("ellipsis",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"19",cy:"12",r:"1",key:"1wjl8i"}],["circle",{cx:"5",cy:"12",r:"1",key:"1pcz8c"}]]);const W=w("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);const X=w("folder-plus",[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);const $=w("trash",[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),ee=E({__name:"FolderItem",props:{folder:{type:Object,required:!0},level:{type:Number,default:0}},emits:["add-subfolder"],setup(m,{expose:o,emit:n}){o();const e=m,u=n,l=V(),t=_(!1),{confirm:i}=z(),b=k(()=>l.getChildFolders(e.folder.uid)),x=k(()=>l.currentFolder===e.folder.uid),C=k(()=>!!e.folder.expanded);function A(){l.setCurrentFolder(e.folder.uid)}function y(){l.toggleFolderExpanded(e.folder.uid)}function a(){const s=b.value.length>0,D=l.documents.some(f=>f.folderUid===e.folder.uid);s||D?i({title:"Delete Folder?",description:"Delete this folder and all its contents?",confirmText:"Delete",cancelText:"Cancel",variant:"destructive"}).then(f=>{f&&l.deleteFolder(e.folder.uid)}):l.deleteFolder(e.folder.uid),t.value=!1}const F={props:e,emit:u,store:l,isMenuOpen:t,confirm:i,childFolders:b,isActive:x,isExpanded:C,handleFolderClick:A,handleToggleExpand:y,handleDeleteFolder:a,vClickOutside:{mounted(s,D){s._clickOutside=f=>{s===f.target||s.contains(f.target)||D.value(f)},document.addEventListener("click",s._clickOutside)},unmounted(s){s._clickOutside&&document.removeEventListener("click",s._clickOutside)}},get Folder(){return J},get FolderOpen(){return W},get ChevronRight(){return Z},get ChevronDown(){return Y},get Plus(){return H},get MoreHorizontal(){return Q},get Trash(){return $}};return Object.defineProperty(F,"__isScriptSetup",{enumerable:!1,value:!0}),F}}),oe=["aria-expanded","aria-label"],re=["aria-label"],te={key:1,class:"w-4"},ne={class:"mr-2 text-muted-foreground"},le={class:"flex items-center opacity-0 group-hover:opacity-100 transition-opacity duration-200"},de=["aria-label"],ie={class:"relative"},ae=["aria-label","aria-expanded","aria-controls"],se={key:0,id:"folder-menu",class:"absolute right-0 mt-1 w-48 rounded-md border border-border bg-card p-1 text-card-foreground shadow-md z-10",role:"menu","aria-orientation":"vertical","aria-labelledby":"folder-menu-button"},ce=["aria-label"];function ue(m,o,n,e,u,l){const t=B("FolderItem",!0);return d(),c("div",null,[r("div",{class:O(["flex justify-start items-center p-2 rounded-md cursor-pointer group transition-colors duration-200",n.level>0&&"ml-2",e.isActive&&"bg-accent text-accent-foreground",!e.isActive&&"hover:bg-accent/50"]),onClick:e.handleFolderClick,role:"button","aria-expanded":e.isExpanded,"aria-label":`${n.folder.name} folder${e.childFolders.length>0?` with ${e.childFolders.length} subfolders`:""}`},[r("div",{class:"flex items-center mr-2",onClick:v(e.handleToggleExpand,["stop"]),role:"button","aria-label":`${e.isExpanded?"Collapse":"Expand"} ${n.folder.name} folder`},[e.childFolders.length>0?(d(),h(N(e.childFolders.length>0?e.isExpanded?e.ChevronDown:e.ChevronRight:"div"),{key:0,class:"w-4 h-4 text-muted-foreground","aria-hidden":"true"})):(d(),c("div",te))],8,re),r("div",ne,[(d(),h(N(e.isExpanded?e.FolderOpen:e.Folder),{class:O(["w-[18px] h-[18px]",e.isActive&&"text-accent-foreground"]),"aria-hidden":"true"},null,8,["class"]))]),r("div",{class:O(["flex-1 truncate",e.isActive&&"text-accent-foreground"])},I(n.folder.name),3),r("div",le,[r("button",{onClick:o[0]||(o[0]=v(i=>m.$emit("add-subfolder",n.folder.uid),["stop"])),class:"h-7 w-7 flex items-center justify-center rounded-full hover:bg-accent/80 transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","aria-label":`Add subfolder to ${n.folder.name}`},[p(e.Plus,{class:"text-muted-foreground w-4 h-4","aria-hidden":"true"})],8,de),r("div",ie,[r("button",{onClick:o[1]||(o[1]=v(i=>e.isMenuOpen=!e.isMenuOpen,["stop"])),class:"h-7 w-7 flex items-center justify-center rounded-full hover:bg-accent/80 transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2","aria-label":`Open menu for ${n.folder.name}`,"aria-expanded":e.isMenuOpen,"aria-controls":e.isMenuOpen?"folder-menu":void 0},[p(e.MoreHorizontal,{class:"text-muted-foreground w-4 h-4","aria-hidden":"true"})],8,ae),e.isMenuOpen?P((d(),c("div",se,[r("button",{onClick:v(e.handleDeleteFolder,["stop"]),class:"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground text-destructive w-full text-left hover:bg-accent/80",role:"menuitem"},[p(e.Trash,{class:"mr-2 w-4 h-4","aria-hidden":"true"}),o[3]||(o[3]=r("span",null,"Delete Folder",-1))])])),[[e.vClickOutside,()=>e.isMenuOpen=!1]]):M("",!0)])])],10,oe),e.isExpanded&&e.childFolders.length>0?(d(),c("div",{key:0,class:"mt-1 ml-1 pl-1 border-l border-border",role:"group","aria-label":`Subfolders of ${n.folder.name}`},[(d(!0),c(T,null,S(e.childFolders,i=>(d(),h(t,{key:i.uid,folder:i,level:n.level+1,onAddSubfolder:o[2]||(o[2]=b=>m.$emit("add-subfolder",b))},null,8,["folder","level"]))),128))],8,ce)):M("",!0)])}const fe=j(ee,[["render",ue],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/components/document/FolderItem.vue"]]),me=E({__name:"FolderNavigation",setup(m,{expose:o}){o();const{withClientMutation:n}=L(),e=V(),u=_(!1),l=_(""),t=_(null),i=k(()=>e.getChildFolders(null));function b(a){t.value=a,u.value=!0}function x(){u.value=!1,l.value="",t.value=null}async function C(){if(l.value.trim())try{const a=await n(G,{payload:{name:l.value.trim(),parentUid:t.value}},"createDocumentFolder");if(a&&"uid"in a&&(e.addFolder(a),t.value)){const g=e.folders.find(F=>F.uid===t.value);g&&!g.expanded&&e.toggleFolderExpanded(t.value)}}catch{}finally{x()}}function A(a){return e.folders.find(g=>g.uid===a)}const y={withClientMutation:n,store:e,isAddFolderOpen:u,folderName:l,parentFolderId:t,rootFolders:i,openAddFolderDialog:b,closeAddFolderDialog:x,handleAddFolder:C,folderById:A,get Plus(){return H},get FolderPlus(){return X},FolderItem:fe};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}}),be={class:"h-full overflow-hidden flex flex-col bg-card border border-border rounded-lg",role:"navigation","aria-label":"Folder navigation"},ge={class:"p-4 flex items-center justify-between border-b border-border"},ve={class:"flex-1 overflow-auto p-2"},he={class:"space-y-1"},pe={key:0,class:"fixed inset-0 bg-background/80 backdrop-blur-sm z-50 flex items-center justify-center",role:"dialog","aria-labelledby":"add-folder-title","aria-modal":"true"},xe={id:"add-folder-title",class:"text-lg font-medium text-card-foreground mb-4"},ye={class:"mb-4"},Fe={class:"flex justify-end gap-2"},_e=["disabled"];function ke(m,o,n,e,u,l){return d(),c("div",be,[r("div",ge,[o[3]||(o[3]=r("h2",{class:"font-semibold text-sm text-card-foreground"},"Folders",-1)),r("button",{onClick:o[0]||(o[0]=t=>e.openAddFolderDialog(null)),class:"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none hover:bg-accent hover:text-accent-foreground h-8 w-8","aria-label":"Add new folder"},[p(e.Plus,{class:"w-4 h-4","aria-hidden":"true"})])]),r("div",ve,[r("div",he,[(d(!0),c(T,null,S(e.rootFolders,t=>(d(),h(e.FolderItem,{key:t.uid,folder:t,onAddSubfolder:e.openAddFolderDialog},null,8,["folder"]))),128))])]),(d(),h(K,{to:"body"},[e.isAddFolderOpen?(d(),c("div",pe,[r("div",{class:"bg-card rounded-lg shadow-lg p-6 max-w-md w-full mx-4 border border-border",onClick:o[2]||(o[2]=v(()=>{},["stop"]))},[r("h3",xe,I(e.parentFolderId?`Add subfolder to ${e.folderById(e.parentFolderId)?.name}`:"Add new folder"),1),r("div",ye,[o[4]||(o[4]=r("label",{for:"folderName",class:"block text-sm font-medium text-card-foreground mb-1"},"Folder Name",-1)),P(r("input",{id:"folderName","onUpdate:modelValue":o[1]||(o[1]=t=>e.folderName=t),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:"Enter folder name",onKeyup:q(e.handleAddFolder,["enter"]),"aria-required":"true"},null,544),[[U,e.folderName]])]),r("div",Fe,[r("button",{onClick:e.closeAddFolderDialog,class:"inline-flex items-center justify-center gap-2 rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none border border-input bg-background hover:bg-accent hover:text-accent-foreground h-10 px-4 py-2"}," Cancel "),r("button",{onClick:e.handleAddFolder,class:"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2",disabled:!e.folderName.trim()},[p(e.FolderPlus,{class:"w-4 h-4 mr-2","aria-hidden":"true"}),o[5]||(o[5]=R(" Add Folder ",-1))],8,_e)])])])):M("",!0)]))])}const Pe=j(me,[["render",ke],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/components/document/FolderNavigation.vue"]]);export{Pe as default};
