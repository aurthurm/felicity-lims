import{Y as j,u as G,ah as N,a0 as l,av as S,U as T,_ as L,r as M,c as x,o as p,z as e,A as q,C as z,F as H,H as I,N as _,I as b,K as U,B as K,D as C,M as O,al as D,a as A}from"./index-OdhKCqIc.js";import{j as P,k as Q,l as Y}from"./grind.queries-D_H4x9UG.js";import{r as J,m as R}from"./index-tFVefQDg.js";import{Multiselect as W}from"./vue-multiselect.esm-Cvm3ZCjW.js";const X=j({__name:"ErrandMilestone",props:{errandUid:{type:String,required:!0}},emits:["milestoneUpdated"],setup(v,{expose:o,emit:y}){o();const t=v,{withClientMutation:d,withClientQuery:a}=G();N(()=>{r(),w()});const u=y,c=l([]);function r(s="cache-first"){a(P,{errandUid:t.errandUid},"grindMilestonesByErrand",s).then(f=>{f&&(c.value=f)})}const i=l(!1),m=l(!1),g=l(""),n=S({});function E(){i.value=!0,g.value="Add Milestone",m.value=!0,J(n)}function F(s){i.value=!0,g.value="Edit Milestone",m.value=!1,R(n,s)}function V(){i.value=!1;const s={title:n.title,description:n.description,complete:n.complete,assigneeUid:n.assignee?.uid,errandUid:t.errandUid};m.value?d(Q,{payload:{...s,errandUid:t.errandUid}},"createGrindMilestone").then(()=>r("network-only")):d(Y,{uid:n.uid,payload:s},"updateGrindMilestone").then(()=>{r("network-only"),u("milestoneUpdated")})}function B({firstName:s,lastName:f}){return`${s} ${f}`}const h=l();function w(){a(T,{first:100},"userAll").then(s=>{h.value=s.items})}const k={props:t,withClientMutation:d,withClientQuery:a,emit:u,milestones:c,fetchMilestones:r,showForm:i,formAction:m,formTitle:g,form:n,addMilestone:E,editMilestone:F,saveForm:V,customLabel:B,users:h,getUsers:w,get Multiselect(){return W}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),Z={class:"space-y-6"},$={class:"space-y-6"},ee=["onDblclick"],oe={class:"absolute left-0 top-0 transform -translate-x-1/2 bg-background p-1 border border-border rounded-full w-4 h-4 flex items-center justify-center transition-colors duration-200 group-hover:border-primary"},te={class:"mb-6"},re={class:"font-medium text-foreground group-hover:text-primary transition-colors duration-200"},se={class:"text-sm text-muted-foreground mt-1"},ne={class:"text-lg font-semibold text-foreground"},ie={class:"flex items-center space-x-2"},le={class:"flex justify-end space-x-3"},de={type:"submit",class:"px-4 py-2 text-sm font-medium text-primary-foreground bg-primary border border-transparent rounded-md shadow-sm hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors duration-200"};function ae(v,o,y,t,d,a){const u=M("Checkbox"),c=M("Modal");return p(),x("div",Z,[e("div",{class:"flex justify-between items-center"},[o[7]||(o[7]=e("h3",{class:"text-lg font-medium text-foreground"},"Milestones",-1)),e("button",{onClick:t.addMilestone,class:"px-3 py-1.5 text-sm font-medium text-foreground bg-background border border-border rounded-md hover:border-primary hover:text-primary hover:bg-secondary transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"},[...o[6]||(o[6]=[e("span",{class:"flex items-center space-x-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",null,"Add New")],-1)])])]),e("div",$,[(p(!0),x(H,null,I(t.milestones,r=>(p(),x("div",{key:r.uid,class:_(["pl-6 border-l-2 relative group cursor-pointer",{"border-success/20":r.complete,"border-destructive/20":!r.complete}]),onDblclick:i=>t.editMilestone(r)},[e("div",oe,[e("div",{class:_(["w-2 h-2 rounded-full transition-colors duration-200",{"bg-success":r.complete,"bg-destructive":!r.complete}])},null,2)]),e("div",te,[e("h4",re,b(r.title),1),e("p",se,b(r.description),1)])],42,ee))),128))]),t.showForm?(p(),q(c,{key:0,onClose:o[5]||(o[5]=r=>t.showForm=!1),"content-width":"w-full max-w-2xl"},{header:U(()=>[e("h3",ne,b(t.formTitle),1)]),body:U(()=>[e("form",{onSubmit:K(t.saveForm,["prevent"]),class:"space-y-6 p-6"},[e("div",null,[o[8]||(o[8]=e("label",{class:"block text-sm font-medium text-foreground mb-1",for:"title"},[O(" Title "),e("span",{class:"text-destructive"},"*")],-1)),C(e("input",{id:"title","onUpdate:modelValue":o[0]||(o[0]=r=>t.form.title=r),type:"text",required:"",class:"w-full px-3 py-2 border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-background text-foreground",placeholder:"Enter milestone title"},null,512),[[D,t.form.title]])]),e("div",null,[o[9]||(o[9]=e("label",{class:"block text-sm font-medium text-foreground mb-1",for:"description"}," Description ",-1)),C(e("textarea",{id:"description","onUpdate:modelValue":o[1]||(o[1]=r=>t.form.description=r),rows:"3",class:"w-full px-3 py-2 border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-background text-foreground",placeholder:"Enter milestone description"},null,512),[[D,t.form.description]])]),e("div",null,[o[10]||(o[10]=e("label",{class:"block text-sm font-medium text-foreground mb-1"}," Assignee ",-1)),A(t.Multiselect,{modelValue:t.form.assignee,"onUpdate:modelValue":o[2]||(o[2]=r=>t.form.assignee=r),options:t.users,"track-by":"uid",searchable:!0,"custom-label":t.customLabel,placeholder:"Select assignee",class:"multiselect-primary"},null,8,["modelValue","options"])]),e("div",ie,[A(u,{id:"complete",checked:t.form.complete,"onUpdate:checked":o[3]||(o[3]=r=>t.form.complete=r)},null,8,["checked"]),o[11]||(o[11]=e("label",{class:"text-sm font-medium text-foreground",for:"complete"}," Complete ",-1))]),e("div",le,[e("button",{type:"button",onClick:o[4]||(o[4]=r=>t.showForm=!1),class:"px-4 py-2 text-sm font-medium text-foreground bg-background border border-border rounded-md shadow-sm hover:bg-muted focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors duration-200"}," Cancel "),e("button",de,b(t.formAction?"Create":"Update"),1)])],32)]),_:1})):z("",!0)])}const pe=L(X,[["render",ae],["__scopeId","data-v-7f459d59"],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/grind/_id/ErrandMilestone.vue"]]);export{pe as default};
