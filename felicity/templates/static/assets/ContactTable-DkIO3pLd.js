import{a0 as F,ac as S,f as A,ap as R,a7 as b,_ as V,r as N,c as f,o as m,A as e,C as j,E as T,F as i,H as g,J as E,K as L,L as u,P as B,a as I,N as D,a2 as v,D as O}from"./index-Daoe3XS9.js";import{a as q,b as H,D as J}from"./clients.mutations-Dg0hX0Bq.js";import{u as K}from"./client-CTaZ-zn-.js";import{s as z}from"./index-YWAiCrzl.js";import"./location-CxPODs5_.js";const G=F({__name:"ContactTable",props:{clientUid:String},setup(x,{expose:o}){o();let a=K(),t=S();const{withClientMutation:d}=A(),{clientContacts:_,fetchingClientContacts:p}=R(a);let c=b(""),r=b(!1),s=b(!1),l=b({});const P=x,h=t.query.clientUid||"";h&&a.fetchClientContacts(h);function y(){d(q,{payload:{clientUid:t.query.clientUid,firstName:l.value.firstName,mobilePhone:l.value.mobilePhone,email:l.value.email}},"createClientContact").then(n=>a.addClientContact(n))}function w(){d(H,{uid:l.value.uid,payload:{clientUid:t.query.clientUid,firstName:l.value.firstName,mobilePhone:l.value.mobilePhone,email:l.value.email}},"updateClientContact").then(n=>a.updateClientContact(n))}function M(n,C={}){s.value=n,c.value=(n?"CREATE":"EDIT")+" CONTACT",r.value=!0,n?Object.assign(l,{}):Object.assign(l.value,{...C})}function U(){s.value===!0&&y(),s.value||w(),r.value=!1}const k={get clientStore(){return a},set clientStore(n){a=n},get router(){return t},set router(n){t=n},withClientMutation:d,clientContacts:_,fetchingClientContacts:p,get formTitle(){return c},set formTitle(n){c=n},get showContactModal(){return r},set showContactModal(n){r=n},get createContact(){return s},set createContact(n){s=n},get contact(){return l},set contact(n){l=n},props:P,clientUid:h,addClientContact:y,editClientContact:w,FormManager:M,saveForm:U,deleteClientContact:n=>{d(J,{uid:n.uid},"deleteClientContact").then(C=>{C&&a.deleteClientContact(n.uid)})},get shield(){return z}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),Q={class:"overflow-x-auto"},W={class:"align-middle inline-block min-w-full shadow overflow-hidden bg-background shadow-dashboard px-2 pt-1 rounded-bl-lg rounded-br-lg"},X={class:"min-w-full fel-table"},Y={class:"bg-background"},Z={class:"px-1 py-1 whitespace-no-wrap border-b border-border"},$={class:"flex items-center"},ee={class:"text-sm leading-5 text-foreground"},te={class:"px-1 py-1 whitespace-no-wrap border-b border-border"},oe={class:"text-sm leading-5 text-primary"},ne={class:"px-1 py-1 whitespace-no-wrap border-b border-border"},re={class:"text-sm leading-5 text-primary"},le={class:"px-1 py-1 whitespace-no-wrap text-right border-b border-border text-sm leading-5"},ae=["onClick"],se=["onClick"],ie={key:0,class:"py-4 text-center"},de={action:"post",class:"p-1"},ce={class:"grid grid-cols-2 gap-x-4 mb-4"},me={class:"block col-span-1 mb-2"},ue={class:"block col-span-1 mb-2"},be={class:"block col-span-1 mb-2"};function fe(x,o,a,t,d,_){const p=N("fel-loader"),c=N("fel-modal");return m(),f(E,null,[e("div",Q,[i(e("button",{onClick:o[0]||(o[0]=r=>t.FormManager(!0)),class:"px-1 py-0 mb-4 border-primary border text-primary rounded-sm transition duration-300 hover:bg-primary hover:text-primary-foreground focus:outline-none"}," Add Contact ",512),[[g,t.shield.hasRights(t.shield.actions.CREATE,t.shield.objects.CLIENT)]]),e("div",W,[e("table",X,[o[7]||(o[7]=e("thead",null,[e("tr",null,[e("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Full Name "),e("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Email "),e("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Phone "),e("th",{class:"px-1 py-1 border-b-2 border-border"})])],-1)),e("tbody",Y,[(m(!0),f(E,null,L(t.clientContacts,r=>(m(),f("tr",{key:r.uid},[e("td",Z,[e("div",$,[e("div",null,[e("div",ee,u(r.firstName)+" "+u(r.lastName),1)])])]),e("td",te,[e("div",oe,u(r.email),1)]),e("td",ne,[e("div",re,u(r.mobilePhone),1)]),e("td",le,[i(e("button",{onClick:s=>t.FormManager(!1,r),class:"px-2 py-1 mr-2 border-border border text-orange-500rounded-smtransition duration-300 hover:bg-muted hover:text-primary-foreground focus:outline-none"}," Edit ",8,ae),[[g,t.shield.hasRights(t.shield.actions.UPDATE,t.shield.objects.CLIENT)]]),o[6]||(o[6]=B()),i(e("button",{onClick:s=>t.deleteClientContact(r),class:"px-2 py-1 mr-2 border-destructive border text-orange-500rounded-smtransition duration-300 hover:bg-destructive hover:text-primary-foreground focus:outline-none"}," Deactivate ",8,se),[[g,t.shield.hasRights(t.shield.actions.UPDATE,t.shield.objects.CLIENT)]])])]))),128))])]),t.fetchingClientContacts?(m(),f("div",ie,[I(p,{message:"Fetching client contacts ..."})])):T("",!0)])]),t.showContactModal?(m(),j(c,{key:0,onClose:o[5]||(o[5]=r=>t.showContactModal=!1)},{header:D(()=>[e("h3",null,u(t.formTitle),1)]),body:D(()=>[e("form",de,[e("div",ce,[e("label",me,[o[8]||(o[8]=e("span",{class:"text-foreground"},"Full Name",-1)),i(e("input",{class:"form-input mt-1 block w-full",autocomplete:"off","onUpdate:modelValue":o[1]||(o[1]=r=>t.contact.firstName=r),placeholder:"Full Name ..."},null,512),[[v,t.contact.firstName]])]),e("label",ue,[o[9]||(o[9]=e("span",{class:"text-foreground"},"Email",-1)),i(e("input",{class:"form-input mt-1 block w-full",autocomplete:"off","onUpdate:modelValue":o[2]||(o[2]=r=>t.contact.email=r),placeholder:"Email ..."},null,512),[[v,t.contact.email]])]),e("label",be,[o[10]||(o[10]=e("span",{class:"text-foreground"},"Mobile Phone",-1)),i(e("input",{class:"form-input mt-1 block w-full",autocomplete:"off","onUpdate:modelValue":o[3]||(o[3]=r=>t.contact.mobilePhone=r),placeholder:"Mobile Phone ..."},null,512),[[v,t.contact.mobilePhone]])])]),o[11]||(o[11]=e("hr",null,null,-1)),e("button",{type:"button",onClick:o[4]||(o[4]=O(r=>t.saveForm(),["prevent"])),class:"-mb-4 w-full border border-primary bg-primary text-primary-foreground rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-primary focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):T("",!0)],64)}const _e=V(G,[["render",fe],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/client/_id/ContactTable.vue"]]);export{_e as default};
