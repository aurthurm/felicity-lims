import{P as M,e as Q,aa as q,h as D,Z as i,R as V,r as B,o as u,c,b as v,a as d,a2 as r,a7 as x,F as A,L as F,D as O,X as y,ao as b,Y as f,_ as j}from"./index-03a7f0eb.js";import{u as I}from"./analysis-625e9fcd.js";const N={class:"min-h-[500px]"},U={class:"flex justify-between"},Y={class:"flex justify-start items-center gap-x-2"},z=M({__name:"QualityCharts",setup(G){const k=y(()=>f(()=>import("./vue-multiselect.esm-e5326598.js"),["assets/vue-multiselect.esm-e5326598.js","assets/index-03a7f0eb.js","assets/index-81d3252e.css"])),w=y(()=>f(()=>import("./index-03a7f0eb.js").then(e=>e.cM),["assets/index-03a7f0eb.js","assets/index-81d3252e.css"])),L=y(()=>f(()=>import("./ChartLJ-1f01ae24.js"),["assets/ChartLJ-1f01ae24.js","assets/index-03a7f0eb.js","assets/index-81d3252e.css","assets/index-155f3d9f.js","assets/value-c2034ca5.js","assets/string-6dabfbe0.js"])),h=I(),{withClientQuery:p}=Q();q(()=>{h.fetchAnalysesServices({})});const P=D(()=>h.getAnalysesServicesSimple),o=i([]),m=new Date;let l=i({month:m.getMonth(),year:m.getFullYear()}),n=i(null);const _=i(!1),S=async e=>{if(!l.value)return;const a={analyses:[e.uid],month:l.value.month+1,year:l.value.year};await p(b,a,"qcChartData").then(s=>{o.value=s??[]}).finally(()=>_.value=!1)},E=async e=>{if(!n.value)return;const a={analyses:[n.value?.uid],month:e.month+1,year:e.year};await p(b,a,"qcChartData").then(s=>{o.value=s??[]}).finally(()=>_.value=!1)},C=D(()=>o.value?T(R(o.value)):[]);function R(e){return e.reduce((a,s)=>{const t=s.sample.qcLevel.level;return a[t]||(a[t]={results:[],dates:[]}),a[t].results.push(parseFloat(s.result)),a[t].dates.push(s.dateVerified),a},{})}function T(e){return Object.entries(e).map(([a,s])=>({name:a,data:s.results.map((t,g)=>({date:s.dates[g],value:t}))}))}return V(n,async e=>{e&&await S(e)}),V(l,async e=>{e&&await E(e)}),(e,a)=>{const s=B("VueDatePicker");return u(),c("div",N,[v("div",U,[d(r(w),{title:"Analyses Service Control Charts"}),v("div",Y,[d(s,{class:"z-60 disabled:bg-slate-200",modelValue:r(l),"onUpdate:modelValue":a[0]||(a[0]=t=>x(l)?l.value=t:l=t),"max-date":r(m),"month-picker":""},null,8,["modelValue","max-date"]),d(r(k),{class:"max-w-[300px]",modelValue:r(n),"onUpdate:modelValue":a[1]||(a[1]=t=>x(n)?n.value=t:n=t),options:P.value,multiple:!1,searchable:!0,label:"name","track-by":"uid"},null,8,["modelValue","options"])])]),a[2]||(a[2]=v("hr",{class:"my-4"},null,-1)),C.value?.length==0?(u(),c(A,{key:0},[F(" The selected analysis has no data for the selected period. ")],64)):(u(!0),c(A,{key:1},O(C.value,t=>(u(),c("div",{class:"mb-4",key:t.name},[d(r(L),{title:t.name,series:t.data},null,8,["title","series"])]))),128))])}}}),X=j(z,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/qcontrol/QualityCharts.vue"]]);export{X as default};
