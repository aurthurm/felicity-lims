import{Y as U,u as A,a7 as v,aY as C,aZ as G,_ as V,r as c,c as d,o,z as y,a as n,K as r,M as k,F as m,H as _,A as h,I as P}from"./index-OdhKCqIc.js";import{u as H}from"./user-DYsgscqA.js";const D=U({name:"PermissionsView",__name:"Permissions",setup(S,{expose:f}){f();let i=H();const{withClientMutation:a}=A();i.fetchGroupsAndPermissions();const T=v(()=>i.getGroups);function w(s,e){return s?.permissions?.some(t=>t?.uid===e?.uid)??!1}const p=(s,e)=>s?.reduce(function(t,l){return(t[l[e]]=t[l[e]]||[]).push(l),t},{}),b=v(()=>Array.from(Object.entries(p(i.getPermissions,"target"))));function g(s,e){a(C,{groupUid:s?.uid,permissionUid:e?.uid},"updateGroupPermissions").then(t=>i.updateGroupsAndPermissions(t))}function u(s,e,t){t!==w(s,e)&&g(s,e)}const x={get userStore(){return i},set userStore(s){i=s},withClientMutation:a,groups:T,hasPermission:w,groupBy:p,permissions:b,updateGroupPerms:g,handlePermissionToggle:u,get Switch(){return G}};return Object.defineProperty(x,"__isScriptSetup",{enumerable:!1,value:!0}),x}}),z={class:"space-y-6"},N={class:"border border-border bg-card rounded-lg shadow-md overflow-hidden"},j={class:"relative w-full overflow-y-auto max-h-[700px] scrollbar-thin scrollbar-thumb-border scrollbar-track-muted"},F=["title"];function M(S,f,i,a,T,w){const p=c("TableHead"),b=c("TableRow"),g=c("TableHeader"),u=c("TableCell"),x=c("TableBody"),s=c("Table");return o(),d("div",z,[y("div",N,[y("div",j,[n(s,{class:"w-full table-fixed caption-bottom text-sm"},{default:r(()=>[n(g,{class:"[&_tr]:border-b"},{default:r(()=>[n(b,{class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:r(()=>[n(p,{class:"sticky top-0 z-10 h-12 px-4 bg-card/95 backdrop-blur supports-backdrop-filter:bg-card/60 text-left align-middle font-medium text-muted-foreground w-[200px] min-w-[200px]"},{default:r(()=>[...f[0]||(f[0]=[k(" Permissions ",-1)])]),_:1}),(o(!0),d(m,null,_(a.groups,e=>(o(),h(p,{key:e.uid,class:"sticky top-0 z-10 h-12 px-4 bg-card/95 backdrop-blur supports-backdrop-filter:bg-card/60 text-right align-middle font-medium text-muted-foreground"},{default:r(()=>[y("span",{class:"block truncate",title:e.name},P(e.name),9,F)]),_:2},1024))),128))]),_:1})]),_:1}),n(x,{class:"[&_tr:last-child]:border-0"},{default:r(()=>[(o(!0),d(m,null,_(a.permissions,e=>(o(),d(m,{key:e[0]},[n(b,{class:"border-b transition-colors bg-muted/50"},{default:r(()=>[n(u,{class:"px-4 py-3 align-middle font-medium text-sm text-foreground w-[200px] min-w-[200px]"},{default:r(()=>[k(P(e[0]),1)]),_:2},1024),(o(!0),d(m,null,_(a.groups,t=>(o(),h(u,{class:"px-4 py-3 align-middle text-muted-foreground",key:t.uid}))),128))]),_:2},1024),(o(!0),d(m,null,_(e[1],t=>(o(),h(b,{key:t.uid,class:"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted"},{default:r(()=>[n(u,{class:"px-4 py-2 align-middle text-sm text-muted-foreground w-[200px] min-w-[200px]"},{default:r(()=>[k(P(t.action),1)]),_:2},1024),(o(!0),d(m,null,_(a.groups,l=>(o(),h(u,{key:l.uid,class:"px-4 py-2 text-right align-middle"},{default:r(()=>[n(a.Switch,{"model-value":a.hasPermission(l,t),"onUpdate:modelValue":B=>a.handlePermissionToggle(l,t,B)},null,8,["model-value","onUpdate:modelValue"])]),_:2},1024))),128))]),_:2},1024))),128))],64))),128))]),_:1})]),_:1})])])])}const Y=V(D,[["render",M],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/users/Permissions.vue"]]);export{Y as default};
