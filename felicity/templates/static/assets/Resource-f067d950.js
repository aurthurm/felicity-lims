import{S as D,ah as $,h as B,a0 as N,a7 as L,W as y,r as b,o as l,c,N as o,C as v,D as h,a5 as n,F as _,E as w,y as k,L as g,M as U,H as p,a3 as j,a as E,K as S,b as A,X as C,A as H,e as R,_ as W}from"./index-8d0a01b3.js";import{C as I}from"./index-5bd8638f.js";import{u as z}from"./dashboard-d1526188.js";import"./value-c2034ca5.js";import"./string-6dabfbe0.js";const K={class:"mt-4"},P={class:"flex justify-between mb-8"},X={class:"flex justify-end items-center"},q=["onClick"],G={key:0,class:"text-start my-4"},J={class:"mb-8"},O={key:0,class:"text-muted-foreground"},Q={key:1,class:"flex justify-start"},Y={class:"mr-4 font-bold text-foreground text-xl"},Z={class:"font-semibold text-muted-foreground text-l"},ee={action:"post",class:"p-1"},te={class:"grid grid-cols-2 gap-x-4 mb-4"},oe={class:"block col-span-2 mb-2"},se={class:"block col-span-2 mb-2"},re=D({__name:"Resource",setup(ne){const d=z(),{dashboard:r}=$(d),m=B({range:{from:"",to:""}}),f=N(!1),F=()=>{d.setFilterRange(R(m.range.from),R(m.range.to)),f.value=!1};L(async()=>{x(),d.setShowFilters(!0),d.getResourceStats()}),y(()=>r.value.filterRange.from,()=>{x(),d.getResourceStats()}),y(()=>r.value.resourceStats?.samples,a=>{a?.forEach(e=>{const u=[],s=e.counts?.reduce((i,t)=>i+t.count,0)||0;e.counts?.forEach(i=>{u.push({item:i.group,count:i.count,percent:i.count/s})}),console.log(e.group),T(u,e.group,e.group)})});const M=a=>{const e=r.value.resourceStats?.instruments?.reduce((s,i)=>s+i.count,0)||0;return`${(a/e*100).toFixed(2)}%`},T=(a,e,u)=>{const s=new I({container:e,autoFit:!0,height:250,width:500,localRefresh:!1});s.coordinate("theta",{radius:.75,innerRadius:.5}),s.data(a),s.scale("percent",{formatter:t=>`${(t*100).toFixed(2)}%`}),s.tooltip({showTitle:!1,showMarkers:!1}),s.legend(!1),s.interval().position("percent").color("item").label("percent",{layout:[{type:"pie-spider"},{type:"hide-overlap"}],offset:8,labelHeight:38,content:t=>`${t.item} (${t.count})`,labelLine:{style:{lineWidth:.5}}}).adjust("stack"),s.createView().annotation().text({position:["50%","50%"],content:u,style:{fill:"#262626",textAlign:"center"}}),s.interaction("element-active"),s.render()},x=()=>{const a=document.getElementById("user-matrix");a&&(a.innerHTML=`
      <div>
        <div id="registration"></div>
      </div>
      <div>
        <div id="submission"></div>
      </div>
      <div>
        <div id="verification"></div>
      </div>
      <div>
        <div id="publication"></div>
      </div>
    `)};return(a,e)=>{const u=b("VTooltip"),s=b("fel-loader"),i=b("fel-modal");return l(),c("div",K,[o("section",P,[v(o("div",X,[(l(!0),c(_,null,w(n(r).filters,(t,V)=>v((l(),k(u,{key:V,placements:["right-start"]},{popper:g(()=>[U(p(n(d).filterToolTip(t)),1)]),default:g(()=>[o("button",{onClick:ie=>n(d).setCurrentFilter(t),type:"button",class:j(["px-2 py-1 mr-2 border border-foreground text-foreground rounded-sm transition duration-300 hover:bg-primary hover:text-primary-foreground focus:outline-none",{"bg-primary text-primary-foreground":n(r).currentFilter===t}])},p(t),11,q)]),_:2},1024)),[[h,t!==n(r).filters[n(r).filters.length]]])),128)),o("button",{onClick:e[0]||(e[0]=t=>f.value=!0),class:"ml-4 mr-1 px-2 py-1 border border-border text-muted-foreground rounded-sm transition duration-300 hover:bg-muted hover:text-primary-foreground focus:outline-none"},p(n(r).filterRange.from)+" - "+p(n(r).filterRange.to),1)],512),[[h,n(r).showFilters]])]),n(r).fetchingResourceStats?(l(),c("div",G,[E(s,{message:"Fetching resource stats..."})])):S("",!0),o("section",null,[o("div",J,[e[5]||(e[5]=o("h1",{class:"text-xl text-foreground font-semibold"},"Instrument Matrix / Load",-1)),e[6]||(e[6]=o("hr",{class:"my-2"},null,-1)),n(r).resourceStats?.instruments?.length?(l(),c("div",Q,[(l(!0),c(_,null,w(n(r).resourceStats?.instruments,t=>(l(),c("div",{key:t.group,class:"flex items-center bg-background shadow rounded-sm px-6 pt-3 pb-5 border border-foreground mr-8"},[o("span",Y,p(M(t?.count)),1),o("span",Z,p(t.group),1)]))),128))])):(l(),c("div",O," No instrument data available "))]),e[7]||(e[7]=A('<div class="mb-8"><h1 class="text-xl text-foreground font-semibold">User Matrix / Load</h1><hr class="my-2"><div class="flex flex-wrap justify-start" id="user-matrix"><div><div id="registration"></div></div><div><div id="submission"></div></div><div><div id="verification"></div></div><div><div id="publication"></div></div></div></div>',1))]),f.value?(l(),k(i,{key:1,onClose:e[4]||(e[4]=t=>f.value=!1),contentWidth:"w-1/4"},{header:g(()=>e[8]||(e[8]=[o("h3",null,"Custom Filter Date Range",-1)])),body:g(()=>[o("form",ee,[o("div",te,[o("label",oe,[e[9]||(e[9]=o("span",{class:"text-foreground"},"Date From",-1)),v(o("input",{type:"datetime-local",class:"form-input mt-1 block w-full",autocomplete:"off","onUpdate:modelValue":e[1]||(e[1]=t=>m.range.from=t),placeholder:"Select start date..."},null,512),[[C,m.range.from]])]),o("label",se,[e[10]||(e[10]=o("span",{class:"text-foreground"},"Date To",-1)),v(o("input",{type:"datetime-local",class:"form-input mt-1 block w-full",autocomplete:"off","onUpdate:modelValue":e[2]||(e[2]=t=>m.range.to=t),placeholder:"Select end date..."},null,512),[[C,m.range.to]])])]),e[11]||(e[11]=o("hr",null,null,-1)),o("button",{type:"button",onClick:e[3]||(e[3]=H(t=>F(),["prevent"])),class:"m-2 -mb-4 w-full rounded-sm border border-primary bg-primary px-4 py-2 text-primary-foreground transition-colors duration-500 ease select-none hover:bg-primary focus:outline-none focus:shadow-outline"}," Apply Filter ")])]),_:1})):S("",!0)])}}});const me=W(re,[["__file","/Users/admin/Documents/Development/felicity/felicity-lims/webapp/views/dashboard/Resource.vue"]]);export{me as default};
