import{V as G,f as K,aj as Q,a7 as W,a1 as b,a2 as f,ak as X,h as ee,i as te,r as w,o as d,c,O as t,a as g,M as u,ae as m,N as S,J as C,a4 as se,D as p,Z as oe,a6 as n,z as ae,F as k,H as V,L as D,a3 as ne,Y as M,C as le,$ as ie,a0 as re,_ as ue}from"./index-74595aff.js";import{u as de,a as fe}from"./shipment-edabec92.js";import{c as ce,b as I,a as R,u as me,e as v}from"./array-b292c9a7.js";const pe={class:"space-y-6"},be={class:"flex items-center space-x-4 mb-4"},ge={class:"bg-card rounded-lg shadow-sm p-6"},ve={class:"flex"},he={key:0,class:"bg-destructive/10 text-destructive p-4 rounded-md mb-4"},ye={class:"list-disc list-inside space-y-1"},xe={action:"post",class:"space-y-6"},_e={class:"grid grid-cols-3 gap-6"},we={class:"col-span-1"},Se={class:"block space-y-1.5"},Ce=["value"],ke={class:"col-span-1"},Me={class:"block space-y-1.5"},Le={class:"col-span-1"},Be={class:"block space-y-1.5"},Ne={class:"block space-y-1.5"},Ue={class:"border-t border-border pt-4"},Ve=G({__name:"ShipmentListing",setup(De){const T=ie(()=>re(()=>import("./FelDataTable-b273d3d1.js"),["assets/FelDataTable-b273d3d1.js","assets/index-74595aff.js","assets/index-8412b2a5.css"])),l=de(),{withClientMutation:A}=K(),{shipments:L,fetchingShipments:F,shipmentPageInfo:B}=Q(l);W();let r=b(!1);const i=b(!1),P=b([{name:"All",value:""},{name:"Due",value:"due"},{name:"Awaiting",value:"awaiting"},{name:"Failed",value:"failed"}]),$=b([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Shipment Id",value:"shipmentId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(a,e){return f(X,{to:{name:"shipment-detail",params:{shipmentUid:a?.uid}},innerHTML:a?.shipmentId})}},{name:"External Laboratory",value:"laboratory.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Courier",value:"courier",sortable:!1,sortBy:"asc",hidden:!1},{name:"Flow Detail",value:"",sortable:!1,sortBy:"asc",hidden:!1},{name:"Assigned Count",value:"assignedCount",sortable:!1,sortBy:"asc",hidden:!1},{name:"Current Status",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(a,e){return f("button",{type:"button",class:"bg-primary text-primary-foreground py-1 px-2 rounded-sm leading-none",innerHTML:a?.state||"unknown"})}},{name:"",value:"",sortable:!1,showInToggler:!1,hidden:!1,customRender:function(a,e){return a.incoming?f("span",{class:"text-success"},f("i",{class:"fa fa-reply-all"})):f("span",{class:"text-destructive"},f("i",{class:"fa fa-share-from-square"}))}}]);l.removeShipment();let o=ee({first:25,before:"",incoming:i.value,status:"",text:"",sort:["-uid"],filterAction:!1});l.fetchShipments(o),l.fetchReferralLaboratories();const q=ce({laboratoryUid:I().required("Laboratory is Required").typeError("Laboratory is Required"),comment:R().nullable(),courier:R().required("Courier is required"),count:I()}),{handleSubmit:E,errors:N}=me({validationSchema:q,initialValues:{laboratoryUid:void 0,comment:"",courier:"",count:1}}),{value:h}=v("laboratoryUid"),{value:y}=v("comment"),{value:x}=v("courier"),{value:_}=v("count"),O=E(a=>{r.value=!1,A(fe,{payload:a},"createShipment").then(e=>{l.addShipment(e),r.value=!1})});function H(a){o.first=a.fetchCount,o.before=B?.value?.endCursor??"",o.text=a.filterText,o.status=a.filterStatus,o.incoming=i.value,o.filterAction=!1,l.fetcShipments(o)}function j(a){o.first=25,o.before="",o.text=a.filterText,o.status=a.filterStatus,o.incoming=i.value,o.filterAction=!0,l.clearShipment(),l.fetcShipments(o)}const z=te(()=>L?.value?.length+" of "+l.getShipmentCount+" Shipments");return(a,e)=>{const U=w("fel-button"),J=w("fel-heading"),Y=w("fel-modal");return d(),c(k,null,[t("div",pe,[g(J,{title:"Shipments"},{default:u(()=>[g(U,{onClick:e[0]||(e[0]=s=>m(r)?r.value=!0:r=!0)},{default:u(()=>e[9]||(e[9]=[S("Create New")])),_:1})]),_:1}),t("div",be,[g(U,{onClick:e[1]||(e[1]=s=>i.value=!i.value),class:se([i.value?"bg-primary text-primary-foreground hover:bg-primary/90":"bg-secondary text-secondary-foreground hover:bg-secondary/80"]),"aria-pressed":i.value},{default:u(()=>[S(C(i.value?"Incoming":"Outgoing"),1)]),_:1},8,["class","aria-pressed"])]),t("div",ge,[g(n(T),{columns:$.value,data:n(L),toggleColumns:!0,loading:n(F),paginable:!0,pageMeta:{fetchCount:n(o).first,hasNextPage:n(B)?.hasNextPage,countNone:z.value},searchable:!0,filterable:!0,filterMeta:{defaultFilter:n(o).status,filters:P.value},onOnSearch:j,onOnPaginate:H,selectable:!1},{"pre-filter":u(()=>[t("label",ve,[p(t("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=s=>i.value=s)},null,512),[[oe,i.value]]),e[10]||(e[10]=S()),e[11]||(e[11]=t("span",{class:"mx-2"},"InBound",-1))])]),footer:u(()=>e[12]||(e[12]=[])),_:1},8,["columns","data","loading","pageMeta","filterMeta"])])]),n(r)?(d(),ae(Y,{key:0,onClose:e[8]||(e[8]=s=>m(r)?r.value=!1:r=!1)},{header:u(()=>e[13]||(e[13]=[t("h3",{class:"text-lg font-medium leading-6 text-foreground"},"Create New Shipment",-1)])),validation:u(()=>[n(N).length?(d(),c("div",he,[t("ul",ye,[(d(!0),c(k,null,V(n(N),(s,Z)=>(d(),c("li",{key:Z,class:"text-sm"},C(s),1))),128))])])):D("v-if",!0)]),body:u(()=>[t("form",xe,[t("div",_e,[t("div",we,[t("label",Se,[e[14]||(e[14]=t("span",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},"External Laboratory",-1)),p(t("select",{class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","onUpdate:modelValue":e[3]||(e[3]=s=>m(h)?h.value=s:null)},[(d(!0),c(k,null,V(n(l).laboratories,s=>(d(),c("option",{key:s.uid,value:s.uid},C(s.name),9,Ce))),128))],512),[[ne,n(h)]])])]),t("div",ke,[t("label",Me,[e[15]||(e[15]=t("span",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},"Courier",-1)),p(t("input",{type:"text",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","onUpdate:modelValue":e[4]||(e[4]=s=>m(x)?x.value=s:null)},null,512),[[M,n(x)]])])]),t("div",Le,[t("label",Be,[e[16]||(e[16]=t("span",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},"How Many",-1)),p(t("input",{type:"number",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","onUpdate:modelValue":e[5]||(e[5]=s=>m(_)?_.value=s:null),min:"1",default:"1"},null,512),[[M,n(_)]])])])]),t("div",null,[t("label",Ne,[e[17]||(e[17]=t("span",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},"Comment",-1)),p(t("textarea",{class:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",rows:"2",placeholder:"Notes ...","onUpdate:modelValue":e[6]||(e[6]=s=>m(y)?y.value=s:null)},null,512),[[M,n(y)]])])]),t("div",Ue,[t("button",{type:"button",onClick:e[7]||(e[7]=le(s=>n(O)(),["prevent"])),class:"inline-flex w-full items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4"}," Create Shipment ")])])]),_:1})):D("v-if",!0)],64)}}}),Ae=ue(Ve,[["__file","/home/aurthurm/Documents/Development/felicity/felicity-lims/webapp/views/shipment/ShipmentListing.vue"]]);export{Ae as default};
