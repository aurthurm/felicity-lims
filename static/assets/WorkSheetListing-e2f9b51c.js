import{d as K,a_ as $,a8 as z,s as G,ad as J,r as y,b4 as g,b5 as Q,A as X,c as Y,ae as c,b as Z,e as h,bB as ee,aa as U,o as i,g as u,h as t,y as S,i as f,C as te,w as E,k as d,l as se,E as _,j as n,an as ae,D as oe,F as m,z as w,t as W,R as C,v as ne,I as le,ak as re,_ as ie}from"./index-055aea84.js";import{h as ue,o as de,a as ce}from"./constants-a9696022.js";const he={class:"flex justify-between items-center"},fe=t("h2",null,"WORKSHEETS",-1),me=t("h3",null,"Create Worksheet",-1),ve=t("hr",null,null,-1),pe={action:"post",class:"p-1"},ke={class:"grid grid-cols-3 gap-x-4 mb-4"},be={class:"block col-span-1 mb-2"},ye=t("span",{class:"text-gray-700"},"Analyst",-1),ge=["value"],Se={class:"block col-span-1 mb-2"},_e=t("span",{class:"text-gray-700"},"Worksheet Template",-1),we=t("option",{value:"undefined"},null,-1),We=["value"],xe={class:"block col-span-1 mb-2"},Re=t("span",{class:"text-gray-700"},"How Many",-1),Te=t("hr",null,null,-1),Ue=K({__name:"WorkSheetListing",setup(Ee){const r=$(),x=z(),{withClientMutation:A}=re(),{workSheets:v,fetchingWorkSheets:M,workSheetPageInfo:R,workSheetTemplates:N}=G(r);console.log(v),J();let l=y(!1);const B=y([{name:"All",value:""},{name:"Pending",value:"pending"},{name:"Awaiting",value:"awaiting"},{name:"Approved",value:"approved"},{name:"Empty",value:"empty"}]),I=y([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"WorkSheet Id",value:"workSheetId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(e,a){return g(Q,{to:{name:"worksheet-detail",params:{workSheetUid:e?.uid}},innerHTML:e?.worksheetId})}},{name:"Analysis/Test",value:"analysis.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Samples",value:"assignedCount",sortable:!1,sortBy:"asc",hidden:!1},{name:"Instrument",value:"instrument.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Analyst",value:"clientPatientId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(e,a){return g("div",{innerHTML:T(e?.analyst)})}},{name:"Status",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(e,a){return g("button",{type:"button",class:"bg-sky-800 text-white py-1 px-2 rounded-sm leading-none",innerHTML:e?.state||"unknown"})}}]);r.removeWorksheet();let o=X({first:25,before:"",status:"",text:"",sort:["-uid"],filterAction:!1});r.fetchWorkSheets(o),r.fetchWorkSheetTemplates(),x.fetchUsers({});const L=Y({analystUid:c().required("Analyst is Required").typeError("Analyst is Required"),templateUid:c().typeError("Worksheet Template is required"),instrumentUid:c(),count:c().typeError("Required number of worksheets must be defined")}),{handleSubmit:D,errors:F}=Z({validationSchema:L,initialValues:{count:1,analystUid:void 0,templateUid:void 0,instrumentUid:void 0}}),{value:p}=h("count"),{value:k}=h("analystUid"),{value:b}=h("templateUid");h("instrumentUid");const H=D(e=>{l.value=!1,A(ee,e,"createWorksheet").then(a=>{r.addWorksheet(a),l.value=!1})});function O(e){o.first=e.fetchCount,o.before=R?.value?.endCursor??"",o.text=e.filterText,o.status=e.filterStatus,o.filterAction=!1,r.fetchWorkSheets(o)}function P(e){o.first=25,o.before="",o.text=e.filterText,o.status=e.filterStatus,o.filterAction=!0,r.fetchWorkSheets(o)}const V=U(()=>x.getUsers),T=e=>e?.auth?.userName?e?.auth?.userName:e?.firstName?e.firstName+" "+e.lastName:"----",j=U(()=>v?.value?.length+" of "+r.getWorkSheetCount+" WorkSheets");return(e,a)=>(i(),u(m,null,[t("div",he,[fe,S(' <div v-show="hasRights(userRole, objects.WORKSHEET, actions.CREATE)"> '),t("div",null,[f(t("button",{onClick:a[0]||(a[0]=E(s=>d(l)?l.value=!0:l=!0,["prevent"])),class:"p-2 h-10 border-sky-800 border text-sky-800rounded-smtransition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Add WorkSheet ",512),[[te,ue(ce.CREATE,de.WORKSHEET)]])])]),se(ae,{columns:I.value,data:n(v),toggleColumns:!0,loading:n(M),paginable:!0,pageMeta:{fetchCount:n(o).first,hasNextPage:n(R)?.hasNextPage,countNone:n(j)},searchable:!0,filterable:!0,filterMeta:{defaultFilter:n(o).status,filters:B.value},onOnSearch:P,onOnPaginate:O,selectable:!1},{footer:_(()=>[]),_:1},8,["columns","data","loading","pageMeta","filterMeta"]),S(" Location Edit Form Modal "),n(l)?(i(),oe(le,{key:0,onClose:a[5]||(a[5]=s=>d(l)?l.value=!1:l=!1)},{header:_(()=>[t("div",null,[me,ve,t("ul",null,[(i(!0),u(m,null,w(Object.values(n(F)),(s,q)=>(i(),u("li",{key:q,class:"text-orange-600"},W(s),1))),128))])])]),body:_(()=>[t("form",pe,[t("div",ke,[t("label",be,[ye,f(t("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":a[1]||(a[1]=s=>d(k)?k.value=s:null)},[(i(!0),u(m,null,w(n(V),s=>(i(),u("option",{key:s.uid,value:s.uid},W(T(s)),9,ge))),128))],512),[[C,n(k)]])]),t("label",Se,[_e,f(t("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":a[2]||(a[2]=s=>d(b)?b.value=s:null)},[we,(i(!0),u(m,null,w(n(N),s=>(i(),u("option",{key:s.uid,value:s.uid},W(s.name),9,We))),128))],512),[[C,n(b)]])]),t("label",xe,[Re,f(t("input",{type:"number",class:"form-input mt-1 block w-full","onUpdate:modelValue":a[3]||(a[3]=s=>d(p)?p.value=s:null),min:"1"},null,512),[[ne,n(p)]])])]),Te,t("button",{type:"button",onClick:a[4]||(a[4]=E(s=>n(H)(),["prevent"])),class:"-mb-4 w-full border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):S("v-if",!0)],64))}}),Me=ie(Ue,[["__file","/home/aurthur/Development/Python/felicity/felicity-lims/webapp/views/worksheet/WorkSheetListing.vue"]]);export{Me as default};
