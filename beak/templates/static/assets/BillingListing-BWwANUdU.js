const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BeakDataTable-CSqXb4Dl.js","assets/index-DCVfsbos.js","assets/index-C_1sfwqa.css","assets/BillDetail-CNmYaMYf.js","assets/billing-DgtkDXhi.js","assets/billing.queries-C5-RkHZH.js","assets/billing.mutations-xeFsMwi-.js","assets/index.esm-89YX2EbQ.js","assets/BillDetail-Sa9oDNZ-.css"])))=>i.map(i=>d[i]);
import{a0 as $,aq as j,a7 as m,g as q,ad as J,h as Y,a1 as P,a6 as D,a8 as l,_ as G,r as H,c as K,o as S,A as s,E as d,a as F,N as I,C as Q,J as W}from"./index-DCVfsbos.js";import{u as X}from"./billing-DgtkDXhi.js";import"./billing.queries-C5-RkHZH.js";const Z=$({__name:"BillingListing",setup(N,{expose:n}){n();const B=P(()=>D(()=>import("./BeakDataTable-CSqXb4Dl.js"),__vite__mapDeps([0,1,2]))),a=P(()=>D(()=>import("./BillDetail-CNmYaMYf.js"),__vite__mapDeps([3,1,2,4,5,6,7,8]))),p=X(),{bills:g,billPageInfo:c,fetchingBills:f}=j(p),v=m(!1),b=m(void 0);function C(e){return{pending:"bg-warning/15 text-warning",received:"bg-info/15 text-info",approved:"bg-success/15 text-success",published:"bg-accent/15 text-accent",rejected:"bg-destructive/15 text-destructive",cancelled:"bg-muted text-muted-foreground"}[e?.toLowerCase()]||"bg-muted text-muted-foreground"}function _(e){b.value=e,v.value=!0}function R(){v.value=!1,b.value=void 0}const T=m([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Bill #",value:"billId",sortable:!1,hidden:!1,customRender:function(e,i){return l("button",{onClick:()=>_(e),type:"button",class:"px-2 py-1 font-semibold rounded-md hover:underline transition-colors duration-200 text-left cursor-pointer"},e?.billId||"—")}},{name:"Client",value:"client.name",sortable:!1,hidden:!1},{name:"Patient",value:"",sortable:!1,hidden:!1,customRender:function(e,i){if(!e?.orders||e.orders.length===0)return l("span","—");const o=e.orders[0]?.patient;if(!o)return l("span","—");const r=`${o?.firstName||""} ${o?.lastName||""}`.trim(),h=o?.gender?` (${o.gender})`:"";return l("span",`${r}${h}`)}},{name:"Samples",value:"",sortable:!1,hidden:!1,customRender:function(e,i){if(!e?.orders||e.orders.length===0)return l("span","—");const o=[];return e.orders.forEach((r,h)=>{r.samples&&r.samples.length>0&&r.samples.forEach((x,O)=>{const V=C(x?.status);o.push(l("div",{key:`${h}-${O}`,class:"mb-2"},[l("span",{class:"font-mono text-sm"},x?.sampleId||"—"),l("span",{class:"mx-2"},"•"),l("span",{class:`text-xs px-2 py-1 rounded ${V}`},x?.status||"—")]))})}),l("div",o.length>0?o:l("span","—"))}},{name:"Amount Charged",value:"totalCharged",sortable:!1,hidden:!1,customRender:function(e,i){return l("span",`$${parseFloat(e?.totalCharged||0).toFixed(2)}`)}},{name:"Amount Paid",value:"totalPaid",sortable:!1,hidden:!1,customRender:function(e,i){return l("span",`$${parseFloat(e?.totalPaid||0).toFixed(2)}`)}},{name:"Balance",value:"",sortable:!1,hidden:!1,customRender:function(e,i){const o=parseFloat(e?.totalCharged||0)-parseFloat(e?.totalPaid||0),r=o>0?"text-destructive":"text-success";return l("span",{class:r},`$${o.toFixed(2)}`)}},{name:"Partial",value:"partial",sortable:!1,hidden:!1,customRender:function(e,i){const o=e?.partial?"Yes":"No",r=e?.partial?"bg-warning/15 text-warning":"bg-success/15 text-success";return l("span",{class:`px-2 py-1 rounded text-sm font-medium ${r}`},o)}},{name:"Status",value:"isActive",sortable:!1,hidden:!1,customRender:function(e,i){const o=e?.isActive?"Active":"Inactive",r=e?.isActive?"bg-success/15 text-success":"bg-muted text-muted-foreground";return l("span",{class:`px-2 py-1 rounded text-sm font-medium ${r}`},o)}},{name:"Date",value:"createdAt",sortable:!1,hidden:!1,customRender:function(e,i){return l("span",new Date(e?.createdAt).toLocaleDateString())}}]);let t=q({pageSize:50,afterCursor:"",beforeCursor:"",text:"",isActive:null,partial:null,clientUid:"",sortBy:["-uid"],filterAction:!1});const A=m(null),w=m(null);J(()=>{u()});async function u(){await p.searchBills({pageSize:t.pageSize,afterCursor:t.afterCursor||void 0,beforeCursor:t.beforeCursor||void 0,text:t.text||void 0,isActive:t.isActive!==null?t.isActive:void 0,partial:t.partial!==null?t.partial:void 0,clientUid:t.clientUid||void 0,sortBy:t.sortBy})}function k(e){e==="all"?t.partial=null:e==="partial"?t.partial=!0:e==="complete"&&(t.partial=!1),t.afterCursor="",t.beforeCursor="",t.filterAction=!0,A.value=e,u()}function E(e){e==="all"?t.isActive=null:e==="active"?t.isActive=!0:e==="inactive"&&(t.isActive=!1),t.afterCursor="",t.beforeCursor="",t.filterAction=!0,w.value=e,u()}function L(e){t.pageSize=100,t.afterCursor="",t.beforeCursor="",t.text=e.filterText,t.filterAction=!0,u()}function M(e){t.pageSize=e.fetchCount,t.afterCursor=c?.value?.endCursor??"",t.beforeCursor="",t.text=e.filterText,t.filterAction=!1,u()}function U(e){t.isActive=e,t.afterCursor="",t.beforeCursor="",t.filterAction=!0,u()}const z=Y(()=>`${g?.value?.length} of ${c?.value?.totalCount??0} bills`),y={DataTable:B,BillDetail:a,billingStore:p,bills:g,billPageInfo:c,fetchingBills:f,showBillDetail:v,selectedBill:b,getStatusBadgeClass:C,openBillDetail:_,closeBillDetail:R,tableColumns:T,get billParams(){return t},set billParams(e){t=e},selectedPartial:A,selectedIsActive:w,fetchBills:u,handlePartialFilter:k,handleIsActiveFilter:E,searchBills:L,showMoreBills:M,filterByStatus:U,countNone:z};return Object.defineProperty(y,"__isScriptSetup",{enumerable:!1,value:!0}),y}}),ee={class:"space-y-6"},te={class:"rounded-lg border border-border bg-card shadow-sm p-4"},ae={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},le=["value"],se=["value"],ne={class:"rounded-lg border border-border bg-card shadow-sm p-6"};function oe(N,n,B,a,p,g){const c=H("beak-drawer");return S(),K(W,null,[s("div",ee,[d(" Filters "),s("div",te,[s("div",ae,[d(" Billing Type Filter "),s("div",null,[n[3]||(n[3]=s("label",{class:"block text-sm font-medium text-foreground mb-2"},"Billing Type",-1)),s("select",{value:a.selectedPartial,onChange:n[0]||(n[0]=f=>a.handlePartialFilter(f.target.value)),class:"w-full px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary"},[...n[2]||(n[2]=[s("option",{value:"all"},"All Types",-1),s("option",{value:"complete"},"Complete Bills",-1),s("option",{value:"partial"},"Partial Bills",-1)])],40,le)]),d(" Bill Status Filter "),s("div",null,[n[5]||(n[5]=s("label",{class:"block text-sm font-medium text-foreground mb-2"},"Bill Status",-1)),s("select",{value:a.selectedIsActive,onChange:n[1]||(n[1]=f=>a.handleIsActiveFilter(f.target.value)),class:"w-full px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary"},[...n[4]||(n[4]=[s("option",{value:"all"},"All Status",-1),s("option",{value:"active"},"Active",-1),s("option",{value:"inactive"},"Inactive",-1)])],40,se)])])]),d(" Data Table "),s("div",ne,[F(a.DataTable,{columns:a.tableColumns,data:a.bills,toggleColumns:!0,loading:a.fetchingBills,paginable:!0,pageMeta:{fetchCount:a.billParams.pageSize,hasNextPage:a.billPageInfo?.hasNextPage,countNone:a.countNone},searchable:!0,filterable:!1,onOnSearch:a.searchBills,onOnPaginate:a.showMoreBills,selectable:!1},null,8,["columns","data","loading","pageMeta"])])]),d(" Bill Detail Drawer "),F(c,{show:a.showBillDetail,onClose:a.closeBillDetail,"content-width":"w-2/4"},{header:I(()=>[...n[6]||(n[6]=[s("span",null,"Bill Details",-1)])]),body:I(()=>[a.selectedBill?(S(),Q(a.BillDetail,{key:0,customerUid:a.selectedBill?.patientUid??"",testBill:a.selectedBill},null,8,["customerUid","testBill"])):d("v-if",!0)]),_:1},8,["show"])],64)}const de=G(Z,[["render",oe],["__file","/home/administrator/Documents/Development/beak-insights/beak/beak-lims/webapp/views/billing/BillingListing.vue"]]);export{de as default};
