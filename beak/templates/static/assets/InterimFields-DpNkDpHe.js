const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-B3ZheI5m.js","assets/index-C_1sfwqa.css"])))=>i.map(i=>d[i]);
import{a0 as z,f as G,t as H,a7 as g,a5 as Q,h as X,a1 as Z,a6 as j,_ as $,r as N,c as a,o as i,a as D,A as e,C as ee,E as v,N as x,P as te,J as h,K as T,L as d,D as re,F as k,a9 as ne,a2 as q}from"./index-B3ZheI5m.js";import{c as se,a as R,d as oe,u as ie,b as w}from"./index.esm-C1wdlr_y.js";import{B as ae,D as de}from"./analyses.mutations--kSQRsEC.js";import{u as le}from"./analysis-B6vUCJdb.js";import{u as ue}from"./setup-DpgcXA6u.js";const me=z({__name:"InterimFields",props:{analysis:{type:Object,required:!0,default:()=>({})},analysisUid:{type:String,required:!0,default:0}},setup(I,{expose:t}){t();const E=Z(()=>j(()=>import("./index-B3ZheI5m.js").then(s=>s.cl),__vite__mapDeps([0,1]))),r=le(),m=ue(),{withClientMutation:c}=G(),l=I,{analysis:f}=H(l);let n=g(!1),b=g("");const p=g(!0),u=g(null),U=se({instrumentUid:R().trim().required("Instrument is required"),key:oe().typeError("Interim key must be a number").integer("Interim key must be an integer").required("Interim key is required"),value:R().trim().required("Result value is required")}),{handleSubmit:A,resetForm:S,setValues:F}=ie({validationSchema:U,initialValues:{instrumentUid:"",key:"",value:""}}),{value:K,errorMessage:B}=w("instrumentUid"),{value:L,errorMessage:P}=w("key"),{value:O,errorMessage:J}=w("value");Q(()=>l.analysisUid,(s,o)=>{}),m.fetchInstruments();const _=X(()=>m.getInstruments);function M(s){c(ae,{payload:s},"createAnalysisInterim").then(o=>r.addAnalysisInterim(o))}function V(s){u.value&&c(de,{uid:u.value,payload:s},"updateAnalysisInterim").then(o=>r.updateAnalysisInterim(o))}function W(s,o={}){p.value=s,n.value=!0,b.value=(s?"CREATE":"EDIT")+" ANALYSIS INTERIM",s?(u.value=null,S({values:{instrumentUid:"",key:"",value:""}})):(u.value=o.uid??null,F({instrumentUid:o.instrumentUid??"",key:o.key??"",value:o.value??""}))}const Y=A(s=>{const o=f?.value?.uid;if(!o)return;const y={instrumentUid:s.instrumentUid,key:Number(s.key),value:s.value,analysisUid:o};p.value===!0&&M(y),p.value===!1&&V(y),n.value=!1}),C={modal:E,analysisStore:r,setupStore:m,withClientMutation:c,props:l,analysis:f,get showModal(){return n},set showModal(s){n=s},get formTitle(){return b},set formTitle(s){b=s},formAction:p,currentUid:u,interimSchema:U,handleSubmit:A,resetForm:S,setValues:F,instrumentUid:K,instrumentError:B,interimKey:L,keyError:P,interimValue:O,valueError:J,instruments:_,addAnalysisInterim:M,editAnalysisInterim:V,FormManager:W,saveForm:Y,instrumentName:s=>{const o=_?.value?.findIndex(y=>y.uid===s);return _?.value[o]?.name||"unknown"}};return Object.defineProperty(C,"__isScriptSetup",{enumerable:!1,value:!0}),C}}),ce={class:"overflow-x-auto mt-4"},fe={class:"align-middle inline-block min-w-full shadow overflow-hidden bg-card text-card-foreground rounded-lg border border-border"},be={class:"min-w-full beak-table"},pe={class:"bg-card"},ye={class:"px-4 py-2 whitespace-nowrap border-b border-border"},ge={class:"text-sm text-foreground"},ve={class:"px-4 py-2 whitespace-nowrap border-b border-border"},xe={class:"text-sm text-foreground"},_e={class:"px-4 py-2 whitespace-nowrap border-b border-border"},he={class:"text-sm text-foreground"},ke={class:"px-4 py-2 whitespace-nowrap text-right border-b border-border"},we=["onClick"],Ie={class:"text-lg font-bold text-foreground"},Ee={class:"space-y-4"},Ue={class:"grid grid-cols-3 gap-4"},Ae={class:"space-y-2"},Se=["value"],Fe={key:0,class:"text-sm text-destructive"},Me={class:"space-y-2"},Ve={key:0,class:"text-sm text-destructive"},Ce={class:"space-y-2"},Ne={key:0,class:"text-sm text-destructive"};function De(I,t,E,r,m,c){const l=N("beak-button"),f=N("beak-heading");return i(),a(h,null,[D(f,{title:"Interim Fields"},{default:x(()=>[D(l,{onClick:t[0]||(t[0]=n=>r.FormManager(!0))},{default:x(()=>[...t[6]||(t[6]=[te("Add Interim Field",-1)])]),_:1})]),_:1}),e("div",ce,[e("div",fe,[e("table",be,[t[7]||(t[7]=e("thead",null,[e("tr",null,[e("th",{class:"px-4 py-2 border-b border-border text-left text-sm font-medium text-muted-foreground"},"Interim Key"),e("th",{class:"px-4 py-2 border-b border-border text-left text-sm font-medium text-muted-foreground"},"Result Value"),e("th",{class:"px-4 py-2 border-b border-border text-left text-sm font-medium text-muted-foreground"},"Instrument"),e("th",{class:"px-4 py-2 border-b border-border"})])],-1)),e("tbody",pe,[(i(!0),a(h,null,T(r.analysis?.interims,n=>(i(),a("tr",{key:n?.uid,class:"hover:bg-accent/50"},[e("td",ye,[e("div",ge,d(n?.key),1)]),e("td",ve,[e("div",xe,d(n?.value),1)]),e("td",_e,[e("div",he,d(r.instrumentName(n?.instrumentUid)),1)]),e("td",ke,[e("button",{onClick:b=>r.FormManager(!1,n),class:"px-2 py-1 mr-2 border border-border bg-background text-foreground transition-colors duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-ring hover:bg-accent hover:text-accent-foreground"}," Edit ",8,we)])]))),128))])])])]),r.showModal?(i(),ee(r.modal,{key:0,onClose:t[5]||(t[5]=n=>r.showModal=!1),contentWidth:"w-2/4"},{header:x(()=>[e("h3",Ie,d(r.formTitle),1)]),body:x(()=>[e("form",{onSubmit:t[4]||(t[4]=re((...n)=>r.saveForm&&r.saveForm(...n),["prevent"])),class:"p-6 space-y-6"},[e("div",Ee,[e("div",Ue,[e("label",Ae,[t[9]||(t[9]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Instrument",-1)),k(e("select",{class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":t[1]||(t[1]=n=>r.instrumentUid=n)},[t[8]||(t[8]=e("option",{value:""},"Select Instrument",-1)),(i(!0),a(h,null,T(r.instruments,n=>(i(),a("option",{key:n?.uid,value:n.uid},d(n?.name),9,Se))),128))],512),[[ne,r.instrumentUid]]),r.instrumentError?(i(),a("p",Fe,d(r.instrumentError),1)):v("",!0)]),e("label",Me,[t[10]||(t[10]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Interim",-1)),k(e("input",{type:"number",class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":t[2]||(t[2]=n=>r.interimKey=n),placeholder:"Interim Key ..."},null,512),[[q,r.interimKey]]),r.keyError?(i(),a("p",Ve,d(r.keyError),1)):v("",!0)]),e("label",Ce,[t[11]||(t[11]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Result",-1)),k(e("input",{type:"text",class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":t[3]||(t[3]=n=>r.interimValue=n),placeholder:"Result Value ..."},null,512),[[q,r.interimValue]]),r.valueError?(i(),a("p",Ne,d(r.valueError),1)):v("",!0)])])]),t[12]||(t[12]=e("div",{class:"pt-4"},[e("button",{type:"submit",class:"w-full bg-primary text-primary-foreground hover:bg-primary/90 rounded-lg px-4 py-2 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-ring"}," Save Form ")],-1))],32)]),_:1})):v("",!0)],64)}const Pe=$(me,[["render",De],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/analyses/services/InterimFields.vue"]]);export{Pe as default};
