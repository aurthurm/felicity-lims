const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DCVfsbos.js","assets/index-C_1sfwqa.css"])))=>i.map(i=>d[i]);
import{a0 as J,ac as K,a7 as y,h as A,g as Q,a1 as G,a6 as W,_ as X,r as I,aa as B,c,o as r,F as i,E,A as e,H as a,J as P,K as q,L as m,a9 as Y,a2 as Z,a as N,N as j,P as F,D as k,a3 as L,Q as $,C as ee}from"./index-DCVfsbos.js";import{u as te}from"./shipment-BLjiMqHB.js";import{u as se}from"./shipment-WjNW9B2l.js";const oe=J({__name:"ShipmentSamples",setup(T,{expose:t}){t();const w=G(()=>W(()=>import("./index-DCVfsbos.js").then(s=>s.cm),__vite__mapDeps([0,1]))),n=se(),v=K();let u=y(!1),l=A(()=>n.getShipment);const b=()=>{n.fetchShipmentByUid(v.params.shipmentUid)},h=Q({laboratoryUid:void 0,comment:void 0,courier:void 0}),f=y(!1),o=()=>{f.value=!0,n.updateShipment({uid:v.params.shipmentUid,payload:h}).then(()=>{f.value=!1,b()})};function p(){return l.value?.samples?.every(s=>s.checked===!0)}function C(){let s=[];return l.value?.shippedSamples?.forEach(d=>{d?.checked&&s.push(d.sample)}),s}function O(){p()?u.value=!0:u.value=!1,g()}function U(s){if(D(s)||l.value?.state!=="preperation"){S(s);return}s.checked=!0,g()}function D(s){return["retracted","approved"].includes(s.status)}function S(s){s.checked=!1,g()}function z(){l?.value?.samples?.forEach(s=>u.value?U(s):S(s)),g()}function M(){return C().map(s=>({sampleUid:s.uid,shipedSampleUid:void 0,analyses:[]}))}let x=y(!1),_=y(!1);function g(){x.value=!1,_.value=!1;const s=C();s.length!==0&&(s.every(d=>["referred","paired"].includes(d.status??""))&&(x.value=!0),s.every(d=>d.status==="referred")&&(_.value=!0))}const H=A(()=>!["cancelled","dispatched"].includes(l.value?.state??"")),{manageSamples:V}=te(),R={FButton:w,shipmentStore:n,route:v,get allChecked(){return u},set allChecked(s){u=s},get shipment(){return l},set shipment(s){l=s},refresh:b,form:h,applying:f,applyChanges:o,areAllChecked:p,getSamplesChecked:C,checkCheck:O,check:U,checkDisabled:D,unCheck:S,toggleCheckAll:z,getSelectedMetadata:M,get can_recover(){return x},set can_recover(s){x=s},get can_recall(){return _},set can_recall(s){_=s},checkUserActionPermissios:g,viewShipmentModifier:H,manageSamples:V,sampleManager:s=>{const d=M();V(l?.value?.uid,d,s)}};return Object.defineProperty(R,"__isScriptSetup",{enumerable:!1,value:!0}),R}}),ne={class:"space-y-6"},ie={class:"space-y-4"},le={action:"post",class:"space-y-4"},re={class:"flex flex-wrap gap-4 items-end"},ae={class:"flex-1 min-w-[200px]"},de={class:"block space-y-1.5"},ce=["value"],me={class:"flex-1 min-w-[200px]"},ue={class:"block space-y-1.5"},fe={class:"text-sm text-muted-foreground"},pe={class:"rounded-md border border-border"},ge={class:"overflow-x-auto"},ve={class:"w-full beak-table"},be={class:"border-b border-border bg-muted/50"},he={class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground"},xe={class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground"},_e={class:"divide-y divide-border"},ye={class:"p-4 align-middle"},ke=["onUpdate:modelValue"],Ce={class:"p-4 align-middle"},Se={class:"p-4 align-middle"},we={class:"text-sm font-medium"},Ue={key:1},De={class:"p-4 align-middle"},Me={class:"text-sm"},Ve={class:"p-4 align-middle"},Re={class:"text-sm"},Ae={class:"p-4 align-middle"},Ie={class:"text-sm"},Be={class:"p-4 align-middle"},Ee={class:"inline-flex items-center rounded-md bg-primary/10 px-2 py-1 text-xs font-medium text-primary"},Pe={class:"flex gap-2"};function qe(T,t,w,n,v,u){const l=I("font-awesome-icon"),b=I("router-link"),h=B("motion-slide-left"),f=B("motion-slide-right");return r(),c("div",ne,[i((r(),c("div",ie,[i(e("form",le,[e("div",re,[e("div",ae,[e("label",de,[t[9]||(t[9]=e("span",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},"Reference Laboratory",-1)),i(e("select",{name:"laboratory_uid","onUpdate:modelValue":t[0]||(t[0]=o=>n.form.laboratoryUid=o),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[(r(!0),c(P,null,q(n.shipmentStore.laboratories,o=>(r(),c("option",{key:o.uid,value:o.uid},m(o.name),9,ce))),128))],512),[[Y,n.form.laboratoryUid]])])]),e("div",me,[e("label",ue,[t[10]||(t[10]=e("span",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"},"Courier",-1)),i(e("input",{type:"text",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","onUpdate:modelValue":t[1]||(t[1]=o=>n.form.courier=o)},null,512),[[Z,n.form.courier]])])]),e("div",null,[N(n.FButton,{onClick:t[2]||(t[2]=k(o=>n.applyChanges(),["prevent"])),color:"sky-800",class:"h-10 px-4"},{default:j(()=>[...t[11]||(t[11]=[F(" Apply ",-1)])]),_:1})])])],512),[[a,!n.applying&&!n.shipmentStore.shipment?.incoming]]),i(e("p",fe,"Updating...",512),[[a,n.applying]]),e("div",null,[e("button",{onClick:t[3]||(t[3]=k(o=>n.refresh(),["prevent"])),class:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background border border-input hover:bg-accent hover:text-accent-foreground h-9 px-4"}," Refresh ")])])),[[a,n.viewShipmentModifier],[h]]),E(" Sample Table View "),e("div",pe,[e("div",ge,[e("table",ve,[e("thead",null,[e("tr",be,[i(e("th",he,[i(e("input",{type:"checkbox",class:"h-4 w-4 rounded border-input text-primary focus:ring-primary",onChange:t[4]||(t[4]=o=>n.toggleCheckAll()),"onUpdate:modelValue":t[5]||(t[5]=o=>n.allChecked=o)},null,544),[[L,n.allChecked]])],512),[[a,n.shipment?.state==="preperation"]]),t[12]||(t[12]=e("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground"},null,-1)),t[13]||(t[13]=e("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground"},"Sample ID",-1)),i(e("th",xe," External SID ",512),[[a,n.shipment?.incoming]]),t[14]||(t[14]=e("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground"},"Client Request Id",-1)),t[15]||(t[15]=e("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground"},"Date Collected",-1)),t[16]||(t[16]=e("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground"},"Analysis",-1)),t[17]||(t[17]=e("th",{class:"h-10 px-4 text-left align-middle font-medium text-muted-foreground"},"Status",-1))])]),e("tbody",_e,[(r(!0),c(P,null,q(n.shipment?.shippedSamples,o=>i((r(),c("tr",{key:o.sampleUid,class:"hover:bg-muted/50"},[i(e("td",ye,[i(e("input",{type:"checkbox",class:"h-4 w-4 rounded border-input text-primary focus:ring-primary","onUpdate:modelValue":p=>o.checked=p,onChange:t[6]||(t[6]=p=>n.checkCheck())},null,40,ke),[[L,o.checked]])],512),[[a,n.shipment?.state==="preperation"]]),e("td",Ce,[o.sample?.priority??!1?(r(),c("span",{key:0,class:$(["text-sm",{"text-destructive":o.sample?.priority??!1}])},[N(l,{icon:"fa-star"})],2)):E("v-if",!0)]),e("td",Se,[e("div",we,[o.sample?.analysisRequest?.patient?.uid?(r(),ee(b,{key:0,to:{name:"sample-detail",params:{patientUid:o.sample?.analysisRequest?.patient?.uid,sampleUid:o.sample?.uid}},class:"text-primary hover:underline"},{default:j(()=>[F(m(o.sample?.sampleId),1)]),_:2},1032,["to"])):(r(),c("div",Ue,m(o.sample?.sampleId),1))])]),i(e("td",De,[e("div",Me,m(o.extSampleId),1)],512),[[a,n.shipment?.incoming]]),e("td",Ve,[e("div",Re,m(o.sample?.analysisRequest?.clientRequestId),1)]),e("td",Ae,[e("div",Ie,m(o.sample?.dateCollected),1)]),t[18]||(t[18]=e("td",{class:"p-4 align-middle"},[e("div",{class:"text-sm"},"tests")],-1)),e("td",Be,[e("span",Ee,m(o.sample?.status||"unknown"),1)])])),[[f]])),128))])])])]),e("section",Pe,[i(e("button",{onClick:t[7]||(t[7]=k(o=>n.sampleManager("recover"),["prevent"])),class:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background border border-input hover:bg-accent hover:text-accent-foreground h-9 px-4"}," Remove ",512),[[a,n.can_recover]]),i(e("button",{onClick:t[8]||(t[8]=k(o=>n.sampleManager("recall"),["prevent"])),class:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background border border-input hover:bg-accent hover:text-accent-foreground h-9 px-4"}," Pair ",512),[[a,n.can_recall]])])])}const Te=X(oe,[["render",qe],["__file","/home/administrator/Documents/Development/beak-insights/beak/beak-lims/webapp/views/shipment/_id/ShipmentSamples.vue"]]);export{Te as default};
