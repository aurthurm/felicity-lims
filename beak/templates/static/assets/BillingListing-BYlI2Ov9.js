const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BeakDataTable--KDatWv7.js","assets/index-B3ZheI5m.js","assets/index-C_1sfwqa.css","assets/BillDetail-Cm_6-Vr2.js","assets/billing-CgiyGpDP.js","assets/billing.queries-BnMgH4Vz.js","assets/billing.mutations-DdDRIHbu.js","assets/index.esm-C1wdlr_y.js","assets/BillDetail-Sa9oDNZ-.css"])))=>i.map(i=>d[i]);
import{a0 as V,aq as $,a7 as f,g as j,ad as q,h as J,a1 as y,a6 as P,a8 as s,_ as Y,r as G,c as H,o as S,A as l,a as D,N as I,C as K,E as Q,J as W}from"./index-B3ZheI5m.js";import{u as X}from"./billing-CgiyGpDP.js";import"./billing.queries-BnMgH4Vz.js";const Z=V({__name:"BillingListing",setup(N,{expose:n}){n();const x=y(()=>P(()=>import("./BeakDataTable--KDatWv7.js"),__vite__mapDeps([0,1,2]))),a=y(()=>P(()=>import("./BillDetail-Cm_6-Vr2.js"),__vite__mapDeps([3,1,2,4,5,6,7,8]))),m=X(),{bills:p,billPageInfo:d,fetchingBills:c}=$(m),g=f(!1),v=f(void 0);function C(e){return{pending:"bg-warning/15 text-warning",received:"bg-info/15 text-info",approved:"bg-success/15 text-success",published:"bg-accent/15 text-accent",rejected:"bg-destructive/15 text-destructive",cancelled:"bg-muted text-muted-foreground"}[e?.toLowerCase()]||"bg-muted text-muted-foreground"}function _(e){v.value=e,g.value=!0}function F(){g.value=!1,v.value=void 0}const R=f([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Bill #",value:"billId",sortable:!1,hidden:!1,customRender:function(e,i){return s("button",{onClick:()=>_(e),type:"button",class:"px-2 py-1 font-semibold rounded-md hover:underline transition-colors duration-200 text-left cursor-pointer"},e?.billId||"—")}},{name:"Client",value:"client.name",sortable:!1,hidden:!1},{name:"Patient",value:"",sortable:!1,hidden:!1,customRender:function(e,i){if(!e?.orders||e.orders.length===0)return s("span","—");const o=e.orders[0]?.patient;if(!o)return s("span","—");const r=`${o?.firstName||""} ${o?.lastName||""}`.trim(),b=o?.gender?` (${o.gender})`:"";return s("span",`${r}${b}`)}},{name:"Samples",value:"",sortable:!1,hidden:!1,customRender:function(e,i){if(!e?.orders||e.orders.length===0)return s("span","—");const o=[];return e.orders.forEach((r,b)=>{r.samples&&r.samples.length>0&&r.samples.forEach((h,z)=>{const O=C(h?.status);o.push(s("div",{key:`${b}-${z}`,class:"mb-2"},[s("span",{class:"font-mono text-sm"},h?.sampleId||"—"),s("span",{class:"mx-2"},"•"),s("span",{class:`text-xs px-2 py-1 rounded ${O}`},h?.status||"—")]))})}),s("div",o.length>0?o:s("span","—"))}},{name:"Amount Charged",value:"totalCharged",sortable:!1,hidden:!1,customRender:function(e,i){return s("span",`$${parseFloat(e?.totalCharged||0).toFixed(2)}`)}},{name:"Amount Paid",value:"totalPaid",sortable:!1,hidden:!1,customRender:function(e,i){return s("span",`$${parseFloat(e?.totalPaid||0).toFixed(2)}`)}},{name:"Balance",value:"",sortable:!1,hidden:!1,customRender:function(e,i){const o=parseFloat(e?.totalCharged||0)-parseFloat(e?.totalPaid||0),r=o>0?"text-destructive":"text-success";return s("span",{class:r},`$${o.toFixed(2)}`)}},{name:"Partial",value:"partial",sortable:!1,hidden:!1,customRender:function(e,i){const o=e?.partial?"Yes":"No",r=e?.partial?"bg-warning/15 text-warning":"bg-success/15 text-success";return s("span",{class:`px-2 py-1 rounded text-sm font-medium ${r}`},o)}},{name:"Status",value:"isActive",sortable:!1,hidden:!1,customRender:function(e,i){const o=e?.isActive?"Active":"Inactive",r=e?.isActive?"bg-success/15 text-success":"bg-muted text-muted-foreground";return s("span",{class:`px-2 py-1 rounded text-sm font-medium ${r}`},o)}},{name:"Date",value:"createdAt",sortable:!1,hidden:!1,customRender:function(e,i){return s("span",new Date(e?.createdAt).toLocaleDateString())}}]);let t=j({pageSize:50,afterCursor:"",beforeCursor:"",text:"",isActive:null,partial:null,clientUid:"",sortBy:["-uid"],filterAction:!1});const B=f(null),A=f(null);q(()=>{u()});async function u(){await m.searchBills({pageSize:t.pageSize,afterCursor:t.afterCursor||void 0,beforeCursor:t.beforeCursor||void 0,text:t.text||void 0,isActive:t.isActive!==null?t.isActive:void 0,partial:t.partial!==null?t.partial:void 0,clientUid:t.clientUid||void 0,sortBy:t.sortBy})}function k(e){e==="all"?t.partial=null:e==="partial"?t.partial=!0:e==="complete"&&(t.partial=!1),t.afterCursor="",t.beforeCursor="",t.filterAction=!0,B.value=e,u()}function T(e){e==="all"?t.isActive=null:e==="active"?t.isActive=!0:e==="inactive"&&(t.isActive=!1),t.afterCursor="",t.beforeCursor="",t.filterAction=!0,A.value=e,u()}function E(e){t.pageSize=100,t.afterCursor="",t.beforeCursor="",t.text=e.filterText,t.filterAction=!0,u()}function L(e){t.pageSize=e.fetchCount,t.afterCursor=d?.value?.endCursor??"",t.beforeCursor="",t.text=e.filterText,t.filterAction=!1,u()}function M(e){t.isActive=e,t.afterCursor="",t.beforeCursor="",t.filterAction=!0,u()}const U=J(()=>`${p?.value?.length} of ${d?.value?.totalCount??0} bills`),w={DataTable:x,BillDetail:a,billingStore:m,bills:p,billPageInfo:d,fetchingBills:c,showBillDetail:g,selectedBill:v,getStatusBadgeClass:C,openBillDetail:_,closeBillDetail:F,tableColumns:R,get billParams(){return t},set billParams(e){t=e},selectedPartial:B,selectedIsActive:A,fetchBills:u,handlePartialFilter:k,handleIsActiveFilter:T,searchBills:E,showMoreBills:L,filterByStatus:M,countNone:U};return Object.defineProperty(w,"__isScriptSetup",{enumerable:!1,value:!0}),w}}),ee={class:"space-y-6"},te={class:"rounded-lg border border-border bg-card shadow-sm p-4"},ae={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},se=["value"],le=["value"],ne={class:"rounded-lg border border-border bg-card shadow-sm p-6"};function oe(N,n,x,a,m,p){const d=G("beak-drawer");return S(),H(W,null,[l("div",ee,[l("div",te,[l("div",ae,[l("div",null,[n[3]||(n[3]=l("label",{class:"block text-sm font-medium text-foreground mb-2"},"Billing Type",-1)),l("select",{value:a.selectedPartial,onChange:n[0]||(n[0]=c=>a.handlePartialFilter(c.target.value)),class:"w-full px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary"},[...n[2]||(n[2]=[l("option",{value:"all"},"All Types",-1),l("option",{value:"complete"},"Complete Bills",-1),l("option",{value:"partial"},"Partial Bills",-1)])],40,se)]),l("div",null,[n[5]||(n[5]=l("label",{class:"block text-sm font-medium text-foreground mb-2"},"Bill Status",-1)),l("select",{value:a.selectedIsActive,onChange:n[1]||(n[1]=c=>a.handleIsActiveFilter(c.target.value)),class:"w-full px-3 py-2 border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary"},[...n[4]||(n[4]=[l("option",{value:"all"},"All Status",-1),l("option",{value:"active"},"Active",-1),l("option",{value:"inactive"},"Inactive",-1)])],40,le)])])]),l("div",ne,[D(a.DataTable,{columns:a.tableColumns,data:a.bills,toggleColumns:!0,loading:a.fetchingBills,paginable:!0,pageMeta:{fetchCount:a.billParams.pageSize,hasNextPage:a.billPageInfo?.hasNextPage,countNone:a.countNone},searchable:!0,filterable:!1,onOnSearch:a.searchBills,onOnPaginate:a.showMoreBills,selectable:!1},null,8,["columns","data","loading","pageMeta"])])]),D(d,{show:a.showBillDetail,onClose:a.closeBillDetail,"content-width":"w-2/4"},{header:I(()=>[...n[6]||(n[6]=[l("span",null,"Bill Details",-1)])]),body:I(()=>[a.selectedBill?(S(),K(a.BillDetail,{key:0,customerUid:a.selectedBill?.patientUid??"",testBill:a.selectedBill},null,8,["customerUid","testBill"])):Q("",!0)]),_:1},8,["show"])],64)}const de=Y(Z,[["render",oe],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/billing/BillingListing.vue"]]);export{de as default};
