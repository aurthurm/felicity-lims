const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BeakTreeItem-Bur97j0c.js","assets/index-DCVfsbos.js","assets/index-C_1sfwqa.css","assets/storage-C2DMRCPv.js"])))=>i.map(i=>d[i]);
import{a0 as O,ad as V,a5 as j,h as E,a1 as L,a6 as P,aS as B,_ as G,c as d,o as l,A as e,J as x,K as C,C as q,L as u,E as y,D as J,F as T,a9 as W,H,a as K}from"./index-DCVfsbos.js";import{u as Q}from"./samples-BrAyCdA1.js";import{u as X,a as Y}from"./storage-C2DMRCPv.js";import{b as Z,c as z,e as M,u as $}from"./index.esm-89YX2EbQ.js";import"./analyses.mutations-BEU63HnJ.js";import"./storage.mutations-CYc-ciRc.js";const ee=(_,t,S,s)=>{const f="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("").slice(0,_),n=Array.from({length:t},(r,a)=>a+1);if(S)return Array.from({length:(t??1)*_},(r,a)=>a+1).map(r=>({storageSlot:r.toString(),storageSlotIndex:r}));{const r=[];let a=1;return s?f.forEach((m,c)=>{n.forEach(h=>{r.push({storageSlot:m+h.toString(),storageSlotIndex:a}),a++})}):n.forEach(m=>{f.forEach((c,h)=>{r.push({storageSlot:c+m.toString(),storageSlotIndex:a}),a++})}),r}},se=O({__name:"StoreSamples",setup(_,{expose:t}){t();const S=L(()=>P(()=>import("./BeakTreeItem-Bur97j0c.js"),__vite__mapDeps([0,1,2,3]))),{treeData:s,tags:b,activeTree:f,resetActiveTree:n}=X();n();const r=Y(),{storeSamples:a}=Q();let m=JSON.parse(window.history.state.samples),c=[];const h=i=>{c=[],g.value.forEach(o=>{o.sampleUid&&c.push(o.sampleUid?.toString())})};V(()=>r.fetchStorageTree()),j(()=>f.value,(i,o)=>{i.tag==="storage-container"&&(r.fetchStorageContainer(i.uid),g.value=[])},{deep:!0});const p=E(()=>r.getStorageContainer),R=E(()=>{const i=r.getStorageContainer;return(i?.slots??0)-(i?.storedCount??0)}),w=()=>{m=[...m,...p.value?.samples??[]],g.value=[],ee(p.value?.cols??1,p.value?.rows??1,!p.value?.grid,p.value?.rowWise??!1).map(o=>({...o,storageContainerUid:p.value?.uid})).forEach(o=>{const v=m.filter(A=>A.storageSlotIndex===o.storageSlotIndex&&A.storageContainerUid===o.storageContainerUid);v.length>0&&(o={...o,sampleUid:v[0].uid},c.push(o.sampleUid.toString())),g.value.push({sampleUid:void 0,...o})})},U=z({samples:M().required().min(1,"Select At least one sample")}),{handleSubmit:I,errors:D}=$({validationSchema:U,initialValues:{priority:0,samples:p.value?.samples??[]}}),{value:g}=Z("samples"),F=i=>{g.value=g.value.map(o=>(o.sampleUid===i&&(o={...o,sampleUid:void 0}),o)),c=c.filter(o=>+o!==i)},N=I(async i=>{const o=i.samples.filter(v=>v.sampleUid);await a(o).then(async v=>{await r.fetchStorageContainer(o[0].storageContainerUid),w()})}),k={TreeItem:S,treeData:s,tags:b,activeTree:f,resetActiveTree:n,storageSrore:r,storeSamples:a,get samples(){return m},set samples(i){m=i},get assignedUids(){return c},set assignedUids(i){c=i},setAssigned:h,storageContainer:p,emptySlots:R,prepareSlots:w,formSchema:U,handleSubmit:I,errors:D,samplesData:g,removeSample:F,submitForm:N,get FontAwesomeIcon(){return B}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),te={class:"space-y-6"},oe={class:"grid grid-cols-12 gap-6 min-h-full"},ae={class:"col-span-2 bg-secondary rounded-lg shadow-sm p-4"},re={class:"space-y-2"},ne={class:"col-span-7 space-y-6"},ie={class:"bg-background rounded-lg shadow-sm p-6"},le={key:0},de={class:"grid grid-cols-2 gap-6"},ce={class:"space-y-4"},me={class:"flex items-center justify-between"},ue={class:"text-muted-foreground"},pe={class:"flex items-center justify-between"},ge={class:"flex items-center gap-2"},fe={class:"text-muted-foreground"},ve={key:0,class:"text-sm text-muted-foreground bg-muted px-2 py-1 rounded-md"},_e={class:"space-y-4"},Se={class:"flex items-center justify-between"},he={class:"text-muted-foreground"},ye={class:"flex items-center justify-between"},be={class:"text-muted-foreground"},xe={key:1,class:"text-muted-foreground"},Ce={class:"flex justify-end"},we={class:"space-y-4"},Ue={class:"col-span-1 text-muted-foreground"},Ie={class:"col-span-1 text-muted-foreground"},ke={class:"col-span-10"},Ae={class:"flex items-center gap-4"},Ee=["onUpdate:modelValue"],Te=["value"],Re=["onClick"],De={class:"flex justify-end pt-4"},Fe={key:0,type:"submit",class:"px-6 py-2 bg-destructive text-destructive-foreground rounded-md hover:bg-destructive/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-destructive/50"};function Ne(_,t,S,s,b,f){return l(),d("div",te,[t[8]||(t[8]=e("h4",{class:"text-xl font-semibold text-foreground"},"Store Samples",-1)),e("div",oe,[e("div",ae,[e("ul",re,[(l(!0),d(x,null,C(s.treeData,(n,r)=>(l(),q(s.TreeItem,{tree:n,key:r},null,8,["tree"]))),128))])]),e("div",ne,[e("div",ie,[s.activeTree.tag===s.tags.STORAGE_CONTAINER?(l(),d("div",le,[e("div",de,[e("div",ce,[e("div",me,[t[2]||(t[2]=e("span",{class:"font-medium text-foreground"},"Name",-1)),e("span",ue,u(s.storageContainer?.name),1)]),e("div",pe,[t[3]||(t[3]=e("span",{class:"font-medium text-foreground"},"Layout",-1)),e("div",ge,[e("span",fe,u(s.storageContainer?.grid?"grid":"column"),1),s.storageContainer?.grid?(l(),d("span",ve,u(s.storageContainer?.rowWise?"by-row":"by-column"),1)):y("v-if",!0)])])]),e("div",_e,[e("div",Se,[t[4]||(t[4]=e("span",{class:"font-medium text-foreground"},"Slots",-1)),e("span",he,u(s.storageContainer?.slots),1)]),e("div",ye,[t[5]||(t[5]=e("span",{class:"font-medium text-foreground"},"Empty Slots",-1)),e("span",be,u(s.emptySlots),1)])])])])):(l(),d("div",xe,"Please select a storage container"))]),e("div",Ce,[s.activeTree.tag===s.tags.STORAGE_CONTAINER?(l(),d("button",{key:0,onClick:t[0]||(t[0]=n=>s.prepareSlots()),class:"px-4 py-2 bg-primary text-primary-foreground rounded-md hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary/50"}," Reset Slots ")):y("v-if",!0)]),e("form",{action:"post",class:"bg-background rounded-lg shadow-sm p-6 space-y-6",onSubmit:t[1]||(t[1]=J((...n)=>s.submitForm&&s.submitForm(...n),["prevent"]))},[t[6]||(t[6]=e("div",{class:"grid grid-cols-12 gap-4 text-sm font-medium text-foreground"},[e("div",{class:"col-span-1"},"Position"),e("div",{class:"col-span-1"},"Label"),e("div",{class:"col-span-10"},"Sample")],-1)),e("div",we,[(l(!0),d(x,null,C(s.samplesData,(n,r)=>(l(),d("div",{key:r,class:"grid grid-cols-12 gap-4 items-center py-4 border-b border-border last:border-0"},[e("div",Ue,u(n.storageSlotIndex),1),e("div",Ie,u(n.storageSlot),1),e("div",ke,[e("div",Ae,[T(e("select",{name:"sampleUid",id:"sampleUid","onUpdate:modelValue":a=>n.sampleUid=a,class:"w-64 px-3 py-2 bg-background border border-border rounded-md focus:outline-none focus:ring-2 focus:ring-primary/50",onChange:s.setAssigned,"aria-label":"Select sample"},[(l(!0),d(x,null,C(s.samples,a=>T((l(),d("option",{key:a.uid,value:a.uid},u(a?.sampleId)+" ❲"+u(a?.analysisRequest?.clientRequestId)+"❳ ",9,Te)),[[H,!s.assignedUids.includes(a.uid.toString())]])),128))],40,Ee),[[W,n.sampleUid]]),n.sampleUid?(l(),d("button",{key:0,onClick:a=>s.removeSample(n.sampleUid),class:"text-destructive hover:text-destructive/80 transition-colors","aria-label":"Remove sample"},[K(s.FontAwesomeIcon,{icon:"ban"})],8,Re)):y("v-if",!0)])])]))),128))]),e("div",De,[s.activeTree.tag===s.tags.STORAGE_CONTAINER&&s.samples?.length>0?(l(),d("button",Fe," Store Samples ")):y("v-if",!0)])],32)]),t[7]||(t[7]=e("div",{class:"col-span-3"},null,-1))])])}const Ge=G(se,[["render",Ne],["__file","/home/administrator/Documents/Development/beak-insights/beak/beak-lims/webapp/views/sample/StoreSamples.vue"]]);export{Ge as default};
