const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/CommentSystem-CcLMGrLW.js","assets/index-DCVfsbos.js","assets/index-C_1sfwqa.css","assets/grind.queries-CepHqusz.js","assets/ErrandFile-C0kf1KDj.js","assets/ErrandFile-UJ1mDsT4.css","assets/ErrandMilestone-Bgfqi-91.js","assets/index-DKgQr4wR.js","assets/vue-multiselect.esm-CQe58Q7H.js","assets/ErrandMilestone-cHzfRvMf.css"])))=>i.map(i=>d[i]);
import{a0 as he,a7 as i,ad as xe,ac as _e,h as Q,f as ke,W as De,b3 as K,a4 as we,a1 as V,a6 as C,b4 as Ee,b1 as Te,_ as Ue,r as z,c as m,E as n,o as u,A as t,F as W,a as l,L as g,a2 as Me,M as Ve,C as Ce,H as Se,O as Be,Q as S,N as q}from"./index-DCVfsbos.js";import{p as J,f as B}from"./index-Cw3weLtk.js";import{a as Ae,b as Le,c as Pe,d as He,e as Ie}from"./grind.queries-CepHqusz.js";import{A as Re,a as Ye,b as Ne,B as Ge,c as Fe,E as je,H as Oe,I as Qe,d as Ke,e as ze,L as We,P as qe,S as Je,T as Xe,f as Ze,U as $e,g as et,C as tt}from"./index-BQ5jAWaE.js";import{Multiselect as ot}from"./vue-multiselect.esm-CQe58Q7H.js";import{r as rt}from"./ArrowLeftIcon-HJKXquEv.js";const at=he({__name:"ErrandDetail",setup(X,{expose:o}){o();const A=V(()=>C(()=>import("./CommentSystem-CcLMGrLW.js"),__vite__mapDeps([0,1,2,3]))),e=V(()=>C(()=>import("./ErrandFile-C0kf1KDj.js"),__vite__mapDeps([4,1,2,3,5]))),L=V(()=>C(()=>import("./ErrandMilestone-Bgfqi-91.js"),__vite__mapDeps([6,1,2,3,7,8,9]))),_=i(!1),y=i(null),k=i(tt);function a(){y.value={toolbar:{items:["undo","redo","|","heading","|","bold","italic","underline","|","link","insertTable","blockQuote","|","bulletedList","numberedList","todoList","outdent","indent"],shouldNotGroupWhenFull:!1},plugins:[Re,Ye,Ne,Ge,Fe,je,Oe,Qe,Ke,ze,We,qe,Je,Xe,Ze,$e,et],heading:{options:[{model:"paragraph",title:"Paragraph",class:"ck-heading_paragraph"},{model:"heading1",view:"h1",title:"Heading 1",class:"ck-heading_heading1"},{model:"heading2",view:"h2",title:"Heading 2",class:"ck-heading_heading2"},{model:"heading3",view:"h3",title:"Heading 3",class:"ck-heading_heading3"},{model:"heading4",view:"h4",title:"Heading 4",class:"ck-heading_heading4"},{model:"heading5",view:"h5",title:"Heading 5",class:"ck-heading_heading5"},{model:"heading6",view:"h6",title:"Heading 6",class:"ck-heading_heading6"}]},placeholder:"Begin typing..."},_.value=!0}xe(()=>{a(),h(),R(),N(),G()});const b=i("discussions"),p=_e(),D=Q(()=>p.params.errandUid),P=Q(()=>p.params.boardUid);let d=i();const{withClientQuery:v,withClientMutation:w}=ke();function h(){v(Ae,{uid:D.value},"grindErrandByUid").then(r=>{d.value=r;const s=J(d.value.startDate,!0)??new Date,f=J(d.value.endDate,!0)??new Date(new Date().setDate(s.getDate()+7));H.value=[s,f]})}function c(r){w(He,{uid:D.value,payload:r},"updateGrindErrand").then(()=>h())}const E=i(!1),T=i(null),Z=()=>{E.value=!0,Ee(()=>{T.value?.focus(),T.value?.select()})},$=()=>{E.value=!1,c({title:d.value?.title})},x=i(!1),U=i(""),ee=()=>{x.value=!0,U.value=d.value?.description??""},te=()=>{x.value=!1,c({description:d.value?.description})},oe=()=>{d.value.description=U.value,x.value=!1},H=i(),re=r=>{const s=r[0]?.getDate(),f=r[0]?.getMonth()+1,be=r[0]?.getFullYear(),pe=r[1]?.getDate(),ve=r[1]?.getMonth()+1,ye=r[1]?.getFullYear();return`${s}/${f}/${be} - ${pe}/${ve}/${ye}`},ae=r=>{if(r.length!==2){alert("Invalid date range");return}c({startDate:B(r[0],"YYYY-MM-DD HH:mm"),endDate:B(r[1],"YYYY-MM-DD HH:mm")})},I=i([]);function R(){v(Le,{boardUid:P.value},"grindPostersByBoard").then(r=>{I.value=r.filter(s=>s.uid!==d.value?.posterUid)})}function ne(r){c({posterUid:r.uid})}const Y=i();function N(){v(De,{first:100},"userAll").then(r=>{Y.value=r.items})}function se({firstName:r,lastName:s}){return`${r} ${s}`}function ie(r){c({assigneeUid:r.uid})}function de(r){c({reporterUid:r.uid})}function le(r){c({members:r.map(s=>s.uid)})}const ce=["Low","Normal","High","Critical"];function ue(r){c({priority:r})}const M=i([]);function G(){v(Pe,{category:K.Project},"grindStampByCategory").then(r=>{M.value=r})}function F(r){c({stamps:r?.map(s=>s.uid)})}const me=r=>{w(Ie,{payload:{title:r,category:K.Project}},"createGrindStamp").then(s=>{if(s.uid){M.value.push(s);const f=d.value?.stamps??[];f.push(s),F(f)}})},ge=()=>h(),j=we();function fe(){j.back()}const O={ErrandDiscussion:A,ErrandFile:e,ErrandMilestone:L,isLayoutReady:_,config:y,editor:k,initCKEditor:a,activeTab:b,route:p,errandUid:D,boardUid:P,get errand(){return d},set errand(r){d=r},withClientQuery:v,withClientMutation:w,getErrand:h,updateErrand:c,editingTitle:E,titleInput:T,startEditingTitle:Z,endEditingTitle:$,editingBody:x,originalDescription:U,startEditingBody:ee,saveDescription:te,cancelEditing:oe,dateRange:H,rangeFormat:re,handleDate:ae,posters:I,getPosters:R,updateStatus:ne,users:Y,getUsers:N,customLabel:se,updateAssignee:ie,updateReporter:de,updateMembers:le,priorities:ce,updatePriority:ue,stamps:M,getStamps:G,updateStamps:F,addStamp:me,handleMilestoneUpdated:ge,router:j,goBack:fe,get formatDate(){return B},get getUserInitials(){return Te},get Multiselect(){return ot},get ArrowLeftIcon(){return rt}};return Object.defineProperty(O,"__isScriptSetup",{enumerable:!1,value:!0}),O}}),nt={key:0,class:"bg-background rounded-lg shadow-sm border border-border"},st={class:"flex flex-col md:flex-row"},it={class:"flex-1 p-6 border-r border-border"},dt={class:"space-y-6 pb-6 border-b border-border"},lt={class:"flex justify-between items-center"},ct={class:"relative w-full"},ut={class:"flex items-center space-x-2 text-sm text-muted-foreground"},mt={class:"h-8 w-8 rounded-full bg-muted flex items-center justify-center text-destructive font-medium"},gt={class:"font-medium text-foreground"},ft=["innerHTML"],bt={key:1,class:"space-y-4"},pt={class:"prose max-w-none"},vt={class:"editor-container editor-container_balloon-editor",ref:"editorContainerElement"},yt={class:"editor-container__editor"},ht={ref:"editorElement"},xt={class:"flex items-center space-x-3 mt-6"},_t={class:"flex-1 h-2 bg-muted rounded-full overflow-hidden"},kt={class:"text-sm font-medium text-muted-foreground"},Dt={class:"border-b border-border mt-6"},wt={class:"flex space-x-1"},Et={class:"py-6"},Tt={key:0,class:"space-y-6"},Ut={key:1,class:"space-y-6"},Mt={key:2,class:"space-y-6"},Vt={class:"w-full md:w-80 p-6 border-l border-border"},Ct={class:"space-y-8"},St={class:"space-y-2"},Bt={class:"space-y-2"},At={class:"space-y-2"},Lt={class:"space-y-2"},Pt={class:"space-y-2"},Ht={class:"multiselect-tag bg-primary/10 text-primary px-2 py-1 rounded-md text-sm flex items-center space-x-1 hover:bg-primary/20 transition-colors duration-200"},It=["onClick"],Rt={class:"space-y-2"},Yt={class:"space-y-2"},Nt={class:"multiselect-tag bg-primary/10 text-primary px-2 py-1 rounded-md text-sm flex items-center space-x-1 hover:bg-primary/20 transition-colors duration-200"},Gt=["onClick"];function Ft(X,o,A,e,L,_){const y=z("ckeditor"),k=z("VueDatePicker");return e.errand?(u(),m("div",nt,[n(" Content area with sidebar "),t("div",st,[n(" Main content "),t("div",it,[n(" Header "),t("div",dt,[t("div",lt,[t("div",ct,[t("button",{onClick:e.goBack,class:"absolute -left-2 -top-2 p-1 text-muted-foreground hover:text-foreground transition-colors duration-200"},[l(e.ArrowLeftIcon,{class:"w-5 h-5"})]),e.editingTitle?W((u(),m("input",{key:1,type:"text","onUpdate:modelValue":o[0]||(o[0]=a=>e.errand.title=a),onBlur:e.endEditingTitle,onKeyup:Ve(e.endEditingTitle,["enter"]),ref:"titleInput",class:"text-2xl font-semibold text-foreground w-full px-3 py-2 border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-background"},null,544)),[[Me,e.errand.title]]):(u(),m("h1",{key:0,onClick:e.startEditingTitle,class:"text-3xl font-bold text-foreground cursor-pointer hover:bg-muted rounded px-2 py-1 transition-colors duration-200"},g(e.errand.title),1))])]),t("div",ut,[t("div",mt,g(e.getUserInitials(e.errand.createdBy?.firstName,e.errand.createdBy?.lastName)),1),o[12]||(o[12]=t("span",null,"by",-1)),t("span",gt,g(e.errand.createdBy?.firstName)+" "+g(e.errand.createdBy?.lastName),1),t("span",null,"on "+g(e.formatDate(e.errand.createdAt,"D MMMM YYYY")),1)]),e.editingBody?(u(),m("div",bt,[t("div",pt,[t("div",vt,[t("div",yt,[t("div",ht,[e.isLayoutReady?(u(),Ce(y,{key:0,modelValue:e.errand.description,"onUpdate:modelValue":o[1]||(o[1]=a=>e.errand.description=a),editor:e.editor,config:e.config,"tag-name":"textarea",class:"ck-editor"},null,8,["modelValue","editor","config"])):n("v-if",!0)],512)])],512)]),t("div",{class:"flex space-x-3"},[t("button",{onClick:e.saveDescription,class:"px-4 py-2 text-sm font-medium text-primary-foreground bg-primary border border-transparent rounded-md shadow-sm hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors duration-200"}," Save "),t("button",{onClick:e.cancelEditing,class:"px-4 py-2 text-sm font-medium text-foreground bg-background border border-border rounded-md shadow-sm hover:bg-muted focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors duration-200"}," Cancel ")])])):(u(),m("div",{key:0,class:"prose max-w-none",onClick:e.startEditingBody},[e.errand.description?(u(),m("article",{key:0,class:"text-lg text-foreground",innerHTML:e.errand.description},null,8,ft)):n("v-if",!0)]))]),n(" Progress Bar "),W(t("div",xt,[t("div",_t,[t("div",{class:"h-full bg-success rounded-full transition-all duration-300",style:Be(`width: ${e.errand?.milestonesAt}%`)},null,4)]),t("span",kt,g(e.errand?.milestonesAt)+"%",1)],512),[[Se,e.errand?.milestonesAt]]),n(" Tabs "),t("div",Dt,[t("div",wt,[t("button",{onClick:o[2]||(o[2]=a=>e.activeTab="discussions"),class:S(["py-3 px-4 text-sm font-medium border-b-2 transition-colors duration-200 focus:outline-none",e.activeTab==="discussions"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"])}," Discussions ",2),t("button",{onClick:o[3]||(o[3]=a=>e.activeTab="milestones"),class:S(["py-3 px-4 text-sm font-medium border-b-2 transition-colors duration-200 focus:outline-none",e.activeTab==="milestones"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"])}," Milestones ",2),t("button",{onClick:o[4]||(o[4]=a=>e.activeTab="files"),class:S(["py-3 px-4 text-sm font-medium border-b-2 transition-colors duration-200 focus:outline-none",e.activeTab==="files"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground"])}," Files ",2)])]),n(" Tab Content "),t("div",Et,[n(" Discussions Tab "),e.activeTab==="discussions"?(u(),m("div",Tt,[l(e.ErrandDiscussion,{errandUid:e.errand.uid},null,8,["errandUid"])])):n("v-if",!0),n(" Milestones Tab "),e.activeTab==="milestones"?(u(),m("div",Ut,[l(e.ErrandMilestone,{errandUid:e.errand.uid,onMilestoneUpdated:e.handleMilestoneUpdated},null,8,["errandUid"])])):n("v-if",!0),n(" Files Tab "),e.activeTab==="files"?(u(),m("div",Mt,[l(e.ErrandFile,{errandUid:e.errand.uid},null,8,["errandUid"])])):n("v-if",!0)])]),n(" Sidebar "),t("div",Vt,[t("div",Ct,[n(" Dates "),t("div",St,[o[13]||(o[13]=t("label",{class:"block text-sm font-medium text-foreground"},"Date Range",-1)),l(k,{class:"w-full",modelValue:e.dateRange,"onUpdate:modelValue":[o[5]||(o[5]=a=>e.dateRange=a),e.handleDate],range:"",format:e.rangeFormat},null,8,["modelValue"])]),n(" Status "),t("div",Bt,[o[14]||(o[14]=t("label",{class:"block text-sm font-medium text-foreground"},"Status",-1)),l(e.Multiselect,{modelValue:e.errand.poster,"onUpdate:modelValue":[o[6]||(o[6]=a=>e.errand.poster=a),e.updateStatus],options:e.posters,label:"title","track-by":"uid",placeholder:"Select status",class:"multiselect-primary"},null,8,["modelValue","options"])]),n(" Assignee "),t("div",At,[o[15]||(o[15]=t("label",{class:"block text-sm font-medium text-foreground"},"Assignee",-1)),l(e.Multiselect,{modelValue:e.errand.assignee,"onUpdate:modelValue":[o[7]||(o[7]=a=>e.errand.assignee=a),e.updateAssignee],options:e.users,"track-by":"uid",searchable:!0,"custom-label":e.customLabel,placeholder:"Select assignee",class:"multiselect-primary"},null,8,["modelValue","options"])]),n(" Reporter "),t("div",Lt,[o[16]||(o[16]=t("label",{class:"block text-sm font-medium text-foreground"},"Reporter",-1)),l(e.Multiselect,{modelValue:e.errand.reporter,"onUpdate:modelValue":[o[8]||(o[8]=a=>e.errand.reporter=a),e.updateReporter],options:e.users,"track-by":"uid",searchable:!0,"custom-label":e.customLabel,placeholder:"Select reporter",class:"multiselect-primary"},null,8,["modelValue","options"])]),n(" Team Members "),t("div",Pt,[o[17]||(o[17]=t("label",{class:"block text-sm font-medium text-foreground"},"Team Members",-1)),l(e.Multiselect,{modelValue:e.errand.members,"onUpdate:modelValue":[o[9]||(o[9]=a=>e.errand.members=a),e.updateMembers],options:e.users,multiple:!0,searchable:!0,"custom-label":e.customLabel,"track-by":"uid",placeholder:"Select members",class:"multiselect-primary"},{tag:q(({option:a,remove:b})=>[t("div",Ht,[t("span",null,g(a.firstName)+" "+g(a.lastName),1),t("button",{onClick:p=>b(a),class:"text-primary hover:text-primary/80 focus:outline-none transition-colors duration-200"}," × ",8,It)])]),_:1},8,["modelValue","options"])]),n(" Priority "),t("div",Rt,[o[18]||(o[18]=t("label",{class:"block text-sm font-medium text-foreground"},"Priority",-1)),l(e.Multiselect,{modelValue:e.errand.priority,"onUpdate:modelValue":[o[10]||(o[10]=a=>e.errand.priority=a),e.updatePriority],options:e.priorities,searchable:!1,"show-labels":!1,placeholder:"Select priority",class:"multiselect-primary"},null,8,["modelValue"])]),n(" Tags "),t("div",Yt,[o[19]||(o[19]=t("label",{class:"block text-sm font-medium text-foreground"},"Tags",-1)),l(e.Multiselect,{modelValue:e.errand.stamps,"onUpdate:modelValue":[o[11]||(o[11]=a=>e.errand.stamps=a),e.updateStamps],options:e.stamps,multiple:!0,taggable:!0,searchable:!0,"track-by":"uid","show-labels":!1,placeholder:"Select or add tags",onTag:e.addStamp,"custom-label":({title:a})=>`${a}`,class:"multiselect-primary"},{tag:q(({option:a,remove:b})=>[t("div",Nt,[t("span",null,g(a.title),1),t("button",{onClick:p=>b(a),class:"text-primary hover:text-primary/80 focus:outline-none transition-colors duration-200"}," × ",8,Gt)])]),_:1},8,["modelValue","options","custom-label"])])])])])])):n("v-if",!0)}const qt=Ue(at,[["render",Ft],["__scopeId","data-v-2d23bea1"],["__file","/home/administrator/Documents/Development/beak-insights/beak/beak-lims/webapp/views/grind/_id/ErrandDetail.vue"]]);export{qt as default};
