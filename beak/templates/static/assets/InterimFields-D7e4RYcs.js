const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DCVfsbos.js","assets/index-C_1sfwqa.css"])))=>i.map(i=>d[i]);
import{a0 as z,f as G,t as H,a7 as v,a5 as Q,h as X,a1 as Z,a6 as j,_ as $,r as N,c as a,o as i,a as D,A as e,E as m,C as ee,N as x,P as te,J as h,K as T,L as d,D as re,F as k,a9 as oe,a2 as R}from"./index-DCVfsbos.js";import{c as se,a as q,d as ne,u as ie,b as w}from"./index.esm-89YX2EbQ.js";import{B as ae,D as de}from"./analyses.mutations-BEU63HnJ.js";import{u as le}from"./analysis-BI7XPyQA.js";import{u as ue}from"./setup-DMRnqeyP.js";const me=z({__name:"InterimFields",props:{analysis:{type:Object,required:!0,default:()=>({})},analysisUid:{type:String,required:!0,default:0}},setup(I,{expose:t}){t();const E=Z(()=>j(()=>import("./index-DCVfsbos.js").then(s=>s.cl),__vite__mapDeps([0,1]))),r=le(),c=ue(),{withClientMutation:f}=G(),l=I,{analysis:b}=H(l);let o=v(!1),p=v("");const y=v(!0),u=v(null),U=se({instrumentUid:q().trim().required("Instrument is required"),key:ne().typeError("Interim key must be a number").integer("Interim key must be an integer").required("Interim key is required"),value:q().trim().required("Result value is required")}),{handleSubmit:A,resetForm:F,setValues:S}=ie({validationSchema:U,initialValues:{instrumentUid:"",key:"",value:""}}),{value:K,errorMessage:B}=w("instrumentUid"),{value:L,errorMessage:O}=w("key"),{value:P,errorMessage:J}=w("value");Q(()=>l.analysisUid,(s,n)=>{}),c.fetchInstruments();const _=X(()=>c.getInstruments);function M(s){f(ae,{payload:s},"createAnalysisInterim").then(n=>r.addAnalysisInterim(n))}function V(s){u.value&&f(de,{uid:u.value,payload:s},"updateAnalysisInterim").then(n=>r.updateAnalysisInterim(n))}function W(s,n={}){y.value=s,o.value=!0,p.value=(s?"CREATE":"EDIT")+" ANALYSIS INTERIM",s?(u.value=null,F({values:{instrumentUid:"",key:"",value:""}})):(u.value=n.uid??null,S({instrumentUid:n.instrumentUid??"",key:n.key??"",value:n.value??""}))}const Y=A(s=>{const n=b?.value?.uid;if(!n)return;const g={instrumentUid:s.instrumentUid,key:Number(s.key),value:s.value,analysisUid:n};y.value===!0&&M(g),y.value===!1&&V(g),o.value=!1}),C={modal:E,analysisStore:r,setupStore:c,withClientMutation:f,props:l,analysis:b,get showModal(){return o},set showModal(s){o=s},get formTitle(){return p},set formTitle(s){p=s},formAction:y,currentUid:u,interimSchema:U,handleSubmit:A,resetForm:F,setValues:S,instrumentUid:K,instrumentError:B,interimKey:L,keyError:O,interimValue:P,valueError:J,instruments:_,addAnalysisInterim:M,editAnalysisInterim:V,FormManager:W,saveForm:Y,instrumentName:s=>{const n=_?.value?.findIndex(g=>g.uid===s);return _?.value[n]?.name||"unknown"}};return Object.defineProperty(C,"__isScriptSetup",{enumerable:!1,value:!0}),C}}),ce={class:"overflow-x-auto mt-4"},fe={class:"align-middle inline-block min-w-full shadow overflow-hidden bg-card text-card-foreground rounded-lg border border-border"},be={class:"min-w-full beak-table"},pe={class:"bg-card"},ye={class:"px-4 py-2 whitespace-nowrap border-b border-border"},ge={class:"text-sm text-foreground"},ve={class:"px-4 py-2 whitespace-nowrap border-b border-border"},xe={class:"text-sm text-foreground"},_e={class:"px-4 py-2 whitespace-nowrap border-b border-border"},he={class:"text-sm text-foreground"},ke={class:"px-4 py-2 whitespace-nowrap text-right border-b border-border"},we=["onClick"],Ie={class:"text-lg font-bold text-foreground"},Ee={class:"space-y-4"},Ue={class:"grid grid-cols-3 gap-4"},Ae={class:"space-y-2"},Fe=["value"],Se={key:0,class:"text-sm text-destructive"},Me={class:"space-y-2"},Ve={key:0,class:"text-sm text-destructive"},Ce={class:"space-y-2"},Ne={key:0,class:"text-sm text-destructive"};function De(I,t,E,r,c,f){const l=N("beak-button"),b=N("beak-heading");return i(),a(h,null,[D(b,{title:"Interim Fields"},{default:x(()=>[D(l,{onClick:t[0]||(t[0]=o=>r.FormManager(!0))},{default:x(()=>[...t[6]||(t[6]=[te("Add Interim Field",-1)])]),_:1})]),_:1}),e("div",ce,[e("div",fe,[e("table",be,[t[7]||(t[7]=e("thead",null,[e("tr",null,[e("th",{class:"px-4 py-2 border-b border-border text-left text-sm font-medium text-muted-foreground"},"Interim Key"),e("th",{class:"px-4 py-2 border-b border-border text-left text-sm font-medium text-muted-foreground"},"Result Value"),e("th",{class:"px-4 py-2 border-b border-border text-left text-sm font-medium text-muted-foreground"},"Instrument"),e("th",{class:"px-4 py-2 border-b border-border"})])],-1)),e("tbody",pe,[(i(!0),a(h,null,T(r.analysis?.interims,o=>(i(),a("tr",{key:o?.uid,class:"hover:bg-accent/50"},[e("td",ye,[e("div",ge,d(o?.key),1)]),e("td",ve,[e("div",xe,d(o?.value),1)]),e("td",_e,[e("div",he,d(r.instrumentName(o?.instrumentUid)),1)]),e("td",ke,[e("button",{onClick:p=>r.FormManager(!1,o),class:"px-2 py-1 mr-2 border border-border bg-background text-foreground transition-colors duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-ring hover:bg-accent hover:text-accent-foreground"}," Edit ",8,we)])]))),128))])])])]),m(" Result Options Form Modal "),r.showModal?(i(),ee(r.modal,{key:0,onClose:t[5]||(t[5]=o=>r.showModal=!1),contentWidth:"w-2/4"},{header:x(()=>[e("h3",Ie,d(r.formTitle),1)]),body:x(()=>[e("form",{onSubmit:t[4]||(t[4]=re((...o)=>r.saveForm&&r.saveForm(...o),["prevent"])),class:"p-6 space-y-6"},[e("div",Ee,[e("div",Ue,[e("label",Ae,[t[9]||(t[9]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Instrument",-1)),k(e("select",{class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":t[1]||(t[1]=o=>r.instrumentUid=o)},[t[8]||(t[8]=e("option",{value:""},"Select Instrument",-1)),(i(!0),a(h,null,T(r.instruments,o=>(i(),a("option",{key:o?.uid,value:o.uid},d(o?.name),9,Fe))),128))],512),[[oe,r.instrumentUid]]),r.instrumentError?(i(),a("p",Se,d(r.instrumentError),1)):m("v-if",!0)]),e("label",Me,[t[10]||(t[10]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Interim",-1)),k(e("input",{type:"number",class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":t[2]||(t[2]=o=>r.interimKey=o),placeholder:"Interim Key ..."},null,512),[[R,r.interimKey]]),r.keyError?(i(),a("p",Ve,d(r.keyError),1)):m("v-if",!0)]),e("label",Ce,[t[11]||(t[11]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Result",-1)),k(e("input",{type:"text",class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":t[3]||(t[3]=o=>r.interimValue=o),placeholder:"Result Value ..."},null,512),[[R,r.interimValue]]),r.valueError?(i(),a("p",Ne,d(r.valueError),1)):m("v-if",!0)])])]),t[12]||(t[12]=e("div",{class:"pt-4"},[e("button",{type:"submit",class:"w-full bg-primary text-primary-foreground hover:bg-primary/90 rounded-lg px-4 py-2 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-ring"}," Save Form ")],-1))],32)]),_:1})):m("v-if",!0)],64)}const Oe=$(me,[["render",De],["__file","/home/administrator/Documents/Development/beak-insights/beak/beak-lims/webapp/views/admin/analyses/services/InterimFields.vue"]]);export{Oe as default};
