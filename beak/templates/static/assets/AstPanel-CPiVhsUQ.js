import{a0 as te,f as se,a7 as u,ad as oe,ak as ie,_ as ne,r as M,c as a,o as r,a as G,A as e,E as f,C as re,N as k,P as ae,J as v,K as _,L as c,D as le,F as x,a2 as O,a3 as z}from"./index-DCVfsbos.js";import{c as de,e as J,a as T,u as ce,b as S}from"./index.esm-89YX2EbQ.js";import{g as ue,a as me,X as fe,Y as be,Z as ge}from"./microbiology.mutations-CV_wjL4A.js";const ve=te({__name:"AstPanel",setup(K,{expose:s}){s();const{withClientMutation:y,withClientQuery:t}=se(),w=u(!1),P=u(""),p=u(!0),g=u(null),h=u(""),o=u(""),i=u([]),m=u([]),A=u([]),b=u([]),C=u([]),L=de({name:T().trim().required("Panel name is required"),selectedAntibiotics:J().of(T().trim()).min(1,"Select at least one antibiotic"),selectedOrganisms:J().of(T().trim()).min(1,"Select at least one organism")}),{handleSubmit:E,resetForm:V,setValues:N,errors:Q}=ce({validationSchema:L,initialValues:{name:"",description:"",selectedAntibiotics:[],selectedOrganisms:[]}}),{value:W}=S("name"),{value:X}=S("description"),{value:Y}=S("selectedAntibiotics"),{value:j}=S("selectedOrganisms");oe(()=>{B(),D(),U()});function B(){t(ue,{},"abxLaboratoryAntibiotics").then(n=>{n&&(m.value=n,A.value=[...m.value])})}function D(){t(me,{text:h.value,pageSize:25,sortBy:["name"]},"abxOrganismAll").then(n=>{b.value=b.value?.filter(l=>j.value.includes(l.uid))||[],b.value=ie(b.value,n?.items,"uid"),C.value=[...b.value]})}function U(){t(fe,{},"abxAstPanelAll").then(n=>{n&&(i.value=n,i.value.forEach(l=>l.organisms?.forEach(d=>b.value.push(d))))})}function Z(n,l={}){p.value=n,w.value=!0,P.value=(n?"Create":"Edit")+" AST Panel",n?(g.value=null,V()):(g.value=l.uid??null,N({name:l.name??"",description:l.description??"",selectedAntibiotics:l.antibiotics?.map(d=>d.uid)||[],selectedOrganisms:l.organisms?.map(d=>d.uid)||[]}))}const H=E(n=>{const l={name:n.name,description:n.description,antibiotics:n.selectedAntibiotics,organisms:n.selectedOrganisms};p.value?y(be,{payload:l},"createAbxAstPanel").then(d=>{d&&i.value.unshift(d)}):g.value&&y(ge,{uid:g.value,payload:l},"updateAbxAstPanel").then(d=>{if(d){const q=i.value.findIndex(F=>F.uid===d.uid);q>-1&&(i.value=[...i.value.map((F,ee)=>ee===q?d:F)])}}),w.value=!1});function R(){if(!o.value){A.value=[...m.value];return}A.value=m.value.filter(n=>n.name.toLowerCase().includes(o.value.toLowerCase()))}function $(){if(!h.value){C.value=[...b.value];return}D()}const I={withClientMutation:y,withClientQuery:t,showModal:w,formTitle:P,formAction:p,currentUid:g,searchOrgText:h,searchAbxText:o,panels:i,antibiotics:m,filteredAntibiotics:A,organisms:b,filteredOrganisms:C,astPanelSchema:L,handleSubmit:E,resetForm:V,setValues:N,errors:Q,name:W,description:X,selectedAntibiotics:Y,selectedOrganisms:j,fetchAntibiotics:B,fetchOrganisms:D,fetchPanels:U,FormManager:Z,saveForm:H,filterAntibiotics:R,filterOrganisms:$};return Object.defineProperty(I,"__isScriptSetup",{enumerable:!1,value:!0}),I}}),xe={class:"overflow-x-auto"},pe={class:"align-middle inline-block min-w-full shadow overflow-hidden bg-background shadow-dashboard rounded-lg"},he={class:"min-w-full divide-y divide-border beak-table"},_e={class:"bg-background divide-y divide-border"},ye={class:"whitespace-nowrap text-sm text-foreground"},we={class:"whitespace-nowrap text-sm text-foreground"},Ae={class:"whitespace-nowrap text-sm text-foreground"},ke={class:"whitespace-nowrap text-sm text-foreground"},Oe={class:"whitespace-nowrap text-right text-sm"},Se=["onClick"],Pe={class:"text-xl font-semibold text-foreground"},Ce={class:"space-y-4"},De={class:"grid grid-cols-1 gap-4"},Fe={class:"block"},Me={key:0,class:"text-sm text-destructive"},Te={class:"block"},Le={class:"flex gap-4"},Ee={class:"w-2/3 space-y-2"},Ve={class:"block"},Ne={class:"border border-border rounded-md p-2 h-64 overflow-y-auto"},je=["value"],Be={class:"ml-2 text-sm text-foreground"},Ue={key:0,class:"text-sm text-destructive"},Ie={class:"w-1/3"},qe={class:"border border-border rounded-md p-2 h-72 overflow-y-auto bg-background"},Ge={class:"text-sm text-foreground"},ze=["onClick"],Je={class:"flex gap-4"},Ke={class:"w-2/3 space-y-2"},Qe={class:"block"},We={class:"border border-border rounded-md p-2 h-64 overflow-y-auto"},Xe=["value"],Ye={class:"ml-2 text-sm text-foreground"},Ze={key:0,class:"text-sm text-destructive"},He={class:"w-1/3"},Re={class:"border border-border rounded-md p-2 h-72 overflow-y-auto bg-background"},$e={class:"text-sm text-foreground"},et=["onClick"];function tt(K,s,y,t,w,P){const p=M("beak-button"),g=M("beak-heading"),h=M("beak-modal");return r(),a(v,null,[G(g,{title:"AST Panels"},{default:k(()=>[G(p,{onClick:s[0]||(s[0]=o=>t.FormManager(!0))},{default:k(()=>[...s[9]||(s[9]=[ae("Add Panel",-1)])]),_:1})]),_:1}),e("div",xe,[e("div",pe,[e("table",he,[s[10]||(s[10]=e("thead",null,[e("tr",null,[e("th",{class:"text-left text-sm font-semibold text-foreground"},"Name"),e("th",{class:"text-left text-sm font-semibold text-foreground"},"Description"),e("th",{class:"text-left text-sm font-semibold text-foreground"},"Organisms"),e("th",{class:"text-left text-sm font-semibold text-foreground"},"Antibiotics"),e("th",{class:""})])],-1)),e("tbody",_e,[(r(!0),a(v,null,_(t.panels,o=>(r(),a("tr",{key:o?.uid},[e("td",ye,c(o?.name),1),e("td",we,c(o?.description),1),e("td",Ae,c(o?.organisms?.map(i=>i.name).join(", ")),1),e("td",ke,c(o?.antibiotics?.map(i=>i.name).join(", ")),1),e("td",Oe,[e("button",{onClick:i=>t.FormManager(!1,o),class:"px-3 py-1.5 bg-primary text-primary-foreground rounded-sm transition duration-300 hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Edit ",8,Se)])]))),128))])])])]),f(" Panel Form Modal "),t.showModal?(r(),re(h,{key:0,onClose:s[8]||(s[8]=o=>t.showModal=!1),contentWidth:"w-1/2"},{header:k(()=>[e("h3",Pe,c(t.formTitle),1)]),body:k(()=>[e("form",{onSubmit:s[7]||(s[7]=le((...o)=>t.saveForm&&t.saveForm(...o),["prevent"])),class:"space-y-6 p-4"},[e("div",Ce,[e("div",De,[e("label",Fe,[s[11]||(s[11]=e("span",{class:"text-sm font-medium text-foreground"},"Panel Name",-1)),x(e("input",{"onUpdate:modelValue":s[1]||(s[1]=o=>t.name=o),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:"Enter panel name"},null,512),[[O,t.name]]),t.errors.name?(r(),a("p",Me,c(t.errors.name),1)):f("v-if",!0)]),e("label",Te,[s[12]||(s[12]=e("span",{class:"text-sm font-medium text-foreground"},"Description",-1)),x(e("textarea",{"onUpdate:modelValue":s[2]||(s[2]=o=>t.description=o),rows:"2",class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:"Enter description"},null,512),[[O,t.description]])])]),f(" Organisms Selection with Selected List "),e("div",Le,[e("div",Ee,[e("label",Ve,[s[13]||(s[13]=e("span",{class:"text-sm font-medium text-foreground"},"Search Organisms",-1)),x(e("input",{"onUpdate:modelValue":s[3]||(s[3]=o=>t.searchOrgText=o),onInput:t.filterOrganisms,class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:"Search organisms..."},null,544),[[O,t.searchOrgText]])]),e("div",Ne,[(r(!0),a(v,null,_(t.filteredOrganisms,o=>(r(),a("div",{key:o.uid,class:"flex items-center py-1"},[x(e("input",{type:"checkbox",value:o.uid,"onUpdate:modelValue":s[4]||(s[4]=i=>t.selectedOrganisms=i),class:"rounded border-border text-primary shadow-sm focus:border-primary focus:ring focus:ring-primary/50"},null,8,je),[[z,t.selectedOrganisms]]),e("span",Be,c(o.name),1)]))),128))]),t.errors.selectedOrganisms?(r(),a("p",Ue,c(t.errors.selectedOrganisms),1)):f("v-if",!0)]),f(" Selected Organisms List "),e("div",Ie,[s[14]||(s[14]=e("div",{class:"text-sm font-medium text-foreground mb-1"},"Selected Organisms",-1)),e("div",qe,[(r(!0),a(v,null,_(t.selectedOrganisms,o=>(r(),a("div",{key:o,class:"flex items-center justify-between py-1 px-2 mb-1 bg-background rounded-md shadow-sm"},[e("span",Ge,c(t.organisms?.find(i=>i.uid===o)?.name),1),e("button",{onClick:i=>t.selectedOrganisms=t.selectedOrganisms.filter(m=>m!==o),class:"text-destructive hover:text-destructive/80 text-sm"}," × ",8,ze)]))),128))])])]),f(" Antibiotics Selection with Selected List "),e("div",Je,[e("div",Ke,[e("label",Qe,[s[15]||(s[15]=e("span",{class:"text-sm font-medium text-foreground"},"Search Antibiotics",-1)),x(e("input",{"onUpdate:modelValue":s[5]||(s[5]=o=>t.searchAbxText=o),onInput:t.filterAntibiotics,class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",placeholder:"Search antibiotics..."},null,544),[[O,t.searchAbxText]])]),e("div",We,[(r(!0),a(v,null,_(t.filteredAntibiotics,o=>(r(),a("div",{key:o.uid,class:"flex items-center py-1"},[x(e("input",{type:"checkbox",value:o.uid,"onUpdate:modelValue":s[6]||(s[6]=i=>t.selectedAntibiotics=i),class:"rounded border-border text-primary shadow-sm focus:border-primary focus:ring focus:ring-primary/50"},null,8,Xe),[[z,t.selectedAntibiotics]]),e("span",Ye,c(o.name),1)]))),128))]),t.errors.selectedAntibiotics?(r(),a("p",Ze,c(t.errors.selectedAntibiotics),1)):f("v-if",!0)]),f(" Selected Antibiotics List "),e("div",He,[s[16]||(s[16]=e("div",{class:"text-sm font-medium text-foreground mb-1"},"Selected Antibiotics",-1)),e("div",Re,[(r(!0),a(v,null,_(t.selectedAntibiotics,o=>(r(),a("div",{key:o,class:"flex items-center justify-between py-1 px-2 mb-1 bg-background rounded-md shadow-sm"},[e("span",$e,c(t.antibiotics.find(i=>i.uid==o)?.name),1),e("button",{onClick:i=>t.selectedAntibiotics=t.selectedAntibiotics.filter(m=>m!==o),class:"text-destructive hover:text-destructive/80 text-sm"}," × ",8,et)]))),128))])])])]),s[17]||(s[17]=e("div",{class:"mt-6"},[e("button",{type:"submit",class:"w-full bg-primary text-primary-foreground rounded-sm px-4 py-2 transition-colors duration-300 hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Save Panel ")],-1))],32)]),_:1})):f("v-if",!0)],64)}const nt=ne(ve,[["render",tt],["__scopeId","data-v-195d3b3a"],["__file","/home/administrator/Documents/Development/beak-insights/beak/beak-lims/webapp/views/admin/microbiology/astpanel/AstPanel.vue"]]);export{nt as default};
