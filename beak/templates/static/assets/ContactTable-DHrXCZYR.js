import{a0 as F,ac as U,f as A,aq as S,a7 as b,_ as V,r as T,c as f,o as u,E as p,A as e,C as R,F as s,H as v,J as N,K as j,L as m,P as L,a as q,N as E,a2 as x,D as B}from"./index-DCVfsbos.js";import{a as I,b as O,D as H}from"./clients.mutations-DUBsbRkU.js";import{u as J}from"./client-B-7vfgTR.js";import{s as K}from"./index-BaPnjn4Y.js";import"./location-DdmSnePa.js";const z=F({__name:"ContactTable",setup(D,{expose:o}){o();let l=J(),t=U();const{withClientMutation:d}=A(),{clientContacts:_,fetchingClientContacts:h}=S(l);let c=b(""),r=b(!1),i=b(!1),a=b({});const C=t.query.clientUid||"";C&&l.fetchClientContacts(C);function y(){d(I,{payload:{clientUid:t.query.clientUid,firstName:a.value.firstName,mobilePhone:a.value.mobilePhone,email:a.value.email}},"createClientContact").then(n=>l.addClientContact(n))}function w(){d(O,{uid:a.value.uid,payload:{clientUid:t.query.clientUid,firstName:a.value.firstName,mobilePhone:a.value.mobilePhone,email:a.value.email}},"updateClientContact").then(n=>l.updateClientContact(n))}function M(n,g={}){i.value=n,c.value=(n?"CREATE":"EDIT")+" CONTACT",r.value=!0,n?Object.assign(a,{}):Object.assign(a.value,{...g})}function P(){i.value===!0&&y(),i.value||w(),r.value=!1}const k={get clientStore(){return l},set clientStore(n){l=n},get router(){return t},set router(n){t=n},withClientMutation:d,clientContacts:_,fetchingClientContacts:h,get formTitle(){return c},set formTitle(n){c=n},get showContactModal(){return r},set showContactModal(n){r=n},get createContact(){return i},set createContact(n){i=n},get contact(){return a},set contact(n){a=n},clientUid:C,addClientContact:y,editClientContact:w,FormManager:M,saveForm:P,deleteClientContact:n=>{d(H,{uid:n.uid},"deleteClientContact").then(g=>{g&&l.deleteClientContact(n.uid)})},get shield(){return K}};return Object.defineProperty(k,"__isScriptSetup",{enumerable:!1,value:!0}),k}}),G={class:"overflow-x-auto"},Q={class:"align-middle inline-block min-w-full shadow overflow-hidden bg-background shadow-dashboard px-2 pt-1 rounded-bl-lg rounded-br-lg"},W={class:"min-w-full beak-table"},X={class:"bg-background"},Y={class:"px-1 py-1 whitespace-nowrap border-b border-border"},Z={class:"flex items-center"},$={class:"text-sm leading-5 text-foreground"},ee={class:"px-1 py-1 whitespace-nowrap border-b border-border"},te={class:"text-sm leading-5 text-primary"},oe={class:"px-1 py-1 whitespace-nowrap border-b border-border"},ne={class:"text-sm leading-5 text-primary"},re={class:"px-1 py-1 whitespace-nowrap text-right border-b border-border text-sm leading-5"},ae=["onClick"],le=["onClick"],ie={key:0,class:"py-4 text-center"},se={action:"post",class:"p-1"},de={class:"grid grid-cols-2 gap-x-4 mb-4"},ce={class:"block col-span-1 mb-2"},ue={class:"block col-span-1 mb-2"},me={class:"block col-span-1 mb-2"};function be(D,o,l,t,d,_){const h=T("beak-loader"),c=T("beak-modal");return u(),f(N,null,[p(" Contacts Table View "),e("div",G,[s(e("button",{onClick:o[0]||(o[0]=r=>t.FormManager(!0)),class:"px-1 py-0 mb-4 border-primary border text-primary rounded-sm transition duration-300 hover:bg-primary hover:text-primary-foreground focus:outline-none"}," Add Contact ",512),[[v,t.shield.hasRights(t.shield.actions.CREATE,t.shield.objects.CLIENT)]]),e("div",Q,[e("table",W,[o[7]||(o[7]=e("thead",null,[e("tr",null,[e("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Full Name "),e("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Email "),e("th",{class:"px-1 py-1 border-b-2 border-border text-left text-sm leading-4 text-foreground tracking-wider"}," Phone "),e("th",{class:"px-1 py-1 border-b-2 border-border"})])],-1)),e("tbody",X,[(u(!0),f(N,null,j(t.clientContacts,r=>(u(),f("tr",{key:r.uid},[e("td",Y,[e("div",Z,[e("div",null,[e("div",$,m(r.firstName)+" "+m(r.lastName),1)])])]),e("td",ee,[e("div",te,m(r.email),1)]),e("td",oe,[e("div",ne,m(r.mobilePhone),1)]),e("td",re,[s(e("button",{onClick:i=>t.FormManager(!1,r),class:"px-2 py-1 mr-2 border border-border text-muted-foreground rounded-sm transition duration-300 hover:bg-muted hover:text-primary-foreground focus:outline-none"}," Edit ",8,ae),[[v,t.shield.hasRights(t.shield.actions.UPDATE,t.shield.objects.CLIENT)]]),o[6]||(o[6]=L()),s(e("button",{onClick:i=>t.deleteClientContact(r),class:"px-2 py-1 mr-2 border border-destructive text-destructive rounded-sm transition duration-300 hover:bg-destructive hover:text-primary-foreground focus:outline-none"}," Deactivate ",8,le),[[v,t.shield.hasRights(t.shield.actions.UPDATE,t.shield.objects.CLIENT)]])])]))),128))])]),t.fetchingClientContacts?(u(),f("div",ie,[q(h,{message:"Fetching client contacts ..."})])):p("v-if",!0)])]),p(" Contact Edit Form Modal "),t.showContactModal?(u(),R(c,{key:0,onClose:o[5]||(o[5]=r=>t.showContactModal=!1)},{header:E(()=>[e("h3",null,m(t.formTitle),1)]),body:E(()=>[e("form",se,[e("div",de,[e("label",ce,[o[8]||(o[8]=e("span",{class:"text-foreground"},"Full Name",-1)),s(e("input",{class:"form-input mt-1 block w-full",autocomplete:"off","onUpdate:modelValue":o[1]||(o[1]=r=>t.contact.firstName=r),placeholder:"Full Name ..."},null,512),[[x,t.contact.firstName]])]),e("label",ue,[o[9]||(o[9]=e("span",{class:"text-foreground"},"Email",-1)),s(e("input",{class:"form-input mt-1 block w-full",autocomplete:"off","onUpdate:modelValue":o[2]||(o[2]=r=>t.contact.email=r),placeholder:"Email ..."},null,512),[[x,t.contact.email]])]),e("label",me,[o[10]||(o[10]=e("span",{class:"text-foreground"},"Mobile Phone",-1)),s(e("input",{class:"form-input mt-1 block w-full",autocomplete:"off","onUpdate:modelValue":o[3]||(o[3]=r=>t.contact.mobilePhone=r),placeholder:"Mobile Phone ..."},null,512),[[x,t.contact.mobilePhone]])])]),o[11]||(o[11]=e("hr",null,null,-1)),e("button",{type:"button",onClick:o[4]||(o[4]=B(r=>t.saveForm(),["prevent"])),class:"-mb-4 w-full border border-primary bg-primary text-primary-foreground rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-primary focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):p("v-if",!0)],64)}const xe=V(z,[["render",be],["__file","/home/administrator/Documents/Development/beak-insights/beak/beak-lims/webapp/views/client/_id/ContactTable.vue"]]);export{xe as default};
