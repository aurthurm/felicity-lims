import{a0 as w,a7 as d,h as p,ad as N,i as C,ap as x,_ as V,c as a,o as n,A as t,E as s,L as u,a as I,N as D,T as L}from"./index-DCVfsbos.js";const M=w({__name:"VersionDisplay",setup(g,{expose:o}){o();const i=d(!1),e=d("0.0.0"),r=d(null),c=d(null),v=d(!1),_=async()=>{i.value=!0,x.get("/version").then(({data:{version:l}})=>{e.value=l}).catch(()=>{c.value="Failed to get current version"}).finally(()=>i.value=!1)},{toastInfo:f}=C(),m=async()=>{i.value=!0,x.get("/version/updates").then(({data:l})=>{r.value=l,l.update_available?f(`Update available: ${l.latest_version}`):f("No updates available")}).catch(()=>{c.value="Failed to get current version"}).finally(()=>i.value=!1)},b=p(()=>r.value?.latest_version||"-"),y=p(()=>r.value?.last_checked?new Date(r.value.last_checked).toLocaleString():"-"),k=p(()=>r.value?.release_notes?r.value.release_notes.replace(/^(\s*[-*] .*)$/gm,'<span style="color:hsl(var(--primary));">$1</span>').replace(/^(\s*[A-Z][^:]+:)/gm,"<b>$1</b>").replace(/\r?\n/g,"<br>"):"");N(()=>{_(),m()});const h={loading:i,currentVersion:e,updateInfo:r,error:c,showNotes:v,getCurrentVersion:_,toastInfo:f,getUpdates:m,latestVersion:b,formattedLastChecked:y,formattedReleaseNotes:k};return Object.defineProperty(h,"__isScriptSetup",{enumerable:!1,value:!0}),h}}),B={class:"flex flex-col gap-y-2 bg-background/50 px-4 py-2 rounded-lg border border-border/50"},R={class:"flex items-center gap-x-4"},S={class:"flex items-center gap-x-2"},T={class:"text-sm font-medium text-foreground"},U={key:0,class:"flex items-center gap-x-2 text-primary"},H={class:"text-sm font-medium"},j={key:1,class:"ml-auto text-xs text-muted-foreground"},A={key:0},E={key:0,class:"flex flex-col gap-2 mt-2"},F={class:"flex items-center gap-2"},G=["href"],O={key:0,class:"bg-muted/30 border border-border/30 rounded p-3 mt-1 max-h-96 overflow-auto whitespace-pre-wrap text-xs font-mono"},P=["innerHTML"],Z={key:1,class:"text-xs text-muted-foreground mt-2"};function q(g,o,i,e,r,c){return n(),a("div",B,[t("div",R,[s(" Current version "),t("div",S,[t("span",T,"v"+u(e.currentVersion),1),s(" Refresh button when no update "),e.updateInfo?.update_available?s("v-if",!0):(n(),a("button",{key:0,onClick:e.getUpdates,class:"p-1.5 text-muted-foreground hover:text-foreground hover:bg-muted rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2","aria-label":"Check for updates"},[...o[1]||(o[1]=[t("svg",{class:"w-4 h-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[t("path",{d:"M21.5 2v6h-6M2.5 22v-6h6M2 11.5a10 10 0 0 1 18.8-4.3M22 12.5a10 10 0 0 1-18.8 4.3"})],-1)])]))]),s(" Update available "),e.updateInfo?.update_available?(n(),a("div",U,[t("span",H,"v"+u(e.latestVersion)+" available",1),o[2]||(o[2]=t("svg",{class:"w-4 h-4 animate-pulse",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round","aria-hidden":"true"},[t("circle",{cx:"12",cy:"12",r:"10"}),t("line",{x1:"12",y1:"16",x2:"12",y2:"12"}),t("line",{x1:"12",y1:"8",x2:"12",y2:"8"})],-1))])):s("v-if",!0),e.updateInfo?.last_checked?(n(),a("span",j,"Last checked: "+u(e.formattedLastChecked),1)):s("v-if",!0)]),s(" Update details "),e.updateInfo?(n(),a("div",A,[e.updateInfo.update_available?(n(),a("div",E,[t("div",F,[e.updateInfo.release_url?(n(),a("a",{key:0,href:e.updateInfo.release_url,target:"_blank",rel:"noopener",class:"text-primary hover:underline text-xs font-medium"}," View Release on GitHub ",8,G)):s("v-if",!0),t("button",{onClick:o[0]||(o[0]=v=>e.showNotes=!e.showNotes),class:"text-xs text-primary underline focus:outline-none"},u(e.showNotes?"Hide":"Show")+" Release Notes ",1)]),I(L,{name:"fade"},{default:D(()=>[e.showNotes?(n(),a("div",O,[t("span",{innerHTML:e.formattedReleaseNotes},null,8,P)])):s("v-if",!0)]),_:1})])):(n(),a("div",Z,[...o[3]||(o[3]=[t("span",null,"No updates available.",-1)])]))])):s("v-if",!0)])}const J=V(M,[["render",q],["__scopeId","data-v-f64094ba"],["__file","/home/administrator/Documents/Development/beak-insights/beak/beak-lims/webapp/views/admin/VersionDisplay.vue"]]);export{J as default};
