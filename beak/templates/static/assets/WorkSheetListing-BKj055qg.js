const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BeakDataTable--KDatWv7.js","assets/index-B3ZheI5m.js","assets/index-C_1sfwqa.css"])))=>i.map(i=>d[i]);
import{a0 as Y,S as Z,f as $,aq as ee,ac as te,a7 as y,g as oe,aw as se,h as T,a1 as re,a6 as ae,a8 as v,ar as ne,_ as le,r as A,c as l,o as n,a as N,A as r,N as c,F as f,D as P,H as ie,C as ue,E as B,J as h,K as S,L as w,a9 as R,a2 as de}from"./index-B3ZheI5m.js";import{u as me}from"./user-BHZZlXLC.js";import{c as ce,d as fe,a as _,u as he,b as p}from"./index.esm-C1wdlr_y.js";import{s as pe}from"./index-C7zlg90Q.js";const ge=Y({__name:"WorkSheetListing",setup(D,{expose:t}){t();const x=re(()=>ae(()=>import("./BeakDataTable--KDatWv7.js"),__vite__mapDeps([0,1,2]))),e=Z(),u=me(),{withClientMutation:g}=$(),{workSheets:d,fetchingWorkSheets:b,workSheetPageInfo:s,workSheetTemplates:k}=ee(e),E=te();let m=y(!1);const I=y([{name:"All",value:""},{name:"Pending",value:"pending"},{name:"Awaiting",value:"awaiting"},{name:"Approved",value:"approved"},{name:"Empty",value:"empty"}]),L=y([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"WorkSheet Id",value:"workSheetId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(o,i){return v(ne,{to:{name:"worksheet-detail",params:{workSheetUid:o?.uid}},innerHTML:o?.worksheetId})}},{name:"Analysis/Test",value:"analysis.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Samples",value:"assignedCount",sortable:!1,sortBy:"asc",hidden:!1},{name:"Instrument",value:"instrument.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Analyst",value:"clientPatientId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(o,i){return v("div",{innerHTML:C(o?.analyst)})}},{name:"Status",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(o,i){return v("button",{type:"button",class:"bg-primary text-primary-foreground py-1 px-2 rounded-sm leading-none",innerHTML:o?.state||"unknown"})}}]);e.removeWorksheet();let a=oe({first:25,before:"",status:"",text:"",sort:["-uid"],filterAction:!1});e.fetchWorkSheets(a),e.fetchWorkSheetTemplates(),u.fetchUsers({});const W=ce({analystUid:_().required("Analyst is Required"),templateUid:_().required("Worksheet Template is required"),instrumentUid:_().nullable(),count:fe().min(1,"Count must be at least 1").required("Count is required")}),{handleSubmit:U,errors:O}=he({validationSchema:W,initialValues:{count:1,analystUid:"",templateUid:"",instrumentUid:null}}),{value:F}=p("count"),{value:V}=p("analystUid"),{value:q}=p("templateUid"),{value:H}=p("instrumentUid"),j=U(o=>{m.value=!1,g(se,o,"createWorksheet").then(i=>{e.addWorksheet(i),m.value=!1})});function K(o){let i=[];return o?.forEach(X=>i.push(X.name)),i?.join(", ")}function J(o){a.first=o.fetchCount,a.before=s?.value?.endCursor??"",a.text=o.filterText,a.status=o.filterStatus,a.filterAction=!1,e.fetchWorkSheets(a)}function z(o){a.first=25,a.before="",a.text=o.filterText,a.status=o.filterStatus,a.filterAction=!0,e.fetchWorkSheets(a)}const G=T(()=>u.getUsers),C=o=>o?.auth?.userName?o?.auth?.userName:o?.firstName?o.firstName+" "+o.lastName:"----",Q=T(()=>d?.value?.length+" of "+e.getWorkSheetCount+" WorkSheets"),M={DataTable:x,worksheetStore:e,userStore:u,withClientMutation:g,workSheets:d,fetchingWorkSheets:b,workSheetPageInfo:s,workSheetTemplates:k,route:E,get showModal(){return m},set showModal(o){m=o},filterOptions:I,tableColumns:L,get workSheetParams(){return a},set workSheetParams(o){a=o},worksheetSchema:W,handleSubmit:U,errors:O,count:F,analystUid:V,templateUid:q,instrumentUid:H,saveForm:j,analysesText:K,showMoreWorkSheets:J,searchWorkSheets:z,analysts:G,analystName:C,countNone:Q,get shield(){return pe}};return Object.defineProperty(M,"__isScriptSetup",{enumerable:!1,value:!0}),M}}),be={class:"space-y-6"},ke={class:"rounded-lg border border-border bg-card shadow-sm p-6"},ye={class:"space-y-4"},ve={key:0,class:"space-y-1"},Se={action:"post",class:"space-y-6 p-4"},we={class:"grid grid-cols-3 gap-4"},_e={class:"block space-y-2"},xe=["value"],We={class:"block space-y-2"},Ue=["value"],Ce={class:"block space-y-2"},Me={class:"border-t border-border pt-4"};function Te(D,t,x,e,u,g){const d=A("beak-heading"),b=A("beak-modal");return n(),l(h,null,[N(d,{title:"Worksheets"},{default:c(()=>[f(r("button",{onClick:t[0]||(t[0]=P(s=>e.showModal=!0,["prevent"])),class:"px-4 py-2 bg-primary text-primary-foreground rounded-md transition-colors duration-200 hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Add WorkSheet ",512),[[ie,e.shield.hasRights(e.shield.actions.CREATE,e.shield.objects.WORKSHEET)]])]),_:1}),r("div",be,[r("div",ke,[N(e.DataTable,{columns:e.tableColumns,data:e.workSheets,toggleColumns:!0,loading:e.fetchingWorkSheets,paginable:!0,pageMeta:{fetchCount:e.workSheetParams.first,hasNextPage:e.workSheetPageInfo?.hasNextPage,countNone:e.countNone},searchable:!0,filterable:!0,filterMeta:{defaultFilter:e.workSheetParams.status,filters:e.filterOptions},onOnSearch:e.searchWorkSheets,onOnPaginate:e.showMoreWorkSheets,selectable:!1,class:"bg-background rounded-lg shadow-sm"},{footer:c(()=>[...t[6]||(t[6]=[])]),_:1},8,["columns","data","loading","pageMeta","filterMeta"])]),e.showModal?(n(),ue(b,{key:0,onClose:t[5]||(t[5]=s=>e.showModal=!1),contentWidth:"w-1/2"},{header:c(()=>[r("div",ye,[t[7]||(t[7]=r("h3",{class:"text-lg font-medium"},"Create Worksheet",-1)),t[8]||(t[8]=r("div",{class:"border-t border-border"},null,-1)),Object.keys(e.errors).length>0?(n(),l("ul",ve,[(n(!0),l(h,null,S(Object.values(e.errors),(s,k)=>(n(),l("li",{key:k,class:"text-destructive text-sm"},w(s),1))),128))])):B("",!0)])]),body:c(()=>[r("form",Se,[r("div",we,[r("label",_e,[t[10]||(t[10]=r("span",{class:"text-sm font-medium"},"Analyst",-1)),f(r("select",{class:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary","onUpdate:modelValue":t[1]||(t[1]=s=>e.analystUid=s)},[t[9]||(t[9]=r("option",{value:""},null,-1)),(n(!0),l(h,null,S(e.analysts,s=>(n(),l("option",{key:s.uid,value:s.uid},w(e.analystName(s)),9,xe))),128))],512),[[R,e.analystUid]])]),r("label",We,[t[12]||(t[12]=r("span",{class:"text-sm font-medium"},"Worksheet Template",-1)),f(r("select",{class:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary","onUpdate:modelValue":t[2]||(t[2]=s=>e.templateUid=s)},[t[11]||(t[11]=r("option",{value:""},null,-1)),(n(!0),l(h,null,S(e.workSheetTemplates,s=>(n(),l("option",{key:s.uid,value:s.uid},w(s.name),9,Ue))),128))],512),[[R,e.templateUid]])]),r("label",Ce,[t[13]||(t[13]=r("span",{class:"text-sm font-medium"},"How Many",-1)),f(r("input",{type:"number",class:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary","onUpdate:modelValue":t[3]||(t[3]=s=>e.count=s),min:"1"},null,512),[[de,e.count]])])]),r("div",Me,[r("button",{type:"button",onClick:t[4]||(t[4]=P(s=>e.saveForm(),["prevent"])),class:"w-full px-4 py-2 bg-primary text-primary-foreground rounded-md transition-colors duration-200 hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Save Form ")])])]),_:1})):B("",!0)])],64)}const Re=le(ge,[["render",Te],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/worksheet/WorkSheetListing.vue"]]);export{Re as default};
