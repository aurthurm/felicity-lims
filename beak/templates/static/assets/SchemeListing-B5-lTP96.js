const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/vue-multiselect.esm-CQe58Q7H.js","assets/index-DCVfsbos.js","assets/index-C_1sfwqa.css"])))=>i.map(i=>d[i]);
import{a0 as J,f as Q,a7 as c,g as U,h as T,ad as W,W as X,a1 as Z,a6 as $,b1 as ee,b2 as te,_ as oe,r as D,c as l,o as a,a as C,A as e,E as s,C as re,F as h,a2 as y,M as se,L as d,J as S,K as E,N,P as L,O as I,D as ne}from"./index-DCVfsbos.js";import{f as ie}from"./index-Cw3weLtk.js";import{G as ae,A as le,E as de}from"./grind.queries-CepHqusz.js";const ue=J({__name:"SchemeListing",setup(Y,{expose:t}){t();const A=Z(()=>$(()=>import("./vue-multiselect.esm-CQe58Q7H.js"),__vite__mapDeps([0,1,2]))),{withClientMutation:o,withClientQuery:w}=Q();let b=c(!1),p=c(""),u=U({});const x=c(!0),r=c(!1),i=c([]),k=c([]);let m=U({first:12,after:"",text:"",sortBy:["created_at"],filterAction:!1});const M=c(0);let v=c({startCursor:"",endCursor:"",hasNextPage:!1,hasPreviousPage:!1});const F=T(()=>i.value.length+" of "+M.value+" schemes"),G=T(()=>r.value);function _(n){r.value=!0,w(ae,{first:n.first,after:n.after,text:n.text,sortBy:n.sortBy},"grindSchemeAll").then(g=>{g&&(i.value=g?.items,M.value=g?.totalCount||0,v.value=g?.pageInfo)}).finally(()=>{r.value=!1})}W(()=>{_(m),V()});function V(){w(X,{first:100,after:"",text:"",sortBy:["first_name"]},"userAll").then(n=>{n&&(k.value=n?.items)})}function H(n){m.first=12,m.after="",m.text=n,m.filterAction=!0,_(m)}function O(){!v.value.hasNextPage||r.value||(m.first=6,m.after=v.value.endCursor,m.filterAction=!1,_(m))}function P(){Object.assign(u,{title:"",description:"",startDate:"",endDate:"",assignee:null,members:[]})}function z(){x.value=!0,b.value=!0,p.value="Create New Scheme",P()}function K(n){x.value=!1,b.value=!0,p.value="Edit Scheme",Object.assign(u,{...n})}function R(){const n=u.members?.map(f=>f.uid)||[],g={title:u.title,description:u.description,startDate:u.startDate,endDate:u.endDate,assignee:u.assignee?.uid,members:n};x.value===!0?o(le,{payload:g},"createGrindScheme").then(f=>{f&&i.value.unshift(f)}):o(de,{uid:u.uid,payload:g},"updateGrindScheme").then(f=>{if(f){const B=i.value.findIndex(q=>q.uid===f.uid);B!==-1&&(i.value[B]=f)}}),b.value=!1}const j={VueMultiselect:A,withClientMutation:o,withClientQuery:w,get showModal(){return b},set showModal(n){b=n},get formTitle(){return p},set formTitle(n){p=n},get form(){return u},set form(n){u=n},formAction:x,fetchingSchemes:r,schemes:i,users:k,get schemeParams(){return m},set schemeParams(n){m=n},schemesCount:M,get schemesPageInfo(){return v},set schemesPageInfo(n){v=n},countText:F,isLoading:G,fetchSchemes:_,fetchAvailableUsers:V,searchSchemes:H,loadMoreSchemes:O,resetForm:P,openCreateForm:z,openEditForm:K,saveForm:R,get formatDate(){return ie},get stringToColor(){return te},get getUserInitials(){return ee}};return Object.defineProperty(j,"__isScriptSetup",{enumerable:!1,value:!0}),j}}),me={class:"pb-8"},fe={class:"flex justify-between items-center mb-6"},ce={class:"flex space-x-4"},ge={class:"relative"},be={class:"mb-4 text-sm text-foreground"},pe={key:0,class:"text-muted-foreground"},xe={key:1},ve={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"},he={class:"p-6"},ye={class:"flex justify-between items-start mb-3"},we=["onClick"],ke={class:"text-foreground text-sm mb-4 line-clamp-2"},_e={class:"flex items-center text-xs text-muted-foreground mb-4"},Ce={class:"flex items-center space-x-1"},Me={key:0,class:"mb-4"},De={class:"flex items-center space-x-2"},Se={class:"text-sm text-foreground"},Ne={key:1},Ae={class:"flex -space-x-2 overflow-hidden"},Ve=["title"],Pe=["title"],je={class:"mt-4 pt-3 border-t border-border text-xs text-muted-foreground flex justify-between"},Be={key:0},Ue={key:0,class:"mt-8 flex justify-center"},Te=["disabled"],Ee={key:0},Le={key:1},Ie={key:1,class:"flex flex-col items-center justify-center py-12"},Ye={class:"text-lg font-semibold text-foreground"},Fe={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ge={class:"flex justify-end space-x-3"},He={type:"submit",class:"px-4 py-2 text-sm font-medium text-primary-foreground bg-primary border border-transparent rounded-md shadow-sm hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors duration-200"};function Oe(Y,t,A,o,w,b){const p=D("beak-heading"),u=D("router-link"),x=D("beak-modal");return a(),l(S,null,[C(p,{title:"Projects"}),e("div",me,[e("div",fe,[e("div",ce,[s(" Search input "),e("div",ge,[h(e("input",{type:"text",placeholder:"Search schemes...",class:"w-full px-4 py-2 border border-border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-background text-foreground","onUpdate:modelValue":t[0]||(t[0]=r=>o.schemeParams.text=r),onKeyup:t[1]||(t[1]=se(r=>o.searchSchemes(o.schemeParams.text),["enter"]))},null,544),[[y,o.schemeParams.text]]),e("button",{onClick:t[2]||(t[2]=r=>o.searchSchemes(o.schemeParams.text)),class:"absolute right-2 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-primary transition-colors duration-200"},[...t[11]||(t[11]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})],-1)])])]),s(" Add button "),e("button",{onClick:o.openCreateForm,class:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"},[...t[12]||(t[12]=[e("span",{class:"flex items-center space-x-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",null,"Add Scheme")],-1)])])])]),s(" Status and count information "),e("div",be,[o.isLoading?(a(),l("span",pe,"Loading schemes...")):(a(),l("span",xe,d(o.countText),1))]),s(" Cards grid layout "),e("div",ve,[s(" Scheme card "),(a(!0),l(S,null,E(o.schemes,r=>(a(),l("div",{key:r.uid,class:"bg-background rounded-lg shadow-sm overflow-hidden border border-border hover:shadow-md transition-all duration-200"},[e("div",he,[e("div",ye,[C(u,{to:{name:"scheme-detail",params:{schemeUid:r?.uid}},class:"text-lg font-semibold text-foreground hover:text-primary transition-colors duration-200 truncate"},{default:N(()=>[L(d(r.title),1)]),_:2},1032,["to"]),e("button",{onClick:i=>o.openEditForm(r),class:"text-muted-foreground hover:text-primary transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary rounded-md p-1"},[...t[13]||(t[13]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)])],8,we)]),s(" Description "),e("p",ke,d(r.description||"No description provided"),1),s(" Date information "),e("div",_e,[e("div",Ce,[t[14]||(t[14]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),e("span",null,d(o.formatDate(r.startDate,"D MMMM YYYY"))+" - "+d(o.formatDate(r.endDate,"D MMMM YYYY")),1)])]),s(" Assignee "),r.assignee?(a(),l("div",Me,[t[15]||(t[15]=e("p",{class:"text-xs text-muted-foreground mb-1"},"Assignee:",-1)),e("div",De,[e("div",{class:"w-8 h-8 rounded-full flex items-center justify-center text-primary-foreground text-xs font-medium",style:I({backgroundColor:o.stringToColor(r.assignee.firstName+r.assignee.lastName)})},d(o.getUserInitials(r.assignee.firstName,r.assignee.lastName)),5),e("span",Se,d(r.assignee.firstName)+" "+d(r.assignee.lastName),1)])])):s("v-if",!0),s(" Members "),r.members&&r.members.length>0?(a(),l("div",Ne,[t[16]||(t[16]=e("p",{class:"text-xs text-muted-foreground mb-1"},"Members:",-1)),e("div",Ae,[(a(!0),l(S,null,E(r.members.slice(0,5),(i,k)=>(a(),l("div",{key:k,class:"w-8 h-8 rounded-full border-2 border-background flex items-center justify-center text-primary-foreground text-xs font-medium",style:I({backgroundColor:o.stringToColor(i.firstName+i.lastName)}),title:`${i.firstName} ${i.lastName}`},d(o.getUserInitials(i.firstName,i.lastName)),13,Ve))),128)),s(" Show count for additional members "),r.members.length>5?(a(),l("div",{key:0,class:"w-8 h-8 rounded-full border-2 border-background flex items-center justify-center bg-muted text-foreground text-xs font-medium",title:r.members.slice(5).map(i=>`${i.firstName} ${i.lastName}`).join(", ")}," +"+d(r.members.length-5),9,Pe)):s("v-if",!0)])])):s("v-if",!0),s(" Created info "),e("div",je,[e("span",null,"Created "+d(o.formatDate(r.createdAt,"D MMMM YYYY")),1),r.createdBy?(a(),l("span",Be,"by "+d(r.createdBy.firstName),1)):s("v-if",!0)])])]))),128))]),s(" Load more button "),o.schemesPageInfo.hasNextPage?(a(),l("div",Ue,[e("button",{onClick:o.loadMoreSchemes,class:"px-4 py-2 bg-secondary text-foreground rounded-lg hover:bg-secondary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-secondary focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed",disabled:o.fetchingSchemes},[o.fetchingSchemes?(a(),l("span",Ee,"Loading...")):(a(),l("span",Le,"Load More"))],8,Te)])):s("v-if",!0),s(" Empty state "),o.schemes.length===0&&!o.isLoading?(a(),l("div",Ie,[t[18]||(t[18]=e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-16 w-16 text-muted-foreground mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1)),t[19]||(t[19]=e("h3",{class:"text-lg font-medium text-foreground mb-2"},"No schemes found",-1)),t[20]||(t[20]=e("p",{class:"text-muted-foreground mb-4"},"Get started by creating your first scheme",-1)),e("button",{onClick:o.openCreateForm,class:"px-4 py-2 bg-primary text-primary-foreground rounded-lg hover:bg-primary/90 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"},[...t[17]||(t[17]=[e("span",{class:"flex items-center space-x-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",null,"Create Scheme")],-1)])])])):s("v-if",!0)]),s(" Create/Edit Scheme Modal "),o.showModal?(a(),re(x,{key:0,onClose:t[10]||(t[10]=r=>o.showModal=!1),"content-width":"w-full max-w-2xl"},{header:N(()=>[e("h3",Ye,d(o.formTitle),1)]),body:N(()=>[e("form",{onSubmit:ne(o.saveForm,["prevent"]),class:"p-6 space-y-6"},[s(" Scheme Title "),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-foreground mb-1",for:"title"},[L(" Scheme Title "),e("span",{class:"text-destructive"},"*")],-1)),h(e("input",{id:"title","onUpdate:modelValue":t[3]||(t[3]=r=>o.form.title=r),type:"text",required:"",class:"w-full px-3 py-2 border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-background text-foreground",placeholder:"Enter scheme title"},null,512),[[y,o.form.title]])]),s(" Description "),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-foreground mb-1",for:"description"}," Description ",-1)),h(e("textarea",{id:"description","onUpdate:modelValue":t[4]||(t[4]=r=>o.form.description=r),rows:"3",class:"w-full px-3 py-2 border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-background text-foreground",placeholder:"Enter scheme description"},null,512),[[y,o.form.description]])]),s(" Date Range "),e("div",Fe,[e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-foreground mb-1",for:"startDate"}," Start Date ",-1)),h(e("input",{id:"startDate","onUpdate:modelValue":t[5]||(t[5]=r=>o.form.startDate=r),type:"date",class:"w-full px-3 py-2 border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-background text-foreground"},null,512),[[y,o.form.startDate]])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-foreground mb-1",for:"endDate"}," End Date ",-1)),h(e("input",{id:"endDate","onUpdate:modelValue":t[6]||(t[6]=r=>o.form.endDate=r),type:"date",class:"w-full px-3 py-2 border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-background text-foreground"},null,512),[[y,o.form.endDate]])])]),s(" Assignee "),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-foreground mb-1"}," Assignee ",-1)),C(o.VueMultiselect,{modelValue:o.form.assignee,"onUpdate:modelValue":t[7]||(t[7]=r=>o.form.assignee=r),options:o.users,label:"firstName",searchable:!0,"track-by":"uid",placeholder:"Select an assignee",class:"multiselect-primary"},null,8,["modelValue","options"])]),s(" Members "),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-foreground mb-1"}," Members ",-1)),C(o.VueMultiselect,{modelValue:o.form.members,"onUpdate:modelValue":t[8]||(t[8]=r=>o.form.members=r),options:o.users,label:"firstName",searchable:!0,"track-by":"uid",multiple:!0,placeholder:"Select members",class:"multiselect-primary"},null,8,["modelValue","options"])]),s(" Submit button "),e("div",Ge,[e("button",{type:"button",onClick:t[9]||(t[9]=r=>o.showModal=!1),class:"px-4 py-2 text-sm font-medium text-foreground bg-background border border-border rounded-md shadow-sm hover:bg-muted focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors duration-200"}," Cancel "),e("button",He,d(o.formAction?"Create":"Update"),1)])],32)]),_:1})):s("v-if",!0)],64)}const qe=oe(ue,[["render",Oe],["__scopeId","data-v-3bab7638"],["__file","/home/administrator/Documents/Development/beak-insights/beak/beak-lims/webapp/views/grind/SchemeListing.vue"]]);export{qe as default};
