import{a0 as R,f as T,aq as z,h as J,ad as K,a5 as O,a7 as P,_ as Q,r as p,c as f,o as u,C as W,E as G,a as A,A as o,J as H,K as X,L as v,N as L,F as h,Q as S,a2 as F,a3 as Y,D as Z}from"./index-B3ZheI5m.js";import{e as $,f as ee}from"./billing.mutations-DdDRIHbu.js";import{u as oe}from"./billing-CgiyGpDP.js";import{c as te,f as ie,a as b,d as se,u as re,b as c}from"./index.esm-C1wdlr_y.js";import"./billing.queries-BnMgH4Vz.js";const de=R({__name:"VoucherCodes",props:{voucherUid:String},setup(x,{expose:t}){t();const n=x,{withClientMutation:i}=T();let d=oe();const{fetchingVoucherCodes:y}=z(d),g=J(()=>{const e=d.getVouchers,l=e?.findIndex(I=>I.uid===n.voucherUid);return l>-1?e[l]?.codes:[]});K(()=>d.fetchVoucherCodes(n.voucherUid)),O(()=>n.voucherUid,e=>{d.fetchVoucherCodes(n.voucherUid)});let a=P(!1);const m=te({uid:b().nullable(),voucherUid:b().required(),code:b().required("Code is Required"),usageLimit:se().required("Usage Limit is Required"),used:b().nullable(),isActive:ie().default(!0)}),{handleSubmit:s,errors:_,setFieldValue:r}=re({validationSchema:m,initialValues:{isActive:!0,voucherUid:n.voucherUid}}),{value:C}=c("uid"),{value:M}=c("voucherUid"),{value:j}=c("code"),{value:D}=c("usageLimit"),{value:q}=c("used"),{value:B}=c("isActive"),N=s(e=>{e.uid||w(e),e.uid&&k(e)});let V=e=>{r("uid",e.uid),r("code",e.code),r("usageLimit",e.usageLimit),r("used",e.used),r("isActive",e.isActive),a.value=!0};const E=()=>{r("uid",void 0),r("voucherUid",n.voucherUid),r("code",void 0),r("usageLimit",void 0),r("used",void 0),r("isActive",!0),a.value=!0},w=e=>{delete e.uid,i($,{payload:e},"createVoucherCode").then(l=>d.addVoucherCode(l)).finally(()=>a.value=!1)},k=e=>{delete e.uid,delete e.used,i(ee,{uid:C?.value,payload:e},"updateVoucherCode").then(l=>d.updateVoucherCode(l)).finally(()=>a.value=!1)},U={props:n,withClientMutation:i,get billingStore(){return d},set billingStore(e){d=e},fetchingVoucherCodes:y,codes:g,get showModal(){return a},set showModal(e){a=e},codeSchema:m,handleSubmit:s,errors:_,setFieldValue:r,uid:C,voucherUid:M,code:j,usageLimit:D,used:q,isActive:B,submitVoucherForm:N,get editCode(){return V},set editCode(e){V=e},newVoucherCode:E,addVoucherCode:w,updateVoucherCode:k};return Object.defineProperty(U,"__isScriptSetup",{enumerable:!1,value:!0}),U}}),ne={class:"space-y-6"},ae={key:0,class:"rounded-lg border border-border bg-card p-4"},le={key:1,class:"space-y-6"},ue={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4"},ce={class:"flex items-center justify-between"},fe={class:"space-y-1"},me={class:"font-medium text-foreground"},be={class:"text-sm text-muted-foreground"},ge=["onClick"],pe={class:"space-y-6"},ve={class:"grid grid-cols-2 gap-4"},he={class:"space-y-2"},xe={class:"space-y-2"},ye={class:"flex items-center space-x-2"},_e={class:"flex justify-end"};function Ce(x,t,n,i,d,y){const g=p("beak-loader"),a=p("font-awesome-icon"),m=p("beak-modal");return u(),f("div",ne,[i.fetchingVoucherCodes?(u(),f("div",ae,[A(g,{message:"Fetching voucher codes ..."})])):(u(),f("section",le,[o("div",{class:"flex justify-between items-center"},[t[5]||(t[5]=o("h4",{class:"text-lg font-semibold text-foreground"},"Voucher Codes",-1)),o("button",{class:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-9 px-4 py-2",onClick:i.newVoucherCode}," Add Voucher Code ")]),o("div",ue,[(u(!0),f(H,null,X(i.codes,s=>(u(),f("div",{key:s.uid,class:"rounded-lg border border-border bg-card p-4 transition-colors hover:bg-accent hover:text-accent-foreground"},[o("div",ce,[o("div",fe,[o("h5",me,v(s.code),1),o("p",be,v(s.used)+" of "+v(s.usageLimit),1)]),o("button",{class:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-9 w-9",onClick:_=>i.editCode(s)},[A(a,{icon:"pen",class:"text-muted-foreground"})],8,ge)])]))),128))])])),i.showModal?(u(),W(m,{key:2,onClose:t[4]||(t[4]=s=>i.showModal=!1),contentWidth:"w-2/6"},{header:L(()=>[...t[6]||(t[6]=[o("h3",{class:"text-lg font-semibold text-foreground"},"Voucher Code Form",-1)])]),body:L(()=>[o("form",pe,[o("div",ve,[o("label",he,[t[7]||(t[7]=o("span",{class:"text-sm font-medium text-foreground"},"Voucher Code",-1)),h(o("input",{class:S(["form-input w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive animate-pulse":i.errors.code}]),type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>i.code=s),placeholder:"Code ..."},null,2),[[F,i.code]])]),o("label",xe,[t[8]||(t[8]=o("span",{class:"text-sm font-medium text-foreground"},"Usage Limit",-1)),h(o("input",{class:S(["form-input w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",{"border-destructive animate-pulse":i.errors.usageLimit}]),type:"number",min:"1","onUpdate:modelValue":t[1]||(t[1]=s=>i.usageLimit=s)},null,2),[[F,i.usageLimit]])])]),o("div",ye,[h(o("input",{class:"form-checkbox h-4 w-4 rounded border-input text-primary focus:ring-primary",type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=s=>i.isActive=s),checked:""},null,512),[[Y,i.isActive]]),t[9]||(t[9]=o("label",{class:"text-sm font-medium text-foreground"},"Is Active",-1))]),o("div",_e,[o("button",{type:"submit",class:"inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-9 px-4 py-2",onClick:t[3]||(t[3]=Z((...s)=>i.submitVoucherForm&&i.submitVoucherForm(...s),["prevent"]))}," Save Voucher Code ")])])]),_:1})):G("",!0)])}const Le=Q(de,[["render",Ce],["__scopeId","data-v-8e7b96f9"],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/billing/VoucherCodes.vue"]]);export{Le as default};
