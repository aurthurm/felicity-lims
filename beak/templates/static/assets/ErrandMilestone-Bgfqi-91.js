import{a0 as S,f as B,ad as j,a7 as d,g as G,W as N,_ as T,r as L,c as v,o as b,E as s,A as e,C as q,J as H,K as I,Q as C,L as g,N as U,D as P,F as y,P as Q,a2 as D,a as z,a3 as J}from"./index-DCVfsbos.js";import{j as K,k as O,l as W}from"./grind.queries-CepHqusz.js";import{r as R,m as X}from"./index-DKgQr4wR.js";import{Multiselect as Y}from"./vue-multiselect.esm-CQe58Q7H.js";const Z=S({__name:"ErrandMilestone",props:{errandUid:{type:String,required:!0}},emits:["milestoneUpdated"],setup(w,{expose:o,emit:h}){o();const t=w,{withClientMutation:a,withClientQuery:u}=B();j(()=>{l(),M()});const c=h,r=d([]);function l(n="cache-first"){u(K,{errandUid:t.errandUid},"grindMilestonesByErrand",n).then(p=>{p&&(r.value=p)})}const m=d(!1),f=d(!1),x=d(""),i=G({});function E(){m.value=!0,x.value="Add Milestone",f.value=!0,R(i)}function A(n){m.value=!0,x.value="Edit Milestone",f.value=!1,X(i,n)}function F(){m.value=!1;const n={title:i.title,description:i.description,complete:i.complete,assigneeUid:i.assignee?.uid,errandUid:t.errandUid};f.value?a(O,{payload:{...n,errandUid:t.errandUid}},"createGrindMilestone").then(()=>l("network-only")):a(W,{uid:i.uid,payload:n},"updateGrindMilestone").then(()=>{l("network-only"),c("milestoneUpdated")})}function V({firstName:n,lastName:p}){return`${n} ${p}`}const k=d();function M(){u(N,{first:100},"userAll").then(n=>{k.value=n.items})}const _={props:t,withClientMutation:a,withClientQuery:u,emit:c,milestones:r,fetchMilestones:l,showForm:m,formAction:f,formTitle:x,form:i,addMilestone:E,editMilestone:A,saveForm:F,customLabel:V,users:k,getUsers:M,get Multiselect(){return Y}};return Object.defineProperty(_,"__isScriptSetup",{enumerable:!1,value:!0}),_}}),$={class:"space-y-6"},ee={class:"space-y-6"},oe=["onDblclick"],te={class:"absolute left-0 top-0 transform -translate-x-1/2 bg-background p-1 border border-border rounded-full w-4 h-4 flex items-center justify-center transition-colors duration-200 group-hover:border-primary"},re={class:"mb-6"},se={class:"font-medium text-foreground group-hover:text-primary transition-colors duration-200"},ne={class:"text-sm text-muted-foreground mt-1"},ie={class:"text-lg font-semibold text-foreground"},le={class:"flex items-center space-x-2"},de={class:"flex justify-end space-x-3"},ae={type:"submit",class:"px-4 py-2 text-sm font-medium text-primary-foreground bg-primary border border-transparent rounded-md shadow-sm hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors duration-200"};function ue(w,o,h,t,a,u){const c=L("beak-modal");return b(),v("div",$,[s(" Header "),e("div",{class:"flex justify-between items-center"},[o[7]||(o[7]=e("h3",{class:"text-lg font-medium text-foreground"},"Milestones",-1)),e("button",{onClick:t.addMilestone,class:"px-3 py-1.5 text-sm font-medium text-foreground bg-background border border-border rounded-md hover:border-primary hover:text-primary hover:bg-secondary transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"},[...o[6]||(o[6]=[e("span",{class:"flex items-center space-x-2"},[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 4v16m8-8H4"})]),e("span",null,"Add New")],-1)])])]),s(" Milestones List "),e("div",ee,[(b(!0),v(H,null,I(t.milestones,r=>(b(),v("div",{key:r.uid,class:C(["pl-6 border-l-2 relative group cursor-pointer",{"border-success/20":r.complete,"border-destructive/20":!r.complete}]),onDblclick:l=>t.editMilestone(r)},[s(" Status Indicator "),e("div",te,[e("div",{class:C(["w-2 h-2 rounded-full transition-colors duration-200",{"bg-success":r.complete,"bg-destructive":!r.complete}])},null,2)]),s(" Milestone Content "),e("div",re,[e("h4",se,g(r.title),1),e("p",ne,g(r.description),1)])],42,oe))),128))]),s(" Create/Edit Milestone Modal "),t.showForm?(b(),q(c,{key:0,onClose:o[5]||(o[5]=r=>t.showForm=!1),"content-width":"w-full max-w-2xl"},{header:U(()=>[e("h3",ie,g(t.formTitle),1)]),body:U(()=>[e("form",{onSubmit:P(t.saveForm,["prevent"]),class:"space-y-6 p-6"},[s(" Title "),e("div",null,[o[8]||(o[8]=e("label",{class:"block text-sm font-medium text-foreground mb-1",for:"title"},[Q(" Title "),e("span",{class:"text-destructive"},"*")],-1)),y(e("input",{id:"title","onUpdate:modelValue":o[0]||(o[0]=r=>t.form.title=r),type:"text",required:"",class:"w-full px-3 py-2 border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-background text-foreground",placeholder:"Enter milestone title"},null,512),[[D,t.form.title]])]),s(" Description "),e("div",null,[o[9]||(o[9]=e("label",{class:"block text-sm font-medium text-foreground mb-1",for:"description"}," Description ",-1)),y(e("textarea",{id:"description","onUpdate:modelValue":o[1]||(o[1]=r=>t.form.description=r),rows:"3",class:"w-full px-3 py-2 border border-border rounded-md shadow-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-primary bg-background text-foreground",placeholder:"Enter milestone description"},null,512),[[D,t.form.description]])]),s(" Assignee "),e("div",null,[o[10]||(o[10]=e("label",{class:"block text-sm font-medium text-foreground mb-1"}," Assignee ",-1)),z(t.Multiselect,{modelValue:t.form.assignee,"onUpdate:modelValue":o[2]||(o[2]=r=>t.form.assignee=r),options:t.users,"track-by":"uid",searchable:!0,"custom-label":t.customLabel,placeholder:"Select assignee",class:"multiselect-primary"},null,8,["modelValue","options"])]),s(" Complete Status "),e("div",le,[y(e("input",{id:"complete","onUpdate:modelValue":o[3]||(o[3]=r=>t.form.complete=r),type:"checkbox",class:"w-4 h-4 text-primary border-border rounded focus:ring-primary focus:ring-offset-2"},null,512),[[J,t.form.complete]]),o[11]||(o[11]=e("label",{class:"text-sm font-medium text-foreground",for:"complete"}," Complete ",-1))]),s(" Submit button "),e("div",de,[e("button",{type:"button",onClick:o[4]||(o[4]=r=>t.showForm=!1),class:"px-4 py-2 text-sm font-medium text-foreground bg-background border border-border rounded-md shadow-sm hover:bg-muted focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-colors duration-200"}," Cancel "),e("button",ae,g(t.formAction?"Create":"Update"),1)])],32)]),_:1})):s("v-if",!0)])}const be=T(Z,[["render",ue],["__scopeId","data-v-7f459d59"],["__file","/home/administrator/Documents/Development/beak-insights/beak/beak-lims/webapp/views/grind/_id/ErrandMilestone.vue"]]);export{be as default};
