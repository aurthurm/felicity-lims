import{a0 as $,f as ee,t as te,a7 as h,a5 as re,h as B,_ as oe,r as M,c as a,o as i,a as L,A as e,E as u,C as ne,N as _,P as se,J as U,K as E,L as d,D as ie,F as b,a9 as R,a2 as S}from"./index-DCVfsbos.js";import{c as de,d as A,a as J,u as ae,b as p}from"./index.esm-89YX2EbQ.js";import{H as ue,J as le}from"./analyses.mutations-BEU63HnJ.js";import{u as me}from"./setup-DMRnqeyP.js";import{u as ce}from"./analysis-BI7XPyQA.js";const fe=$({__name:"Uncertainty",props:{analysis:{type:Object,required:!0,default:()=>({})},analysisUid:{type:String,required:!0,default:0}},setup(V,{expose:t}){t();const x=ce(),r=me(),{withClientMutation:g}=ee(),y=V,{analysis:v}=te(y);let l=h(!1),f=h("");const o=h(!0),m=h(null),N=de({instrumentUid:J().trim().required("Instrument is required"),methodUid:J().trim().required("Method is required"),min:A().typeError("Min must be a number").required("Min is required"),max:A().typeError("Max must be a number").required("Max is required"),value:A().typeError("Variance must be a number").required("Variance is required")}),{handleSubmit:F,resetForm:q,setValues:C}=ae({validationSchema:N,initialValues:{instrumentUid:"",methodUid:"",min:"",max:"",value:""}}),{value:O,errorMessage:P}=p("instrumentUid"),{value:Y,errorMessage:H}=p("methodUid"),{value:K,errorMessage:W}=p("min"),{value:z,errorMessage:G}=p("max"),{value:Q,errorMessage:X}=p("value");re(()=>y.analysisUid,(n,s)=>{}),r.fetchInstruments();const w=B(()=>r.getInstruments);r.fetchMethods();const k=B(()=>r.getMethods);function I(n){g(ue,{payload:n},"createAnalysisUncertainty").then(s=>x.addAnalysisUncertainty(s))}function T(n){m.value&&g(le,{uid:m.value,payload:n},"updateAnalysisUncertainty").then(s=>x.updateAnalysisUncertainty(s))}function Z(n,s={}){o.value=n,l.value=!0,f.value=(n?"CREATE":"EDIT")+" ANALYSIS UNCERTAINTY",n?(m.value=null,q({values:{instrumentUid:"",methodUid:"",min:"",max:"",value:""}})):(m.value=s.uid??null,C({instrumentUid:s.instrumentUid??"",methodUid:s.methodUid??"",min:s.min??"",max:s.max??"",value:s.value??""}))}const j=F(n=>{const s=v?.value?.uid;if(!s)return;const c={instrumentUid:n.instrumentUid,methodUid:n.methodUid,min:Number(n.min),max:Number(n.max),value:Number(n.value),analysisUid:s};o.value===!0&&I(c),o.value===!1&&T(c),l.value=!1}),D={analysisStore:x,setupStore:r,withClientMutation:g,props:y,analysis:v,get showModal(){return l},set showModal(n){l=n},get formTitle(){return f},set formTitle(n){f=n},formAction:o,currentUid:m,uncertaintySchema:N,handleSubmit:F,resetForm:q,setValues:C,instrumentUid:O,instrumentError:P,methodUid:Y,methodError:H,min:K,minError:W,max:z,maxError:G,variance:Q,varianceError:X,instruments:w,methods:k,addAnalysisUncertainty:I,editAnalysisUncertainty:T,FormManager:Z,saveForm:j,instrumentName:n=>{const s=w?.value?.findIndex(c=>c.uid===n);return w?.value[s]?.name||"unknown"},methodName:n=>{const s=k?.value?.findIndex(c=>c.uid===n);return k?.value[s]?.name||"unknown"}};return Object.defineProperty(D,"__isScriptSetup",{enumerable:!1,value:!0}),D}}),be={class:"overflow-x-auto mt-4"},pe={class:"align-middle inline-block min-w-full shadow overflow-hidden bg-card text-card-foreground rounded-lg border border-border"},xe={class:"min-w-full beak-table"},ge={class:"bg-card"},ye={class:"px-4 py-2 whitespace-nowrap border-b border-border"},ve={class:"text-sm text-foreground"},he={class:"px-4 py-2 whitespace-nowrap border-b border-border"},_e={class:"text-sm text-foreground"},Ue={class:"px-4 py-2 whitespace-nowrap border-b border-border"},we={class:"text-sm text-foreground"},ke={class:"px-4 py-2 whitespace-nowrap border-b border-border"},Me={class:"text-sm text-foreground"},Ee={class:"px-4 py-2 whitespace-nowrap border-b border-border"},Se={class:"text-sm text-foreground"},Ae={class:"px-4 py-2 whitespace-nowrap text-right border-b border-border"},Ve=["onClick"],Ne={class:"text-lg font-bold text-foreground"},Fe={class:"space-y-4"},qe={class:"grid grid-cols-5 gap-4"},Ce={class:"space-y-2"},Ie=["value"],Te={key:0,class:"text-sm text-destructive"},De={class:"space-y-2"},Be=["value"],Le={key:0,class:"text-sm text-destructive"},Re={class:"space-y-2"},Je={key:0,class:"text-sm text-destructive"},Oe={class:"space-y-2"},Pe={key:0,class:"text-sm text-destructive"},Ye={class:"space-y-2"},He={key:0,class:"text-sm text-destructive"};function Ke(V,t,x,r,g,y){const v=M("beak-button"),l=M("beak-heading"),f=M("beak-modal");return i(),a(U,null,[L(l,{title:"Uncertainty"},{default:_(()=>[L(v,{onClick:t[0]||(t[0]=o=>r.FormManager(!0))},{default:_(()=>[...t[8]||(t[8]=[se("Add Uncertainty",-1)])]),_:1})]),_:1}),e("div",be,[e("div",pe,[e("table",xe,[t[9]||(t[9]=e("thead",null,[e("tr",null,[e("th",{class:"px-4 py-2 border-b border-border text-left text-sm font-medium text-muted-foreground"},"Instrument"),e("th",{class:"px-4 py-2 border-b border-border text-left text-sm font-medium text-muted-foreground"},"Method"),e("th",{class:"px-4 py-2 border-b border-border text-left text-sm font-medium text-muted-foreground"},"Min"),e("th",{class:"px-4 py-2 border-b border-border text-left text-sm font-medium text-muted-foreground"},"Max"),e("th",{class:"px-4 py-2 border-b border-border text-left text-sm font-medium text-muted-foreground"},"Variance (+/-)"),e("th",{class:"px-4 py-2 border-b border-border"})])],-1)),e("tbody",ge,[(i(!0),a(U,null,E(r.analysis?.uncertainties,o=>(i(),a("tr",{key:o?.uid,class:"hover:bg-accent/50"},[e("td",ye,[e("div",ve,d(r.instrumentName(o?.instrumentUid)),1)]),e("td",he,[e("div",_e,d(r.methodName(o?.methodUid)),1)]),e("td",Ue,[e("div",we,d(o.min),1)]),e("td",ke,[e("div",Me,d(o.max),1)]),e("td",Ee,[e("div",Se,d(o.value),1)]),e("td",Ae,[e("button",{onClick:m=>r.FormManager(!1,o),class:"px-2 py-1 mr-2 border border-border bg-background text-foreground transition-colors duration-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-ring hover:bg-accent hover:text-accent-foreground"},"Edit",8,Ve)])]))),128))])])])]),u(" Uncertainty Form Modal "),r.showModal?(i(),ne(f,{key:0,onClose:t[7]||(t[7]=o=>r.showModal=!1),contentWidth:"w-2/4"},{header:_(()=>[e("h3",Ne,d(r.formTitle),1)]),body:_(()=>[e("form",{onSubmit:t[6]||(t[6]=ie((...o)=>r.saveForm&&r.saveForm(...o),["prevent"])),class:"p-6 space-y-6"},[e("div",Fe,[e("div",qe,[e("label",Ce,[t[11]||(t[11]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Instrument",-1)),b(e("select",{class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":t[1]||(t[1]=o=>r.instrumentUid=o)},[t[10]||(t[10]=e("option",{value:""},"Select Instrument",-1)),(i(!0),a(U,null,E(r.instruments,o=>(i(),a("option",{key:o?.uid,value:o.uid},d(o?.name),9,Ie))),128))],512),[[R,r.instrumentUid]]),r.instrumentError?(i(),a("p",Te,d(r.instrumentError),1)):u("v-if",!0)]),e("label",De,[t[13]||(t[13]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Method",-1)),b(e("select",{class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":t[2]||(t[2]=o=>r.methodUid=o)},[t[12]||(t[12]=e("option",{value:""},"Select Method",-1)),(i(!0),a(U,null,E(r.methods,o=>(i(),a("option",{key:o?.uid,value:o.uid},d(o?.name),9,Be))),128))],512),[[R,r.methodUid]]),r.methodError?(i(),a("p",Le,d(r.methodError),1)):u("v-if",!0)]),e("label",Re,[t[14]||(t[14]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Min",-1)),b(e("input",{type:"number",class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":t[3]||(t[3]=o=>r.min=o),placeholder:"Value ..."},null,512),[[S,r.min]]),r.minError?(i(),a("p",Je,d(r.minError),1)):u("v-if",!0)]),e("label",Oe,[t[15]||(t[15]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Max",-1)),b(e("input",{type:"number",class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":t[4]||(t[4]=o=>r.max=o),placeholder:"Value ..."},null,512),[[S,r.max]]),r.maxError?(i(),a("p",Pe,d(r.maxError),1)):u("v-if",!0)]),e("label",Ye,[t[16]||(t[16]=e("span",{class:"text-sm font-medium text-muted-foreground"},"Variance +/-",-1)),b(e("input",{type:"number",class:"w-full px-3 py-2 border border-input bg-background text-foreground rounded-lg focus:outline-none focus:ring-2 focus:ring-ring","onUpdate:modelValue":t[5]||(t[5]=o=>r.variance=o),placeholder:"Value ..."},null,512),[[S,r.variance]]),r.varianceError?(i(),a("p",He,d(r.varianceError),1)):u("v-if",!0)])])]),t[17]||(t[17]=e("div",{class:"pt-4"},[e("button",{type:"submit",class:"w-full bg-primary text-primary-foreground hover:bg-primary/90 rounded-lg px-4 py-2 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-ring"}," Save Form ")],-1))],32)]),_:1})):u("v-if",!0)],64)}const $e=oe(fe,[["render",Ke],["__file","/home/administrator/Documents/Development/beak-insights/beak/beak-lims/webapp/views/admin/analyses/services/Uncertainty.vue"]]);export{$e as default};
