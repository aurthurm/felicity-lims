const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-B3ZheI5m.js","assets/index-C_1sfwqa.css","assets/BeakSelect-BgG0VmPV.js","assets/BeakSwitch-DTeAYq0B.js"])))=>i.map(i=>d[i]);
import{a0 as ue,S as ce,ac as me,a4 as pe,a7 as i,h as fe,g as ge,a1 as D,a6 as N,av as L,_ as he,c as y,o as x,A as o,F as u,H as w,a as l,N as f,P as g,a3 as ee,J as ve,K as ke,Q as te,L as _,a2 as be}from"./index-B3ZheI5m.js";import{u as ye}from"./worksheet-CF75bUVd.js";import{u as xe}from"./analysis-rzEZ13nX.js";import{u as we}from"./user-BHZZlXLC.js";import{u as _e}from"./setup-DpgcXA6u.js";import{s as Se}from"./index-C7zlg90Q.js";import"./analyses.mutations--kSQRsEC.js";const Re=ue({__name:"WorkSheetResults",setup(m,{expose:s}){s();const T=D(()=>N(()=>import("./index-B3ZheI5m.js").then(t=>t.cm),__vite__mapDeps([0,1]))),e=D(()=>N(()=>import("./BeakSelect-BgG0VmPV.js"),__vite__mapDeps([2,0,1]))),j=D(()=>N(()=>import("./BeakSwitch-DTeAYq0B.js"),__vite__mapDeps([3,0,1]))),h=ce(),a=_e(),c=we(),I=me(),F=pe();let S=i(!1),R=i(!1),U=i(!1),C=i(!1),A=i(!1),V=i(!1),v=i(!1),W=i(!1),d=fe(()=>h.getWorkSheet);const P=()=>{h.fetchWorksheetByUid(I.params.workSheetUid)};c.fetchUsers({}),a.fetchLaboratoryInstruments(),a.fetchMethods();const z=ge({analystUid:null,instrumentUid:null,methodUid:null}),E=i(!1),se=()=>{E.value=!0,h.updateWorksheet({worksheetUid:I.params.workSheetUid,...z}).then(()=>{E.value=!1,P()})};function M(){return d.value?.analysisResults?.every(t=>t.checked===!0)}function k(){let t=[];return d.value?.analysisResults?.forEach(n=>{n.checked&&t.push(n)}),t}function ae(){M()?v.value=!0:v.value=!1,p()}function O(t){if(Y(t)){B(t);return}t.checked=!0,p()}function Y(t){return["retracted","approved"].includes(t.status)}function B(t){t.checked=!1,p()}function oe(){d?.value?.analysisResults?.forEach(t=>v.value?O(t):B(t)),p()}function ne(){d?.value?.analysisResults?.forEach(t=>B(t)),p()}function le(t){let n=[];return t?.forEach(r=>n.push(r.name)),n.join(", ")}function J(t){t.editable=!0}function re(t){return t.status!=="pending"?!1:t?.editable||L(t?.result)?(J(t),!0):!1}function q(){let t=k(),n=[];return t?.forEach(r=>n.push({uid:r.uid,result:r.result,laboratoryInstrumentUid:r.laboratoryInstrumentUid,methodUid:r.methodUid})),n}function b(){const t=k();let n=[];return t?.forEach(r=>n.push(r.uid)),n}function G(){const t=k();let n=[];return t?.forEach(r=>n.push(r.sample?.uid)),n}function ie(t){switch(t?.status){case"retracted":return"bg-muted text-sm italic text-muted-foreground";default:return"text-sm leading-5 text-primary"}}function de(t){switch(t?.status){case"retracted":return!0;case"approved":return t?.reportable===!1;default:return!1}}function p(){S.value=!1,A.value=!1,R.value=!1,U.value=!1,C.value=!1,V.value=!1;const t=k();t.length!==0&&(V.value=!0,t.every(n=>n.status==="pending"&&!L(n.methodUid)&&!L(n.laboratoryInstrumentUid))&&(S.value=!0,A.value=!0),t.every(n=>n.status==="resulted")&&(R.value=!0,U.value=!0,C.value=!0))}const{submitResults:H,approveResults:K,retractResults:Q,retestResults:X}=xe(),{unAssignSamples:Z}=ye(),$={FButton:T,BeakSelect:e,BeakSwitch:j,worksheetStore:h,setupStore:a,userStore:c,route:I,router:F,get can_submit(){return S},set can_submit(t){S=t},get can_retract(){return R},set can_retract(t){R=t},get can_approve(){return U},set can_approve(t){U=t},get can_retest(){return C},set can_retest(t){C=t},get can_unassign(){return A},set can_unassign(t){A=t},get barcodes(){return V},set barcodes(t){V=t},get allChecked(){return v},set allChecked(t){v=t},get viewDetail(){return W},set viewDetail(t){W=t},get worksheet(){return d},set worksheet(t){d=t},refresh:P,form:z,applying:E,applyChanges:se,areAllChecked:M,getResultsChecked:k,checkCheck:ae,check:O,checkDisabled:Y,unCheck:B,toggleCheckAll:oe,unCheckAll:ne,analysesText:le,editResult:J,isEditable:re,prepareResults:q,getResultsUids:b,getSampleUids:G,getResultRowColor:ie,isDisabledRowCheckBox:de,checkUserActionPermissios:p,submitter_:H,approver_:K,retracter_:Q,retester_:X,unassinger_:Z,unAssignSamples:()=>Z(b()),submitResults:()=>H(q(),"worksheet",d.value?.uid),approveResults:()=>K(b(),"worksheet",d.value?.uid),retractResults:()=>Q(b()),retestResults:()=>X(b()),printBarCodes:async()=>{window.open(F.resolve({name:"print-barcodes",query:{sampleUids:JSON.stringify(G().join(","))}}).href,"_blank")},get shield(){return Se}};return Object.defineProperty($,"__isScriptSetup",{enumerable:!1,value:!0}),$}}),Ue={class:"space-y-6"},Ce={class:"flex items-center justify-between bg-background rounded-lg shadow-sm p-4"},Ae={class:"flex items-center space-x-4"},Ve={class:"flex items-center space-x-4"},Be={class:"bg-background rounded-lg shadow-sm overflow-hidden"},Ie={class:"p-4 border-b border-border"},Ee={class:"grid grid-cols-3 gap-4"},De={class:"block space-y-2"},Ne={class:"block space-y-2"},Le={class:"block space-y-2"},Te={class:"mt-4 flex justify-end"},je={class:"overflow-x-auto"},Fe={class:"w-full beak-table"},We={class:"bg-muted"},Pe={class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},ze={class:"divide-y divide-border"},Me={class:"px-4 py-3 whitespace-nowrap"},Oe=["onUpdate:modelValue","disabled"],Ye={class:"px-4 py-3 whitespace-nowrap"},Je={class:"px-4 py-3 whitespace-nowrap"},qe={class:"px-4 py-3 whitespace-nowrap"},Ge={class:"px-4 py-3 whitespace-nowrap"},He=["onUpdate:modelValue"],Ke={key:1},Qe={class:"px-4 py-3 whitespace-nowrap"};function Xe(m,s,T,e,j,h){return x(),y("div",Ue,[o("div",Ce,[o("div",Ae,[u(l(e.FButton,{onClick:s[0]||(s[0]=a=>e.submitResults()),loading:m.submitting,variant:"primary",size:"sm"},{default:f(()=>[...s[14]||(s[14]=[g(" Submit Results ",-1)])]),_:1},8,["loading"]),[[w,e.can_submit&&e.shield.hasRights(e.shield.actions.SUBMIT,e.shield.objects.ANALYSIS)]]),u(l(e.FButton,{onClick:s[1]||(s[1]=a=>e.approveResults()),loading:m.approving,variant:"primary",size:"sm"},{default:f(()=>[...s[15]||(s[15]=[g(" Approve Results ",-1)])]),_:1},8,["loading"]),[[w,e.can_approve&&e.shield.hasRights(e.shield.actions.VERIFY,e.shield.objects.ANALYSIS)]]),u(l(e.FButton,{onClick:s[2]||(s[2]=a=>e.retractResults()),loading:m.retracting,variant:"destructive",size:"sm"},{default:f(()=>[...s[16]||(s[16]=[g(" Retract Results ",-1)])]),_:1},8,["loading"]),[[w,e.can_retract&&e.shield.hasRights(e.shield.actions.RETRACT,e.shield.objects.ANALYSIS)]]),u(l(e.FButton,{onClick:s[3]||(s[3]=a=>e.retestResults()),loading:m.retesting,variant:"secondary",size:"sm"},{default:f(()=>[...s[17]||(s[17]=[g(" Retest ",-1)])]),_:1},8,["loading"]),[[w,e.can_retest&&e.shield.hasRights(e.shield.actions.RETEST,e.shield.objects.ANALYSIS)]]),u(l(e.FButton,{onClick:s[4]||(s[4]=a=>e.unAssignSamples()),loading:m.unassigning,variant:"secondary",size:"sm"},{default:f(()=>[...s[18]||(s[18]=[g(" Unassign ",-1)])]),_:1},8,["loading"]),[[w,e.can_unassign&&e.shield.hasRights(e.shield.actions.UNASSIGN,e.shield.objects.ANALYSIS)]])]),o("div",Ve,[l(e.BeakSwitch,{modelValue:e.viewDetail,"onUpdate:modelValue":s[5]||(s[5]=a=>e.viewDetail=a),label:"View Detail"},null,8,["modelValue"]),l(e.BeakSwitch,{modelValue:e.barcodes,"onUpdate:modelValue":s[6]||(s[6]=a=>e.barcodes=a),label:"Print Barcodes"},null,8,["modelValue"])])]),o("div",Be,[o("div",Ie,[o("div",Ee,[o("label",De,[s[19]||(s[19]=o("span",{class:"text-sm font-medium text-foreground"},"Analyst",-1)),l(e.BeakSelect,{modelValue:e.form.analystUid,"onUpdate:modelValue":s[7]||(s[7]=a=>e.form.analystUid=a),options:e.userStore.getUsers,"option-label":"firstName","option-value":"uid",placeholder:"Select Analyst",class:"w-full"},null,8,["modelValue","options"])]),o("label",Ne,[s[20]||(s[20]=o("span",{class:"text-sm font-medium text-foreground"},"Instrument",-1)),l(e.BeakSelect,{modelValue:e.form.instrumentUid,"onUpdate:modelValue":s[8]||(s[8]=a=>e.form.instrumentUid=a),options:e.setupStore.getLaboratoryInstruments,"option-label":"name","option-value":"uid",placeholder:"Select Instrument",class:"w-full"},null,8,["modelValue","options"])]),o("label",Le,[s[21]||(s[21]=o("span",{class:"text-sm font-medium text-foreground"},"Method",-1)),l(e.BeakSelect,{modelValue:e.form.methodUid,"onUpdate:modelValue":s[9]||(s[9]=a=>e.form.methodUid=a),options:e.setupStore.getMethods,"option-label":"name","option-value":"uid",placeholder:"Select Method",class:"w-full"},null,8,["modelValue","options"])])]),o("div",Te,[l(e.FButton,{onClick:s[10]||(s[10]=a=>e.applyChanges()),loading:e.applying,variant:"primary",size:"sm"},{default:f(()=>[...s[22]||(s[22]=[g(" Apply Changes ",-1)])]),_:1},8,["loading"])])]),o("div",je,[o("table",Fe,[o("thead",We,[o("tr",null,[o("th",Pe,[u(o("input",{type:"checkbox","onUpdate:modelValue":s[11]||(s[11]=a=>e.allChecked=a),onClick:s[12]||(s[12]=a=>e.toggleCheckAll()),class:"rounded border-input text-primary focus:ring-primary"},null,512),[[ee,e.allChecked]])]),s[23]||(s[23]=o("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Sample ID",-1)),s[24]||(s[24]=o("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Client Sample ID",-1)),s[25]||(s[25]=o("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Analysis",-1)),s[26]||(s[26]=o("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Result",-1)),s[27]||(s[27]=o("th",{class:"px-4 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider"},"Status",-1))])]),o("tbody",ze,[(x(!0),y(ve,null,ke(e.worksheet?.analysisResults,a=>(x(),y("tr",{key:a.uid,class:te(e.getResultRowColor(a))},[o("td",Me,[u(o("input",{type:"checkbox","onUpdate:modelValue":c=>a.checked=c,onClick:s[13]||(s[13]=c=>e.checkCheck()),disabled:e.isDisabledRowCheckBox(a),class:"rounded border-input text-primary focus:ring-primary"},null,8,Oe),[[ee,a.checked]])]),o("td",Ye,_(a.sample?.sampleId),1),o("td",Je,_(a.sample?.clientSampleId),1),o("td",qe,_(a.analysis?.name),1),o("td",Ge,[e.isEditable(a)?u((x(),y("input",{key:0,type:"text","onUpdate:modelValue":c=>a.result=c,class:"w-full px-2 py-1 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary"},null,8,He)),[[be,a.result]]):(x(),y("span",Ke,_(a.result),1))]),o("td",Qe,[o("span",{class:te(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",{"bg-primary/10 text-primary":a.status==="pending","bg-warning/10 text-warning":a.status==="awaiting","bg-success/10 text-success":a.status==="approved","bg-destructive/10 text-destructive":a.status==="retracted"}])},_(a.status),3)])],2))),128))])])])])])}const ct=he(Re,[["render",Xe],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/worksheet/_id/WorkSheetResults.vue"]]);export{ct as default};
