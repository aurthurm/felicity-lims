import{a0 as J,f as Q,a4 as j,ad as G,h as T,a7 as c,aK as W,aH as X,i as Y,_ as Z,r as h,c as b,o as d,A as e,C as $,E as ee,a as V,N as g,P as te,J as x,K as A,L as i,D as oe,F as _,a2 as D,a9 as se}from"./index-B3ZheI5m.js";import{u as ae}from"./user-BHZZlXLC.js";import{u as ne}from"./setup-DpgcXA6u.js";import{c as re,a as w,u as ie,b as M}from"./index.esm-C1wdlr_y.js";const le=J({__name:"LaboratoryListing",setup(E,{expose:t}){t();const{toastSuccess:k,toastError:s}=Y(),{withClientQuery:L,withClientMutation:f}=Q(),p=j(),l=ae(),r=ne();G(()=>{r.fetchOrganization(),l.fetchUsers({}),r.fetchLaboratories()});const o=T(()=>l.getUsers),U=T(()=>r.getLaboratories),B=a=>{if(a.labManagerUid){const n=l.getUsers?.filter(I=>I.uid==a.labManagerUid);if(n?.length>0)return`${n[0]?.firstName} ${n[0]?.lastName}`}return"No Manager Assigned"};let m=c(!1),v=c("");const y=c(!0),u=c(null),N=re({name:w().required("Laboratory name is required"),labManagerUid:w().nullable(),businessPhone:w().nullable()}),{handleSubmit:S,errors:z,resetForm:P,setValues:C}=ie({validationSchema:N,initialValues:{name:"",labManagerUid:null,businessPhone:""}}),{value:O}=M("name"),{value:q}=M("labManagerUid"),{value:K}=M("businessPhone");function R(a,n){y.value=a,m.value=!0,v.value=(a?"CREATE":"EDIT")+" Laboratory",a?(u.value=null,P({values:{name:"",labManagerUid:null,businessPhone:""}})):(u.value=n?.uid??null,C({name:n?.name??"",labManagerUid:n?.labManagerUid??null,businessPhone:n?.businessPhone??""}))}const H=S(a=>{if(y.value===!0)f(W,{payload:{...a,organizationUid:r.getOrganization?.uid}},"createLaboratory").then(n=>r.addLaboratory(n));else{if(!u.value)return;f(X,{uid:u.value,payload:a},"updateLaboratory").then(n=>r.updateLaboratory(n,!0))}m.value=!1}),F={toastSuccess:k,toastError:s,withClientQuery:L,withClientMutation:f,router:p,userStore:l,setupStore:r,users:o,laboratories:U,getManagerName:B,get showModal(){return m},set showModal(a){m=a},get formTitle(){return v},set formTitle(a){v=a},formAction:y,currentUid:u,formSchema:N,handleSubmit:S,errors:z,resetForm:P,setValues:C,name:O,labManagerUid:q,businessPhone:K,FormManager:R,saveForm:H};return Object.defineProperty(F,"__isScriptSetup",{enumerable:!1,value:!0}),F}}),de={class:"space-y-6"},ue={class:"shadow-sm rounded-lg bg-card p-6"},be={class:"overflow-x-auto"},fe={class:"min-w-full divide-y divide-border beak-table"},me={class:"divide-y divide-border bg-background"},ce={class:"whitespace-nowrap text-sm text-foreground"},ge={class:"whitespace-nowrap text-sm text-foreground"},pe={class:"whitespace-nowrap text-sm text-foreground"},ve={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-6"},ye=["onClick"],he={class:"text-lg font-semibold text-foreground"},xe={class:"space-y-2"},_e={class:"text-sm text-destructive"},we={class:"space-y-2"},Me=["value"],ke={class:"space-y-2"};function Le(E,t,k,s,L,f){const p=h("beak-button"),l=h("beak-heading"),r=h("beak-modal");return d(),b(x,null,[e("div",de,[V(l,{title:"Laboratories",description:"Manage your laboratories and their details."},{default:g(()=>[V(p,{onClick:t[0]||(t[0]=o=>s.FormManager(!0,null))},{default:g(()=>[...t[6]||(t[6]=[te("Add Laboratory",-1)])]),_:1})]),_:1}),e("div",ue,[e("div",be,[e("table",fe,[t[7]||(t[7]=e("thead",null,[e("tr",null,[e("th",{class:"text-left text-sm font-semibold text-foreground"},"Name"),e("th",{class:"text-left text-sm font-semibold text-foreground"},"Manager"),e("th",{class:"text-left text-sm font-semibold text-foreground"},"Contact Phone"),e("th",{class:"relative py-3.5 pl-3 pr-4 sm:pr-6"},[e("span",{class:"sr-only"},"Actions")])])],-1)),e("tbody",me,[(d(!0),b(x,null,A(s.laboratories,o=>(d(),b("tr",{key:o?.uid,class:"hover:bg-muted/50"},[e("td",ce,i(o?.name),1),e("td",ge,i(s.getManagerName(o)),1),e("td",pe,i(o?.businessPhone),1),e("td",ve,[e("button",{onClick:U=>s.FormManager(!1,o),class:"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 px-4 py-2"}," Edit ",8,ye)])]))),128))])])])])]),s.showModal?(d(),$(r,{key:0,onClose:t[5]||(t[5]=o=>s.showModal=!1)},{header:g(()=>[e("h3",he,i(s.formTitle),1)]),body:g(()=>[e("form",{class:"space-y-6",onSubmit:t[4]||(t[4]=oe((...o)=>s.saveForm&&s.saveForm(...o),["prevent"]))},[e("div",xe,[t[8]||(t[8]=e("label",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"}," Laboratory Name ",-1)),_(e("input",{class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","onUpdate:modelValue":t[1]||(t[1]=o=>s.name=o),placeholder:"Name ..."},null,512),[[D,s.name]]),e("div",_e,i(s.errors.name),1)]),e("div",we,[t[10]||(t[10]=e("label",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"}," Lab Manager ",-1)),_(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.labManagerUid=o),class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"},[t[9]||(t[9]=e("option",{value:""},"Select Manager",-1)),(d(!0),b(x,null,A(s.users,o=>(d(),b("option",{key:o?.uid,value:o.uid},i(o?.firstName)+" "+i(o?.lastName),9,Me))),128))],512),[[se,s.labManagerUid]])]),e("div",ke,[t[11]||(t[11]=e("label",{class:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"}," Business Phone ",-1)),_(e("input",{class:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50","onUpdate:modelValue":t[3]||(t[3]=o=>s.businessPhone=o),placeholder:"Business Phone ..."},null,512),[[D,s.businessPhone]])]),t[12]||(t[12]=e("hr",{class:"border-border"},null,-1)),t[13]||(t[13]=e("button",{type:"submit",class:"inline-flex w-full items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2"}," Save Form ",-1))],32)]),_:1})):ee("",!0)],64)}const Ce=Z(le,[["render",Le],["__file","/home/administrator/Documents/Development/beak-insights/felicity/felicity-lims/webapp/views/admin/laboratory/LaboratoryListing.vue"]]);export{Ce as default};
