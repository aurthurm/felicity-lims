const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BeakDataTable-CSqXb4Dl.js","assets/index-DCVfsbos.js","assets/index-C_1sfwqa.css"])))=>i.map(i=>d[i]);
import{a0 as Y,S as Z,f as $,aq as ee,ac as te,a7 as v,g as oe,aw as se,h as A,a1 as re,a6 as ae,a8 as y,ar as ne,_ as ie,r as N,c as i,o as n,a as P,A as r,N as c,F as f,D as B,H as le,E as S,C as de,J as h,K as w,L as _,a9 as E,a2 as ue}from"./index-DCVfsbos.js";import{u as me}from"./user-C8Z2RT46.js";import{c as ce,d as fe,a as x,u as he,b as p}from"./index.esm-89YX2EbQ.js";import{s as pe}from"./index-BaPnjn4Y.js";const ge=Y({__name:"WorkSheetListing",setup(L,{expose:t}){t();const W=re(()=>ae(()=>import("./BeakDataTable-CSqXb4Dl.js"),__vite__mapDeps([0,1,2]))),e=Z(),d=me(),{withClientMutation:g}=$(),{workSheets:u,fetchingWorkSheets:b,workSheetPageInfo:s,workSheetTemplates:k}=ee(e),R=te();let m=v(!1);const D=v([{name:"All",value:""},{name:"Pending",value:"pending"},{name:"Awaiting",value:"awaiting"},{name:"Approved",value:"approved"},{name:"Empty",value:"empty"}]),I=v([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"WorkSheet Id",value:"workSheetId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(o,l){return y(ne,{to:{name:"worksheet-detail",params:{workSheetUid:o?.uid}},innerHTML:o?.worksheetId})}},{name:"Analysis/Test",value:"analysis.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Samples",value:"assignedCount",sortable:!1,sortBy:"asc",hidden:!1},{name:"Instrument",value:"instrument.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Analyst",value:"clientPatientId",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(o,l){return y("div",{innerHTML:M(o?.analyst)})}},{name:"Status",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(o,l){return y("button",{type:"button",class:"bg-primary text-primary-foreground py-1 px-2 rounded-sm leading-none",innerHTML:o?.state||"unknown"})}}]);e.removeWorksheet();let a=oe({first:25,before:"",status:"",text:"",sort:["-uid"],filterAction:!1});e.fetchWorkSheets(a),e.fetchWorkSheetTemplates(),d.fetchUsers({});const U=ce({analystUid:x().required("Analyst is Required"),templateUid:x().required("Worksheet Template is required"),instrumentUid:x().nullable(),count:fe().min(1,"Count must be at least 1").required("Count is required")}),{handleSubmit:C,errors:F}=he({validationSchema:U,initialValues:{count:1,analystUid:"",templateUid:"",instrumentUid:null}}),{value:O}=p("count"),{value:V}=p("analystUid"),{value:q}=p("templateUid"),{value:H}=p("instrumentUid"),j=C(o=>{m.value=!1,g(se,o,"createWorksheet").then(l=>{e.addWorksheet(l),m.value=!1})});function K(o){let l=[];return o?.forEach(X=>l.push(X.name)),l?.join(", ")}function J(o){a.first=o.fetchCount,a.before=s?.value?.endCursor??"",a.text=o.filterText,a.status=o.filterStatus,a.filterAction=!1,e.fetchWorkSheets(a)}function z(o){a.first=25,a.before="",a.text=o.filterText,a.status=o.filterStatus,a.filterAction=!0,e.fetchWorkSheets(a)}const G=A(()=>d.getUsers),M=o=>o?.auth?.userName?o?.auth?.userName:o?.firstName?o.firstName+" "+o.lastName:"----",Q=A(()=>u?.value?.length+" of "+e.getWorkSheetCount+" WorkSheets"),T={DataTable:W,worksheetStore:e,userStore:d,withClientMutation:g,workSheets:u,fetchingWorkSheets:b,workSheetPageInfo:s,workSheetTemplates:k,route:R,get showModal(){return m},set showModal(o){m=o},filterOptions:D,tableColumns:I,get workSheetParams(){return a},set workSheetParams(o){a=o},worksheetSchema:U,handleSubmit:C,errors:F,count:O,analystUid:V,templateUid:q,instrumentUid:H,saveForm:j,analysesText:K,showMoreWorkSheets:J,searchWorkSheets:z,analysts:G,analystName:M,countNone:Q,get shield(){return pe}};return Object.defineProperty(T,"__isScriptSetup",{enumerable:!1,value:!0}),T}}),be={class:"space-y-6"},ke={class:"rounded-lg border border-border bg-card shadow-sm p-6"},ve={class:"space-y-4"},ye={key:0,class:"space-y-1"},Se={action:"post",class:"space-y-6 p-4"},we={class:"grid grid-cols-3 gap-4"},_e={class:"block space-y-2"},xe=["value"],We={class:"block space-y-2"},Ue=["value"],Ce={class:"block space-y-2"},Me={class:"border-t border-border pt-4"};function Te(L,t,W,e,d,g){const u=N("beak-heading"),b=N("beak-modal");return n(),i(h,null,[P(u,{title:"Worksheets"},{default:c(()=>[f(r("button",{onClick:t[0]||(t[0]=B(s=>e.showModal=!0,["prevent"])),class:"px-4 py-2 bg-primary text-primary-foreground rounded-md transition-colors duration-200 hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Add WorkSheet ",512),[[le,e.shield.hasRights(e.shield.actions.CREATE,e.shield.objects.WORKSHEET)]])]),_:1}),r("div",be,[r("div",ke,[P(e.DataTable,{columns:e.tableColumns,data:e.workSheets,toggleColumns:!0,loading:e.fetchingWorkSheets,paginable:!0,pageMeta:{fetchCount:e.workSheetParams.first,hasNextPage:e.workSheetPageInfo?.hasNextPage,countNone:e.countNone},searchable:!0,filterable:!0,filterMeta:{defaultFilter:e.workSheetParams.status,filters:e.filterOptions},onOnSearch:e.searchWorkSheets,onOnPaginate:e.showMoreWorkSheets,selectable:!1,class:"bg-background rounded-lg shadow-sm"},{footer:c(()=>[...t[6]||(t[6]=[])]),_:1},8,["columns","data","loading","pageMeta","filterMeta"])]),S(" Location Edit Form Modal "),e.showModal?(n(),de(b,{key:0,onClose:t[5]||(t[5]=s=>e.showModal=!1),contentWidth:"w-1/2"},{header:c(()=>[r("div",ve,[t[7]||(t[7]=r("h3",{class:"text-lg font-medium"},"Create Worksheet",-1)),t[8]||(t[8]=r("div",{class:"border-t border-border"},null,-1)),Object.keys(e.errors).length>0?(n(),i("ul",ye,[(n(!0),i(h,null,w(Object.values(e.errors),(s,k)=>(n(),i("li",{key:k,class:"text-destructive text-sm"},_(s),1))),128))])):S("v-if",!0)])]),body:c(()=>[r("form",Se,[r("div",we,[r("label",_e,[t[10]||(t[10]=r("span",{class:"text-sm font-medium"},"Analyst",-1)),f(r("select",{class:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary","onUpdate:modelValue":t[1]||(t[1]=s=>e.analystUid=s)},[t[9]||(t[9]=r("option",{value:""},null,-1)),(n(!0),i(h,null,w(e.analysts,s=>(n(),i("option",{key:s.uid,value:s.uid},_(e.analystName(s)),9,xe))),128))],512),[[E,e.analystUid]])]),r("label",We,[t[12]||(t[12]=r("span",{class:"text-sm font-medium"},"Worksheet Template",-1)),f(r("select",{class:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary","onUpdate:modelValue":t[2]||(t[2]=s=>e.templateUid=s)},[t[11]||(t[11]=r("option",{value:""},null,-1)),(n(!0),i(h,null,w(e.workSheetTemplates,s=>(n(),i("option",{key:s.uid,value:s.uid},_(s.name),9,Ue))),128))],512),[[E,e.templateUid]])]),r("label",Ce,[t[13]||(t[13]=r("span",{class:"text-sm font-medium"},"How Many",-1)),f(r("input",{type:"number",class:"w-full px-3 py-2 border border-input rounded-md bg-background text-foreground focus:outline-none focus:ring-2 focus:ring-primary","onUpdate:modelValue":t[3]||(t[3]=s=>e.count=s),min:"1"},null,512),[[ue,e.count]])])]),r("div",Me,[r("button",{type:"button",onClick:t[4]||(t[4]=B(s=>e.saveForm(),["prevent"])),class:"w-full px-4 py-2 bg-primary text-primary-foreground rounded-md transition-colors duration-200 hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2"}," Save Form ")])])]),_:1})):S("v-if",!0)])],64)}const Ee=ie(ge,[["render",Te],["__file","/home/administrator/Documents/Development/beak-insights/beak/beak-lims/webapp/views/worksheet/WorkSheetListing.vue"]]);export{Ee as default};
