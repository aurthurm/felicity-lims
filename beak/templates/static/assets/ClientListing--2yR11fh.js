const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/BeakDataTable-CSqXb4Dl.js","assets/index-DCVfsbos.js","assets/index-C_1sfwqa.css"])))=>i.map(i=>d[i]);
import{a0 as Y,f as Z,a7 as r,aq as L,g as V,h as $,a1 as ee,a6 as te,a8 as ne,ar as oe,_ as le,r as w,c as d,o as a,a as P,A as l,E as F,C as ie,N as b,F as m,P as se,H as ae,a2 as O,J as C,K as D,L as p,a9 as M,D as re}from"./index-DCVfsbos.js";import{A as de,E as ce}from"./clients.mutations-DUBsbRkU.js";import{u as ue}from"./client-B-7vfgTR.js";import{u as me}from"./location-DdmSnePa.js";import{s as fe}from"./index-BaPnjn4Y.js";const be=Y({__name:"ClientListing",setup(R,{expose:e}){e();const T=ee(()=>te(()=>import("./BeakDataTable-CSqXb4Dl.js"),__vite__mapDeps([0,1,2]))),t=ue(),c=me(),{withClientMutation:v}=Z(),y=r([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Client Name",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(n,u){return ne(oe,{to:{name:"client-detail",query:{clientUid:n?.uid}},class:"px-2 py-1 font-semibold rounded-md hover:underline transition-colors duration-200",innerHTML:n?.name})}},{name:"Client ID",value:"code",sortable:!1,sortBy:"asc",hidden:!1},{name:"District",value:"district.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Province",value:"district.province.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Mobile Number",value:"mobilePhone",sortable:!1,sortBy:"asc",hidden:!1},{name:"Email Address",value:"email",sortable:!1,sortBy:"asc",hidden:!1}]),{countries:h,provinces:k,districts:o}=L(c),{clients:N,clientPageInfo:B,fetchingClients:j}=L(t);let g=r(!1),f=r(!1),U=r(""),s=V({});const E=r(""),q=()=>Object.assign(s,{});let i=V({first:50,after:"",text:"",sortBy:["uid"],filterAction:!1}),x=r(),_=r();t.fetchClients(i),c.fetchCountries();function I(){v(de,{payload:{name:s.name,code:s.code,districtUid:s.districtUid}},"createClient").then(n=>t.addClient(n))}function A(){v(ce,{uid:s.uid,payload:{name:s.name,code:s.code,districtUid:s.districtUid}},"updateClient").then(n=>t.updateClient(n))}function H(n){c.filterProvincesByCountry(x.value)}function K(n){c.filterDistrictsByProvince(_.value)}function J(n){i.first=100,i.after="",i.text=n.filterText,i.filterAction=!0,t.fetchClients(i)}function z(n){i.first=n.fetchCount,i.after=B?.value?.endCursor,i.text=n.filterText,i.filterAction=!1,t.fetchClients(i)}function G(n,u,X={}){f.value=n,U.value=u,E.value=(n?"CREATE":"EDIT")+" "+u.toUpperCase(),u=="client"&&(g.value=!0),n?u=="client"&&Object.assign(s,{}):u=="client"&&Object.assign(s,{...X})}function Q(){f.value&&I(),f.value||A(),g.value=!1}const W=$(()=>N?.value?.length+" of "+t.getClientCount+" clients"),S={DataTable:T,clientStore:t,locationStore:c,withClientMutation:v,tableColumns:y,countries:h,provinces:k,districts:o,clients:N,clientPageInfo:B,fetchingClients:j,get showClientModal(){return g},set showClientModal(n){g=n},get createItem(){return f},set createItem(n){f=n},get targetItem(){return U},set targetItem(n){U=n},get client(){return s},set client(n){s=n},formTitle:E,resetClient:q,get clientParams(){return i},set clientParams(n){i=n},get countryUid(){return x},set countryUid(n){x=n},get provinceUid(){return _},set provinceUid(n){_=n},addClient:I,editClient:A,getProvinces:H,getDistricts:K,searchClients:J,showMoreClients:z,FormManager:G,saveForm:Q,countNone:W,get shield(){return fe}};return Object.defineProperty(S,"__isScriptSetup",{enumerable:!1,value:!0}),S}}),ve={class:"rounded-lg border border-border bg-card shadow-sm p-6"},ge={action:"post",class:"p-1"},Ce={class:"grid grid-cols-2 gap-x-4 mb-4"},pe={class:"block col-span-1 mb-2"},ye={class:"block col-span-1 mb-2"},he={class:"grid grid-cols-3 gap-x-4 mb-4"},ke={class:"block col-span-1 mb-2"},Ue=["value"],xe={class:"block col-span-1 mb-2"},_e=["value"],we={class:"block col-span-1 mb-2"},Pe=["value"];function De(R,e,T,t,c,v){const y=w("beak-button"),h=w("beak-heading"),k=w("beak-modal");return a(),d(C,null,[P(h,{title:"Clients"},{default:b(()=>[m(P(y,{onClick:e[0]||(e[0]=o=>t.FormManager(!0,"client"))},{default:b(()=>[...e[10]||(e[10]=[se(" Add client ",-1)])]),_:1},512),[[ae,t.shield.hasRights(t.shield.actions.CREATE,t.shield.objects.CLIENT)]])]),_:1}),l("div",ve,[P(t.DataTable,{columns:t.tableColumns,data:t.clients,toggleColumns:!0,loading:t.fetchingClients,paginable:!0,pageMeta:{fetchCount:t.clientParams.first,hasNextPage:t.clientPageInfo?.hasNextPage,countNone:t.countNone},searchable:!0,filterable:!1,onOnSearchKeyUp:t.searchClients,onOnSearchFocus:t.resetClient,onOnPaginate:t.showMoreClients,selectable:!1},{footer:b(()=>[...e[11]||(e[11]=[])]),_:1},8,["columns","data","loading","pageMeta"])]),F(" Location Edit Form Modal "),t.showClientModal?(a(),ie(k,{key:0,onClose:e[9]||(e[9]=o=>t.showClientModal=!1)},{header:b(()=>[l("h3",null,p(t.formTitle),1)]),body:b(()=>[l("form",ge,[l("div",Ce,[l("label",pe,[e[12]||(e[12]=l("span",{class:"text-foreground"},"Name",-1)),m(l("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":e[1]||(e[1]=o=>t.client.name=o),placeholder:"Name ..."},null,512),[[O,t.client.name]])]),l("label",ye,[e[13]||(e[13]=l("span",{class:"text-foreground"},"Code",-1)),m(l("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":e[2]||(e[2]=o=>t.client.code=o),placeholder:"Code ..."},null,512),[[O,t.client.code]])])]),l("div",he,[l("label",ke,[e[15]||(e[15]=l("span",{class:"text-foreground"},"Country",-1)),m(l("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[3]||(e[3]=o=>t.countryUid=o),onChange:e[4]||(e[4]=o=>t.getProvinces(o))},[e[14]||(e[14]=l("option",null,null,-1)),(a(!0),d(C,null,D(t.countries,o=>(a(),d("option",{key:o.uid,value:o.uid},p(o.name),9,Ue))),128))],544),[[M,t.countryUid]])]),l("label",xe,[e[17]||(e[17]=l("span",{class:"text-foreground"},"Province",-1)),m(l("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[5]||(e[5]=o=>t.provinceUid=o),onChange:e[6]||(e[6]=o=>t.getDistricts(o))},[e[16]||(e[16]=l("option",null,null,-1)),(a(!0),d(C,null,D(t.provinces,o=>(a(),d("option",{key:o.uid,value:o.uid},p(o.name),9,_e))),128))],544),[[M,t.provinceUid]])]),l("label",we,[e[19]||(e[19]=l("span",{class:"text-foreground"},"District",-1)),m(l("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":e[7]||(e[7]=o=>t.client.districtUid=o)},[e[18]||(e[18]=l("option",null,null,-1)),(a(!0),d(C,null,D(t.districts,o=>(a(),d("option",{key:o.uid,value:o.uid},p(o.name),9,Pe))),128))],512),[[M,t.client.districtUid]])])]),e[20]||(e[20]=l("hr",null,null,-1)),l("button",{type:"button",onClick:e[8]||(e[8]=re(o=>t.saveForm(),["prevent"])),class:"m-2 -mb-4 w-full rounded-sm border border-primary bg-primary px-4 py-2 text-primary-foreground transition-colors duration-500 ease select-none hover:bg-primary focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):F("v-if",!0)],64)}const Ie=le(be,[["render",De],["__file","/home/administrator/Documents/Development/beak-insights/beak/beak-lims/webapp/views/client/ClientListing.vue"]]);export{Ie as default};
