import{S as z,bb as xe,q as we,_ as Ue,v as Re,n as Ce,W as Se,ab as Ae}from"./billing-356772f3.js";import{f as Ee,G as Te,r as u,d as Ve,c as We,v as De,aj as G,h as n,k as a,ag as l,x as e,al as K,i as J,u as d,F as f,ak as g,D as i,B as Be,A as Q,y as W,s as X,j as Ne,_ as Oe}from"./_plugin-vue_export-helper-3f67fb71.js";import{a as $e}from"./index-3189f120.js";import{u as Ie}from"./analysis-ff49db01.js";import{u as Ke}from"./samples-6869bb19.js";import{h as x,o as w,a as U}from"./constants-df420cc9.js";import{e as M,d as R,a as p,b as m,v as Me}from"./runtime-dom.esm-bundler-6e07ef74.js";function Pe(){const{withClientMutation:P}=we();return{unAssignSamples:async v=>{try{z.fire({title:"Are you sure?",text:"You want to Un-Assign these analyses",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, Un-Assign now!",cancelButtonText:"No, cancel UnAssign!"}).then(async h=>{h.isConfirmed&&(await P(xe,v,"updateWorksheet").then(C=>{}),z.fire("Its Happening!","Selected analyses have been UnAssigned.","success").then(C=>location.reload()))})}catch{}}}}const je={class:""},qe=e("hr",{class:"mt-4"},null,-1),He={class:"flex justify-between items-center"},Fe={for:"toggle",class:"text-medium text-gray-700 my-4"},Le={class:"relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in"},Ye=e("label",{for:"toggle",class:"toggle-label block overflow-hidden h-6 rounded-full bg-gray-300 cursor-pointer"},null,-1),ze={action:"post",class:"p-1"},Ge={class:"flex justify-start items-center mb-4"},Je={class:"flex justify-between items-center"},Qe=e("span",{class:"text-gray-700 mr-2"},"Analyst",-1),Xe=["value"],Ze={class:"flex justify-between items-center ml-4"},et=e("span",{class:"text-gray-700 mr-2"},"Instrument",-1),tt=["value"],st={class:"flex justify-between items-center ml-4"},ot=e("span",{class:"text-gray-700 mr-2"},"Method",-1),nt=["value"],at={class:"ml-6 mt-2"},rt=e("hr",{class:"mb-4"},null,-1),lt={class:"overflow-x-auto"},it={class:"align-middle inline-block min-w-full shadow overflow-hidden bg-white shadow-dashboard px-2 pt-1 rounded-bl-lg rounded-br-lg"},dt={class:"min-w-full"},ut={class:"px-1 py-1 border-b-2 border-gray-300 text-left leading-4 text-gray-800 tracking-wider"},ct=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left leading-4 text-gray-800 tracking-wider"},null,-1),pt=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left leading-4 text-gray-800 tracking-wider"}," Sample ID ",-1),mt=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Analysis/Test ",-1),ht=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Instrument ",-1),yt=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Method ",-1),bt=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Interim ",-1),_t=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Result ",-1),ft=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Unit ",-1),gt=e("th",{class:"px-1 py-1 border-b-2 border-gray-300 text-left text-sm leading-4 text-gray-800 tracking-wider"}," Status ",-1),vt={class:"bg-white"},kt=["onUpdate:modelValue","disabled"],xt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},wt=e("i",{class:"fa fa-star"},null,-1),Ut=[wt],Rt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Ct={class:"text-sm leading-5 text-gray-800 font-semibold"},St={key:1},At={key:0},Et={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Tt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Vt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Wt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Dt={key:0,class:"text-sm leading-5 text-sky-800"},Bt={key:1,class:"block col-span-2 mb-2"},Nt=["onUpdate:modelValue","onChange"],Ot=e("option",{value:""},null,-1),$t=["value"],It={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Kt={key:0},Mt={key:1,class:"block"},Pt=["onUpdate:modelValue","onKeyup"],jt={key:2,class:"block col-span-2 mb-2"},qt=["onUpdate:modelValue","onChange"],Ht=e("option",{value:""},null,-1),Ft=["value"],Lt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},Yt={class:"px-1 py-1 whitespace-no-wrap border-b border-gray-500"},zt={type:"button",class:"bg-sky-800 text-white py-1 px-2 rounded-sm leading-none"},Gt={class:"my-4"},Jt=["onClick"],Qt=Ee({__name:"WorkSheetResults",setup(P){const j=Te(()=>Ue(()=>import("./Button-dc046b43.js"),["assets/Button-dc046b43.js","assets/_plugin-vue_export-helper-3f67fb71.js"])),v=Re(),h=Ce(),C=Se(),q=$e();let D=u(!1),B=u(!1),N=u(!1),O=u(!1),$=u(!1),I=u(!1),y=u(!1),k=u(!1),b=Ve(()=>v.getWorkSheet);const H=()=>{v.fetchWorksheetByUid(q.params.workSheetUid)};C.fetchUsers({}),h.fetchInstruments(),h.fetchMethods();const _=We({analystUid:void 0,instrumentUid:void 0,methodUid:void 0}),S=u(!1),Z=()=>{S.value=!0,v.updateWorksheet({worksheetUid:q.params.workSheetUid,..._}).then(()=>{S.value=!1,H()})};function ee(){return b.value?.analysisResults?.every(o=>o.checked===!0)}function A(){let o=[];return b.value?.analysisResults?.forEach(s=>{s.checked&&o.push(s)}),o}function te(){ee()?y.value=!0:y.value=!1,V()}function E(o){if(F(o)){L(o);return}o.checked=!0,V()}function F(o){return["retracted","approved"].includes(o.status)}function L(o){o.checked=!1,V()}function se(){b?.value?.analysisResults?.forEach(o=>y.value?E(o):L(o)),V()}function oe(o){o.editable=!0}function Y(o){return o.status!=="pending"?!1:o?.editable||Ae(o?.result)?(oe(o),!0):!1}function ne(){let o=A(),s=[];return o?.forEach(c=>s.push({uid:c.uid,result:c.result})),s}function T(){const o=A();let s=[];return o?.forEach(c=>s.push(c.uid)),s}function ae(){const o=A();let s=[];return o?.forEach(c=>s.push(c.sampleUid)),s}function re(o){switch(o?.status){case"retracted":return"bg-gray-300 text-sm italic text-gray-500";case"pending":return o?.retest===!0?"bg-sky-800 text-sm leading-5 text-sky-800":"";case"resulted":return o?.retest===!0?"bg-sky-800 text-sm leading-5 text-sky-800":"";case"approved":return o?.retest===!0?"bg-sky-800 text-sm leading-5 text-sky-800":"";default:return"text-sm leading-5 text-sky-800"}}function V(){D.value=!1,$.value=!1,B.value=!1,N.value=!1,O.value=!1,I.value=!1;const o=A();o.length!==0&&(I.value=!0,o.every(s=>s.status==="pending")&&(D.value=!0,$.value=!0),o.every(s=>s.status==="resulted")&&(B.value=!0,N.value=!0,O.value=!0))}const{submitResults:le,approveResults:ie,retractResults:de,retestResults:ue}=Ie(),{barcodeSamples:ce}=Ke(),{unAssignSamples:pe}=Pe(),me=()=>pe(T()),he=()=>le(ne(),"worksheet",b.value?.uid),ye=()=>ie(T(),"worksheet",b.value?.uid),be=()=>de(T()),_e=()=>ue(T()),fe=async()=>await ce(ae());return(o,s)=>{const c=De("router-link"),ge=G("motion-slide-left"),ve=G("motion-slide-right");return n(),a("div",je,[qe,l((n(),a("div",He,[e("label",Fe,[K("More Sample Detail "),e("div",Le,[l(e("input",{type:"checkbox",name:"toggle",id:"toggle","onUpdate:modelValue":s[0]||(s[0]=t=>J(k)?k.value=t:k=t),class:"toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer outline-none"},null,512),[[M,d(k)]]),Ye])]),l(e("form",ze,[e("div",Ge,[e("label",Je,[Qe,l(e("select",{name:"instrument_uid","onUpdate:modelValue":s[1]||(s[1]=t=>_.analystUid=t),class:"form-input mt-1 block w-full py-1"},[(n(!0),a(f,null,g(d(C).users,t=>(n(),a("option",{key:t.uid,value:t.uid},i(t.firstName)+" "+i(t.lastName),9,Xe))),128))],512),[[R,_.analystUid]])]),e("label",Ze,[et,l(e("select",{name:"instrument_uid","onUpdate:modelValue":s[2]||(s[2]=t=>_.instrumentUid=t),class:"form-input mt-1 block w-full py-1"},[(n(!0),a(f,null,g(d(h).instruments,t=>(n(),a("option",{key:t.uid,value:t.uid},i(t.name),9,tt))),128))],512),[[R,_.instrumentUid]])]),e("label",st,[ot,l(e("select",{name:"method_uid","onUpdate:modelValue":s[3]||(s[3]=t=>_.methodUid=t),class:"form-input mt-1 block w-full py-1"},[(n(!0),a(f,null,g(d(h).methods,t=>(n(),a("option",{key:t.uid,value:t.uid},i(t.name),9,nt))),128))],512),[[R,_.methodUid]])]),e("div",at,[Be(d(j),{onClick:s[4]||(s[4]=p(t=>Z(),["prevent"])),color:"sky-800",class:"p-1"},{default:Q(()=>[K("Apply")]),_:1})])])],512),[[m,!S.value]]),l(e("p",null,"updating ...",512),[[m,S.value]]),e("div",null,[e("button",{onClick:s[5]||(s[5]=p(t=>H(),["prevent"])),class:"px-1 py-1 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Refresh ")])])),[[ge]]),rt,W(" Sampe Table View "),e("div",lt,[e("div",it,[e("table",dt,[e("thead",null,[e("tr",null,[e("th",ut,[l(e("input",{type:"checkbox",class:"",onChange:s[6]||(s[6]=t=>se()),"onUpdate:modelValue":s[7]||(s[7]=t=>J(y)?y.value=t:y=t)},null,544),[[M,d(y)]])]),ct,pt,mt,ht,yt,bt,_t,ft,gt,W(' <th class="px-1 py-1 border-b-2 border-gray-300"></th> ')])]),e("tbody",vt,[(n(!0),a(f,null,g(d(b)?.analysisResults,t=>l((n(),a("tr",{key:t.uid,class:X([re(t)])},[e("td",null,[l(e("input",{type:"checkbox",class:"","onUpdate:modelValue":r=>t.checked=r,onChange:s[8]||(s[8]=r=>te()),disabled:F(t)},null,40,kt),[[M,t.checked]])]),e("td",xt,[t?.sample?.priority>0?(n(),a("span",{key:0,class:X(["font-small",{"text-orange-600":d(b)?.priority>1}])},Ut,2)):W("v-if",!0)]),e("td",Rt,[e("div",Ct,[t?.sample?.analysisRequest?.patient?.uid?(n(),Ne(c,{key:0,to:{name:"sample-detail",params:{patientUid:t?.sample?.analysisRequest?.patient?.uid,sampleUid:t?.sample?.uid}}},{default:Q(()=>[K(i(t?.sample?.sampleId),1)]),_:2},1032,["to"])):(n(),a("div",St,i(t?.sample?.sampleId),1))]),d(k)?(n(),a("span",At,[e("span",null,i(t?.sample?.qcLevel?.level),1),e("div",null,i(t?.sample?.analysisRequest?.patient?.firstName)+" "+i(t?.sample?.analysisRequest?.patient?.lastName),1),e("div",null,i(t?.sample?.analysisRequest?.client?.name),1)])):W("v-if",!0)]),e("td",Et,[e("div",null,i(t?.analysis?.name),1)]),e("td",Tt,[e("div",null,i(t?.instrument?.name||"None"),1)]),e("td",Vt,[e("div",null,i(t?.method?.name||"None"),1)]),e("td",Wt,[!Y(t)||(t?.analysis?.interims?.length??0)===0?(n(),a("div",Dt," --- ")):(n(),a("label",Bt,[l(e("select",{class:"form-input mt-1 block w-full","onUpdate:modelValue":r=>t.result=r,onChange:r=>E(t)},[Ot,(n(!0),a(f,null,g(t?.analysis?.interims,(r,ke)=>(n(),a("option",{key:r.key,value:r.value},i(r.value),9,$t))),128))],40,Nt),[[R,t.result]])]))]),e("td",It,[Y(t)?t?.analysis?.resultOptions?.length===0?(n(),a("label",Mt,[l(e("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":r=>t.result=r,onKeyup:r=>E(t)},null,40,Pt),[[Me,t.result]])])):(n(),a("label",jt,[l(e("select",{class:"form-input mt-1 block w-full","onUpdate:modelValue":r=>t.result=r,onChange:r=>E(t)},[Ht,(n(!0),a(f,null,g(t?.analysis?.resultOptions,(r,ke)=>(n(),a("option",{key:r.optionKey,value:r.value},i(r.value),9,Ft))),128))],40,qt),[[R,t.result]])])):(n(),a("div",Kt,i(t?.result),1))]),e("td",Lt,[e("div",null,i(t?.analysis?.unit?.name||"---"),1)]),e("td",Yt,[e("button",zt,i(t?.status||"unknown"),1)])],2)),[[ve]])),128))])])])]),e("section",Gt,[l(e("button",{onClick:s[9]||(s[9]=p(t=>me(),["prevent"])),class:"px-2 py-1 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Un Assign ",512),[[m,x(U.CREATE,w.WORKSHEET)&&d($)]]),l(e("button",{onClick:s[10]||(s[10]=p(t=>he(),["prevent"])),class:"px-2 py-1 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Submit ",512),[[m,x(U.UPDATE,w.WORKSHEET)&&d(D)]]),l(e("button",{onClick:s[11]||(s[11]=p(t=>be(),["prevent"])),class:"px-2 py-1 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Retract ",512),[[m,x(U.UPDATE,w.WORKSHEET)&&d(B)]]),l(e("button",{onClick:s[12]||(s[12]=p(t=>ye(),["prevent"])),class:"px-2 py-1 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Approve ",512),[[m,x(U.UPDATE,w.WORKSHEET)&&d(N)]]),l(e("button",{onClick:s[13]||(s[13]=p(t=>_e(),["prevent"])),class:"px-2 py-1 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Retest ",512),[[m,x(U.UPDATE,w.WORKSHEET)&&d(O)]]),l(e("button",{onClick:p(fe,["prevent"]),class:"px-2 py-1 mr-2 border-sky-800 border text-sky-800 rounded-sm transition duration-300 hover:bg-sky-800 hover:text-white focus:outline-none"}," Print Barcodes ",8,Jt),[[m,d(I)]])])])}}}),as=Oe(Qt,[["__file","/home/aurthurm/Development/felicity-lims/webapp/views/worksheet/_id/WorkSheetResults.vue"]]);export{as as default};
