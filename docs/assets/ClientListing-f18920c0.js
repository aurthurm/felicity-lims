import{f as J,r as u,C as Q,c as D,d as W,h as i,k as c,B as T,ag as f,x as s,A as g,u as l,y as N,j as X,D as v,i as y,F as h,ak as _,_ as Y}from"./_plugin-vue_export-helper-3f67fb71.js";import Z from"./DataTable-6e858f1d.js";import{R as ee}from"./index-3189f120.js";import{B as te,l as se,j as E,q as oe}from"./billing-356772f3.js";import le from"./SimpleModal-1f91868a.js";import{A as ne,E as ae}from"./clients.mutations-f140edee.js";import{h as ie,o as re,a as ue}from"./constants-df420cc9.js";import ce from"./PageHeading-8026de94.js";import{b as de,v as M,d as k,a as fe}from"./runtime-dom.esm-bundler-6e07ef74.js";const me=s("hr",null,null,-1),pe={action:"post",class:"p-1"},be={class:"grid grid-cols-2 gap-x-4 mb-4"},ve={class:"block col-span-1 mb-2"},he=s("span",{class:"text-gray-700"},"Name",-1),Ce={class:"block col-span-1 mb-2"},ge=s("span",{class:"text-gray-700"},"Code",-1),ye={class:"grid grid-cols-3 gap-x-4 mb-4"},_e={class:"block col-span-1 mb-2"},ke=s("span",{class:"text-gray-700"},"Country",-1),xe=s("option",null,null,-1),we=["value"],Ue={class:"block col-span-1 mb-2"},Be=s("span",{class:"text-gray-700"},"Province",-1),De=s("option",null,null,-1),Te=["value"],Ne={class:"block col-span-1 mb-2"},Ee=s("span",{class:"text-gray-700"},"District",-1),Me=s("option",null,null,-1),Pe=["value"],Ae=s("hr",null,null,-1),Ie=J({__name:"ClientListing",setup(Le){const r=te(),b=se(),{withClientMutation:x}=oe(),P=u([{name:"UID",value:"uid",sortable:!0,sortBy:"asc",defaultSort:!0,showInToggler:!1,hidden:!0},{name:"Client Name",value:"",sortable:!1,sortBy:"asc",hidden:!1,customRender:function(o,t){return Q(ee,{to:{name:"client-detail",query:{clientUid:o?.uid}},class:"px-1 ml-2 border-white border text-gray-500rounded-smtransition duration-300 hover:border-sky-800 hover:text-sky-800 focus:outline-none",innerHTML:o?.name})}},{name:"Client ID",value:"code",sortable:!1,sortBy:"asc",hidden:!1},{name:"District",value:"district.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Province",value:"district.province.name",sortable:!1,sortBy:"asc",hidden:!1},{name:"Mobile Number",value:"mobilePhone",sortable:!1,sortBy:"asc",hidden:!1},{name:"Email Asdress",value:"email",sortable:!1,sortBy:"asc",hidden:!1}]),{countries:A,provinces:I,districts:L}=E(b),{clients:w,clientPageInfo:U,fetchingClients:S}=E(r);let d=u(!1),C=u(!1),R=u(""),n=D({});const B=u(""),V=()=>Object.assign(n,{});let a=D({first:50,after:"",text:"",sortBy:["uid"],filterAction:!1}),m=u(),p=u();r.fetchClients(a),b.fetchCountries();function F(){x(ne,{payload:{name:n.name,code:n.code,districtUid:n.districtUid}},"createClient").then(o=>r.addClient(o))}function j(){x(ae,{uid:n.uid,payload:{name:n.name,code:n.code,districtUid:n.districtUid}},"updateClient").then(o=>r.updateClient(o))}function O(o){b.filterProvincesByCountry(m.value)}function q(o){b.filterDistrictsByProvince(p.value)}function H(o){a.first=100,a.after="",a.text=o.filterText,a.filterAction=!0,r.fetchClients(a)}function K(o){a.first=o.fetchCount,a.after=U?.value?.endCursor,a.text=o.filterText,a.filterAction=!1,r.fetchClients(a)}function $(o,t,e={}){C.value=o,R.value=t,B.value=(o?"CREATE":"EDIT")+" "+t.toUpperCase(),t=="client"&&(d.value=!0),o?t=="client"&&Object.assign(n,{}):t=="client"&&Object.assign(n,{...e})}function z(){C.value&&F(),C.value||j(),d.value=!1}const G=W(()=>w?.value?.length+" of "+r.getClientCount+" clients");return(o,t)=>(i(),c(h,null,[T(ce,{title:"Clients"}),f(s("button",{class:"p-2 my-2 text-sm border-sky-800 border text-dark-700 transition-colors duration-150 rounded-sm focus:outline-none hover:bg-sky-800 hover:text-gray-100",onClick:t[0]||(t[0]=e=>$(!0,"client"))}," Add client ",512),[[de,ie(ue.CREATE,re.CLIENT)]]),me,T(Z,{columns:P.value,data:l(w),toggleColumns:!0,loading:l(S),paginable:!0,pageMeta:{fetchCount:l(a).first,hasNextPage:l(U)?.hasNextPage,countNone:l(G)},searchable:!0,filterable:!1,onOnSearchKeyUp:H,onOnSearchFocus:V,onOnPaginate:K,selectable:!1},{footer:g(()=>[]),_:1},8,["columns","data","loading","pageMeta"]),N(" Location Edit Form Modal "),l(d)?(i(),X(le,{key:0,onClose:t[9]||(t[9]=e=>y(d)?d.value=!1:d=!1)},{header:g(()=>[s("h3",null,v(B.value),1)]),body:g(()=>[s("form",pe,[s("div",be,[s("label",ve,[he,f(s("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":t[1]||(t[1]=e=>l(n).name=e),placeholder:"Name ..."},null,512),[[M,l(n).name]])]),s("label",Ce,[ge,f(s("input",{class:"form-input mt-1 block w-full","onUpdate:modelValue":t[2]||(t[2]=e=>l(n).code=e),placeholder:"Code ..."},null,512),[[M,l(n).code]])])]),s("div",ye,[s("label",_e,[ke,f(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":t[3]||(t[3]=e=>y(m)?m.value=e:m=e),onChange:t[4]||(t[4]=e=>O(e))},[xe,(i(!0),c(h,null,_(l(A),e=>(i(),c("option",{key:e.uid,value:e.uid},v(e.name),9,we))),128))],544),[[k,l(m)]])]),s("label",Ue,[Be,f(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":t[5]||(t[5]=e=>y(p)?p.value=e:p=e),onChange:t[6]||(t[6]=e=>q(e))},[De,(i(!0),c(h,null,_(l(I),e=>(i(),c("option",{key:e.uid,value:e.uid},v(e.name),9,Te))),128))],544),[[k,l(p)]])]),s("label",Ne,[Ee,f(s("select",{class:"form-select block w-full mt-1","onUpdate:modelValue":t[7]||(t[7]=e=>l(n).districtUid=e)},[Me,(i(!0),c(h,null,_(l(L),e=>(i(),c("option",{key:e.uid,value:e.uid},v(e.name),9,Pe))),128))],512),[[k,l(n).districtUid]])])]),Ae,s("button",{type:"button",onClick:t[8]||(t[8]=fe(e=>z(),["prevent"])),class:"-mb-4 w-full border border-sky-800 bg-sky-800 text-white rounded-sm px-4 py-2 m-2 transition-colors duration-500 ease select-none hover:bg-sky-800 focus:outline-none focus:shadow-outline"}," Save Form ")])]),_:1})):N("v-if",!0)],64))}}),$e=Y(Ie,[["__file","/home/aurthurm/Development/felicity-lims/webapp/views/client/ClientListing.vue"]]);export{$e as default};
